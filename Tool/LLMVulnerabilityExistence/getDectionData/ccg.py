import sys
import os

sys.path.append(os.path.abspath(r'D:\D\个人文件\开源软件供应链安全\python漏洞影响性分析实验\知识图谱创建\bishe\Jarvis'))
from Jarvis.jarvis import CallGraphGenerator


def ccg(relative_entry):
    relative_entry = "/".join(relative_entry.split(os.sep))
    absolute_entry = os.path.abspath(relative_entry)
    package = os.path.dirname(absolute_entry)
    entry_points = [absolute_entry]
    call_graph_generator = CallGraphGenerator(entry_points, package, decy=False)
    # 执行分析
    call_graph_generator.analyze()
    call_graph = call_graph_generator.output()

    return call_graph

