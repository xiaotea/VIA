{
    "proxy/http/proxy/auth.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 35,
                "afterPatchRowNumber": 35,
                "PatchRowcode": "                 raise ProxyAuthenticationFailed()"
            },
            "1": {
                "beforePatchRowNumber": 36,
                "afterPatchRowNumber": 36,
                "PatchRowcode": "             parts = request.headers[b'proxy-authorization'][1].split()"
            },
            "2": {
                "beforePatchRowNumber": 37,
                "afterPatchRowNumber": 37,
                "PatchRowcode": "             if len(parts) != 2 \\"
            },
            "3": {
                "beforePatchRowNumber": 38,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    and parts[0].lower() != b'basic' \\"
            },
            "4": {
                "beforePatchRowNumber": 39,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    and parts[1] != self.flags.auth_code:"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 38,
                "PatchRowcode": "+                    or parts[0].lower() != b'basic' \\"
            },
            "6": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 39,
                "PatchRowcode": "+                    or parts[1] != self.flags.auth_code:"
            },
            "7": {
                "beforePatchRowNumber": 40,
                "afterPatchRowNumber": 40,
                "PatchRowcode": "                 raise ProxyAuthenticationFailed()"
            },
            "8": {
                "beforePatchRowNumber": 41,
                "afterPatchRowNumber": 41,
                "PatchRowcode": "         return request"
            },
            "9": {
                "beforePatchRowNumber": 42,
                "afterPatchRowNumber": 42,
                "PatchRowcode": " "
            }
        },
        "frontPatchFile": [
            "# -*- coding: utf-8 -*-",
            "\"\"\"",
            "    proxy.py",
            "    ~~~~~~~~",
            "    \u26a1\u26a1\u26a1 Fast, Lightweight, Pluggable, TLS interception capable proxy server focused on",
            "    Network monitoring, controls & Application development, testing, debugging.",
            "",
            "    :copyright: (c) 2013-present by Abhinav Singh and contributors.",
            "    :license: BSD, see LICENSE for more details.",
            "\"\"\"",
            "from typing import Optional",
            "",
            "from ..exception import ProxyAuthenticationFailed",
            "from ...common.flag import flags",
            "from ...common.constants import DEFAULT_BASIC_AUTH",
            "from ...http.parser import HttpParser",
            "from ...http.proxy import HttpProxyBasePlugin",
            "",
            "",
            "flags.add_argument(",
            "    '--basic-auth',",
            "    type=str,",
            "    default=DEFAULT_BASIC_AUTH,",
            "    help='Default: No authentication. Specify colon separated user:password '",
            "    'to enable basic authentication.')",
            "",
            "",
            "class AuthPlugin(HttpProxyBasePlugin):",
            "    \"\"\"Performs proxy authentication.\"\"\"",
            "",
            "    def before_upstream_connection(",
            "            self, request: HttpParser) -> Optional[HttpParser]:",
            "        if self.flags.auth_code:",
            "            if b'proxy-authorization' not in request.headers:",
            "                raise ProxyAuthenticationFailed()",
            "            parts = request.headers[b'proxy-authorization'][1].split()",
            "            if len(parts) != 2 \\",
            "                    and parts[0].lower() != b'basic' \\",
            "                    and parts[1] != self.flags.auth_code:",
            "                raise ProxyAuthenticationFailed()",
            "        return request",
            "",
            "    def handle_client_request(",
            "            self, request: HttpParser) -> Optional[HttpParser]:",
            "        return request",
            "",
            "    def handle_upstream_chunk(self, chunk: memoryview) -> memoryview:",
            "        return chunk",
            "",
            "    def on_upstream_connection_close(self) -> None:",
            "        pass"
        ],
        "afterPatchFile": [
            "# -*- coding: utf-8 -*-",
            "\"\"\"",
            "    proxy.py",
            "    ~~~~~~~~",
            "    \u26a1\u26a1\u26a1 Fast, Lightweight, Pluggable, TLS interception capable proxy server focused on",
            "    Network monitoring, controls & Application development, testing, debugging.",
            "",
            "    :copyright: (c) 2013-present by Abhinav Singh and contributors.",
            "    :license: BSD, see LICENSE for more details.",
            "\"\"\"",
            "from typing import Optional",
            "",
            "from ..exception import ProxyAuthenticationFailed",
            "from ...common.flag import flags",
            "from ...common.constants import DEFAULT_BASIC_AUTH",
            "from ...http.parser import HttpParser",
            "from ...http.proxy import HttpProxyBasePlugin",
            "",
            "",
            "flags.add_argument(",
            "    '--basic-auth',",
            "    type=str,",
            "    default=DEFAULT_BASIC_AUTH,",
            "    help='Default: No authentication. Specify colon separated user:password '",
            "    'to enable basic authentication.')",
            "",
            "",
            "class AuthPlugin(HttpProxyBasePlugin):",
            "    \"\"\"Performs proxy authentication.\"\"\"",
            "",
            "    def before_upstream_connection(",
            "            self, request: HttpParser) -> Optional[HttpParser]:",
            "        if self.flags.auth_code:",
            "            if b'proxy-authorization' not in request.headers:",
            "                raise ProxyAuthenticationFailed()",
            "            parts = request.headers[b'proxy-authorization'][1].split()",
            "            if len(parts) != 2 \\",
            "                    or parts[0].lower() != b'basic' \\",
            "                    or parts[1] != self.flags.auth_code:",
            "                raise ProxyAuthenticationFailed()",
            "        return request",
            "",
            "    def handle_client_request(",
            "            self, request: HttpParser) -> Optional[HttpParser]:",
            "        return request",
            "",
            "    def handle_upstream_chunk(self, chunk: memoryview) -> memoryview:",
            "        return chunk",
            "",
            "    def on_upstream_connection_close(self) -> None:",
            "        pass"
        ],
        "action": [
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "38": [
                "AuthPlugin",
                "before_upstream_connection"
            ],
            "39": [
                "AuthPlugin",
                "before_upstream_connection"
            ]
        },
        "addLocation": []
    }
}