{
    "superset/views/redirects.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 14,
                "afterPatchRowNumber": 14,
                "PatchRowcode": " # KIND, either express or implied.  See the License for the"
            },
            "1": {
                "beforePatchRowNumber": 15,
                "afterPatchRowNumber": 15,
                "PatchRowcode": " # specific language governing permissions and limitations"
            },
            "2": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " # under the License."
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 17,
                "PatchRowcode": "+import logging"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 18,
                "PatchRowcode": "+from typing import Optional"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 19,
                "PatchRowcode": "+"
            },
            "6": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " from flask import flash, request, Response"
            },
            "7": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 21,
                "PatchRowcode": " from flask_appbuilder import expose"
            },
            "8": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 22,
                "PatchRowcode": " from flask_appbuilder.security.decorators import has_access_api"
            },
            "9": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": 27,
                "PatchRowcode": " from superset.typing import FlaskResponse"
            },
            "10": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 28,
                "PatchRowcode": " from superset.views.base import BaseSupersetView"
            },
            "11": {
                "beforePatchRowNumber": 26,
                "afterPatchRowNumber": 29,
                "PatchRowcode": " "
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 30,
                "PatchRowcode": "+logger = logging.getLogger(__name__)"
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 31,
                "PatchRowcode": "+"
            },
            "14": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": 32,
                "PatchRowcode": " "
            },
            "15": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": 33,
                "PatchRowcode": " class R(BaseSupersetView):  # pylint: disable=invalid-name"
            },
            "16": {
                "beforePatchRowNumber": 29,
                "afterPatchRowNumber": 34,
                "PatchRowcode": " "
            },
            "17": {
                "beforePatchRowNumber": 30,
                "afterPatchRowNumber": 35,
                "PatchRowcode": "     \"\"\"used for short urls\"\"\""
            },
            "18": {
                "beforePatchRowNumber": 31,
                "afterPatchRowNumber": 36,
                "PatchRowcode": " "
            },
            "19": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 37,
                "PatchRowcode": "+    @staticmethod"
            },
            "20": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 38,
                "PatchRowcode": "+    def _validate_url(url: Optional[str] = None) -> bool:"
            },
            "21": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 39,
                "PatchRowcode": "+        if url and ("
            },
            "22": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 40,
                "PatchRowcode": "+            url.startswith(\"//superset/dashboard/\")"
            },
            "23": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 41,
                "PatchRowcode": "+            or url.startswith(\"//superset/explore/\")"
            },
            "24": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 42,
                "PatchRowcode": "+        ):"
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 43,
                "PatchRowcode": "+            return True"
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 44,
                "PatchRowcode": "+        return False"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 45,
                "PatchRowcode": "+"
            },
            "28": {
                "beforePatchRowNumber": 32,
                "afterPatchRowNumber": 46,
                "PatchRowcode": "     @event_logger.log_this"
            },
            "29": {
                "beforePatchRowNumber": 33,
                "afterPatchRowNumber": 47,
                "PatchRowcode": "     @expose(\"/<int:url_id>\")"
            },
            "30": {
                "beforePatchRowNumber": 34,
                "afterPatchRowNumber": 48,
                "PatchRowcode": "     def index(self, url_id: int) -> FlaskResponse:  # pylint: disable=no-self-use"
            },
            "31": {
                "beforePatchRowNumber": 38,
                "afterPatchRowNumber": 52,
                "PatchRowcode": "             if url.url.startswith(explore_url):"
            },
            "32": {
                "beforePatchRowNumber": 39,
                "afterPatchRowNumber": 53,
                "PatchRowcode": "                 explore_url += f\"r={url_id}\""
            },
            "33": {
                "beforePatchRowNumber": 40,
                "afterPatchRowNumber": 54,
                "PatchRowcode": "                 return redirect(explore_url[1:])"
            },
            "34": {
                "beforePatchRowNumber": 41,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "35": {
                "beforePatchRowNumber": 42,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            return redirect(url.url[1:])"
            },
            "36": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 55,
                "PatchRowcode": "+            if self._validate_url(url.url):"
            },
            "37": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 56,
                "PatchRowcode": "+                return redirect(url.url[1:])"
            },
            "38": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 57,
                "PatchRowcode": "+            return redirect(\"/\")"
            },
            "39": {
                "beforePatchRowNumber": 43,
                "afterPatchRowNumber": 58,
                "PatchRowcode": " "
            },
            "40": {
                "beforePatchRowNumber": 44,
                "afterPatchRowNumber": 59,
                "PatchRowcode": "         flash(\"URL to nowhere...\", \"danger\")"
            },
            "41": {
                "beforePatchRowNumber": 45,
                "afterPatchRowNumber": 60,
                "PatchRowcode": "         return redirect(\"/\")"
            },
            "42": {
                "beforePatchRowNumber": 49,
                "afterPatchRowNumber": 64,
                "PatchRowcode": "     @expose(\"/shortner/\", methods=[\"POST\"])"
            },
            "43": {
                "beforePatchRowNumber": 50,
                "afterPatchRowNumber": 65,
                "PatchRowcode": "     def shortner(self) -> FlaskResponse:  # pylint: disable=no-self-use"
            },
            "44": {
                "beforePatchRowNumber": 51,
                "afterPatchRowNumber": 66,
                "PatchRowcode": "         url = request.form.get(\"data\")"
            },
            "45": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 67,
                "PatchRowcode": "+        if not self._validate_url(url):"
            },
            "46": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 68,
                "PatchRowcode": "+            logger.warning(\"Invalid URL: %s\", url)"
            },
            "47": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 69,
                "PatchRowcode": "+            return Response(f\"Invalid URL: {url}\", 400)"
            },
            "48": {
                "beforePatchRowNumber": 52,
                "afterPatchRowNumber": 70,
                "PatchRowcode": "         obj = models.Url(url=url)"
            },
            "49": {
                "beforePatchRowNumber": 53,
                "afterPatchRowNumber": 71,
                "PatchRowcode": "         db.session.add(obj)"
            },
            "50": {
                "beforePatchRowNumber": 54,
                "afterPatchRowNumber": 72,
                "PatchRowcode": "         db.session.commit()"
            }
        },
        "frontPatchFile": [
            "# Licensed to the Apache Software Foundation (ASF) under one",
            "# or more contributor license agreements.  See the NOTICE file",
            "# distributed with this work for additional information",
            "# regarding copyright ownership.  The ASF licenses this file",
            "# to you under the Apache License, Version 2.0 (the",
            "# \"License\"); you may not use this file except in compliance",
            "# with the License.  You may obtain a copy of the License at",
            "#",
            "#   http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "# Unless required by applicable law or agreed to in writing,",
            "# software distributed under the License is distributed on an",
            "# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY",
            "# KIND, either express or implied.  See the License for the",
            "# specific language governing permissions and limitations",
            "# under the License.",
            "from flask import flash, request, Response",
            "from flask_appbuilder import expose",
            "from flask_appbuilder.security.decorators import has_access_api",
            "from werkzeug.utils import redirect",
            "",
            "from superset import db, event_logger",
            "from superset.models import core as models",
            "from superset.typing import FlaskResponse",
            "from superset.views.base import BaseSupersetView",
            "",
            "",
            "class R(BaseSupersetView):  # pylint: disable=invalid-name",
            "",
            "    \"\"\"used for short urls\"\"\"",
            "",
            "    @event_logger.log_this",
            "    @expose(\"/<int:url_id>\")",
            "    def index(self, url_id: int) -> FlaskResponse:  # pylint: disable=no-self-use",
            "        url = db.session.query(models.Url).get(url_id)",
            "        if url and url.url:",
            "            explore_url = \"//superset/explore/?\"",
            "            if url.url.startswith(explore_url):",
            "                explore_url += f\"r={url_id}\"",
            "                return redirect(explore_url[1:])",
            "",
            "            return redirect(url.url[1:])",
            "",
            "        flash(\"URL to nowhere...\", \"danger\")",
            "        return redirect(\"/\")",
            "",
            "    @event_logger.log_this",
            "    @has_access_api",
            "    @expose(\"/shortner/\", methods=[\"POST\"])",
            "    def shortner(self) -> FlaskResponse:  # pylint: disable=no-self-use",
            "        url = request.form.get(\"data\")",
            "        obj = models.Url(url=url)",
            "        db.session.add(obj)",
            "        db.session.commit()",
            "        return Response(",
            "            \"{scheme}://{request.headers[Host]}/r/{obj.id}\".format(",
            "                scheme=request.scheme, request=request, obj=obj",
            "            ),",
            "            mimetype=\"text/plain\",",
            "        )"
        ],
        "afterPatchFile": [
            "# Licensed to the Apache Software Foundation (ASF) under one",
            "# or more contributor license agreements.  See the NOTICE file",
            "# distributed with this work for additional information",
            "# regarding copyright ownership.  The ASF licenses this file",
            "# to you under the Apache License, Version 2.0 (the",
            "# \"License\"); you may not use this file except in compliance",
            "# with the License.  You may obtain a copy of the License at",
            "#",
            "#   http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "# Unless required by applicable law or agreed to in writing,",
            "# software distributed under the License is distributed on an",
            "# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY",
            "# KIND, either express or implied.  See the License for the",
            "# specific language governing permissions and limitations",
            "# under the License.",
            "import logging",
            "from typing import Optional",
            "",
            "from flask import flash, request, Response",
            "from flask_appbuilder import expose",
            "from flask_appbuilder.security.decorators import has_access_api",
            "from werkzeug.utils import redirect",
            "",
            "from superset import db, event_logger",
            "from superset.models import core as models",
            "from superset.typing import FlaskResponse",
            "from superset.views.base import BaseSupersetView",
            "",
            "logger = logging.getLogger(__name__)",
            "",
            "",
            "class R(BaseSupersetView):  # pylint: disable=invalid-name",
            "",
            "    \"\"\"used for short urls\"\"\"",
            "",
            "    @staticmethod",
            "    def _validate_url(url: Optional[str] = None) -> bool:",
            "        if url and (",
            "            url.startswith(\"//superset/dashboard/\")",
            "            or url.startswith(\"//superset/explore/\")",
            "        ):",
            "            return True",
            "        return False",
            "",
            "    @event_logger.log_this",
            "    @expose(\"/<int:url_id>\")",
            "    def index(self, url_id: int) -> FlaskResponse:  # pylint: disable=no-self-use",
            "        url = db.session.query(models.Url).get(url_id)",
            "        if url and url.url:",
            "            explore_url = \"//superset/explore/?\"",
            "            if url.url.startswith(explore_url):",
            "                explore_url += f\"r={url_id}\"",
            "                return redirect(explore_url[1:])",
            "            if self._validate_url(url.url):",
            "                return redirect(url.url[1:])",
            "            return redirect(\"/\")",
            "",
            "        flash(\"URL to nowhere...\", \"danger\")",
            "        return redirect(\"/\")",
            "",
            "    @event_logger.log_this",
            "    @has_access_api",
            "    @expose(\"/shortner/\", methods=[\"POST\"])",
            "    def shortner(self) -> FlaskResponse:  # pylint: disable=no-self-use",
            "        url = request.form.get(\"data\")",
            "        if not self._validate_url(url):",
            "            logger.warning(\"Invalid URL: %s\", url)",
            "            return Response(f\"Invalid URL: {url}\", 400)",
            "        obj = models.Url(url=url)",
            "        db.session.add(obj)",
            "        db.session.commit()",
            "        return Response(",
            "            \"{scheme}://{request.headers[Host]}/r/{obj.id}\".format(",
            "                scheme=request.scheme, request=request, obj=obj",
            "            ),",
            "            mimetype=\"text/plain\",",
            "        )"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "41": [
                "R",
                "index"
            ],
            "42": [
                "R",
                "index"
            ]
        },
        "addLocation": [
            "superset.views.redirects.R.self",
            "superset.views.redirects.R.shortner",
            "superset.views.redirects.R.index",
            "label_studio.core.settings.base"
        ]
    }
}