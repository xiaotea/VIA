{
    "tcms/core/middleware.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 34,
                "afterPatchRowNumber": 34,
                "PatchRowcode": "                 \"Content-Security-Policy\""
            },
            "1": {
                "beforePatchRowNumber": 35,
                "afterPatchRowNumber": 35,
                "PatchRowcode": "             ] = \"script-src 'self' cdn.crowdin.com;\""
            },
            "2": {
                "beforePatchRowNumber": 36,
                "afterPatchRowNumber": 36,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 37,
                "PatchRowcode": "+            if request.path.find(\"/uploads/\") > -1:"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 38,
                "PatchRowcode": "+                response.headers[\"Content-Type\"] = \"text/plain\""
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 39,
                "PatchRowcode": "+"
            },
            "6": {
                "beforePatchRowNumber": 37,
                "afterPatchRowNumber": 40,
                "PatchRowcode": "         return response"
            }
        },
        "frontPatchFile": [
            "# pylint: disable=no-self-use, too-few-public-methods",
            "",
            "from django.conf import settings",
            "from django.contrib.sites.models import Site",
            "from django.db.utils import OperationalError, ProgrammingError",
            "from django.http import HttpResponseRedirect",
            "from django.urls import reverse",
            "from django.utils.deprecation import MiddlewareMixin",
            "",
            "",
            "class CheckDBStructureExistsMiddleware(MiddlewareMixin):",
            "    def process_request(self, request):",
            "        if request.path == \"/init-db/\":",
            "            return None",
            "        try:",
            "            Site.objects.get(pk=settings.SITE_ID)",
            "        except (OperationalError, ProgrammingError):",
            "            # Redirect to Setup view",
            "            return HttpResponseRedirect(reverse(\"init-db\"))",
            "        return None",
            "",
            "",
            "class ExtraHeadersMiddleware(MiddlewareMixin):",
            "    \"\"\"",
            "    This is enabled only during testing and development. The actual headers",
            "    are configured in `etc/nginx.conf`!",
            "    \"\"\"",
            "",
            "    def process_response(self, request, response):",
            "        if settings.DEBUG:",
            "            response.headers[\"X-Frame-Options\"] = \"DENY\"",
            "            response.headers[\"X-Content-Type-Options\"] = \"nosniff\"",
            "            response.headers[",
            "                \"Content-Security-Policy\"",
            "            ] = \"script-src 'self' cdn.crowdin.com;\"",
            "",
            "        return response"
        ],
        "afterPatchFile": [
            "# pylint: disable=no-self-use, too-few-public-methods",
            "",
            "from django.conf import settings",
            "from django.contrib.sites.models import Site",
            "from django.db.utils import OperationalError, ProgrammingError",
            "from django.http import HttpResponseRedirect",
            "from django.urls import reverse",
            "from django.utils.deprecation import MiddlewareMixin",
            "",
            "",
            "class CheckDBStructureExistsMiddleware(MiddlewareMixin):",
            "    def process_request(self, request):",
            "        if request.path == \"/init-db/\":",
            "            return None",
            "        try:",
            "            Site.objects.get(pk=settings.SITE_ID)",
            "        except (OperationalError, ProgrammingError):",
            "            # Redirect to Setup view",
            "            return HttpResponseRedirect(reverse(\"init-db\"))",
            "        return None",
            "",
            "",
            "class ExtraHeadersMiddleware(MiddlewareMixin):",
            "    \"\"\"",
            "    This is enabled only during testing and development. The actual headers",
            "    are configured in `etc/nginx.conf`!",
            "    \"\"\"",
            "",
            "    def process_response(self, request, response):",
            "        if settings.DEBUG:",
            "            response.headers[\"X-Frame-Options\"] = \"DENY\"",
            "            response.headers[\"X-Content-Type-Options\"] = \"nosniff\"",
            "            response.headers[",
            "                \"Content-Security-Policy\"",
            "            ] = \"script-src 'self' cdn.crowdin.com;\"",
            "",
            "            if request.path.find(\"/uploads/\") > -1:",
            "                response.headers[\"Content-Type\"] = \"text/plain\"",
            "",
            "        return response"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": []
    }
}