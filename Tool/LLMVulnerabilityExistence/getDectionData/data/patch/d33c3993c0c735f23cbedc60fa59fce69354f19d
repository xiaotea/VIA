{
    "djoser/serializers.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 118,
                "afterPatchRowNumber": 118,
                "PatchRowcode": " "
            },
            "1": {
                "beforePatchRowNumber": 119,
                "afterPatchRowNumber": 119,
                "PatchRowcode": "     def validate(self, attrs):"
            },
            "2": {
                "beforePatchRowNumber": 120,
                "afterPatchRowNumber": 120,
                "PatchRowcode": "         password = attrs.get(\"password\")"
            },
            "3": {
                "beforePatchRowNumber": 121,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        params = {settings.LOGIN_FIELD: attrs.get(settings.LOGIN_FIELD)}"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 121,
                "PatchRowcode": "+        params = {\"username\": attrs.get(settings.LOGIN_FIELD)}"
            },
            "5": {
                "beforePatchRowNumber": 122,
                "afterPatchRowNumber": 122,
                "PatchRowcode": "         self.user = authenticate("
            },
            "6": {
                "beforePatchRowNumber": 123,
                "afterPatchRowNumber": 123,
                "PatchRowcode": "             request=self.context.get(\"request\"), **params, password=password"
            },
            "7": {
                "beforePatchRowNumber": 124,
                "afterPatchRowNumber": 124,
                "PatchRowcode": "         )"
            },
            "8": {
                "beforePatchRowNumber": 125,
                "afterPatchRowNumber": 125,
                "PatchRowcode": "         if not self.user:"
            },
            "9": {
                "beforePatchRowNumber": 126,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            self.user = User.objects.filter(**params).first()"
            },
            "10": {
                "beforePatchRowNumber": 127,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            if self.user and not self.user.check_password(password):"
            },
            "11": {
                "beforePatchRowNumber": 128,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                self.fail(\"invalid_credentials\")"
            },
            "12": {
                "beforePatchRowNumber": 129,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        if self.user and self.user.is_active:"
            },
            "13": {
                "beforePatchRowNumber": 130,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            return attrs"
            },
            "14": {
                "beforePatchRowNumber": 131,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.fail(\"invalid_credentials\")"
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 126,
                "PatchRowcode": "+            self.fail(\"invalid_credentials\")"
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 127,
                "PatchRowcode": "+        return attrs"
            },
            "17": {
                "beforePatchRowNumber": 132,
                "afterPatchRowNumber": 128,
                "PatchRowcode": " "
            },
            "18": {
                "beforePatchRowNumber": 133,
                "afterPatchRowNumber": 129,
                "PatchRowcode": " "
            },
            "19": {
                "beforePatchRowNumber": 134,
                "afterPatchRowNumber": 130,
                "PatchRowcode": " class UserFunctionsMixin:"
            }
        },
        "frontPatchFile": [
            "from django.contrib.auth import authenticate, get_user_model",
            "from django.contrib.auth.password_validation import validate_password",
            "from django.core import exceptions as django_exceptions",
            "from django.db import IntegrityError, transaction",
            "from rest_framework import exceptions, serializers",
            "from rest_framework.exceptions import ValidationError",
            "from rest_framework.settings import api_settings",
            "",
            "from djoser import utils",
            "from djoser.compat import get_user_email, get_user_email_field_name",
            "from djoser.conf import settings",
            "",
            "User = get_user_model()",
            "",
            "",
            "class UserSerializer(serializers.ModelSerializer):",
            "    class Meta:",
            "        model = User",
            "        fields = tuple(User.REQUIRED_FIELDS) + (",
            "            settings.USER_ID_FIELD,",
            "            settings.LOGIN_FIELD,",
            "        )",
            "        read_only_fields = (settings.LOGIN_FIELD,)",
            "",
            "    def update(self, instance, validated_data):",
            "        email_field = get_user_email_field_name(User)",
            "        instance.email_changed = False",
            "        if settings.SEND_ACTIVATION_EMAIL and email_field in validated_data:",
            "            instance_email = get_user_email(instance)",
            "            if instance_email != validated_data[email_field]:",
            "                instance.is_active = False",
            "                instance.email_changed = True",
            "                instance.save(update_fields=[\"is_active\"])",
            "        return super().update(instance, validated_data)",
            "",
            "",
            "class UserCreateMixin:",
            "    def create(self, validated_data):",
            "        try:",
            "            user = self.perform_create(validated_data)",
            "        except IntegrityError:",
            "            self.fail(\"cannot_create_user\")",
            "",
            "        return user",
            "",
            "    def perform_create(self, validated_data):",
            "        with transaction.atomic():",
            "            user = User.objects.create_user(**validated_data)",
            "            if settings.SEND_ACTIVATION_EMAIL:",
            "                user.is_active = False",
            "                user.save(update_fields=[\"is_active\"])",
            "        return user",
            "",
            "",
            "class UserCreateSerializer(UserCreateMixin, serializers.ModelSerializer):",
            "    password = serializers.CharField(style={\"input_type\": \"password\"}, write_only=True)",
            "",
            "    default_error_messages = {",
            "        \"cannot_create_user\": settings.CONSTANTS.messages.CANNOT_CREATE_USER_ERROR",
            "    }",
            "",
            "    class Meta:",
            "        model = User",
            "        fields = tuple(User.REQUIRED_FIELDS) + (",
            "            settings.LOGIN_FIELD,",
            "            settings.USER_ID_FIELD,",
            "            \"password\",",
            "        )",
            "",
            "    def validate(self, attrs):",
            "        user = User(**attrs)",
            "        password = attrs.get(\"password\")",
            "",
            "        try:",
            "            validate_password(password, user)",
            "        except django_exceptions.ValidationError as e:",
            "            serializer_error = serializers.as_serializer_error(e)",
            "            raise serializers.ValidationError(",
            "                {\"password\": serializer_error[api_settings.NON_FIELD_ERRORS_KEY]}",
            "            )",
            "",
            "        return attrs",
            "",
            "",
            "class UserCreatePasswordRetypeSerializer(UserCreateSerializer):",
            "    default_error_messages = {",
            "        \"password_mismatch\": settings.CONSTANTS.messages.PASSWORD_MISMATCH_ERROR",
            "    }",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "        self.fields[\"re_password\"] = serializers.CharField(",
            "            style={\"input_type\": \"password\"}",
            "        )",
            "",
            "    def validate(self, attrs):",
            "        self.fields.pop(\"re_password\", None)",
            "        re_password = attrs.pop(\"re_password\")",
            "        attrs = super().validate(attrs)",
            "        if attrs[\"password\"] == re_password:",
            "            return attrs",
            "        else:",
            "            self.fail(\"password_mismatch\")",
            "",
            "",
            "class TokenCreateSerializer(serializers.Serializer):",
            "    password = serializers.CharField(required=False, style={\"input_type\": \"password\"})",
            "",
            "    default_error_messages = {",
            "        \"invalid_credentials\": settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR,",
            "        \"inactive_account\": settings.CONSTANTS.messages.INACTIVE_ACCOUNT_ERROR,",
            "    }",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "        self.user = None",
            "        self.fields[settings.LOGIN_FIELD] = serializers.CharField(required=False)",
            "",
            "    def validate(self, attrs):",
            "        password = attrs.get(\"password\")",
            "        params = {settings.LOGIN_FIELD: attrs.get(settings.LOGIN_FIELD)}",
            "        self.user = authenticate(",
            "            request=self.context.get(\"request\"), **params, password=password",
            "        )",
            "        if not self.user:",
            "            self.user = User.objects.filter(**params).first()",
            "            if self.user and not self.user.check_password(password):",
            "                self.fail(\"invalid_credentials\")",
            "        if self.user and self.user.is_active:",
            "            return attrs",
            "        self.fail(\"invalid_credentials\")",
            "",
            "",
            "class UserFunctionsMixin:",
            "    def get_user(self, is_active=True):",
            "        try:",
            "            user = User._default_manager.get(",
            "                is_active=is_active,",
            "                **{self.email_field: self.data.get(self.email_field, \"\")},",
            "            )",
            "            if user.has_usable_password():",
            "                return user",
            "        except User.DoesNotExist:",
            "            pass",
            "        if (",
            "            settings.PASSWORD_RESET_SHOW_EMAIL_NOT_FOUND",
            "            or settings.USERNAME_RESET_SHOW_EMAIL_NOT_FOUND",
            "        ):",
            "            self.fail(\"email_not_found\")",
            "",
            "",
            "class SendEmailResetSerializer(serializers.Serializer, UserFunctionsMixin):",
            "    default_error_messages = {",
            "        \"email_not_found\": settings.CONSTANTS.messages.EMAIL_NOT_FOUND",
            "    }",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "",
            "        self.email_field = get_user_email_field_name(User)",
            "        self.fields[self.email_field] = serializers.EmailField()",
            "",
            "",
            "class UidAndTokenSerializer(serializers.Serializer):",
            "    uid = serializers.CharField()",
            "    token = serializers.CharField()",
            "",
            "    default_error_messages = {",
            "        \"invalid_token\": settings.CONSTANTS.messages.INVALID_TOKEN_ERROR,",
            "        \"invalid_uid\": settings.CONSTANTS.messages.INVALID_UID_ERROR,",
            "    }",
            "",
            "    def validate(self, attrs):",
            "        validated_data = super().validate(attrs)",
            "",
            "        # uid validation have to be here, because validate_<field_name>",
            "        # doesn't work with modelserializer",
            "        try:",
            "            uid = utils.decode_uid(self.initial_data.get(\"uid\", \"\"))",
            "            self.user = User.objects.get(pk=uid)",
            "        except (User.DoesNotExist, ValueError, TypeError, OverflowError):",
            "            key_error = \"invalid_uid\"",
            "            raise ValidationError(",
            "                {\"uid\": [self.error_messages[key_error]]}, code=key_error",
            "            )",
            "",
            "        is_token_valid = self.context[\"view\"].token_generator.check_token(",
            "            self.user, self.initial_data.get(\"token\", \"\")",
            "        )",
            "        if is_token_valid:",
            "            return validated_data",
            "        else:",
            "            key_error = \"invalid_token\"",
            "            raise ValidationError(",
            "                {\"token\": [self.error_messages[key_error]]}, code=key_error",
            "            )",
            "",
            "",
            "class ActivationSerializer(UidAndTokenSerializer):",
            "    default_error_messages = {",
            "        \"stale_token\": settings.CONSTANTS.messages.STALE_TOKEN_ERROR",
            "    }",
            "",
            "    def validate(self, attrs):",
            "        attrs = super().validate(attrs)",
            "        if not self.user.is_active:",
            "            return attrs",
            "        raise exceptions.PermissionDenied(self.error_messages[\"stale_token\"])",
            "",
            "",
            "class PasswordSerializer(serializers.Serializer):",
            "    new_password = serializers.CharField(style={\"input_type\": \"password\"})",
            "",
            "    def validate(self, attrs):",
            "        user = getattr(self, \"user\", None) or self.context[\"request\"].user",
            "        # why assert? There are ValidationError / fail everywhere",
            "        assert user is not None",
            "",
            "        try:",
            "            validate_password(attrs[\"new_password\"], user)",
            "        except django_exceptions.ValidationError as e:",
            "            raise serializers.ValidationError({\"new_password\": list(e.messages)})",
            "        return super().validate(attrs)",
            "",
            "",
            "class PasswordRetypeSerializer(PasswordSerializer):",
            "    re_new_password = serializers.CharField(style={\"input_type\": \"password\"})",
            "",
            "    default_error_messages = {",
            "        \"password_mismatch\": settings.CONSTANTS.messages.PASSWORD_MISMATCH_ERROR",
            "    }",
            "",
            "    def validate(self, attrs):",
            "        attrs = super().validate(attrs)",
            "        if attrs[\"new_password\"] == attrs[\"re_new_password\"]:",
            "            return attrs",
            "        else:",
            "            self.fail(\"password_mismatch\")",
            "",
            "",
            "class CurrentPasswordSerializer(serializers.Serializer):",
            "    current_password = serializers.CharField(style={\"input_type\": \"password\"})",
            "",
            "    default_error_messages = {",
            "        \"invalid_password\": settings.CONSTANTS.messages.INVALID_PASSWORD_ERROR",
            "    }",
            "",
            "    def validate_current_password(self, value):",
            "        is_password_valid = self.context[\"request\"].user.check_password(value)",
            "        if is_password_valid:",
            "            return value",
            "        else:",
            "            self.fail(\"invalid_password\")",
            "",
            "",
            "class UsernameSerializer(serializers.ModelSerializer):",
            "    class Meta:",
            "        model = User",
            "        fields = (settings.LOGIN_FIELD,)",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "        self.username_field = settings.LOGIN_FIELD",
            "        self._default_username_field = User.USERNAME_FIELD",
            "        self.fields[f\"new_{self.username_field}\"] = self.fields.pop(self.username_field)",
            "",
            "    def save(self, **kwargs):",
            "        if self.username_field != self._default_username_field:",
            "            kwargs[User.USERNAME_FIELD] = self.validated_data.get(",
            "                f\"new_{self.username_field}\"",
            "            )",
            "        return super().save(**kwargs)",
            "",
            "",
            "class UsernameRetypeSerializer(UsernameSerializer):",
            "    default_error_messages = {",
            "        \"username_mismatch\": settings.CONSTANTS.messages.USERNAME_MISMATCH_ERROR.format(",
            "            settings.LOGIN_FIELD",
            "        )",
            "    }",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "        self.fields[\"re_new_\" + settings.LOGIN_FIELD] = serializers.CharField()",
            "",
            "    def validate(self, attrs):",
            "        attrs = super().validate(attrs)",
            "        new_username = attrs[settings.LOGIN_FIELD]",
            "        if new_username != attrs[f\"re_new_{settings.LOGIN_FIELD}\"]:",
            "            self.fail(\"username_mismatch\")",
            "        else:",
            "            return attrs",
            "",
            "",
            "class TokenSerializer(serializers.ModelSerializer):",
            "    auth_token = serializers.CharField(source=\"key\")",
            "",
            "    class Meta:",
            "        model = settings.TOKEN_MODEL",
            "        fields = (\"auth_token\",)",
            "",
            "",
            "class SetPasswordSerializer(PasswordSerializer, CurrentPasswordSerializer):",
            "    pass",
            "",
            "",
            "class SetPasswordRetypeSerializer(PasswordRetypeSerializer, CurrentPasswordSerializer):",
            "    pass",
            "",
            "",
            "class PasswordResetConfirmSerializer(UidAndTokenSerializer, PasswordSerializer):",
            "    pass",
            "",
            "",
            "class PasswordResetConfirmRetypeSerializer(",
            "    UidAndTokenSerializer, PasswordRetypeSerializer",
            "):",
            "    pass",
            "",
            "",
            "class UsernameResetConfirmSerializer(UidAndTokenSerializer, UsernameSerializer):",
            "    pass",
            "",
            "",
            "class UsernameResetConfirmRetypeSerializer(",
            "    UidAndTokenSerializer, UsernameRetypeSerializer",
            "):",
            "    pass",
            "",
            "",
            "class UserDeleteSerializer(CurrentPasswordSerializer):",
            "    pass",
            "",
            "",
            "class SetUsernameSerializer(UsernameSerializer, CurrentPasswordSerializer):",
            "    class Meta:",
            "        model = User",
            "        fields = (settings.LOGIN_FIELD, \"current_password\")",
            "",
            "",
            "class SetUsernameRetypeSerializer(SetUsernameSerializer, UsernameRetypeSerializer):",
            "    pass"
        ],
        "afterPatchFile": [
            "from django.contrib.auth import authenticate, get_user_model",
            "from django.contrib.auth.password_validation import validate_password",
            "from django.core import exceptions as django_exceptions",
            "from django.db import IntegrityError, transaction",
            "from rest_framework import exceptions, serializers",
            "from rest_framework.exceptions import ValidationError",
            "from rest_framework.settings import api_settings",
            "",
            "from djoser import utils",
            "from djoser.compat import get_user_email, get_user_email_field_name",
            "from djoser.conf import settings",
            "",
            "User = get_user_model()",
            "",
            "",
            "class UserSerializer(serializers.ModelSerializer):",
            "    class Meta:",
            "        model = User",
            "        fields = tuple(User.REQUIRED_FIELDS) + (",
            "            settings.USER_ID_FIELD,",
            "            settings.LOGIN_FIELD,",
            "        )",
            "        read_only_fields = (settings.LOGIN_FIELD,)",
            "",
            "    def update(self, instance, validated_data):",
            "        email_field = get_user_email_field_name(User)",
            "        instance.email_changed = False",
            "        if settings.SEND_ACTIVATION_EMAIL and email_field in validated_data:",
            "            instance_email = get_user_email(instance)",
            "            if instance_email != validated_data[email_field]:",
            "                instance.is_active = False",
            "                instance.email_changed = True",
            "                instance.save(update_fields=[\"is_active\"])",
            "        return super().update(instance, validated_data)",
            "",
            "",
            "class UserCreateMixin:",
            "    def create(self, validated_data):",
            "        try:",
            "            user = self.perform_create(validated_data)",
            "        except IntegrityError:",
            "            self.fail(\"cannot_create_user\")",
            "",
            "        return user",
            "",
            "    def perform_create(self, validated_data):",
            "        with transaction.atomic():",
            "            user = User.objects.create_user(**validated_data)",
            "            if settings.SEND_ACTIVATION_EMAIL:",
            "                user.is_active = False",
            "                user.save(update_fields=[\"is_active\"])",
            "        return user",
            "",
            "",
            "class UserCreateSerializer(UserCreateMixin, serializers.ModelSerializer):",
            "    password = serializers.CharField(style={\"input_type\": \"password\"}, write_only=True)",
            "",
            "    default_error_messages = {",
            "        \"cannot_create_user\": settings.CONSTANTS.messages.CANNOT_CREATE_USER_ERROR",
            "    }",
            "",
            "    class Meta:",
            "        model = User",
            "        fields = tuple(User.REQUIRED_FIELDS) + (",
            "            settings.LOGIN_FIELD,",
            "            settings.USER_ID_FIELD,",
            "            \"password\",",
            "        )",
            "",
            "    def validate(self, attrs):",
            "        user = User(**attrs)",
            "        password = attrs.get(\"password\")",
            "",
            "        try:",
            "            validate_password(password, user)",
            "        except django_exceptions.ValidationError as e:",
            "            serializer_error = serializers.as_serializer_error(e)",
            "            raise serializers.ValidationError(",
            "                {\"password\": serializer_error[api_settings.NON_FIELD_ERRORS_KEY]}",
            "            )",
            "",
            "        return attrs",
            "",
            "",
            "class UserCreatePasswordRetypeSerializer(UserCreateSerializer):",
            "    default_error_messages = {",
            "        \"password_mismatch\": settings.CONSTANTS.messages.PASSWORD_MISMATCH_ERROR",
            "    }",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "        self.fields[\"re_password\"] = serializers.CharField(",
            "            style={\"input_type\": \"password\"}",
            "        )",
            "",
            "    def validate(self, attrs):",
            "        self.fields.pop(\"re_password\", None)",
            "        re_password = attrs.pop(\"re_password\")",
            "        attrs = super().validate(attrs)",
            "        if attrs[\"password\"] == re_password:",
            "            return attrs",
            "        else:",
            "            self.fail(\"password_mismatch\")",
            "",
            "",
            "class TokenCreateSerializer(serializers.Serializer):",
            "    password = serializers.CharField(required=False, style={\"input_type\": \"password\"})",
            "",
            "    default_error_messages = {",
            "        \"invalid_credentials\": settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR,",
            "        \"inactive_account\": settings.CONSTANTS.messages.INACTIVE_ACCOUNT_ERROR,",
            "    }",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "        self.user = None",
            "        self.fields[settings.LOGIN_FIELD] = serializers.CharField(required=False)",
            "",
            "    def validate(self, attrs):",
            "        password = attrs.get(\"password\")",
            "        params = {\"username\": attrs.get(settings.LOGIN_FIELD)}",
            "        self.user = authenticate(",
            "            request=self.context.get(\"request\"), **params, password=password",
            "        )",
            "        if not self.user:",
            "            self.fail(\"invalid_credentials\")",
            "        return attrs",
            "",
            "",
            "class UserFunctionsMixin:",
            "    def get_user(self, is_active=True):",
            "        try:",
            "            user = User._default_manager.get(",
            "                is_active=is_active,",
            "                **{self.email_field: self.data.get(self.email_field, \"\")},",
            "            )",
            "            if user.has_usable_password():",
            "                return user",
            "        except User.DoesNotExist:",
            "            pass",
            "        if (",
            "            settings.PASSWORD_RESET_SHOW_EMAIL_NOT_FOUND",
            "            or settings.USERNAME_RESET_SHOW_EMAIL_NOT_FOUND",
            "        ):",
            "            self.fail(\"email_not_found\")",
            "",
            "",
            "class SendEmailResetSerializer(serializers.Serializer, UserFunctionsMixin):",
            "    default_error_messages = {",
            "        \"email_not_found\": settings.CONSTANTS.messages.EMAIL_NOT_FOUND",
            "    }",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "",
            "        self.email_field = get_user_email_field_name(User)",
            "        self.fields[self.email_field] = serializers.EmailField()",
            "",
            "",
            "class UidAndTokenSerializer(serializers.Serializer):",
            "    uid = serializers.CharField()",
            "    token = serializers.CharField()",
            "",
            "    default_error_messages = {",
            "        \"invalid_token\": settings.CONSTANTS.messages.INVALID_TOKEN_ERROR,",
            "        \"invalid_uid\": settings.CONSTANTS.messages.INVALID_UID_ERROR,",
            "    }",
            "",
            "    def validate(self, attrs):",
            "        validated_data = super().validate(attrs)",
            "",
            "        # uid validation have to be here, because validate_<field_name>",
            "        # doesn't work with modelserializer",
            "        try:",
            "            uid = utils.decode_uid(self.initial_data.get(\"uid\", \"\"))",
            "            self.user = User.objects.get(pk=uid)",
            "        except (User.DoesNotExist, ValueError, TypeError, OverflowError):",
            "            key_error = \"invalid_uid\"",
            "            raise ValidationError(",
            "                {\"uid\": [self.error_messages[key_error]]}, code=key_error",
            "            )",
            "",
            "        is_token_valid = self.context[\"view\"].token_generator.check_token(",
            "            self.user, self.initial_data.get(\"token\", \"\")",
            "        )",
            "        if is_token_valid:",
            "            return validated_data",
            "        else:",
            "            key_error = \"invalid_token\"",
            "            raise ValidationError(",
            "                {\"token\": [self.error_messages[key_error]]}, code=key_error",
            "            )",
            "",
            "",
            "class ActivationSerializer(UidAndTokenSerializer):",
            "    default_error_messages = {",
            "        \"stale_token\": settings.CONSTANTS.messages.STALE_TOKEN_ERROR",
            "    }",
            "",
            "    def validate(self, attrs):",
            "        attrs = super().validate(attrs)",
            "        if not self.user.is_active:",
            "            return attrs",
            "        raise exceptions.PermissionDenied(self.error_messages[\"stale_token\"])",
            "",
            "",
            "class PasswordSerializer(serializers.Serializer):",
            "    new_password = serializers.CharField(style={\"input_type\": \"password\"})",
            "",
            "    def validate(self, attrs):",
            "        user = getattr(self, \"user\", None) or self.context[\"request\"].user",
            "        # why assert? There are ValidationError / fail everywhere",
            "        assert user is not None",
            "",
            "        try:",
            "            validate_password(attrs[\"new_password\"], user)",
            "        except django_exceptions.ValidationError as e:",
            "            raise serializers.ValidationError({\"new_password\": list(e.messages)})",
            "        return super().validate(attrs)",
            "",
            "",
            "class PasswordRetypeSerializer(PasswordSerializer):",
            "    re_new_password = serializers.CharField(style={\"input_type\": \"password\"})",
            "",
            "    default_error_messages = {",
            "        \"password_mismatch\": settings.CONSTANTS.messages.PASSWORD_MISMATCH_ERROR",
            "    }",
            "",
            "    def validate(self, attrs):",
            "        attrs = super().validate(attrs)",
            "        if attrs[\"new_password\"] == attrs[\"re_new_password\"]:",
            "            return attrs",
            "        else:",
            "            self.fail(\"password_mismatch\")",
            "",
            "",
            "class CurrentPasswordSerializer(serializers.Serializer):",
            "    current_password = serializers.CharField(style={\"input_type\": \"password\"})",
            "",
            "    default_error_messages = {",
            "        \"invalid_password\": settings.CONSTANTS.messages.INVALID_PASSWORD_ERROR",
            "    }",
            "",
            "    def validate_current_password(self, value):",
            "        is_password_valid = self.context[\"request\"].user.check_password(value)",
            "        if is_password_valid:",
            "            return value",
            "        else:",
            "            self.fail(\"invalid_password\")",
            "",
            "",
            "class UsernameSerializer(serializers.ModelSerializer):",
            "    class Meta:",
            "        model = User",
            "        fields = (settings.LOGIN_FIELD,)",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "        self.username_field = settings.LOGIN_FIELD",
            "        self._default_username_field = User.USERNAME_FIELD",
            "        self.fields[f\"new_{self.username_field}\"] = self.fields.pop(self.username_field)",
            "",
            "    def save(self, **kwargs):",
            "        if self.username_field != self._default_username_field:",
            "            kwargs[User.USERNAME_FIELD] = self.validated_data.get(",
            "                f\"new_{self.username_field}\"",
            "            )",
            "        return super().save(**kwargs)",
            "",
            "",
            "class UsernameRetypeSerializer(UsernameSerializer):",
            "    default_error_messages = {",
            "        \"username_mismatch\": settings.CONSTANTS.messages.USERNAME_MISMATCH_ERROR.format(",
            "            settings.LOGIN_FIELD",
            "        )",
            "    }",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        super().__init__(*args, **kwargs)",
            "        self.fields[\"re_new_\" + settings.LOGIN_FIELD] = serializers.CharField()",
            "",
            "    def validate(self, attrs):",
            "        attrs = super().validate(attrs)",
            "        new_username = attrs[settings.LOGIN_FIELD]",
            "        if new_username != attrs[f\"re_new_{settings.LOGIN_FIELD}\"]:",
            "            self.fail(\"username_mismatch\")",
            "        else:",
            "            return attrs",
            "",
            "",
            "class TokenSerializer(serializers.ModelSerializer):",
            "    auth_token = serializers.CharField(source=\"key\")",
            "",
            "    class Meta:",
            "        model = settings.TOKEN_MODEL",
            "        fields = (\"auth_token\",)",
            "",
            "",
            "class SetPasswordSerializer(PasswordSerializer, CurrentPasswordSerializer):",
            "    pass",
            "",
            "",
            "class SetPasswordRetypeSerializer(PasswordRetypeSerializer, CurrentPasswordSerializer):",
            "    pass",
            "",
            "",
            "class PasswordResetConfirmSerializer(UidAndTokenSerializer, PasswordSerializer):",
            "    pass",
            "",
            "",
            "class PasswordResetConfirmRetypeSerializer(",
            "    UidAndTokenSerializer, PasswordRetypeSerializer",
            "):",
            "    pass",
            "",
            "",
            "class UsernameResetConfirmSerializer(UidAndTokenSerializer, UsernameSerializer):",
            "    pass",
            "",
            "",
            "class UsernameResetConfirmRetypeSerializer(",
            "    UidAndTokenSerializer, UsernameRetypeSerializer",
            "):",
            "    pass",
            "",
            "",
            "class UserDeleteSerializer(CurrentPasswordSerializer):",
            "    pass",
            "",
            "",
            "class SetUsernameSerializer(UsernameSerializer, CurrentPasswordSerializer):",
            "    class Meta:",
            "        model = User",
            "        fields = (settings.LOGIN_FIELD, \"current_password\")",
            "",
            "",
            "class SetUsernameRetypeSerializer(SetUsernameSerializer, UsernameRetypeSerializer):",
            "    pass"
        ],
        "action": [
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "121": [
                "TokenCreateSerializer",
                "validate"
            ],
            "126": [
                "TokenCreateSerializer",
                "validate"
            ],
            "127": [
                "TokenCreateSerializer",
                "validate"
            ],
            "128": [
                "TokenCreateSerializer",
                "validate"
            ],
            "129": [
                "TokenCreateSerializer",
                "validate"
            ],
            "130": [
                "TokenCreateSerializer",
                "validate"
            ],
            "131": [
                "TokenCreateSerializer",
                "validate"
            ]
        },
        "addLocation": []
    },
    "testproject/testapp/tests/test_token_create.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 1,
                "afterPatchRowNumber": 1,
                "PatchRowcode": " import django"
            },
            "1": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2,
                "PatchRowcode": "+from unittest import mock"
            },
            "2": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 3,
                "PatchRowcode": "+"
            },
            "3": {
                "beforePatchRowNumber": 2,
                "afterPatchRowNumber": 4,
                "PatchRowcode": " from django.conf import settings as django_settings"
            },
            "4": {
                "beforePatchRowNumber": 3,
                "afterPatchRowNumber": 5,
                "PatchRowcode": " from django.contrib.auth import user_logged_in, user_login_failed"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 6,
                "PatchRowcode": "+from django.contrib.auth.backends import ModelBackend"
            },
            "6": {
                "beforePatchRowNumber": 4,
                "afterPatchRowNumber": 7,
                "PatchRowcode": " from django.test import override_settings"
            },
            "7": {
                "beforePatchRowNumber": 5,
                "afterPatchRowNumber": 8,
                "PatchRowcode": " from djet import assertions"
            },
            "8": {
                "beforePatchRowNumber": 6,
                "afterPatchRowNumber": 9,
                "PatchRowcode": " from rest_framework import status"
            },
            "9": {
                "beforePatchRowNumber": 37,
                "afterPatchRowNumber": 40,
                "PatchRowcode": "         self.assertNotEqual(user.last_login, previous_last_login)"
            },
            "10": {
                "beforePatchRowNumber": 38,
                "afterPatchRowNumber": 41,
                "PatchRowcode": "         self.assertTrue(self.signal_sent)"
            },
            "11": {
                "beforePatchRowNumber": 39,
                "afterPatchRowNumber": 42,
                "PatchRowcode": " "
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 43,
                "PatchRowcode": "+    @override_settings("
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 44,
                "PatchRowcode": "+        AUTHENTICATION_BACKENDS=["
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 45,
                "PatchRowcode": "+            \"django.contrib.auth.backends.ModelBackend\","
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 46,
                "PatchRowcode": "+        ]"
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 47,
                "PatchRowcode": "+    )"
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 48,
                "PatchRowcode": "+    @override_settings("
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 49,
                "PatchRowcode": "+        DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"username\"})"
            },
            "19": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 50,
                "PatchRowcode": "+    )"
            },
            "20": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 51,
                "PatchRowcode": "+    def test_post_should_not_login_if_model_backend_user_can_authenticate__LOGIN_FIELD_username__USERNAME_FIELD_username(  # noqa: E501"
            },
            "21": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 52,
                "PatchRowcode": "+        self,"
            },
            "22": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 53,
                "PatchRowcode": "+    ):"
            },
            "23": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 54,
                "PatchRowcode": "+        user = create_user()"
            },
            "24": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 55,
                "PatchRowcode": "+        user_logged_in.connect(self.signal_receiver)"
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 56,
                "PatchRowcode": "+        previous_last_login = user.last_login"
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 57,
                "PatchRowcode": "+"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 58,
                "PatchRowcode": "+        with mock.patch(\"djoser.serializers.User.USERNAME_FIELD\", \"username\"):"
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 59,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "29": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 60,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=True"
            },
            "30": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 61,
                "PatchRowcode": "+            ):"
            },
            "31": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 62,
                "PatchRowcode": "+                response = self.client.post("
            },
            "32": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 63,
                "PatchRowcode": "+                    self.base_url,"
            },
            "33": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 64,
                "PatchRowcode": "+                    {\"username\": user.username, \"password\": user.raw_password},"
            },
            "34": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 65,
                "PatchRowcode": "+                )"
            },
            "35": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 66,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_200_OK)"
            },
            "36": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 67,
                "PatchRowcode": "+"
            },
            "37": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 68,
                "PatchRowcode": "+                user.refresh_from_db()"
            },
            "38": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 69,
                "PatchRowcode": "+                self.assertEqual(response.data[\"auth_token\"], user.auth_token.key)"
            },
            "39": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 70,
                "PatchRowcode": "+                self.assertNotEqual(user.last_login, previous_last_login)"
            },
            "40": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 71,
                "PatchRowcode": "+                self.assertTrue(self.signal_sent)"
            },
            "41": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 72,
                "PatchRowcode": "+"
            },
            "42": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 73,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "43": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 74,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=False"
            },
            "44": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 75,
                "PatchRowcode": "+            ):"
            },
            "45": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 76,
                "PatchRowcode": "+                response = self.client.post("
            },
            "46": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 77,
                "PatchRowcode": "+                    self.base_url,"
            },
            "47": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 78,
                "PatchRowcode": "+                    {\"username\": user.username, \"password\": user.raw_password},"
            },
            "48": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 79,
                "PatchRowcode": "+                )"
            },
            "49": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 80,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "50": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 81,
                "PatchRowcode": "+"
            },
            "51": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 82,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "52": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 83,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=True"
            },
            "53": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 84,
                "PatchRowcode": "+            ):"
            },
            "54": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 85,
                "PatchRowcode": "+                response = self.client.post("
            },
            "55": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 86,
                "PatchRowcode": "+                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}"
            },
            "56": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 87,
                "PatchRowcode": "+                )"
            },
            "57": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 88,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "58": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 89,
                "PatchRowcode": "+"
            },
            "59": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 90,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "60": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 91,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=False"
            },
            "61": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 92,
                "PatchRowcode": "+            ):"
            },
            "62": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 93,
                "PatchRowcode": "+                response = self.client.post("
            },
            "63": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 94,
                "PatchRowcode": "+                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}"
            },
            "64": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 95,
                "PatchRowcode": "+                )"
            },
            "65": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 96,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "66": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 97,
                "PatchRowcode": "+"
            },
            "67": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 98,
                "PatchRowcode": "+    @override_settings("
            },
            "68": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 99,
                "PatchRowcode": "+        AUTHENTICATION_BACKENDS=["
            },
            "69": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 100,
                "PatchRowcode": "+            \"django.contrib.auth.backends.ModelBackend\","
            },
            "70": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 101,
                "PatchRowcode": "+        ]"
            },
            "71": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 102,
                "PatchRowcode": "+    )"
            },
            "72": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 103,
                "PatchRowcode": "+    @override_settings(DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"email\"}))"
            },
            "73": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 104,
                "PatchRowcode": "+    def test_post_should_not_login_if_model_backend_user_can_authenticate__LOGIN_FIELD_email__USERNAME_FIELD_username(  # noqa: E501"
            },
            "74": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 105,
                "PatchRowcode": "+        self,"
            },
            "75": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 106,
                "PatchRowcode": "+    ):"
            },
            "76": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 107,
                "PatchRowcode": "+        user = create_user()"
            },
            "77": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 108,
                "PatchRowcode": "+        user_logged_in.connect(self.signal_receiver)"
            },
            "78": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 109,
                "PatchRowcode": "+        previous_last_login = user.last_login"
            },
            "79": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 110,
                "PatchRowcode": "+"
            },
            "80": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 111,
                "PatchRowcode": "+        with mock.patch(\"djoser.serializers.User.USERNAME_FIELD\", \"username\"):"
            },
            "81": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 112,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "82": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 113,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=True"
            },
            "83": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 114,
                "PatchRowcode": "+            ):"
            },
            "84": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 115,
                "PatchRowcode": "+                response = self.client.post("
            },
            "85": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 116,
                "PatchRowcode": "+                    self.base_url,"
            },
            "86": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 117,
                "PatchRowcode": "+                    {\"username\": user.username, \"password\": user.raw_password},"
            },
            "87": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 118,
                "PatchRowcode": "+                )"
            },
            "88": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 119,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "89": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 120,
                "PatchRowcode": "+"
            },
            "90": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 121,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "91": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 122,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=False"
            },
            "92": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 123,
                "PatchRowcode": "+            ):"
            },
            "93": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 124,
                "PatchRowcode": "+                response = self.client.post("
            },
            "94": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 125,
                "PatchRowcode": "+                    self.base_url,"
            },
            "95": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 126,
                "PatchRowcode": "+                    {\"username\": user.username, \"password\": user.raw_password},"
            },
            "96": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 127,
                "PatchRowcode": "+                )"
            },
            "97": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 128,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "98": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 129,
                "PatchRowcode": "+"
            },
            "99": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 130,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "100": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 131,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=True"
            },
            "101": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 132,
                "PatchRowcode": "+            ):"
            },
            "102": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 133,
                "PatchRowcode": "+                response = self.client.post("
            },
            "103": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 134,
                "PatchRowcode": "+                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}"
            },
            "104": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 135,
                "PatchRowcode": "+                )"
            },
            "105": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 136,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "106": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 137,
                "PatchRowcode": "+"
            },
            "107": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 138,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "108": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 139,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=False"
            },
            "109": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 140,
                "PatchRowcode": "+            ):"
            },
            "110": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 141,
                "PatchRowcode": "+                response = self.client.post("
            },
            "111": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 142,
                "PatchRowcode": "+                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}"
            },
            "112": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 143,
                "PatchRowcode": "+                )"
            },
            "113": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 144,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "114": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 145,
                "PatchRowcode": "+"
            },
            "115": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 146,
                "PatchRowcode": "+        user.refresh_from_db()"
            },
            "116": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 147,
                "PatchRowcode": "+        self.assertEqual(user.last_login, previous_last_login)"
            },
            "117": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 148,
                "PatchRowcode": "+        self.assertFalse(self.signal_sent)"
            },
            "118": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 149,
                "PatchRowcode": "+"
            },
            "119": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 150,
                "PatchRowcode": "+    @override_settings("
            },
            "120": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 151,
                "PatchRowcode": "+        AUTHENTICATION_BACKENDS=["
            },
            "121": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 152,
                "PatchRowcode": "+            \"django.contrib.auth.backends.ModelBackend\","
            },
            "122": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 153,
                "PatchRowcode": "+        ]"
            },
            "123": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 154,
                "PatchRowcode": "+    )"
            },
            "124": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 155,
                "PatchRowcode": "+    @override_settings("
            },
            "125": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 156,
                "PatchRowcode": "+        DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"username\"})"
            },
            "126": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 157,
                "PatchRowcode": "+    )"
            },
            "127": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 158,
                "PatchRowcode": "+    def test_post_should_not_login_if_model_backend_user_can_authenticate__LOGIN_FIELD_username__USERNAME_FIELD_email(  # noqa: E501"
            },
            "128": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 159,
                "PatchRowcode": "+        self,"
            },
            "129": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 160,
                "PatchRowcode": "+    ):"
            },
            "130": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 161,
                "PatchRowcode": "+        user = create_user()"
            },
            "131": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 162,
                "PatchRowcode": "+        user_logged_in.connect(self.signal_receiver)"
            },
            "132": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 163,
                "PatchRowcode": "+        previous_last_login = user.last_login"
            },
            "133": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 164,
                "PatchRowcode": "+"
            },
            "134": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 165,
                "PatchRowcode": "+        with mock.patch(\"djoser.serializers.User.USERNAME_FIELD\", \"email\"):"
            },
            "135": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 166,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "136": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 167,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=True"
            },
            "137": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 168,
                "PatchRowcode": "+            ):"
            },
            "138": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 169,
                "PatchRowcode": "+                response = self.client.post("
            },
            "139": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 170,
                "PatchRowcode": "+                    self.base_url,"
            },
            "140": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 171,
                "PatchRowcode": "+                    {\"username\": user.username, \"password\": user.raw_password},"
            },
            "141": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 172,
                "PatchRowcode": "+                )"
            },
            "142": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 173,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "143": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 174,
                "PatchRowcode": "+"
            },
            "144": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 175,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "145": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 176,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=False"
            },
            "146": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 177,
                "PatchRowcode": "+            ):"
            },
            "147": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 178,
                "PatchRowcode": "+                response = self.client.post("
            },
            "148": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 179,
                "PatchRowcode": "+                    self.base_url,"
            },
            "149": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 180,
                "PatchRowcode": "+                    {\"username\": user.username, \"password\": user.raw_password},"
            },
            "150": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 181,
                "PatchRowcode": "+                )"
            },
            "151": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 182,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "152": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 183,
                "PatchRowcode": "+"
            },
            "153": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 184,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "154": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 185,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=True"
            },
            "155": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 186,
                "PatchRowcode": "+            ):"
            },
            "156": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 187,
                "PatchRowcode": "+                response = self.client.post("
            },
            "157": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 188,
                "PatchRowcode": "+                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}"
            },
            "158": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 189,
                "PatchRowcode": "+                )"
            },
            "159": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 190,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "160": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 191,
                "PatchRowcode": "+"
            },
            "161": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 192,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "162": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 193,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=False"
            },
            "163": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 194,
                "PatchRowcode": "+            ):"
            },
            "164": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 195,
                "PatchRowcode": "+                response = self.client.post("
            },
            "165": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 196,
                "PatchRowcode": "+                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}"
            },
            "166": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 197,
                "PatchRowcode": "+                )"
            },
            "167": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 198,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "168": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 199,
                "PatchRowcode": "+"
            },
            "169": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 200,
                "PatchRowcode": "+        user.refresh_from_db()"
            },
            "170": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 201,
                "PatchRowcode": "+        self.assertEqual(user.last_login, previous_last_login)"
            },
            "171": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 202,
                "PatchRowcode": "+        self.assertFalse(self.signal_sent)"
            },
            "172": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 203,
                "PatchRowcode": "+"
            },
            "173": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 204,
                "PatchRowcode": "+    @override_settings("
            },
            "174": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 205,
                "PatchRowcode": "+        AUTHENTICATION_BACKENDS=["
            },
            "175": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 206,
                "PatchRowcode": "+            \"django.contrib.auth.backends.ModelBackend\","
            },
            "176": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 207,
                "PatchRowcode": "+        ]"
            },
            "177": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 208,
                "PatchRowcode": "+    )"
            },
            "178": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 209,
                "PatchRowcode": "+    @override_settings(DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"email\"}))"
            },
            "179": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 210,
                "PatchRowcode": "+    def test_post_should_not_login_if_model_backend_user_can_authenticate__LOGIN_FIELD_email__USERNAME_FIELD_email(  # noqa: E501"
            },
            "180": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 211,
                "PatchRowcode": "+        self,"
            },
            "181": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 212,
                "PatchRowcode": "+    ):"
            },
            "182": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 213,
                "PatchRowcode": "+        user = create_user()"
            },
            "183": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 214,
                "PatchRowcode": "+        user_logged_in.connect(self.signal_receiver)"
            },
            "184": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 215,
                "PatchRowcode": "+        previous_last_login = user.last_login"
            },
            "185": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 216,
                "PatchRowcode": "+"
            },
            "186": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 217,
                "PatchRowcode": "+        with mock.patch(\"djoser.serializers.User.USERNAME_FIELD\", \"email\"):"
            },
            "187": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 218,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "188": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 219,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=True"
            },
            "189": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 220,
                "PatchRowcode": "+            ):"
            },
            "190": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 221,
                "PatchRowcode": "+                response = self.client.post("
            },
            "191": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 222,
                "PatchRowcode": "+                    self.base_url,"
            },
            "192": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 223,
                "PatchRowcode": "+                    {\"username\": user.username, \"password\": user.raw_password},"
            },
            "193": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 224,
                "PatchRowcode": "+                )"
            },
            "194": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 225,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "195": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 226,
                "PatchRowcode": "+"
            },
            "196": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 227,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "197": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 228,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=False"
            },
            "198": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 229,
                "PatchRowcode": "+            ):"
            },
            "199": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 230,
                "PatchRowcode": "+                response = self.client.post("
            },
            "200": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 231,
                "PatchRowcode": "+                    self.base_url,"
            },
            "201": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 232,
                "PatchRowcode": "+                    {\"username\": user.username, \"password\": user.raw_password},"
            },
            "202": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 233,
                "PatchRowcode": "+                )"
            },
            "203": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 234,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "204": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 235,
                "PatchRowcode": "+"
            },
            "205": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 236,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "206": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 237,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=True"
            },
            "207": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 238,
                "PatchRowcode": "+            ):"
            },
            "208": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 239,
                "PatchRowcode": "+                response = self.client.post("
            },
            "209": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 240,
                "PatchRowcode": "+                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}"
            },
            "210": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 241,
                "PatchRowcode": "+                )"
            },
            "211": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 242,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_200_OK)"
            },
            "212": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 243,
                "PatchRowcode": "+"
            },
            "213": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 244,
                "PatchRowcode": "+                user.refresh_from_db()"
            },
            "214": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 245,
                "PatchRowcode": "+                self.assertEqual(response.data[\"auth_token\"], user.auth_token.key)"
            },
            "215": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 246,
                "PatchRowcode": "+                self.assertNotEqual(user.last_login, previous_last_login)"
            },
            "216": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 247,
                "PatchRowcode": "+                self.assertTrue(self.signal_sent)"
            },
            "217": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 248,
                "PatchRowcode": "+"
            },
            "218": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 249,
                "PatchRowcode": "+            with mock.patch.object("
            },
            "219": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 250,
                "PatchRowcode": "+                ModelBackend, \"user_can_authenticate\", return_value=False"
            },
            "220": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 251,
                "PatchRowcode": "+            ):"
            },
            "221": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 252,
                "PatchRowcode": "+                response = self.client.post("
            },
            "222": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 253,
                "PatchRowcode": "+                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}"
            },
            "223": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 254,
                "PatchRowcode": "+                )"
            },
            "224": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 255,
                "PatchRowcode": "+                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)"
            },
            "225": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 256,
                "PatchRowcode": "+"
            },
            "226": {
                "beforePatchRowNumber": 40,
                "afterPatchRowNumber": 257,
                "PatchRowcode": "     def test_post_should_not_login_if_user_is_not_active(self):"
            },
            "227": {
                "beforePatchRowNumber": 41,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        \"\"\"In Django >= 1.10 authenticate() returns None if user is inactive,"
            },
            "228": {
                "beforePatchRowNumber": 42,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        while in Django < 1.10 authenticate() succeeds if user is inactive.\"\"\""
            },
            "229": {
                "beforePatchRowNumber": 43,
                "afterPatchRowNumber": 258,
                "PatchRowcode": "         user = create_user()"
            },
            "230": {
                "beforePatchRowNumber": 44,
                "afterPatchRowNumber": 259,
                "PatchRowcode": "         data = {\"username\": user.username, \"password\": user.raw_password}"
            },
            "231": {
                "beforePatchRowNumber": 45,
                "afterPatchRowNumber": 260,
                "PatchRowcode": "         user.is_active = False"
            },
            "232": {
                "beforePatchRowNumber": 81,
                "afterPatchRowNumber": 296,
                "PatchRowcode": "             response.data[\"non_field_errors\"],"
            },
            "233": {
                "beforePatchRowNumber": 82,
                "afterPatchRowNumber": 297,
                "PatchRowcode": "             [settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR],"
            },
            "234": {
                "beforePatchRowNumber": 83,
                "afterPatchRowNumber": 298,
                "PatchRowcode": "         )"
            },
            "235": {
                "beforePatchRowNumber": 84,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "236": {
                "beforePatchRowNumber": 85,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    @override_settings(DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"email\"}))"
            },
            "237": {
                "beforePatchRowNumber": 86,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    def test_login_using_email(self):"
            },
            "238": {
                "beforePatchRowNumber": 87,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        user = create_user()"
            },
            "239": {
                "beforePatchRowNumber": 88,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        previous_last_login = user.last_login"
            },
            "240": {
                "beforePatchRowNumber": 89,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        data = {\"email\": user.email, \"password\": user.raw_password}"
            },
            "241": {
                "beforePatchRowNumber": 90,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        user_logged_in.connect(self.signal_receiver)"
            },
            "242": {
                "beforePatchRowNumber": 91,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "243": {
                "beforePatchRowNumber": 92,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        response = self.client.post(self.base_url, data)"
            },
            "244": {
                "beforePatchRowNumber": 93,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        user.refresh_from_db()"
            },
            "245": {
                "beforePatchRowNumber": 94,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "246": {
                "beforePatchRowNumber": 95,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.assert_status_equal(response, status.HTTP_200_OK)"
            },
            "247": {
                "beforePatchRowNumber": 96,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.assertEqual(response.data[\"auth_token\"], user.auth_token.key)"
            },
            "248": {
                "beforePatchRowNumber": 97,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.assertNotEqual(user.last_login, previous_last_login)"
            },
            "249": {
                "beforePatchRowNumber": 98,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.assertTrue(self.signal_sent)"
            }
        },
        "frontPatchFile": [
            "import django",
            "from django.conf import settings as django_settings",
            "from django.contrib.auth import user_logged_in, user_login_failed",
            "from django.test import override_settings",
            "from djet import assertions",
            "from rest_framework import status",
            "from rest_framework.reverse import reverse",
            "from rest_framework.test import APITestCase",
            "from testapp.tests.common import create_user",
            "",
            "from djoser.conf import settings",
            "",
            "",
            "class TokenCreateViewTest(",
            "    APITestCase,",
            "    assertions.StatusCodeAssertionsMixin,",
            "    assertions.InstanceAssertionsMixin,",
            "):",
            "    def setUp(self):",
            "        self.signal_sent = False",
            "        self.base_url = reverse(\"login\")",
            "",
            "    def signal_receiver(self, *args, **kwargs):",
            "        self.signal_sent = True",
            "",
            "    def test_post_should_login_user(self):",
            "        user = create_user()",
            "        previous_last_login = user.last_login",
            "        data = {\"username\": user.username, \"password\": user.raw_password}",
            "        user_logged_in.connect(self.signal_receiver)",
            "",
            "        response = self.client.post(self.base_url, data)",
            "        user.refresh_from_db()",
            "",
            "        self.assert_status_equal(response, status.HTTP_200_OK)",
            "        self.assertEqual(response.data[\"auth_token\"], user.auth_token.key)",
            "        self.assertNotEqual(user.last_login, previous_last_login)",
            "        self.assertTrue(self.signal_sent)",
            "",
            "    def test_post_should_not_login_if_user_is_not_active(self):",
            "        \"\"\"In Django >= 1.10 authenticate() returns None if user is inactive,",
            "        while in Django < 1.10 authenticate() succeeds if user is inactive.\"\"\"",
            "        user = create_user()",
            "        data = {\"username\": user.username, \"password\": user.raw_password}",
            "        user.is_active = False",
            "        user.save()",
            "        user_logged_in.connect(self.signal_receiver)",
            "",
            "        response = self.client.post(self.base_url, data)",
            "",
            "        if django.VERSION >= (1, 10):",
            "            expected_errors = [settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR]",
            "        else:",
            "            expected_errors = [settings.CONSTANTS.messages.INACTIVE_ACCOUNT_ERROR]",
            "",
            "        self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "        self.assertEqual(response.data[\"non_field_errors\"], expected_errors)",
            "        self.assertFalse(self.signal_sent)",
            "",
            "    def test_post_should_not_login_if_invalid_credentials(self):",
            "        user = create_user()",
            "        data = {\"username\": user.username, \"password\": \"wrong\"}",
            "        user_login_failed.connect(self.signal_receiver)",
            "",
            "        response = self.client.post(self.base_url, data)",
            "",
            "        self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "        self.assertEqual(",
            "            response.data[\"non_field_errors\"],",
            "            [settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR],",
            "        )",
            "        self.assertTrue(self.signal_sent)",
            "",
            "    def test_post_should_not_login_if_empty_request(self):",
            "        data = {}",
            "",
            "        response = self.client.post(self.base_url, data)",
            "",
            "        self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "        self.assertEqual(",
            "            response.data[\"non_field_errors\"],",
            "            [settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR],",
            "        )",
            "",
            "    @override_settings(DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"email\"}))",
            "    def test_login_using_email(self):",
            "        user = create_user()",
            "        previous_last_login = user.last_login",
            "        data = {\"email\": user.email, \"password\": user.raw_password}",
            "        user_logged_in.connect(self.signal_receiver)",
            "",
            "        response = self.client.post(self.base_url, data)",
            "        user.refresh_from_db()",
            "",
            "        self.assert_status_equal(response, status.HTTP_200_OK)",
            "        self.assertEqual(response.data[\"auth_token\"], user.auth_token.key)",
            "        self.assertNotEqual(user.last_login, previous_last_login)",
            "        self.assertTrue(self.signal_sent)"
        ],
        "afterPatchFile": [
            "import django",
            "from unittest import mock",
            "",
            "from django.conf import settings as django_settings",
            "from django.contrib.auth import user_logged_in, user_login_failed",
            "from django.contrib.auth.backends import ModelBackend",
            "from django.test import override_settings",
            "from djet import assertions",
            "from rest_framework import status",
            "from rest_framework.reverse import reverse",
            "from rest_framework.test import APITestCase",
            "from testapp.tests.common import create_user",
            "",
            "from djoser.conf import settings",
            "",
            "",
            "class TokenCreateViewTest(",
            "    APITestCase,",
            "    assertions.StatusCodeAssertionsMixin,",
            "    assertions.InstanceAssertionsMixin,",
            "):",
            "    def setUp(self):",
            "        self.signal_sent = False",
            "        self.base_url = reverse(\"login\")",
            "",
            "    def signal_receiver(self, *args, **kwargs):",
            "        self.signal_sent = True",
            "",
            "    def test_post_should_login_user(self):",
            "        user = create_user()",
            "        previous_last_login = user.last_login",
            "        data = {\"username\": user.username, \"password\": user.raw_password}",
            "        user_logged_in.connect(self.signal_receiver)",
            "",
            "        response = self.client.post(self.base_url, data)",
            "        user.refresh_from_db()",
            "",
            "        self.assert_status_equal(response, status.HTTP_200_OK)",
            "        self.assertEqual(response.data[\"auth_token\"], user.auth_token.key)",
            "        self.assertNotEqual(user.last_login, previous_last_login)",
            "        self.assertTrue(self.signal_sent)",
            "",
            "    @override_settings(",
            "        AUTHENTICATION_BACKENDS=[",
            "            \"django.contrib.auth.backends.ModelBackend\",",
            "        ]",
            "    )",
            "    @override_settings(",
            "        DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"username\"})",
            "    )",
            "    def test_post_should_not_login_if_model_backend_user_can_authenticate__LOGIN_FIELD_username__USERNAME_FIELD_username(  # noqa: E501",
            "        self,",
            "    ):",
            "        user = create_user()",
            "        user_logged_in.connect(self.signal_receiver)",
            "        previous_last_login = user.last_login",
            "",
            "        with mock.patch(\"djoser.serializers.User.USERNAME_FIELD\", \"username\"):",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=True",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url,",
            "                    {\"username\": user.username, \"password\": user.raw_password},",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_200_OK)",
            "",
            "                user.refresh_from_db()",
            "                self.assertEqual(response.data[\"auth_token\"], user.auth_token.key)",
            "                self.assertNotEqual(user.last_login, previous_last_login)",
            "                self.assertTrue(self.signal_sent)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=False",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url,",
            "                    {\"username\": user.username, \"password\": user.raw_password},",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=True",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=False",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "    @override_settings(",
            "        AUTHENTICATION_BACKENDS=[",
            "            \"django.contrib.auth.backends.ModelBackend\",",
            "        ]",
            "    )",
            "    @override_settings(DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"email\"}))",
            "    def test_post_should_not_login_if_model_backend_user_can_authenticate__LOGIN_FIELD_email__USERNAME_FIELD_username(  # noqa: E501",
            "        self,",
            "    ):",
            "        user = create_user()",
            "        user_logged_in.connect(self.signal_receiver)",
            "        previous_last_login = user.last_login",
            "",
            "        with mock.patch(\"djoser.serializers.User.USERNAME_FIELD\", \"username\"):",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=True",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url,",
            "                    {\"username\": user.username, \"password\": user.raw_password},",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=False",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url,",
            "                    {\"username\": user.username, \"password\": user.raw_password},",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=True",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=False",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "        user.refresh_from_db()",
            "        self.assertEqual(user.last_login, previous_last_login)",
            "        self.assertFalse(self.signal_sent)",
            "",
            "    @override_settings(",
            "        AUTHENTICATION_BACKENDS=[",
            "            \"django.contrib.auth.backends.ModelBackend\",",
            "        ]",
            "    )",
            "    @override_settings(",
            "        DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"username\"})",
            "    )",
            "    def test_post_should_not_login_if_model_backend_user_can_authenticate__LOGIN_FIELD_username__USERNAME_FIELD_email(  # noqa: E501",
            "        self,",
            "    ):",
            "        user = create_user()",
            "        user_logged_in.connect(self.signal_receiver)",
            "        previous_last_login = user.last_login",
            "",
            "        with mock.patch(\"djoser.serializers.User.USERNAME_FIELD\", \"email\"):",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=True",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url,",
            "                    {\"username\": user.username, \"password\": user.raw_password},",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=False",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url,",
            "                    {\"username\": user.username, \"password\": user.raw_password},",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=True",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=False",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "        user.refresh_from_db()",
            "        self.assertEqual(user.last_login, previous_last_login)",
            "        self.assertFalse(self.signal_sent)",
            "",
            "    @override_settings(",
            "        AUTHENTICATION_BACKENDS=[",
            "            \"django.contrib.auth.backends.ModelBackend\",",
            "        ]",
            "    )",
            "    @override_settings(DJOSER=dict(django_settings.DJOSER, **{\"LOGIN_FIELD\": \"email\"}))",
            "    def test_post_should_not_login_if_model_backend_user_can_authenticate__LOGIN_FIELD_email__USERNAME_FIELD_email(  # noqa: E501",
            "        self,",
            "    ):",
            "        user = create_user()",
            "        user_logged_in.connect(self.signal_receiver)",
            "        previous_last_login = user.last_login",
            "",
            "        with mock.patch(\"djoser.serializers.User.USERNAME_FIELD\", \"email\"):",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=True",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url,",
            "                    {\"username\": user.username, \"password\": user.raw_password},",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=False",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url,",
            "                    {\"username\": user.username, \"password\": user.raw_password},",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=True",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_200_OK)",
            "",
            "                user.refresh_from_db()",
            "                self.assertEqual(response.data[\"auth_token\"], user.auth_token.key)",
            "                self.assertNotEqual(user.last_login, previous_last_login)",
            "                self.assertTrue(self.signal_sent)",
            "",
            "            with mock.patch.object(",
            "                ModelBackend, \"user_can_authenticate\", return_value=False",
            "            ):",
            "                response = self.client.post(",
            "                    self.base_url, {\"email\": user.email, \"password\": user.raw_password}",
            "                )",
            "                self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "",
            "    def test_post_should_not_login_if_user_is_not_active(self):",
            "        user = create_user()",
            "        data = {\"username\": user.username, \"password\": user.raw_password}",
            "        user.is_active = False",
            "        user.save()",
            "        user_logged_in.connect(self.signal_receiver)",
            "",
            "        response = self.client.post(self.base_url, data)",
            "",
            "        if django.VERSION >= (1, 10):",
            "            expected_errors = [settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR]",
            "        else:",
            "            expected_errors = [settings.CONSTANTS.messages.INACTIVE_ACCOUNT_ERROR]",
            "",
            "        self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "        self.assertEqual(response.data[\"non_field_errors\"], expected_errors)",
            "        self.assertFalse(self.signal_sent)",
            "",
            "    def test_post_should_not_login_if_invalid_credentials(self):",
            "        user = create_user()",
            "        data = {\"username\": user.username, \"password\": \"wrong\"}",
            "        user_login_failed.connect(self.signal_receiver)",
            "",
            "        response = self.client.post(self.base_url, data)",
            "",
            "        self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "        self.assertEqual(",
            "            response.data[\"non_field_errors\"],",
            "            [settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR],",
            "        )",
            "        self.assertTrue(self.signal_sent)",
            "",
            "    def test_post_should_not_login_if_empty_request(self):",
            "        data = {}",
            "",
            "        response = self.client.post(self.base_url, data)",
            "",
            "        self.assert_status_equal(response, status.HTTP_400_BAD_REQUEST)",
            "        self.assertEqual(",
            "            response.data[\"non_field_errors\"],",
            "            [settings.CONSTANTS.messages.INVALID_CREDENTIALS_ERROR],",
            "        )"
        ],
        "action": [
            "0",
            "-1",
            "-1",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2"
        ],
        "dele_reviseLocation": {
            "41": [
                "TokenCreateViewTest",
                "test_post_should_not_login_if_user_is_not_active"
            ],
            "42": [
                "TokenCreateViewTest",
                "test_post_should_not_login_if_user_is_not_active"
            ],
            "84": [
                "TokenCreateViewTest"
            ],
            "85": [
                "TokenCreateViewTest"
            ],
            "86": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "87": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "88": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "89": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "90": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "91": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "92": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "93": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "94": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "95": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "96": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "97": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ],
            "98": [
                "TokenCreateViewTest",
                "test_login_using_email"
            ]
        },
        "addLocation": [
            "testproject.testapp.tests.test_token_create.TokenCreateViewTest.self",
            "src.pyload.core.database.user_database"
        ]
    }
}