{
    "django_js_reverse/core.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 8,
                "afterPatchRowNumber": 8,
                "PatchRowcode": " from django.conf import settings"
            },
            "1": {
                "beforePatchRowNumber": 9,
                "afterPatchRowNumber": 9,
                "PatchRowcode": " from django.core.exceptions import ImproperlyConfigured"
            },
            "2": {
                "beforePatchRowNumber": 10,
                "afterPatchRowNumber": 10,
                "PatchRowcode": " from django.template import loader"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 11,
                "PatchRowcode": "+from django.utils.safestring import mark_safe"
            },
            "4": {
                "beforePatchRowNumber": 11,
                "afterPatchRowNumber": 12,
                "PatchRowcode": " from django.utils.encoding import force_text"
            },
            "5": {
                "beforePatchRowNumber": 12,
                "afterPatchRowNumber": 13,
                "PatchRowcode": " "
            },
            "6": {
                "beforePatchRowNumber": 13,
                "afterPatchRowNumber": 14,
                "PatchRowcode": " from . import rjsmin"
            },
            "7": {
                "beforePatchRowNumber": 120,
                "afterPatchRowNumber": 121,
                "PatchRowcode": "     }"
            },
            "8": {
                "beforePatchRowNumber": 121,
                "afterPatchRowNumber": 122,
                "PatchRowcode": " "
            },
            "9": {
                "beforePatchRowNumber": 122,
                "afterPatchRowNumber": 123,
                "PatchRowcode": " "
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 124,
                "PatchRowcode": "+def _safe_json(obj):"
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 125,
                "PatchRowcode": "+    return mark_safe("
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 126,
                "PatchRowcode": "+        json"
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 127,
                "PatchRowcode": "+        .dumps(obj)"
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 128,
                "PatchRowcode": "+        .replace('>', '\\\\u003E')"
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 129,
                "PatchRowcode": "+        .replace('<', '\\\\u003C')"
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 130,
                "PatchRowcode": "+        .replace('&', '\\\\u0026')"
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 131,
                "PatchRowcode": "+    )"
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 132,
                "PatchRowcode": "+"
            },
            "19": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 133,
                "PatchRowcode": "+"
            },
            "20": {
                "beforePatchRowNumber": 123,
                "afterPatchRowNumber": 134,
                "PatchRowcode": " def generate_js(default_urlresolver):"
            },
            "21": {
                "beforePatchRowNumber": 124,
                "afterPatchRowNumber": 135,
                "PatchRowcode": "     js_var_name = getattr(settings, 'JS_REVERSE_JS_VAR_NAME', JS_VAR_NAME)"
            },
            "22": {
                "beforePatchRowNumber": 125,
                "afterPatchRowNumber": 136,
                "PatchRowcode": "     if not JS_IDENTIFIER_RE.match(js_var_name.upper()):"
            },
            "23": {
                "beforePatchRowNumber": 147,
                "afterPatchRowNumber": 158,
                "PatchRowcode": " "
            },
            "24": {
                "beforePatchRowNumber": 148,
                "afterPatchRowNumber": 159,
                "PatchRowcode": "     data = generate_json(default_urlresolver, script_prefix)"
            },
            "25": {
                "beforePatchRowNumber": 149,
                "afterPatchRowNumber": 160,
                "PatchRowcode": "     js_content = loader.render_to_string('django_js_reverse/urls_js.tpl', {"
            },
            "26": {
                "beforePatchRowNumber": 150,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        'data': json.dumps(data),"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 161,
                "PatchRowcode": "+        'data': _safe_json(data),"
            },
            "28": {
                "beforePatchRowNumber": 151,
                "afterPatchRowNumber": 162,
                "PatchRowcode": "         'js_name': '.'.join([js_global_object_name, js_var_name]),"
            },
            "29": {
                "beforePatchRowNumber": 152,
                "afterPatchRowNumber": 163,
                "PatchRowcode": "     })"
            },
            "30": {
                "beforePatchRowNumber": 153,
                "afterPatchRowNumber": 164,
                "PatchRowcode": " "
            }
        },
        "frontPatchFile": [
            "# -*- coding: utf-8 -*-",
            "import json",
            "import re",
            "import sys",
            "from distutils.version import LooseVersion",
            "",
            "import django",
            "from django.conf import settings",
            "from django.core.exceptions import ImproperlyConfigured",
            "from django.template import loader",
            "from django.utils.encoding import force_text",
            "",
            "from . import rjsmin",
            "from .js_reverse_settings import (JS_EXCLUDE_NAMESPACES, JS_GLOBAL_OBJECT_NAME,",
            "                                  JS_INCLUDE_ONLY_NAMESPACES, JS_MINIFY,",
            "                                  JS_VAR_NAME)",
            "",
            "try:",
            "    from django import urls as urlresolvers",
            "except ImportError:",
            "    from django.core import urlresolvers",
            "",
            "if sys.version < '3':",
            "    text_type = unicode  # NOQA",
            "else:",
            "    text_type = str",
            "",
            "JS_IDENTIFIER_RE = re.compile(r'^[$A-Z_][\\dA-Z_$]*$')",
            "",
            "",
            "def prepare_url_list(urlresolver, namespace_path='', namespace=''):",
            "    \"\"\"",
            "    returns list of tuples [(<url_name>, <url_patern_tuple> ), ...]",
            "    \"\"\"",
            "    exclude_ns = getattr(settings, 'JS_REVERSE_EXCLUDE_NAMESPACES', JS_EXCLUDE_NAMESPACES)",
            "    include_only_ns = getattr(settings, 'JS_REVERSE_INCLUDE_ONLY_NAMESPACES', JS_INCLUDE_ONLY_NAMESPACES)",
            "",
            "    if exclude_ns and include_only_ns:",
            "        raise ImproperlyConfigured(",
            "            'Neither use JS_REVERSE_EXCLUDE_NAMESPACES nor JS_REVERSE_INCLUDE_ONLY_NAMESPACES setting')",
            "",
            "    if namespace[:-1] in exclude_ns:",
            "        return",
            "",
            "    include_only_allow = True  # include_only state varible",
            "",
            "    if include_only_ns != []:",
            "        # True mean that ns passed the test",
            "        in_on_empty_ns = False",
            "        in_on_is_in_list = False",
            "        in_on_null = False",
            "",
            "        # Test urls without ns",
            "        if namespace == '' and '' in include_only_ns:",
            "            in_on_empty_ns = True",
            "",
            "        # check if nestead ns isn't subns of include_only ns",
            "        # e.g. ns = \"foo:bar\" include_only = [\"foo\"] -> this ns will be used",
            "        # works for ns = \"lorem:ipsum:dolor\" include_only = [\"lorem:ipsum\"]",
            "        # ns \"lorem\" will be ignored but \"lorem:ipsum\" & \"lorem:ipsum:..\" won't",
            "        for ns in include_only_ns:",
            "            if ns != \"\" and namespace[:-1].startswith(ns):",
            "                in_on_is_in_list = True",
            "                break",
            "",
            "        # Test if isn't used \"\\0\" flag",
            "        # use \"foo\\0\" to add urls just from \"foo\" not from subns \"foo:bar\"",
            "        if namespace[:-1] + '\\0' in include_only_ns:",
            "            in_on_null = True",
            "",
            "        include_only_allow = in_on_empty_ns or in_on_is_in_list or in_on_null",
            "",
            "    if include_only_allow:",
            "        for url_name in urlresolver.reverse_dict.keys():",
            "            if isinstance(url_name, (text_type, str)):",
            "                url_patterns = []",
            "                for url_pattern in urlresolver.reverse_dict.getlist(url_name):",
            "                    url_patterns += [",
            "                        [namespace_path + pat[0], pat[1]] for pat in url_pattern[0]]",
            "                yield [namespace + url_name, url_patterns]",
            "",
            "    for inner_ns, (inner_ns_path, inner_urlresolver) in \\",
            "            urlresolver.namespace_dict.items():",
            "        inner_ns_path = namespace_path + inner_ns_path",
            "        inner_ns = namespace + inner_ns + ':'",
            "",
            "        # if we have inner_ns_path, reconstruct a new resolver so that we can",
            "        # handle regex substitutions within the regex of a namespace.",
            "        if inner_ns_path:",
            "            args = [inner_ns_path, inner_urlresolver]",
            "",
            "            # https://github.com/ierror/django-js-reverse/issues/65",
            "            if LooseVersion(django.get_version()) >= LooseVersion(\"2.0.6\"):",
            "                args.append(tuple(urlresolver.pattern.converters.items()))",
            "",
            "            inner_urlresolver = urlresolvers.get_ns_resolver(*args)",
            "            inner_ns_path = ''",
            "",
            "        for x in prepare_url_list(inner_urlresolver, inner_ns_path, inner_ns):",
            "            yield x",
            "",
            "",
            "def generate_json(default_urlresolver, script_prefix=None):",
            "    if script_prefix is None:",
            "        script_prefix = urlresolvers.get_script_prefix()",
            "",
            "    urls = sorted(list(prepare_url_list(default_urlresolver)))",
            "",
            "    return {",
            "        'urls': [",
            "            [",
            "                force_text(name),",
            "                [",
            "                    [force_text(path), [force_text(arg) for arg in args]]",
            "                    for path, args in patterns",
            "                ],",
            "            ] for name, patterns in urls",
            "        ],",
            "        'prefix': script_prefix,",
            "    }",
            "",
            "",
            "def generate_js(default_urlresolver):",
            "    js_var_name = getattr(settings, 'JS_REVERSE_JS_VAR_NAME', JS_VAR_NAME)",
            "    if not JS_IDENTIFIER_RE.match(js_var_name.upper()):",
            "        raise ImproperlyConfigured(",
            "            'JS_REVERSE_JS_VAR_NAME setting \"%s\" is not a valid javascript identifier.' % (js_var_name))",
            "",
            "    js_global_object_name = getattr(settings, 'JS_REVERSE_JS_GLOBAL_OBJECT_NAME', JS_GLOBAL_OBJECT_NAME)",
            "    if not JS_IDENTIFIER_RE.match(js_global_object_name.upper()):",
            "        raise ImproperlyConfigured(",
            "            'JS_REVERSE_JS_GLOBAL_OBJECT_NAME setting \"%s\" is not a valid javascript identifier.' % (",
            "                js_global_object_name))",
            "",
            "    minfiy = getattr(settings, 'JS_REVERSE_JS_MINIFY', JS_MINIFY)",
            "    if not isinstance(minfiy, bool):",
            "        raise ImproperlyConfigured(",
            "            'JS_REVERSE_JS_MINIFY setting \"%s\" is not a valid. Needs to be set to True or False.' % (minfiy))",
            "",
            "    script_prefix_via_config = getattr(settings, 'JS_REVERSE_SCRIPT_PREFIX', None)",
            "    if script_prefix_via_config:",
            "        script_prefix = script_prefix_via_config",
            "        if not script_prefix.endswith('/'):",
            "            script_prefix = '{0}/'.format(script_prefix)",
            "    else:",
            "        script_prefix = urlresolvers.get_script_prefix()",
            "",
            "    data = generate_json(default_urlresolver, script_prefix)",
            "    js_content = loader.render_to_string('django_js_reverse/urls_js.tpl', {",
            "        'data': json.dumps(data),",
            "        'js_name': '.'.join([js_global_object_name, js_var_name]),",
            "    })",
            "",
            "    if minfiy:",
            "        js_content = rjsmin.jsmin(js_content)",
            "    return js_content"
        ],
        "afterPatchFile": [
            "# -*- coding: utf-8 -*-",
            "import json",
            "import re",
            "import sys",
            "from distutils.version import LooseVersion",
            "",
            "import django",
            "from django.conf import settings",
            "from django.core.exceptions import ImproperlyConfigured",
            "from django.template import loader",
            "from django.utils.safestring import mark_safe",
            "from django.utils.encoding import force_text",
            "",
            "from . import rjsmin",
            "from .js_reverse_settings import (JS_EXCLUDE_NAMESPACES, JS_GLOBAL_OBJECT_NAME,",
            "                                  JS_INCLUDE_ONLY_NAMESPACES, JS_MINIFY,",
            "                                  JS_VAR_NAME)",
            "",
            "try:",
            "    from django import urls as urlresolvers",
            "except ImportError:",
            "    from django.core import urlresolvers",
            "",
            "if sys.version < '3':",
            "    text_type = unicode  # NOQA",
            "else:",
            "    text_type = str",
            "",
            "JS_IDENTIFIER_RE = re.compile(r'^[$A-Z_][\\dA-Z_$]*$')",
            "",
            "",
            "def prepare_url_list(urlresolver, namespace_path='', namespace=''):",
            "    \"\"\"",
            "    returns list of tuples [(<url_name>, <url_patern_tuple> ), ...]",
            "    \"\"\"",
            "    exclude_ns = getattr(settings, 'JS_REVERSE_EXCLUDE_NAMESPACES', JS_EXCLUDE_NAMESPACES)",
            "    include_only_ns = getattr(settings, 'JS_REVERSE_INCLUDE_ONLY_NAMESPACES', JS_INCLUDE_ONLY_NAMESPACES)",
            "",
            "    if exclude_ns and include_only_ns:",
            "        raise ImproperlyConfigured(",
            "            'Neither use JS_REVERSE_EXCLUDE_NAMESPACES nor JS_REVERSE_INCLUDE_ONLY_NAMESPACES setting')",
            "",
            "    if namespace[:-1] in exclude_ns:",
            "        return",
            "",
            "    include_only_allow = True  # include_only state varible",
            "",
            "    if include_only_ns != []:",
            "        # True mean that ns passed the test",
            "        in_on_empty_ns = False",
            "        in_on_is_in_list = False",
            "        in_on_null = False",
            "",
            "        # Test urls without ns",
            "        if namespace == '' and '' in include_only_ns:",
            "            in_on_empty_ns = True",
            "",
            "        # check if nestead ns isn't subns of include_only ns",
            "        # e.g. ns = \"foo:bar\" include_only = [\"foo\"] -> this ns will be used",
            "        # works for ns = \"lorem:ipsum:dolor\" include_only = [\"lorem:ipsum\"]",
            "        # ns \"lorem\" will be ignored but \"lorem:ipsum\" & \"lorem:ipsum:..\" won't",
            "        for ns in include_only_ns:",
            "            if ns != \"\" and namespace[:-1].startswith(ns):",
            "                in_on_is_in_list = True",
            "                break",
            "",
            "        # Test if isn't used \"\\0\" flag",
            "        # use \"foo\\0\" to add urls just from \"foo\" not from subns \"foo:bar\"",
            "        if namespace[:-1] + '\\0' in include_only_ns:",
            "            in_on_null = True",
            "",
            "        include_only_allow = in_on_empty_ns or in_on_is_in_list or in_on_null",
            "",
            "    if include_only_allow:",
            "        for url_name in urlresolver.reverse_dict.keys():",
            "            if isinstance(url_name, (text_type, str)):",
            "                url_patterns = []",
            "                for url_pattern in urlresolver.reverse_dict.getlist(url_name):",
            "                    url_patterns += [",
            "                        [namespace_path + pat[0], pat[1]] for pat in url_pattern[0]]",
            "                yield [namespace + url_name, url_patterns]",
            "",
            "    for inner_ns, (inner_ns_path, inner_urlresolver) in \\",
            "            urlresolver.namespace_dict.items():",
            "        inner_ns_path = namespace_path + inner_ns_path",
            "        inner_ns = namespace + inner_ns + ':'",
            "",
            "        # if we have inner_ns_path, reconstruct a new resolver so that we can",
            "        # handle regex substitutions within the regex of a namespace.",
            "        if inner_ns_path:",
            "            args = [inner_ns_path, inner_urlresolver]",
            "",
            "            # https://github.com/ierror/django-js-reverse/issues/65",
            "            if LooseVersion(django.get_version()) >= LooseVersion(\"2.0.6\"):",
            "                args.append(tuple(urlresolver.pattern.converters.items()))",
            "",
            "            inner_urlresolver = urlresolvers.get_ns_resolver(*args)",
            "            inner_ns_path = ''",
            "",
            "        for x in prepare_url_list(inner_urlresolver, inner_ns_path, inner_ns):",
            "            yield x",
            "",
            "",
            "def generate_json(default_urlresolver, script_prefix=None):",
            "    if script_prefix is None:",
            "        script_prefix = urlresolvers.get_script_prefix()",
            "",
            "    urls = sorted(list(prepare_url_list(default_urlresolver)))",
            "",
            "    return {",
            "        'urls': [",
            "            [",
            "                force_text(name),",
            "                [",
            "                    [force_text(path), [force_text(arg) for arg in args]]",
            "                    for path, args in patterns",
            "                ],",
            "            ] for name, patterns in urls",
            "        ],",
            "        'prefix': script_prefix,",
            "    }",
            "",
            "",
            "def _safe_json(obj):",
            "    return mark_safe(",
            "        json",
            "        .dumps(obj)",
            "        .replace('>', '\\\\u003E')",
            "        .replace('<', '\\\\u003C')",
            "        .replace('&', '\\\\u0026')",
            "    )",
            "",
            "",
            "def generate_js(default_urlresolver):",
            "    js_var_name = getattr(settings, 'JS_REVERSE_JS_VAR_NAME', JS_VAR_NAME)",
            "    if not JS_IDENTIFIER_RE.match(js_var_name.upper()):",
            "        raise ImproperlyConfigured(",
            "            'JS_REVERSE_JS_VAR_NAME setting \"%s\" is not a valid javascript identifier.' % (js_var_name))",
            "",
            "    js_global_object_name = getattr(settings, 'JS_REVERSE_JS_GLOBAL_OBJECT_NAME', JS_GLOBAL_OBJECT_NAME)",
            "    if not JS_IDENTIFIER_RE.match(js_global_object_name.upper()):",
            "        raise ImproperlyConfigured(",
            "            'JS_REVERSE_JS_GLOBAL_OBJECT_NAME setting \"%s\" is not a valid javascript identifier.' % (",
            "                js_global_object_name))",
            "",
            "    minfiy = getattr(settings, 'JS_REVERSE_JS_MINIFY', JS_MINIFY)",
            "    if not isinstance(minfiy, bool):",
            "        raise ImproperlyConfigured(",
            "            'JS_REVERSE_JS_MINIFY setting \"%s\" is not a valid. Needs to be set to True or False.' % (minfiy))",
            "",
            "    script_prefix_via_config = getattr(settings, 'JS_REVERSE_SCRIPT_PREFIX', None)",
            "    if script_prefix_via_config:",
            "        script_prefix = script_prefix_via_config",
            "        if not script_prefix.endswith('/'):",
            "            script_prefix = '{0}/'.format(script_prefix)",
            "    else:",
            "        script_prefix = urlresolvers.get_script_prefix()",
            "",
            "    data = generate_json(default_urlresolver, script_prefix)",
            "    js_content = loader.render_to_string('django_js_reverse/urls_js.tpl', {",
            "        'data': _safe_json(data),",
            "        'js_name': '.'.join([js_global_object_name, js_var_name]),",
            "    })",
            "",
            "    if minfiy:",
            "        js_content = rjsmin.jsmin(js_content)",
            "    return js_content"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "150": [
                "generate_js"
            ]
        },
        "addLocation": [
            "djangocms_attributes_field.fields"
        ]
    },
    "django_js_reverse/tests/test_urls.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " "
            },
            "1": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 21,
                "PatchRowcode": "     # test urls"
            },
            "2": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": 22,
                "PatchRowcode": "     url(r'^test_no_url_args/$', dummy_view, name='test_no_url_args'),"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 23,
                "PatchRowcode": "+    url(r'^test_script/$', dummy_view, name='</script><script>console.log(&amp;)</script><!--'),"
            },
            "4": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": 24,
                "PatchRowcode": "     url(r'^test_one_url_args/(?P<arg_one>[-\\w]+)/$', dummy_view, name='test_one_url_args'),"
            },
            "5": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": 25,
                "PatchRowcode": "     url(r'^test_two_url_args/(?P<arg_one>[-\\w]+)-(?P<arg_two>[-\\w]+)/$', dummy_view, name='test_two_url_args'),"
            },
            "6": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 26,
                "PatchRowcode": "     url(r'^test_optional_url_arg/(?:1_(?P<arg_one>[-\\w]+)-)?2_(?P<arg_two>[-\\w]+)/$', dummy_view,"
            }
        },
        "frontPatchFile": [
            "# -*- coding: utf-8 -*-",
            "from copy import copy",
            "",
            "from django.conf.urls import include as django_include",
            "from django.conf.urls import url",
            "from django.views.generic import View",
            "from django_js_reverse.tests.helper import is_django_ver_gte_2",
            "from django_js_reverse.views import urls_js",
            "",
            "try:",
            "    from django.urls import path",
            "except ImportError:",
            "    pass",
            "",
            "",
            "dummy_view = View.as_view()",
            "",
            "basic_patterns = [",
            "    url(r'^jsreverse/$', urls_js, name='js_reverse'),",
            "",
            "    # test urls",
            "    url(r'^test_no_url_args/$', dummy_view, name='test_no_url_args'),",
            "    url(r'^test_one_url_args/(?P<arg_one>[-\\w]+)/$', dummy_view, name='test_one_url_args'),",
            "    url(r'^test_two_url_args/(?P<arg_one>[-\\w]+)-(?P<arg_two>[-\\w]+)/$', dummy_view, name='test_two_url_args'),",
            "    url(r'^test_optional_url_arg/(?:1_(?P<arg_one>[-\\w]+)-)?2_(?P<arg_two>[-\\w]+)/$', dummy_view,",
            "        name='test_optional_url_arg'),",
            "    url(r'^test_unicode_url_name/$', dummy_view, name=u'test_unicode_url_name'),",
            "    url(r'^test_duplicate_name/(?P<arg_one>[-\\w]+)/$', dummy_view, name='test_duplicate_name'),",
            "    url(r'^test_duplicate_name/(?P<arg_one>[-\\w]+)-(?P<arg_two>[-\\w]+)/$', dummy_view, name='test_duplicate_name'),",
            "    url(r'^test_duplicate_argcount/(?P<arg_one>[-\\w]+)?-(?P<arg_two>[-\\w]+)?/$', dummy_view,",
            "        name='test_duplicate_argcount'),",
            "]",
            "",
            "if is_django_ver_gte_2():",
            "    basic_patterns.append(",
            "        path('test_django_gte_2_path_syntax/<int:arg_one>/<str:arg_two>/', dummy_view,",
            "             name='test_django_gte_2_path_syntax'),",
            "    )",
            "",
            "urlpatterns = copy(basic_patterns)",
            "",
            "# test exclude namespaces urls",
            "urlexclude = [",
            "    url(r'^test_exclude_namespace/$', dummy_view,",
            "        name='test_exclude_namespace_url1')",
            "]",
            "",
            "",
            "def include(v, **kwargs):",
            "    if not is_django_ver_gte_2():",
            "        return django_include(v, **kwargs)",
            "",
            "    return django_include((v, 'django_js_reverse'), **kwargs)",
            "",
            "",
            "# test namespace",
            "pattern_ns_1 = [",
            "    url(r'', django_include(basic_patterns))",
            "]",
            "",
            "pattern_ns_2 = [",
            "    url(r'', django_include(basic_patterns))",
            "]",
            "",
            "pattern_ns = [",
            "    url(r'', django_include(basic_patterns))",
            "]",
            "",
            "pattern_nested_ns = [",
            "    url(r'^ns1/', include(pattern_ns_1, namespace='ns1'))",
            "]",
            "",
            "pattern_dubble_nested2_ns = [",
            "    url(r'^ns1/', include(pattern_ns_1, namespace='ns1'))]",
            "",
            "pattern_dubble_nested_ns = [",
            "    url(r'^ns1/', include(pattern_ns_1, namespace='ns1')),",
            "    url(r'^nsdn2/', include(pattern_dubble_nested2_ns, namespace='nsdn2'))]",
            "",
            "pattern_only_nested_ns = [",
            "    url(r'^ns1/', django_include(pattern_ns_1)),",
            "    url(r'^nsdn0/', include(pattern_dubble_nested2_ns, namespace='nsdn0'))]",
            "",
            "urlpatterns += [",
            "    url(r'^ns1/', include(pattern_ns_1, namespace='ns1')),",
            "    url(r'^ns2/', include(pattern_ns_2, namespace='ns2')),",
            "    url(r'^ns_ex/', include(urlexclude, namespace='exclude_namespace')),",
            "    url(r'^ns(?P<ns_arg>[^/]*)/', include(pattern_ns, namespace='ns_arg')),",
            "    url(r'^nestedns/', include(pattern_nested_ns, namespace='nestedns')),",
            "    url(r'^nsdn/', include(pattern_dubble_nested_ns, namespace='nsdn')),",
            "    url(r'^nsno/', include(pattern_only_nested_ns, namespace='nsno'))",
            "]"
        ],
        "afterPatchFile": [
            "# -*- coding: utf-8 -*-",
            "from copy import copy",
            "",
            "from django.conf.urls import include as django_include",
            "from django.conf.urls import url",
            "from django.views.generic import View",
            "from django_js_reverse.tests.helper import is_django_ver_gte_2",
            "from django_js_reverse.views import urls_js",
            "",
            "try:",
            "    from django.urls import path",
            "except ImportError:",
            "    pass",
            "",
            "",
            "dummy_view = View.as_view()",
            "",
            "basic_patterns = [",
            "    url(r'^jsreverse/$', urls_js, name='js_reverse'),",
            "",
            "    # test urls",
            "    url(r'^test_no_url_args/$', dummy_view, name='test_no_url_args'),",
            "    url(r'^test_script/$', dummy_view, name='</script><script>console.log(&amp;)</script><!--'),",
            "    url(r'^test_one_url_args/(?P<arg_one>[-\\w]+)/$', dummy_view, name='test_one_url_args'),",
            "    url(r'^test_two_url_args/(?P<arg_one>[-\\w]+)-(?P<arg_two>[-\\w]+)/$', dummy_view, name='test_two_url_args'),",
            "    url(r'^test_optional_url_arg/(?:1_(?P<arg_one>[-\\w]+)-)?2_(?P<arg_two>[-\\w]+)/$', dummy_view,",
            "        name='test_optional_url_arg'),",
            "    url(r'^test_unicode_url_name/$', dummy_view, name=u'test_unicode_url_name'),",
            "    url(r'^test_duplicate_name/(?P<arg_one>[-\\w]+)/$', dummy_view, name='test_duplicate_name'),",
            "    url(r'^test_duplicate_name/(?P<arg_one>[-\\w]+)-(?P<arg_two>[-\\w]+)/$', dummy_view, name='test_duplicate_name'),",
            "    url(r'^test_duplicate_argcount/(?P<arg_one>[-\\w]+)?-(?P<arg_two>[-\\w]+)?/$', dummy_view,",
            "        name='test_duplicate_argcount'),",
            "]",
            "",
            "if is_django_ver_gte_2():",
            "    basic_patterns.append(",
            "        path('test_django_gte_2_path_syntax/<int:arg_one>/<str:arg_two>/', dummy_view,",
            "             name='test_django_gte_2_path_syntax'),",
            "    )",
            "",
            "urlpatterns = copy(basic_patterns)",
            "",
            "# test exclude namespaces urls",
            "urlexclude = [",
            "    url(r'^test_exclude_namespace/$', dummy_view,",
            "        name='test_exclude_namespace_url1')",
            "]",
            "",
            "",
            "def include(v, **kwargs):",
            "    if not is_django_ver_gte_2():",
            "        return django_include(v, **kwargs)",
            "",
            "    return django_include((v, 'django_js_reverse'), **kwargs)",
            "",
            "",
            "# test namespace",
            "pattern_ns_1 = [",
            "    url(r'', django_include(basic_patterns))",
            "]",
            "",
            "pattern_ns_2 = [",
            "    url(r'', django_include(basic_patterns))",
            "]",
            "",
            "pattern_ns = [",
            "    url(r'', django_include(basic_patterns))",
            "]",
            "",
            "pattern_nested_ns = [",
            "    url(r'^ns1/', include(pattern_ns_1, namespace='ns1'))",
            "]",
            "",
            "pattern_dubble_nested2_ns = [",
            "    url(r'^ns1/', include(pattern_ns_1, namespace='ns1'))]",
            "",
            "pattern_dubble_nested_ns = [",
            "    url(r'^ns1/', include(pattern_ns_1, namespace='ns1')),",
            "    url(r'^nsdn2/', include(pattern_dubble_nested2_ns, namespace='nsdn2'))]",
            "",
            "pattern_only_nested_ns = [",
            "    url(r'^ns1/', django_include(pattern_ns_1)),",
            "    url(r'^nsdn0/', include(pattern_dubble_nested2_ns, namespace='nsdn0'))]",
            "",
            "urlpatterns += [",
            "    url(r'^ns1/', include(pattern_ns_1, namespace='ns1')),",
            "    url(r'^ns2/', include(pattern_ns_2, namespace='ns2')),",
            "    url(r'^ns_ex/', include(urlexclude, namespace='exclude_namespace')),",
            "    url(r'^ns(?P<ns_arg>[^/]*)/', include(pattern_ns, namespace='ns_arg')),",
            "    url(r'^nestedns/', include(pattern_nested_ns, namespace='nestedns')),",
            "    url(r'^nsdn/', include(pattern_dubble_nested_ns, namespace='nsdn')),",
            "    url(r'^nsno/', include(pattern_only_nested_ns, namespace='nsno'))",
            "]"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": []
    },
    "django_js_reverse/tests/unit_tests.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 265,
                "afterPatchRowNumber": 265,
                "PatchRowcode": " "
            },
            "1": {
                "beforePatchRowNumber": 266,
                "afterPatchRowNumber": 266,
                "PatchRowcode": " @override_settings("
            },
            "2": {
                "beforePatchRowNumber": 267,
                "afterPatchRowNumber": 267,
                "PatchRowcode": "     ROOT_URLCONF='django_js_reverse.tests.test_urls',"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 268,
                "PatchRowcode": "+"
            },
            "4": {
                "beforePatchRowNumber": 268,
                "afterPatchRowNumber": 269,
                "PatchRowcode": "     TEMPLATE_CONTEXT_PROCESSORS=['django.core.context_processors.request'],"
            },
            "5": {
                "beforePatchRowNumber": 269,
                "afterPatchRowNumber": 270,
                "PatchRowcode": " )"
            },
            "6": {
                "beforePatchRowNumber": 270,
                "afterPatchRowNumber": 271,
                "PatchRowcode": " class JSReverseTemplateTagTest(AbstractJSReverseTestCase, TestCase):"
            },
            "7": {
                "beforePatchRowNumber": 288,
                "afterPatchRowNumber": 289,
                "PatchRowcode": "         js_from_view = smart_str(self.client.post('/jsreverse/').content)"
            },
            "8": {
                "beforePatchRowNumber": 289,
                "afterPatchRowNumber": 290,
                "PatchRowcode": "         self.assertEqual(js_from_tag, js_from_view)"
            },
            "9": {
                "beforePatchRowNumber": 290,
                "afterPatchRowNumber": 291,
                "PatchRowcode": " "
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 292,
                "PatchRowcode": "+    def test_tpl_tag_escape_entities(self):"
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 293,
                "PatchRowcode": "+        context_instance = Context()"
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 294,
                "PatchRowcode": "+        tpl = Template('{% load js_reverse %}{% js_reverse_inline %}')"
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 295,
                "PatchRowcode": "+        js = tpl.render(context_instance)"
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 296,
                "PatchRowcode": "+        self.assertIn("
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 297,
                "PatchRowcode": "+            '\\\\u003C/script\\\\u003E\\\\u003Cscript\\\\u003Econsole.log(\\\\u0026amp;)'"
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 298,
                "PatchRowcode": "+            '\\\\u003C/script\\\\u003E\\\\u003C!--',"
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 299,
                "PatchRowcode": "+            js,"
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 300,
                "PatchRowcode": "+        )"
            },
            "19": {
                "beforePatchRowNumber": 291,
                "afterPatchRowNumber": 301,
                "PatchRowcode": " "
            },
            "20": {
                "beforePatchRowNumber": 292,
                "afterPatchRowNumber": 302,
                "PatchRowcode": " if __name__ == '__main__':"
            },
            "21": {
                "beforePatchRowNumber": 293,
                "afterPatchRowNumber": 303,
                "PatchRowcode": "     unittest.main()"
            }
        },
        "frontPatchFile": [
            "#!/usr/bin/env python",
            "# -*- coding: utf-8 -*-",
            "from __future__ import unicode_literals",
            "",
            "import io",
            "import json",
            "import os",
            "import re",
            "import subprocess",
            "import sys",
            "import unittest",
            "",
            "import django",
            "from django.conf import settings",
            "from django.core.exceptions import ImproperlyConfigured",
            "from django.core.management import call_command",
            "from django.template import Context, RequestContext, Template",
            "from django.utils.encoding import smart_str",
            "from helper import is_django_ver_gte_2",
            "from utils import script_prefix",
            "",
            "sys.path.insert(0, os.path.join(os.path.dirname(os.path.abspath(__file__)), '..', '..') + os.sep)",
            "os.environ['DJANGO_SETTINGS_MODULE'] = 'settings'",
            "",
            "from django.test import TestCase, RequestFactory  # noqa: E402 isort:skip",
            "from django.test.client import Client  # noqa: E402 isort:skip",
            "from django.test.utils import override_settings  # noqa: E402 isort:skip",
            "",
            "",
            "class AbstractJSReverseTestCase(object):",
            "    client = Client()",
            "",
            "    @classmethod",
            "    def setUpClass(cls):",
            "        if hasattr(django, 'setup'):",
            "            # for django >= 1.7",
            "            django.setup()",
            "        super(AbstractJSReverseTestCase, cls).setUpClass()",
            "",
            "    def assertEqualJSEval(self, js, url_call, expected_url):",
            "        script = '{}return {};'.format(js, url_call)",
            "        module = 'console.log(new Function({})());'.format(json.dumps(script))",
            "        stdout = (",
            "            subprocess",
            "            .check_output(['node', '-e', module.encode('utf8')])",
            "            .decode('utf8')",
            "        )",
            "        self.assertEqual(re.sub(r'\\n$', '', stdout), expected_url)",
            "",
            "    def assertEqualJSUrlEval(self, *args, **kwargs):",
            "        js = smart_str(self.client.post('/jsreverse/').content)",
            "        self.assertEqualJSEval(js, *args, **kwargs)",
            "",
            "",
            "@override_settings(ROOT_URLCONF='django_js_reverse.tests.test_urls')",
            "class JSReverseViewTestCaseMinified(AbstractJSReverseTestCase, TestCase):",
            "    def test_view_no_url_args(self):",
            "        self.assertEqualJSUrlEval('Urls.test_no_url_args()', '/test_no_url_args/')",
            "",
            "    def test_camel_case(self):",
            "        self.assertEqualJSUrlEval('Urls.testNoUrlArgs()', '/test_no_url_args/')",
            "",
            "    def test_view_one_url_arg(self):",
            "        self.assertEqualJSUrlEval('Urls.test_one_url_args(\"arg_one\")', '/test_one_url_args/arg_one/')",
            "",
            "    def test_view_two_url_args(self):",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(\"arg_one\", \"arg_two\")', '/test_two_url_args/arg_one-arg_two/')",
            "",
            "    def test_view_optional_url_arg(self):",
            "        self.assertEqualJSUrlEval('Urls.test_optional_url_arg(\"arg_two\")',",
            "                                  '/test_optional_url_arg/2_arg_two/')",
            "        self.assertEqualJSUrlEval('Urls.test_optional_url_arg(\"arg_one\", \"arg_two\")',",
            "                                  '/test_optional_url_arg/1_arg_one-2_arg_two/')",
            "",
            "    def test_unicode_url_name(self):",
            "        self.assertEqualJSUrlEval('Urls.test_unicode_url_name()', '/test_unicode_url_name/')",
            "",
            "    @override_settings(JS_REVERSE_JS_VAR_NAME='Foo')",
            "    def test_js_var_name_changed_valid(self):",
            "        self.assertEqualJSUrlEval('Foo.test_no_url_args()', '/test_no_url_args/')",
            "",
            "    @override_settings(JS_REVERSE_JS_VAR_NAME='1test')",
            "    def test_js_var_name_changed_to_invalid(self):",
            "        with self.assertRaises(ImproperlyConfigured):",
            "            self.client.post('/jsreverse/')",
            "",
            "    def test_namespaces(self):",
            "        self.assertEqualJSUrlEval('Urls[\"ns1:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/ns1/test_two_url_args/arg_one-arg_two/')",
            "        self.assertEqualJSUrlEval('Urls[\"ns2:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/ns2/test_two_url_args/arg_one-arg_two/')",
            "",
            "    def test_namespaces_with_args(self):",
            "        self.assertEqualJSUrlEval('Urls[\"ns_arg:test_two_url_args\"](\"arg_one\", \"arg_two\", \"arg_three\")',",
            "                                  '/nsarg_one/test_two_url_args/arg_two-arg_three/')",
            "",
            "    def test_namespaces_nested(self):",
            "        self.assertEqualJSUrlEval('Urls[\"nestedns:ns1:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/nestedns/ns1/test_two_url_args/arg_one-arg_two/')",
            "",
            "    def test_content_type(self):",
            "        response = self.client.post('/jsreverse/')",
            "        self.assertEqual(response['Content-Type'], 'application/javascript')",
            "",
            "    @override_settings(JS_REVERSE_JS_MINIFY='invalid')",
            "    def test_js_minfiy_changed_to_invalid(self):",
            "        with self.assertRaises(ImproperlyConfigured):",
            "            self.client.post('/jsreverse/')",
            "",
            "    def test_namespace_in_urls(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertContains(response, 'exclude_namespace', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_EXCLUDE_NAMESPACES=['exclude_namespace'])",
            "    def test_namespace_not_in_response(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertNotContains(response, 'exclude_namespace', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=['ns1'])",
            "    def test_only_namespace_in_response(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertContains(response, 'ns1', status_code=200)",
            "        self.assertNotContains(response, 'ns2', status_code=200)",
            "        self.assertNotContains(response, 'ns_arg', status_code=200)",
            "        self.assertNotContains(response, 'nesteadns', status_code=200)",
            "        self.assertNotContains(response, 'exclude_namespace', status_code=200)",
            "        self.assertNotContains(response, 'nsdn', status_code=200)",
            "        self.assertNotContains(response, 'nsno', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=['nsdn:nsdn'])",
            "    def test_only_namespace_nestead_in_response(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertContains(response, 'nsdn:nsdn2:ns1', status_code=200)",
            "        self.assertNotContains(response, 'nsdn:ns1', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=[''])",
            "    def test_only_empty_namespaces(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertEqualJSUrlEval('Urls[\"test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/test_two_url_args/arg_one-arg_two/')",
            "        self.assertNotContains(response, 'ns1', status_code=200)",
            "        self.assertNotContains(response, 'ns2', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=['nsno\\0'])",
            "    def test_only_namespaces_without_subnss(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertEqualJSUrlEval('Urls[\"nsno:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/nsno/ns1/test_two_url_args/arg_one-arg_two/')",
            "        self.assertNotContains(response, 'nsno:nsdn0', status_code=200)",
            "",
            "    def test_script_prefix_v1(self):",
            "        with script_prefix('/foobarlala/'):",
            "            self.assertEqualJSUrlEval('Urls[\"nestedns:ns1:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                      '/foobarlala/nestedns/ns1/test_two_url_args/arg_one-arg_two/')",
            "",
            "    def test_duplicate_name(self):",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_name(\"arg_one\")',",
            "                                  '/test_duplicate_name/arg_one/')",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_name(\"arg_one\", \"arg_two\")',",
            "                                  '/test_duplicate_name/arg_one-arg_two/')",
            "",
            "    def test_duplicate_argcount(self):",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_argcount({arg_one: \"arg_one\"})',",
            "                                  '/test_duplicate_argcount/arg_one-/')",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_argcount({arg_two: \"arg_two\"})',",
            "                                  '/test_duplicate_argcount/-arg_two/')",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_argcount({arg_one: \"arg_one\", arg_two: \"arg_two\"})',",
            "                                  '/test_duplicate_argcount/arg_one-arg_two/')",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=['nsno\\0'])",
            "    @override_settings(JS_REVERSE_EXCLUDE_NAMESPACES=['exclude_namespace'])",
            "    def test_include_exclude_configuration(self):",
            "        with self.assertRaises(ImproperlyConfigured):",
            "            self.client.post('/jsreverse/')",
            "",
            "    def test_int_args(self):",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(0, 5)', '/test_two_url_args/0-5/')",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(\"\", 5)', '/test_two_url_args/-5/')",
            "",
            "    def test_float_args(self):",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(0, 5.5)', '/test_two_url_args/0-5.5/')",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(0.00001, 5.5)', '/test_two_url_args/0.00001-5.5/')",
            "",
            "    def test_django_path_syntax(self):",
            "        if is_django_ver_gte_2():",
            "            self.assertEqualJSUrlEval('Urls.test_django_gte_2_path_syntax(42, \"foo\")',",
            "                                      '/test_django_gte_2_path_syntax/42/foo/')",
            "",
            "",
            "@override_settings(JS_REVERSE_JS_MINIFY=False)",
            "@override_settings(ROOT_URLCONF='django_js_reverse.tests.test_urls')",
            "class JSReverseViewTestCaseNotMinified(JSReverseViewTestCaseMinified):",
            "    def test_minification(self):",
            "        js_not_minified = smart_str(self.client.post('/jsreverse/').content)",
            "        with override_settings(JS_REVERSE_JS_MINIFY=True):",
            "            js_minified = smart_str(self.client.post('/jsreverse/').content)",
            "            self.assertTrue(len(js_minified) < len(js_not_minified))",
            "",
            "",
            "@override_settings(ROOT_URLCONF='django_js_reverse.tests.test_urls')",
            "class JSReverseViewTestCaseGlobalObjectName(JSReverseViewTestCaseMinified):",
            "    def test_global_object_name_default(self):",
            "        js_content = smart_str(self.client.post('/jsreverse/').content)",
            "        self.assertTrue(js_content.startswith('this.'))",
            "",
            "    @override_settings(JS_REVERSE_JS_GLOBAL_OBJECT_NAME='window')",
            "    def test_global_object_name_change(self):",
            "        js_content = smart_str(self.client.post('/jsreverse/').content)",
            "        self.assertTrue(js_content.startswith('window.'))",
            "",
            "    @override_settings(JS_REVERSE_JS_GLOBAL_OBJECT_NAME='1test')",
            "    def test_global_object_name_change_invalid_identifier(self):",
            "        with self.assertRaises(ImproperlyConfigured):",
            "            self.client.post('/jsreverse/')",
            "",
            "",
            "@override_settings(ROOT_URLCONF='django_js_reverse.tests.test_urls')",
            "class JSReverseStaticFileSaveTest(AbstractJSReverseTestCase, TestCase):",
            "    def test_reverse_js_file_save(self):",
            "        call_command('collectstatic_js_reverse')",
            "",
            "        path = os.path.join(settings.STATIC_ROOT, 'django_js_reverse', 'js', 'reverse.js')",
            "        f = io.open(path)",
            "        content1 = f.read()",
            "",
            "        r2 = self.client.get('/jsreverse/')",
            "        content2 = r2.content.decode()",
            "",
            "        self.assertEqual(len(content1), len(content2), 'Static file don\\'t match http response content_1')",
            "        self.assertEqual(content1, content2, 'Static file don\\'t match http response content_2')",
            "",
            "        # test for exception if STATIC_ROOT is not set",
            "        with override_settings(STATIC_ROOT=None):",
            "            with self.assertRaises(ImproperlyConfigured):",
            "                call_command('collectstatic_js_reverse')",
            "",
            "    def test_reverse_js_file_save_with_output_path_option(self):",
            "        js_output_path = os.path.join(os.path.dirname(__file__), 'tmp', 'some_path')",
            "        with override_settings(JS_REVERSE_OUTPUT_PATH=js_output_path):",
            "            call_command('collectstatic_js_reverse')",
            "",
            "            f = io.open(os.path.join(js_output_path, 'reverse.js'))",
            "            content1 = f.read()",
            "",
            "            r2 = self.client.get('/jsreverse/')",
            "            content2 = r2.content.decode()",
            "",
            "            self.assertEqual(len(content1), len(content2), 'Static file don\\'t match http response content_1')",
            "            self.assertEqual(content1, content2, 'Static file don\\'t match http response content_2')",
            "",
            "            # should not raise ImproperlyConfigured exception if STATIC_ROOT is not set",
            "            with override_settings(STATIC_ROOT=None):",
            "                call_command('collectstatic_js_reverse')",
            "",
            "    def test_script_prefix_noslash(self):",
            "        script_prefix = '/test/foo/bar'",
            "        with override_settings(JS_REVERSE_SCRIPT_PREFIX=script_prefix):",
            "            self.assertEqualJSUrlEval('Urls.test_no_url_args()', '{0}/test_no_url_args/'.format(script_prefix))",
            "",
            "    def test_script_prefix(self):",
            "        script_prefix = '/test/foo/bar/'",
            "        with override_settings(JS_REVERSE_SCRIPT_PREFIX=script_prefix):",
            "            self.assertEqualJSUrlEval('Urls.test_no_url_args()', '{0}test_no_url_args/'.format(script_prefix))",
            "",
            "",
            "@override_settings(",
            "    ROOT_URLCONF='django_js_reverse.tests.test_urls',",
            "    TEMPLATE_CONTEXT_PROCESSORS=['django.core.context_processors.request'],",
            ")",
            "class JSReverseTemplateTagTest(AbstractJSReverseTestCase, TestCase):",
            "    def test_tpl_tag_with_request_in_context(self):",
            "        request = RequestFactory().post('/jsreverse/')",
            "        request.urlconf = 'django_js_reverse.tests.test_urlconf_urls'",
            "        tpl = Template('{% load js_reverse %}{% js_reverse_inline %}')",
            "        js = tpl.render(RequestContext(request))",
            "        self.assertEqualJSEval(js, 'Urls.test_changed_urlconf()', '/test_changed_urlconf/')",
            "",
            "    def test_tpl_tag_with_dict_request_in_context(self):",
            "        request = {'urlconf': 'django_js_reverse.tests.test_urlconf_urls'}",
            "        tpl = Template('{% load js_reverse %}{% js_reverse_inline %}')",
            "        js = tpl.render(Context({'request': request}))",
            "        self.assertEqualJSEval(js, 'Urls.test_changed_urlconf()', '/test_changed_urlconf/')",
            "",
            "    def test_tpl_tag_without_request_in_context(self):",
            "        context_instance = Context()",
            "        tpl = Template('{% load js_reverse %}{% js_reverse_inline %}')",
            "        js_from_tag = tpl.render(context_instance)",
            "        js_from_view = smart_str(self.client.post('/jsreverse/').content)",
            "        self.assertEqual(js_from_tag, js_from_view)",
            "",
            "",
            "if __name__ == '__main__':",
            "    unittest.main()"
        ],
        "afterPatchFile": [
            "#!/usr/bin/env python",
            "# -*- coding: utf-8 -*-",
            "from __future__ import unicode_literals",
            "",
            "import io",
            "import json",
            "import os",
            "import re",
            "import subprocess",
            "import sys",
            "import unittest",
            "",
            "import django",
            "from django.conf import settings",
            "from django.core.exceptions import ImproperlyConfigured",
            "from django.core.management import call_command",
            "from django.template import Context, RequestContext, Template",
            "from django.utils.encoding import smart_str",
            "from helper import is_django_ver_gte_2",
            "from utils import script_prefix",
            "",
            "sys.path.insert(0, os.path.join(os.path.dirname(os.path.abspath(__file__)), '..', '..') + os.sep)",
            "os.environ['DJANGO_SETTINGS_MODULE'] = 'settings'",
            "",
            "from django.test import TestCase, RequestFactory  # noqa: E402 isort:skip",
            "from django.test.client import Client  # noqa: E402 isort:skip",
            "from django.test.utils import override_settings  # noqa: E402 isort:skip",
            "",
            "",
            "class AbstractJSReverseTestCase(object):",
            "    client = Client()",
            "",
            "    @classmethod",
            "    def setUpClass(cls):",
            "        if hasattr(django, 'setup'):",
            "            # for django >= 1.7",
            "            django.setup()",
            "        super(AbstractJSReverseTestCase, cls).setUpClass()",
            "",
            "    def assertEqualJSEval(self, js, url_call, expected_url):",
            "        script = '{}return {};'.format(js, url_call)",
            "        module = 'console.log(new Function({})());'.format(json.dumps(script))",
            "        stdout = (",
            "            subprocess",
            "            .check_output(['node', '-e', module.encode('utf8')])",
            "            .decode('utf8')",
            "        )",
            "        self.assertEqual(re.sub(r'\\n$', '', stdout), expected_url)",
            "",
            "    def assertEqualJSUrlEval(self, *args, **kwargs):",
            "        js = smart_str(self.client.post('/jsreverse/').content)",
            "        self.assertEqualJSEval(js, *args, **kwargs)",
            "",
            "",
            "@override_settings(ROOT_URLCONF='django_js_reverse.tests.test_urls')",
            "class JSReverseViewTestCaseMinified(AbstractJSReverseTestCase, TestCase):",
            "    def test_view_no_url_args(self):",
            "        self.assertEqualJSUrlEval('Urls.test_no_url_args()', '/test_no_url_args/')",
            "",
            "    def test_camel_case(self):",
            "        self.assertEqualJSUrlEval('Urls.testNoUrlArgs()', '/test_no_url_args/')",
            "",
            "    def test_view_one_url_arg(self):",
            "        self.assertEqualJSUrlEval('Urls.test_one_url_args(\"arg_one\")', '/test_one_url_args/arg_one/')",
            "",
            "    def test_view_two_url_args(self):",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(\"arg_one\", \"arg_two\")', '/test_two_url_args/arg_one-arg_two/')",
            "",
            "    def test_view_optional_url_arg(self):",
            "        self.assertEqualJSUrlEval('Urls.test_optional_url_arg(\"arg_two\")',",
            "                                  '/test_optional_url_arg/2_arg_two/')",
            "        self.assertEqualJSUrlEval('Urls.test_optional_url_arg(\"arg_one\", \"arg_two\")',",
            "                                  '/test_optional_url_arg/1_arg_one-2_arg_two/')",
            "",
            "    def test_unicode_url_name(self):",
            "        self.assertEqualJSUrlEval('Urls.test_unicode_url_name()', '/test_unicode_url_name/')",
            "",
            "    @override_settings(JS_REVERSE_JS_VAR_NAME='Foo')",
            "    def test_js_var_name_changed_valid(self):",
            "        self.assertEqualJSUrlEval('Foo.test_no_url_args()', '/test_no_url_args/')",
            "",
            "    @override_settings(JS_REVERSE_JS_VAR_NAME='1test')",
            "    def test_js_var_name_changed_to_invalid(self):",
            "        with self.assertRaises(ImproperlyConfigured):",
            "            self.client.post('/jsreverse/')",
            "",
            "    def test_namespaces(self):",
            "        self.assertEqualJSUrlEval('Urls[\"ns1:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/ns1/test_two_url_args/arg_one-arg_two/')",
            "        self.assertEqualJSUrlEval('Urls[\"ns2:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/ns2/test_two_url_args/arg_one-arg_two/')",
            "",
            "    def test_namespaces_with_args(self):",
            "        self.assertEqualJSUrlEval('Urls[\"ns_arg:test_two_url_args\"](\"arg_one\", \"arg_two\", \"arg_three\")',",
            "                                  '/nsarg_one/test_two_url_args/arg_two-arg_three/')",
            "",
            "    def test_namespaces_nested(self):",
            "        self.assertEqualJSUrlEval('Urls[\"nestedns:ns1:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/nestedns/ns1/test_two_url_args/arg_one-arg_two/')",
            "",
            "    def test_content_type(self):",
            "        response = self.client.post('/jsreverse/')",
            "        self.assertEqual(response['Content-Type'], 'application/javascript')",
            "",
            "    @override_settings(JS_REVERSE_JS_MINIFY='invalid')",
            "    def test_js_minfiy_changed_to_invalid(self):",
            "        with self.assertRaises(ImproperlyConfigured):",
            "            self.client.post('/jsreverse/')",
            "",
            "    def test_namespace_in_urls(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertContains(response, 'exclude_namespace', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_EXCLUDE_NAMESPACES=['exclude_namespace'])",
            "    def test_namespace_not_in_response(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertNotContains(response, 'exclude_namespace', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=['ns1'])",
            "    def test_only_namespace_in_response(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertContains(response, 'ns1', status_code=200)",
            "        self.assertNotContains(response, 'ns2', status_code=200)",
            "        self.assertNotContains(response, 'ns_arg', status_code=200)",
            "        self.assertNotContains(response, 'nesteadns', status_code=200)",
            "        self.assertNotContains(response, 'exclude_namespace', status_code=200)",
            "        self.assertNotContains(response, 'nsdn', status_code=200)",
            "        self.assertNotContains(response, 'nsno', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=['nsdn:nsdn'])",
            "    def test_only_namespace_nestead_in_response(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertContains(response, 'nsdn:nsdn2:ns1', status_code=200)",
            "        self.assertNotContains(response, 'nsdn:ns1', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=[''])",
            "    def test_only_empty_namespaces(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertEqualJSUrlEval('Urls[\"test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/test_two_url_args/arg_one-arg_two/')",
            "        self.assertNotContains(response, 'ns1', status_code=200)",
            "        self.assertNotContains(response, 'ns2', status_code=200)",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=['nsno\\0'])",
            "    def test_only_namespaces_without_subnss(self):",
            "        response = self.client.get('/jsreverse/')",
            "        self.assertEqualJSUrlEval('Urls[\"nsno:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                  '/nsno/ns1/test_two_url_args/arg_one-arg_two/')",
            "        self.assertNotContains(response, 'nsno:nsdn0', status_code=200)",
            "",
            "    def test_script_prefix_v1(self):",
            "        with script_prefix('/foobarlala/'):",
            "            self.assertEqualJSUrlEval('Urls[\"nestedns:ns1:test_two_url_args\"](\"arg_one\", \"arg_two\")',",
            "                                      '/foobarlala/nestedns/ns1/test_two_url_args/arg_one-arg_two/')",
            "",
            "    def test_duplicate_name(self):",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_name(\"arg_one\")',",
            "                                  '/test_duplicate_name/arg_one/')",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_name(\"arg_one\", \"arg_two\")',",
            "                                  '/test_duplicate_name/arg_one-arg_two/')",
            "",
            "    def test_duplicate_argcount(self):",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_argcount({arg_one: \"arg_one\"})',",
            "                                  '/test_duplicate_argcount/arg_one-/')",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_argcount({arg_two: \"arg_two\"})',",
            "                                  '/test_duplicate_argcount/-arg_two/')",
            "        self.assertEqualJSUrlEval('Urls.test_duplicate_argcount({arg_one: \"arg_one\", arg_two: \"arg_two\"})',",
            "                                  '/test_duplicate_argcount/arg_one-arg_two/')",
            "",
            "    @override_settings(JS_REVERSE_INCLUDE_ONLY_NAMESPACES=['nsno\\0'])",
            "    @override_settings(JS_REVERSE_EXCLUDE_NAMESPACES=['exclude_namespace'])",
            "    def test_include_exclude_configuration(self):",
            "        with self.assertRaises(ImproperlyConfigured):",
            "            self.client.post('/jsreverse/')",
            "",
            "    def test_int_args(self):",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(0, 5)', '/test_two_url_args/0-5/')",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(\"\", 5)', '/test_two_url_args/-5/')",
            "",
            "    def test_float_args(self):",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(0, 5.5)', '/test_two_url_args/0-5.5/')",
            "        self.assertEqualJSUrlEval('Urls.test_two_url_args(0.00001, 5.5)', '/test_two_url_args/0.00001-5.5/')",
            "",
            "    def test_django_path_syntax(self):",
            "        if is_django_ver_gte_2():",
            "            self.assertEqualJSUrlEval('Urls.test_django_gte_2_path_syntax(42, \"foo\")',",
            "                                      '/test_django_gte_2_path_syntax/42/foo/')",
            "",
            "",
            "@override_settings(JS_REVERSE_JS_MINIFY=False)",
            "@override_settings(ROOT_URLCONF='django_js_reverse.tests.test_urls')",
            "class JSReverseViewTestCaseNotMinified(JSReverseViewTestCaseMinified):",
            "    def test_minification(self):",
            "        js_not_minified = smart_str(self.client.post('/jsreverse/').content)",
            "        with override_settings(JS_REVERSE_JS_MINIFY=True):",
            "            js_minified = smart_str(self.client.post('/jsreverse/').content)",
            "            self.assertTrue(len(js_minified) < len(js_not_minified))",
            "",
            "",
            "@override_settings(ROOT_URLCONF='django_js_reverse.tests.test_urls')",
            "class JSReverseViewTestCaseGlobalObjectName(JSReverseViewTestCaseMinified):",
            "    def test_global_object_name_default(self):",
            "        js_content = smart_str(self.client.post('/jsreverse/').content)",
            "        self.assertTrue(js_content.startswith('this.'))",
            "",
            "    @override_settings(JS_REVERSE_JS_GLOBAL_OBJECT_NAME='window')",
            "    def test_global_object_name_change(self):",
            "        js_content = smart_str(self.client.post('/jsreverse/').content)",
            "        self.assertTrue(js_content.startswith('window.'))",
            "",
            "    @override_settings(JS_REVERSE_JS_GLOBAL_OBJECT_NAME='1test')",
            "    def test_global_object_name_change_invalid_identifier(self):",
            "        with self.assertRaises(ImproperlyConfigured):",
            "            self.client.post('/jsreverse/')",
            "",
            "",
            "@override_settings(ROOT_URLCONF='django_js_reverse.tests.test_urls')",
            "class JSReverseStaticFileSaveTest(AbstractJSReverseTestCase, TestCase):",
            "    def test_reverse_js_file_save(self):",
            "        call_command('collectstatic_js_reverse')",
            "",
            "        path = os.path.join(settings.STATIC_ROOT, 'django_js_reverse', 'js', 'reverse.js')",
            "        f = io.open(path)",
            "        content1 = f.read()",
            "",
            "        r2 = self.client.get('/jsreverse/')",
            "        content2 = r2.content.decode()",
            "",
            "        self.assertEqual(len(content1), len(content2), 'Static file don\\'t match http response content_1')",
            "        self.assertEqual(content1, content2, 'Static file don\\'t match http response content_2')",
            "",
            "        # test for exception if STATIC_ROOT is not set",
            "        with override_settings(STATIC_ROOT=None):",
            "            with self.assertRaises(ImproperlyConfigured):",
            "                call_command('collectstatic_js_reverse')",
            "",
            "    def test_reverse_js_file_save_with_output_path_option(self):",
            "        js_output_path = os.path.join(os.path.dirname(__file__), 'tmp', 'some_path')",
            "        with override_settings(JS_REVERSE_OUTPUT_PATH=js_output_path):",
            "            call_command('collectstatic_js_reverse')",
            "",
            "            f = io.open(os.path.join(js_output_path, 'reverse.js'))",
            "            content1 = f.read()",
            "",
            "            r2 = self.client.get('/jsreverse/')",
            "            content2 = r2.content.decode()",
            "",
            "            self.assertEqual(len(content1), len(content2), 'Static file don\\'t match http response content_1')",
            "            self.assertEqual(content1, content2, 'Static file don\\'t match http response content_2')",
            "",
            "            # should not raise ImproperlyConfigured exception if STATIC_ROOT is not set",
            "            with override_settings(STATIC_ROOT=None):",
            "                call_command('collectstatic_js_reverse')",
            "",
            "    def test_script_prefix_noslash(self):",
            "        script_prefix = '/test/foo/bar'",
            "        with override_settings(JS_REVERSE_SCRIPT_PREFIX=script_prefix):",
            "            self.assertEqualJSUrlEval('Urls.test_no_url_args()', '{0}/test_no_url_args/'.format(script_prefix))",
            "",
            "    def test_script_prefix(self):",
            "        script_prefix = '/test/foo/bar/'",
            "        with override_settings(JS_REVERSE_SCRIPT_PREFIX=script_prefix):",
            "            self.assertEqualJSUrlEval('Urls.test_no_url_args()', '{0}test_no_url_args/'.format(script_prefix))",
            "",
            "",
            "@override_settings(",
            "    ROOT_URLCONF='django_js_reverse.tests.test_urls',",
            "",
            "    TEMPLATE_CONTEXT_PROCESSORS=['django.core.context_processors.request'],",
            ")",
            "class JSReverseTemplateTagTest(AbstractJSReverseTestCase, TestCase):",
            "    def test_tpl_tag_with_request_in_context(self):",
            "        request = RequestFactory().post('/jsreverse/')",
            "        request.urlconf = 'django_js_reverse.tests.test_urlconf_urls'",
            "        tpl = Template('{% load js_reverse %}{% js_reverse_inline %}')",
            "        js = tpl.render(RequestContext(request))",
            "        self.assertEqualJSEval(js, 'Urls.test_changed_urlconf()', '/test_changed_urlconf/')",
            "",
            "    def test_tpl_tag_with_dict_request_in_context(self):",
            "        request = {'urlconf': 'django_js_reverse.tests.test_urlconf_urls'}",
            "        tpl = Template('{% load js_reverse %}{% js_reverse_inline %}')",
            "        js = tpl.render(Context({'request': request}))",
            "        self.assertEqualJSEval(js, 'Urls.test_changed_urlconf()', '/test_changed_urlconf/')",
            "",
            "    def test_tpl_tag_without_request_in_context(self):",
            "        context_instance = Context()",
            "        tpl = Template('{% load js_reverse %}{% js_reverse_inline %}')",
            "        js_from_tag = tpl.render(context_instance)",
            "        js_from_view = smart_str(self.client.post('/jsreverse/').content)",
            "        self.assertEqual(js_from_tag, js_from_view)",
            "",
            "    def test_tpl_tag_escape_entities(self):",
            "        context_instance = Context()",
            "        tpl = Template('{% load js_reverse %}{% js_reverse_inline %}')",
            "        js = tpl.render(context_instance)",
            "        self.assertIn(",
            "            '\\\\u003C/script\\\\u003E\\\\u003Cscript\\\\u003Econsole.log(\\\\u0026amp;)'",
            "            '\\\\u003C/script\\\\u003E\\\\u003C!--',",
            "            js,",
            "        )",
            "",
            "if __name__ == '__main__':",
            "    unittest.main()"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": [
            "djangocms_attributes_field.fields"
        ]
    }
}