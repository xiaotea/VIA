{
    "src/PIL/ImageShow.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 15,
                "afterPatchRowNumber": 15,
                "PatchRowcode": " import shutil"
            },
            "1": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " import subprocess"
            },
            "2": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 17,
                "PatchRowcode": " import sys"
            },
            "3": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-import tempfile"
            },
            "4": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 18,
                "PatchRowcode": " from shlex import quote"
            },
            "5": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 19,
                "PatchRowcode": " "
            },
            "6": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " from PIL import Image"
            },
            "7": {
                "beforePatchRowNumber": 147,
                "afterPatchRowNumber": 146,
                "PatchRowcode": " "
            },
            "8": {
                "beforePatchRowNumber": 148,
                "afterPatchRowNumber": 147,
                "PatchRowcode": "     def show_file(self, file, **options):"
            },
            "9": {
                "beforePatchRowNumber": 149,
                "afterPatchRowNumber": 148,
                "PatchRowcode": "         \"\"\"Display given file\"\"\""
            },
            "10": {
                "beforePatchRowNumber": 150,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        fd, path = tempfile.mkstemp()"
            },
            "11": {
                "beforePatchRowNumber": 151,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        with os.fdopen(fd, \"w\") as f:"
            },
            "12": {
                "beforePatchRowNumber": 152,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            f.write(file)"
            },
            "13": {
                "beforePatchRowNumber": 153,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        with open(path) as f:"
            },
            "14": {
                "beforePatchRowNumber": 154,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            subprocess.Popen("
            },
            "15": {
                "beforePatchRowNumber": 155,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                [\"im=$(cat); open -a Preview.app $im; sleep 20; rm -f $im\"],"
            },
            "16": {
                "beforePatchRowNumber": 156,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                shell=True,"
            },
            "17": {
                "beforePatchRowNumber": 157,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                stdin=f,"
            },
            "18": {
                "beforePatchRowNumber": 158,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            )"
            },
            "19": {
                "beforePatchRowNumber": 159,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        os.remove(path)"
            },
            "20": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 149,
                "PatchRowcode": "+        subprocess.call([\"open\", \"-a\", \"Preview.app\", file])"
            },
            "21": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 150,
                "PatchRowcode": "+        subprocess.Popen("
            },
            "22": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 151,
                "PatchRowcode": "+            ["
            },
            "23": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 152,
                "PatchRowcode": "+                sys.executable,"
            },
            "24": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 153,
                "PatchRowcode": "+                \"-c\","
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 154,
                "PatchRowcode": "+                \"import os, sys, time;time.sleep(20);os.remove(sys.argv[1])\","
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 155,
                "PatchRowcode": "+                file,"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 156,
                "PatchRowcode": "+            ]"
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 157,
                "PatchRowcode": "+        )"
            },
            "29": {
                "beforePatchRowNumber": 160,
                "afterPatchRowNumber": 158,
                "PatchRowcode": "         return 1"
            },
            "30": {
                "beforePatchRowNumber": 161,
                "afterPatchRowNumber": 159,
                "PatchRowcode": " "
            },
            "31": {
                "beforePatchRowNumber": 162,
                "afterPatchRowNumber": 160,
                "PatchRowcode": " "
            },
            "32": {
                "beforePatchRowNumber": 172,
                "afterPatchRowNumber": 170,
                "PatchRowcode": "         command = self.get_command_ex(file, **options)[0]"
            },
            "33": {
                "beforePatchRowNumber": 173,
                "afterPatchRowNumber": 171,
                "PatchRowcode": "         return f\"({command} {quote(file)}; rm -f {quote(file)})&\""
            },
            "34": {
                "beforePatchRowNumber": 174,
                "afterPatchRowNumber": 172,
                "PatchRowcode": " "
            },
            "35": {
                "beforePatchRowNumber": 175,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    def show_file(self, file, **options):"
            },
            "36": {
                "beforePatchRowNumber": 176,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        \"\"\"Display given file\"\"\""
            },
            "37": {
                "beforePatchRowNumber": 177,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        fd, path = tempfile.mkstemp()"
            },
            "38": {
                "beforePatchRowNumber": 178,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        with os.fdopen(fd, \"w\") as f:"
            },
            "39": {
                "beforePatchRowNumber": 179,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            f.write(file)"
            },
            "40": {
                "beforePatchRowNumber": 180,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        with open(path) as f:"
            },
            "41": {
                "beforePatchRowNumber": 181,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            command = self.get_command_ex(file, **options)[0]"
            },
            "42": {
                "beforePatchRowNumber": 182,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            subprocess.Popen("
            },
            "43": {
                "beforePatchRowNumber": 183,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                [\"im=$(cat);\" + command + \" $im; rm -f $im\"], shell=True, stdin=f"
            },
            "44": {
                "beforePatchRowNumber": 184,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            )"
            },
            "45": {
                "beforePatchRowNumber": 185,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        os.remove(path)"
            },
            "46": {
                "beforePatchRowNumber": 186,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        return 1"
            },
            "47": {
                "beforePatchRowNumber": 187,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "48": {
                "beforePatchRowNumber": 188,
                "afterPatchRowNumber": 173,
                "PatchRowcode": " "
            },
            "49": {
                "beforePatchRowNumber": 189,
                "afterPatchRowNumber": 174,
                "PatchRowcode": " class XDGViewer(UnixViewer):"
            },
            "50": {
                "beforePatchRowNumber": 190,
                "afterPatchRowNumber": 175,
                "PatchRowcode": "     \"\"\""
            },
            "51": {
                "beforePatchRowNumber": 195,
                "afterPatchRowNumber": 180,
                "PatchRowcode": "         command = executable = \"xdg-open\""
            },
            "52": {
                "beforePatchRowNumber": 196,
                "afterPatchRowNumber": 181,
                "PatchRowcode": "         return command, executable"
            },
            "53": {
                "beforePatchRowNumber": 197,
                "afterPatchRowNumber": 182,
                "PatchRowcode": " "
            },
            "54": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 183,
                "PatchRowcode": "+    def show_file(self, file, **options):"
            },
            "55": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 184,
                "PatchRowcode": "+        subprocess.Popen([\"xdg-open\", file])"
            },
            "56": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 185,
                "PatchRowcode": "+        os.remove(file)"
            },
            "57": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 186,
                "PatchRowcode": "+        return 1"
            },
            "58": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 187,
                "PatchRowcode": "+"
            },
            "59": {
                "beforePatchRowNumber": 198,
                "afterPatchRowNumber": 188,
                "PatchRowcode": " "
            },
            "60": {
                "beforePatchRowNumber": 199,
                "afterPatchRowNumber": 189,
                "PatchRowcode": " class DisplayViewer(UnixViewer):"
            },
            "61": {
                "beforePatchRowNumber": 200,
                "afterPatchRowNumber": 190,
                "PatchRowcode": "     \"\"\""
            },
            "62": {
                "beforePatchRowNumber": 208,
                "afterPatchRowNumber": 198,
                "PatchRowcode": "             command += f\" -name {quote(title)}\""
            },
            "63": {
                "beforePatchRowNumber": 209,
                "afterPatchRowNumber": 199,
                "PatchRowcode": "         return command, executable"
            },
            "64": {
                "beforePatchRowNumber": 210,
                "afterPatchRowNumber": 200,
                "PatchRowcode": " "
            },
            "65": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 201,
                "PatchRowcode": "+    def show_file(self, file, **options):"
            },
            "66": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 202,
                "PatchRowcode": "+        args = [\"display\"]"
            },
            "67": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 203,
                "PatchRowcode": "+        if \"title\" in options:"
            },
            "68": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 204,
                "PatchRowcode": "+            args += [\"-name\", options[\"title\"]]"
            },
            "69": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 205,
                "PatchRowcode": "+        args.append(file)"
            },
            "70": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 206,
                "PatchRowcode": "+"
            },
            "71": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 207,
                "PatchRowcode": "+        subprocess.Popen(args)"
            },
            "72": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 208,
                "PatchRowcode": "+        os.remove(file)"
            },
            "73": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 209,
                "PatchRowcode": "+        return 1"
            },
            "74": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 210,
                "PatchRowcode": "+"
            },
            "75": {
                "beforePatchRowNumber": 211,
                "afterPatchRowNumber": 211,
                "PatchRowcode": " "
            },
            "76": {
                "beforePatchRowNumber": 212,
                "afterPatchRowNumber": 212,
                "PatchRowcode": " class GmDisplayViewer(UnixViewer):"
            },
            "77": {
                "beforePatchRowNumber": 213,
                "afterPatchRowNumber": 213,
                "PatchRowcode": "     \"\"\"The GraphicsMagick ``gm display`` command.\"\"\""
            },
            "78": {
                "beforePatchRowNumber": 217,
                "afterPatchRowNumber": 217,
                "PatchRowcode": "         command = \"gm display\""
            },
            "79": {
                "beforePatchRowNumber": 218,
                "afterPatchRowNumber": 218,
                "PatchRowcode": "         return command, executable"
            },
            "80": {
                "beforePatchRowNumber": 219,
                "afterPatchRowNumber": 219,
                "PatchRowcode": " "
            },
            "81": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 220,
                "PatchRowcode": "+    def show_file(self, file, **options):"
            },
            "82": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 221,
                "PatchRowcode": "+        subprocess.Popen([\"gm\", \"display\", file])"
            },
            "83": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 222,
                "PatchRowcode": "+        os.remove(file)"
            },
            "84": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 223,
                "PatchRowcode": "+        return 1"
            },
            "85": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 224,
                "PatchRowcode": "+"
            },
            "86": {
                "beforePatchRowNumber": 220,
                "afterPatchRowNumber": 225,
                "PatchRowcode": " "
            },
            "87": {
                "beforePatchRowNumber": 221,
                "afterPatchRowNumber": 226,
                "PatchRowcode": " class EogViewer(UnixViewer):"
            },
            "88": {
                "beforePatchRowNumber": 222,
                "afterPatchRowNumber": 227,
                "PatchRowcode": "     \"\"\"The GNOME Image Viewer ``eog`` command.\"\"\""
            },
            "89": {
                "beforePatchRowNumber": 226,
                "afterPatchRowNumber": 231,
                "PatchRowcode": "         command = \"eog -n\""
            },
            "90": {
                "beforePatchRowNumber": 227,
                "afterPatchRowNumber": 232,
                "PatchRowcode": "         return command, executable"
            },
            "91": {
                "beforePatchRowNumber": 228,
                "afterPatchRowNumber": 233,
                "PatchRowcode": " "
            },
            "92": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 234,
                "PatchRowcode": "+    def show_file(self, file, **options):"
            },
            "93": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 235,
                "PatchRowcode": "+        subprocess.Popen([\"eog\", \"-n\", file])"
            },
            "94": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 236,
                "PatchRowcode": "+        os.remove(file)"
            },
            "95": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 237,
                "PatchRowcode": "+        return 1"
            },
            "96": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 238,
                "PatchRowcode": "+"
            },
            "97": {
                "beforePatchRowNumber": 229,
                "afterPatchRowNumber": 239,
                "PatchRowcode": " "
            },
            "98": {
                "beforePatchRowNumber": 230,
                "afterPatchRowNumber": 240,
                "PatchRowcode": " class XVViewer(UnixViewer):"
            },
            "99": {
                "beforePatchRowNumber": 231,
                "afterPatchRowNumber": 241,
                "PatchRowcode": "     \"\"\""
            },
            "100": {
                "beforePatchRowNumber": 241,
                "afterPatchRowNumber": 251,
                "PatchRowcode": "             command += f\" -name {quote(title)}\""
            },
            "101": {
                "beforePatchRowNumber": 242,
                "afterPatchRowNumber": 252,
                "PatchRowcode": "         return command, executable"
            },
            "102": {
                "beforePatchRowNumber": 243,
                "afterPatchRowNumber": 253,
                "PatchRowcode": " "
            },
            "103": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 254,
                "PatchRowcode": "+    def show_file(self, file, **options):"
            },
            "104": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 255,
                "PatchRowcode": "+        args = [\"xv\"]"
            },
            "105": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 256,
                "PatchRowcode": "+        if \"title\" in options:"
            },
            "106": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 257,
                "PatchRowcode": "+            args += [\"-name\", options[\"title\"]]"
            },
            "107": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 258,
                "PatchRowcode": "+        args.append(file)"
            },
            "108": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 259,
                "PatchRowcode": "+"
            },
            "109": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 260,
                "PatchRowcode": "+        subprocess.Popen(args)"
            },
            "110": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 261,
                "PatchRowcode": "+        os.remove(file)"
            },
            "111": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 262,
                "PatchRowcode": "+        return 1"
            },
            "112": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 263,
                "PatchRowcode": "+"
            },
            "113": {
                "beforePatchRowNumber": 244,
                "afterPatchRowNumber": 264,
                "PatchRowcode": " "
            },
            "114": {
                "beforePatchRowNumber": 245,
                "afterPatchRowNumber": 265,
                "PatchRowcode": " if sys.platform not in (\"win32\", \"darwin\"):  # unixoids"
            },
            "115": {
                "beforePatchRowNumber": 246,
                "afterPatchRowNumber": 266,
                "PatchRowcode": "     if shutil.which(\"xdg-open\"):"
            }
        },
        "frontPatchFile": [
            "#",
            "# The Python Imaging Library.",
            "# $Id$",
            "#",
            "# im.show() drivers",
            "#",
            "# History:",
            "# 2008-04-06 fl   Created",
            "#",
            "# Copyright (c) Secret Labs AB 2008.",
            "#",
            "# See the README file for information on usage and redistribution.",
            "#",
            "import os",
            "import shutil",
            "import subprocess",
            "import sys",
            "import tempfile",
            "from shlex import quote",
            "",
            "from PIL import Image",
            "",
            "_viewers = []",
            "",
            "",
            "def register(viewer, order=1):",
            "    \"\"\"",
            "    The :py:func:`register` function is used to register additional viewers.",
            "",
            "    :param viewer: The viewer to be registered.",
            "    :param order:",
            "        Zero or a negative integer to prepend this viewer to the list,",
            "        a positive integer to append it.",
            "    \"\"\"",
            "    try:",
            "        if issubclass(viewer, Viewer):",
            "            viewer = viewer()",
            "    except TypeError:",
            "        pass  # raised if viewer wasn't a class",
            "    if order > 0:",
            "        _viewers.append(viewer)",
            "    else:",
            "        _viewers.insert(0, viewer)",
            "",
            "",
            "def show(image, title=None, **options):",
            "    r\"\"\"",
            "    Display a given image.",
            "",
            "    :param image: An image object.",
            "    :param title: Optional title. Not all viewers can display the title.",
            "    :param \\**options: Additional viewer options.",
            "    :returns: ``True`` if a suitable viewer was found, ``False`` otherwise.",
            "    \"\"\"",
            "    for viewer in _viewers:",
            "        if viewer.show(image, title=title, **options):",
            "            return 1",
            "    return 0",
            "",
            "",
            "class Viewer:",
            "    \"\"\"Base class for viewers.\"\"\"",
            "",
            "    # main api",
            "",
            "    def show(self, image, **options):",
            "        \"\"\"",
            "        The main function for displaying an image.",
            "        Converts the given image to the target format and displays it.",
            "        \"\"\"",
            "",
            "        if not (",
            "            image.mode in (\"1\", \"RGBA\")",
            "            or (self.format == \"PNG\" and image.mode in (\"I;16\", \"LA\"))",
            "        ):",
            "            base = Image.getmodebase(image.mode)",
            "            if image.mode != base:",
            "                image = image.convert(base)",
            "",
            "        return self.show_image(image, **options)",
            "",
            "    # hook methods",
            "",
            "    format = None",
            "    \"\"\"The format to convert the image into.\"\"\"",
            "    options = {}",
            "    \"\"\"Additional options used to convert the image.\"\"\"",
            "",
            "    def get_format(self, image):",
            "        \"\"\"Return format name, or ``None`` to save as PGM/PPM.\"\"\"",
            "        return self.format",
            "",
            "    def get_command(self, file, **options):",
            "        \"\"\"",
            "        Returns the command used to display the file.",
            "        Not implemented in the base class.",
            "        \"\"\"",
            "        raise NotImplementedError",
            "",
            "    def save_image(self, image):",
            "        \"\"\"Save to temporary file and return filename.\"\"\"",
            "        return image._dump(format=self.get_format(image), **self.options)",
            "",
            "    def show_image(self, image, **options):",
            "        \"\"\"Display the given image.\"\"\"",
            "        return self.show_file(self.save_image(image), **options)",
            "",
            "    def show_file(self, file, **options):",
            "        \"\"\"Display the given file.\"\"\"",
            "        os.system(self.get_command(file, **options))",
            "        return 1",
            "",
            "",
            "# --------------------------------------------------------------------",
            "",
            "",
            "class WindowsViewer(Viewer):",
            "    \"\"\"The default viewer on Windows is the default system application for PNG files.\"\"\"",
            "",
            "    format = \"PNG\"",
            "    options = {\"compress_level\": 1}",
            "",
            "    def get_command(self, file, **options):",
            "        return (",
            "            f'start \"Pillow\" /WAIT \"{file}\" '",
            "            \"&& ping -n 2 127.0.0.1 >NUL \"",
            "            f'&& del /f \"{file}\"'",
            "        )",
            "",
            "",
            "if sys.platform == \"win32\":",
            "    register(WindowsViewer)",
            "",
            "",
            "class MacViewer(Viewer):",
            "    \"\"\"The default viewer on macOS using ``Preview.app``.\"\"\"",
            "",
            "    format = \"PNG\"",
            "    options = {\"compress_level\": 1}",
            "",
            "    def get_command(self, file, **options):",
            "        # on darwin open returns immediately resulting in the temp",
            "        # file removal while app is opening",
            "        command = \"open -a Preview.app\"",
            "        command = f\"({command} {quote(file)}; sleep 20; rm -f {quote(file)})&\"",
            "        return command",
            "",
            "    def show_file(self, file, **options):",
            "        \"\"\"Display given file\"\"\"",
            "        fd, path = tempfile.mkstemp()",
            "        with os.fdopen(fd, \"w\") as f:",
            "            f.write(file)",
            "        with open(path) as f:",
            "            subprocess.Popen(",
            "                [\"im=$(cat); open -a Preview.app $im; sleep 20; rm -f $im\"],",
            "                shell=True,",
            "                stdin=f,",
            "            )",
            "        os.remove(path)",
            "        return 1",
            "",
            "",
            "if sys.platform == \"darwin\":",
            "    register(MacViewer)",
            "",
            "",
            "class UnixViewer(Viewer):",
            "    format = \"PNG\"",
            "    options = {\"compress_level\": 1}",
            "",
            "    def get_command(self, file, **options):",
            "        command = self.get_command_ex(file, **options)[0]",
            "        return f\"({command} {quote(file)}; rm -f {quote(file)})&\"",
            "",
            "    def show_file(self, file, **options):",
            "        \"\"\"Display given file\"\"\"",
            "        fd, path = tempfile.mkstemp()",
            "        with os.fdopen(fd, \"w\") as f:",
            "            f.write(file)",
            "        with open(path) as f:",
            "            command = self.get_command_ex(file, **options)[0]",
            "            subprocess.Popen(",
            "                [\"im=$(cat);\" + command + \" $im; rm -f $im\"], shell=True, stdin=f",
            "            )",
            "        os.remove(path)",
            "        return 1",
            "",
            "",
            "class XDGViewer(UnixViewer):",
            "    \"\"\"",
            "    The freedesktop.org ``xdg-open`` command.",
            "    \"\"\"",
            "",
            "    def get_command_ex(self, file, **options):",
            "        command = executable = \"xdg-open\"",
            "        return command, executable",
            "",
            "",
            "class DisplayViewer(UnixViewer):",
            "    \"\"\"",
            "    The ImageMagick ``display`` command.",
            "    This viewer supports the ``title`` parameter.",
            "    \"\"\"",
            "",
            "    def get_command_ex(self, file, title=None, **options):",
            "        command = executable = \"display\"",
            "        if title:",
            "            command += f\" -name {quote(title)}\"",
            "        return command, executable",
            "",
            "",
            "class GmDisplayViewer(UnixViewer):",
            "    \"\"\"The GraphicsMagick ``gm display`` command.\"\"\"",
            "",
            "    def get_command_ex(self, file, **options):",
            "        executable = \"gm\"",
            "        command = \"gm display\"",
            "        return command, executable",
            "",
            "",
            "class EogViewer(UnixViewer):",
            "    \"\"\"The GNOME Image Viewer ``eog`` command.\"\"\"",
            "",
            "    def get_command_ex(self, file, **options):",
            "        executable = \"eog\"",
            "        command = \"eog -n\"",
            "        return command, executable",
            "",
            "",
            "class XVViewer(UnixViewer):",
            "    \"\"\"",
            "    The X Viewer ``xv`` command.",
            "    This viewer supports the ``title`` parameter.",
            "    \"\"\"",
            "",
            "    def get_command_ex(self, file, title=None, **options):",
            "        # note: xv is pretty outdated.  most modern systems have",
            "        # imagemagick's display command instead.",
            "        command = executable = \"xv\"",
            "        if title:",
            "            command += f\" -name {quote(title)}\"",
            "        return command, executable",
            "",
            "",
            "if sys.platform not in (\"win32\", \"darwin\"):  # unixoids",
            "    if shutil.which(\"xdg-open\"):",
            "        register(XDGViewer)",
            "    if shutil.which(\"display\"):",
            "        register(DisplayViewer)",
            "    if shutil.which(\"gm\"):",
            "        register(GmDisplayViewer)",
            "    if shutil.which(\"eog\"):",
            "        register(EogViewer)",
            "    if shutil.which(\"xv\"):",
            "        register(XVViewer)",
            "",
            "",
            "class IPythonViewer(Viewer):",
            "    \"\"\"The viewer for IPython frontends.\"\"\"",
            "",
            "    def show_image(self, image, **options):",
            "        ipython_display(image)",
            "        return 1",
            "",
            "",
            "try:",
            "    from IPython.display import display as ipython_display",
            "except ImportError:",
            "    pass",
            "else:",
            "    register(IPythonViewer)",
            "",
            "",
            "if __name__ == \"__main__\":",
            "",
            "    if len(sys.argv) < 2:",
            "        print(\"Syntax: python3 ImageShow.py imagefile [title]\")",
            "        sys.exit()",
            "",
            "    with Image.open(sys.argv[1]) as im:",
            "        print(show(im, *sys.argv[2:]))"
        ],
        "afterPatchFile": [
            "#",
            "# The Python Imaging Library.",
            "# $Id$",
            "#",
            "# im.show() drivers",
            "#",
            "# History:",
            "# 2008-04-06 fl   Created",
            "#",
            "# Copyright (c) Secret Labs AB 2008.",
            "#",
            "# See the README file for information on usage and redistribution.",
            "#",
            "import os",
            "import shutil",
            "import subprocess",
            "import sys",
            "from shlex import quote",
            "",
            "from PIL import Image",
            "",
            "_viewers = []",
            "",
            "",
            "def register(viewer, order=1):",
            "    \"\"\"",
            "    The :py:func:`register` function is used to register additional viewers.",
            "",
            "    :param viewer: The viewer to be registered.",
            "    :param order:",
            "        Zero or a negative integer to prepend this viewer to the list,",
            "        a positive integer to append it.",
            "    \"\"\"",
            "    try:",
            "        if issubclass(viewer, Viewer):",
            "            viewer = viewer()",
            "    except TypeError:",
            "        pass  # raised if viewer wasn't a class",
            "    if order > 0:",
            "        _viewers.append(viewer)",
            "    else:",
            "        _viewers.insert(0, viewer)",
            "",
            "",
            "def show(image, title=None, **options):",
            "    r\"\"\"",
            "    Display a given image.",
            "",
            "    :param image: An image object.",
            "    :param title: Optional title. Not all viewers can display the title.",
            "    :param \\**options: Additional viewer options.",
            "    :returns: ``True`` if a suitable viewer was found, ``False`` otherwise.",
            "    \"\"\"",
            "    for viewer in _viewers:",
            "        if viewer.show(image, title=title, **options):",
            "            return 1",
            "    return 0",
            "",
            "",
            "class Viewer:",
            "    \"\"\"Base class for viewers.\"\"\"",
            "",
            "    # main api",
            "",
            "    def show(self, image, **options):",
            "        \"\"\"",
            "        The main function for displaying an image.",
            "        Converts the given image to the target format and displays it.",
            "        \"\"\"",
            "",
            "        if not (",
            "            image.mode in (\"1\", \"RGBA\")",
            "            or (self.format == \"PNG\" and image.mode in (\"I;16\", \"LA\"))",
            "        ):",
            "            base = Image.getmodebase(image.mode)",
            "            if image.mode != base:",
            "                image = image.convert(base)",
            "",
            "        return self.show_image(image, **options)",
            "",
            "    # hook methods",
            "",
            "    format = None",
            "    \"\"\"The format to convert the image into.\"\"\"",
            "    options = {}",
            "    \"\"\"Additional options used to convert the image.\"\"\"",
            "",
            "    def get_format(self, image):",
            "        \"\"\"Return format name, or ``None`` to save as PGM/PPM.\"\"\"",
            "        return self.format",
            "",
            "    def get_command(self, file, **options):",
            "        \"\"\"",
            "        Returns the command used to display the file.",
            "        Not implemented in the base class.",
            "        \"\"\"",
            "        raise NotImplementedError",
            "",
            "    def save_image(self, image):",
            "        \"\"\"Save to temporary file and return filename.\"\"\"",
            "        return image._dump(format=self.get_format(image), **self.options)",
            "",
            "    def show_image(self, image, **options):",
            "        \"\"\"Display the given image.\"\"\"",
            "        return self.show_file(self.save_image(image), **options)",
            "",
            "    def show_file(self, file, **options):",
            "        \"\"\"Display the given file.\"\"\"",
            "        os.system(self.get_command(file, **options))",
            "        return 1",
            "",
            "",
            "# --------------------------------------------------------------------",
            "",
            "",
            "class WindowsViewer(Viewer):",
            "    \"\"\"The default viewer on Windows is the default system application for PNG files.\"\"\"",
            "",
            "    format = \"PNG\"",
            "    options = {\"compress_level\": 1}",
            "",
            "    def get_command(self, file, **options):",
            "        return (",
            "            f'start \"Pillow\" /WAIT \"{file}\" '",
            "            \"&& ping -n 2 127.0.0.1 >NUL \"",
            "            f'&& del /f \"{file}\"'",
            "        )",
            "",
            "",
            "if sys.platform == \"win32\":",
            "    register(WindowsViewer)",
            "",
            "",
            "class MacViewer(Viewer):",
            "    \"\"\"The default viewer on macOS using ``Preview.app``.\"\"\"",
            "",
            "    format = \"PNG\"",
            "    options = {\"compress_level\": 1}",
            "",
            "    def get_command(self, file, **options):",
            "        # on darwin open returns immediately resulting in the temp",
            "        # file removal while app is opening",
            "        command = \"open -a Preview.app\"",
            "        command = f\"({command} {quote(file)}; sleep 20; rm -f {quote(file)})&\"",
            "        return command",
            "",
            "    def show_file(self, file, **options):",
            "        \"\"\"Display given file\"\"\"",
            "        subprocess.call([\"open\", \"-a\", \"Preview.app\", file])",
            "        subprocess.Popen(",
            "            [",
            "                sys.executable,",
            "                \"-c\",",
            "                \"import os, sys, time;time.sleep(20);os.remove(sys.argv[1])\",",
            "                file,",
            "            ]",
            "        )",
            "        return 1",
            "",
            "",
            "if sys.platform == \"darwin\":",
            "    register(MacViewer)",
            "",
            "",
            "class UnixViewer(Viewer):",
            "    format = \"PNG\"",
            "    options = {\"compress_level\": 1}",
            "",
            "    def get_command(self, file, **options):",
            "        command = self.get_command_ex(file, **options)[0]",
            "        return f\"({command} {quote(file)}; rm -f {quote(file)})&\"",
            "",
            "",
            "class XDGViewer(UnixViewer):",
            "    \"\"\"",
            "    The freedesktop.org ``xdg-open`` command.",
            "    \"\"\"",
            "",
            "    def get_command_ex(self, file, **options):",
            "        command = executable = \"xdg-open\"",
            "        return command, executable",
            "",
            "    def show_file(self, file, **options):",
            "        subprocess.Popen([\"xdg-open\", file])",
            "        os.remove(file)",
            "        return 1",
            "",
            "",
            "class DisplayViewer(UnixViewer):",
            "    \"\"\"",
            "    The ImageMagick ``display`` command.",
            "    This viewer supports the ``title`` parameter.",
            "    \"\"\"",
            "",
            "    def get_command_ex(self, file, title=None, **options):",
            "        command = executable = \"display\"",
            "        if title:",
            "            command += f\" -name {quote(title)}\"",
            "        return command, executable",
            "",
            "    def show_file(self, file, **options):",
            "        args = [\"display\"]",
            "        if \"title\" in options:",
            "            args += [\"-name\", options[\"title\"]]",
            "        args.append(file)",
            "",
            "        subprocess.Popen(args)",
            "        os.remove(file)",
            "        return 1",
            "",
            "",
            "class GmDisplayViewer(UnixViewer):",
            "    \"\"\"The GraphicsMagick ``gm display`` command.\"\"\"",
            "",
            "    def get_command_ex(self, file, **options):",
            "        executable = \"gm\"",
            "        command = \"gm display\"",
            "        return command, executable",
            "",
            "    def show_file(self, file, **options):",
            "        subprocess.Popen([\"gm\", \"display\", file])",
            "        os.remove(file)",
            "        return 1",
            "",
            "",
            "class EogViewer(UnixViewer):",
            "    \"\"\"The GNOME Image Viewer ``eog`` command.\"\"\"",
            "",
            "    def get_command_ex(self, file, **options):",
            "        executable = \"eog\"",
            "        command = \"eog -n\"",
            "        return command, executable",
            "",
            "    def show_file(self, file, **options):",
            "        subprocess.Popen([\"eog\", \"-n\", file])",
            "        os.remove(file)",
            "        return 1",
            "",
            "",
            "class XVViewer(UnixViewer):",
            "    \"\"\"",
            "    The X Viewer ``xv`` command.",
            "    This viewer supports the ``title`` parameter.",
            "    \"\"\"",
            "",
            "    def get_command_ex(self, file, title=None, **options):",
            "        # note: xv is pretty outdated.  most modern systems have",
            "        # imagemagick's display command instead.",
            "        command = executable = \"xv\"",
            "        if title:",
            "            command += f\" -name {quote(title)}\"",
            "        return command, executable",
            "",
            "    def show_file(self, file, **options):",
            "        args = [\"xv\"]",
            "        if \"title\" in options:",
            "            args += [\"-name\", options[\"title\"]]",
            "        args.append(file)",
            "",
            "        subprocess.Popen(args)",
            "        os.remove(file)",
            "        return 1",
            "",
            "",
            "if sys.platform not in (\"win32\", \"darwin\"):  # unixoids",
            "    if shutil.which(\"xdg-open\"):",
            "        register(XDGViewer)",
            "    if shutil.which(\"display\"):",
            "        register(DisplayViewer)",
            "    if shutil.which(\"gm\"):",
            "        register(GmDisplayViewer)",
            "    if shutil.which(\"eog\"):",
            "        register(EogViewer)",
            "    if shutil.which(\"xv\"):",
            "        register(XVViewer)",
            "",
            "",
            "class IPythonViewer(Viewer):",
            "    \"\"\"The viewer for IPython frontends.\"\"\"",
            "",
            "    def show_image(self, image, **options):",
            "        ipython_display(image)",
            "        return 1",
            "",
            "",
            "try:",
            "    from IPython.display import display as ipython_display",
            "except ImportError:",
            "    pass",
            "else:",
            "    register(IPythonViewer)",
            "",
            "",
            "if __name__ == \"__main__\":",
            "",
            "    if len(sys.argv) < 2:",
            "        print(\"Syntax: python3 ImageShow.py imagefile [title]\")",
            "        sys.exit()",
            "",
            "    with Image.open(sys.argv[1]) as im:",
            "        print(show(im, *sys.argv[2:]))"
        ],
        "action": [
            "0",
            "0",
            "0",
            "1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "18": [],
            "150": [
                "MacViewer",
                "show_file"
            ],
            "151": [
                "MacViewer",
                "show_file"
            ],
            "152": [
                "MacViewer",
                "show_file"
            ],
            "153": [
                "MacViewer",
                "show_file"
            ],
            "154": [
                "MacViewer",
                "show_file"
            ],
            "155": [
                "MacViewer",
                "show_file"
            ],
            "156": [
                "MacViewer",
                "show_file"
            ],
            "157": [
                "MacViewer",
                "show_file"
            ],
            "158": [
                "MacViewer",
                "show_file"
            ],
            "159": [
                "MacViewer",
                "show_file"
            ],
            "175": [
                "UnixViewer",
                "show_file"
            ],
            "176": [
                "UnixViewer",
                "show_file"
            ],
            "177": [
                "UnixViewer",
                "show_file"
            ],
            "178": [
                "UnixViewer",
                "show_file"
            ],
            "179": [
                "UnixViewer",
                "show_file"
            ],
            "180": [
                "UnixViewer",
                "show_file"
            ],
            "181": [
                "UnixViewer",
                "show_file"
            ],
            "182": [
                "UnixViewer",
                "show_file"
            ],
            "183": [
                "UnixViewer",
                "show_file"
            ],
            "184": [
                "UnixViewer",
                "show_file"
            ],
            "185": [
                "UnixViewer",
                "show_file"
            ],
            "186": [
                "UnixViewer",
                "show_file"
            ],
            "187": []
        },
        "addLocation": []
    }
}