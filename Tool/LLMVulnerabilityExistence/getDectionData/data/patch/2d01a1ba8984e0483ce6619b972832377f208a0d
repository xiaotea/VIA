{
    "src/lxml/html/defs.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": 23,
                "PatchRowcode": "     'usemap',"
            },
            "1": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": 24,
                "PatchRowcode": "     # Not standard:"
            },
            "2": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 25,
                "PatchRowcode": "     'dynsrc', 'lowsrc',"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 26,
                "PatchRowcode": "+    # HTML5 formaction"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 27,
                "PatchRowcode": "+    'formaction'"
            },
            "5": {
                "beforePatchRowNumber": 26,
                "afterPatchRowNumber": 28,
                "PatchRowcode": "     ])"
            },
            "6": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": 29,
                "PatchRowcode": " "
            },
            "7": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": 30,
                "PatchRowcode": " # Not in the HTML 4 spec:"
            }
        },
        "frontPatchFile": [
            "# FIXME: this should all be confirmed against what a DTD says",
            "# (probably in a test; this may not match the DTD exactly, but we",
            "# should document just how it differs).",
            "",
            "\"\"\"",
            "Data taken from https://www.w3.org/TR/html401/index/elements.html",
            "and https://www.w3.org/community/webed/wiki/HTML/New_HTML5_Elements",
            "for html5_tags.",
            "\"\"\"",
            "",
            "empty_tags = frozenset([",
            "    'area', 'base', 'basefont', 'br', 'col', 'frame', 'hr',",
            "    'img', 'input', 'isindex', 'link', 'meta', 'param', 'source', 'track'])",
            "",
            "deprecated_tags = frozenset([",
            "    'applet', 'basefont', 'center', 'dir', 'font', 'isindex',",
            "    'menu', 's', 'strike', 'u'])",
            "",
            "# archive actually takes a space-separated list of URIs",
            "link_attrs = frozenset([",
            "    'action', 'archive', 'background', 'cite', 'classid',",
            "    'codebase', 'data', 'href', 'longdesc', 'profile', 'src',",
            "    'usemap',",
            "    # Not standard:",
            "    'dynsrc', 'lowsrc',",
            "    ])",
            "",
            "# Not in the HTML 4 spec:",
            "# onerror, onresize",
            "event_attrs = frozenset([",
            "    'onblur', 'onchange', 'onclick', 'ondblclick', 'onerror',",
            "    'onfocus', 'onkeydown', 'onkeypress', 'onkeyup', 'onload',",
            "    'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover',",
            "    'onmouseup', 'onreset', 'onresize', 'onselect', 'onsubmit',",
            "    'onunload',",
            "    ])",
            "",
            "safe_attrs = frozenset([",
            "    'abbr', 'accept', 'accept-charset', 'accesskey', 'action', 'align',",
            "    'alt', 'axis', 'border', 'cellpadding', 'cellspacing', 'char', 'charoff',",
            "    'charset', 'checked', 'cite', 'class', 'clear', 'cols', 'colspan',",
            "    'color', 'compact', 'coords', 'datetime', 'dir', 'disabled', 'enctype',",
            "    'for', 'frame', 'headers', 'height', 'href', 'hreflang', 'hspace', 'id',",
            "    'ismap', 'label', 'lang', 'longdesc', 'maxlength', 'media', 'method',",
            "    'multiple', 'name', 'nohref', 'noshade', 'nowrap', 'prompt', 'readonly',",
            "    'rel', 'rev', 'rows', 'rowspan', 'rules', 'scope', 'selected', 'shape',",
            "    'size', 'span', 'src', 'start', 'summary', 'tabindex', 'target', 'title',",
            "    'type', 'usemap', 'valign', 'value', 'vspace', 'width'])",
            "",
            "# From http://htmlhelp.com/reference/html40/olist.html",
            "top_level_tags = frozenset([",
            "    'html', 'head', 'body', 'frameset',",
            "    ])",
            "",
            "head_tags = frozenset([",
            "    'base', 'isindex', 'link', 'meta', 'script', 'style', 'title',",
            "    ])",
            "",
            "general_block_tags = frozenset([",
            "    'address',",
            "    'blockquote',",
            "    'center',",
            "    'del',",
            "    'div',",
            "    'h1',",
            "    'h2',",
            "    'h3',",
            "    'h4',",
            "    'h5',",
            "    'h6',",
            "    'hr',",
            "    'ins',",
            "    'isindex',",
            "    'noscript',",
            "    'p',",
            "    'pre',",
            "    ])",
            "",
            "list_tags = frozenset([",
            "    'dir', 'dl', 'dt', 'dd', 'li', 'menu', 'ol', 'ul',",
            "    ])",
            "",
            "table_tags = frozenset([",
            "    'table', 'caption', 'colgroup', 'col',",
            "    'thead', 'tfoot', 'tbody', 'tr', 'td', 'th',",
            "    ])",
            "",
            "# just this one from",
            "# http://www.georgehernandez.com/h/XComputers/HTML/2BlockLevel.htm",
            "block_tags = general_block_tags | list_tags | table_tags | frozenset([",
            "    # Partial form tags",
            "    'fieldset', 'form', 'legend', 'optgroup', 'option',",
            "    ])",
            "",
            "form_tags = frozenset([",
            "    'form', 'button', 'fieldset', 'legend', 'input', 'label',",
            "    'select', 'optgroup', 'option', 'textarea',",
            "    ])",
            "",
            "special_inline_tags = frozenset([",
            "    'a', 'applet', 'basefont', 'bdo', 'br', 'embed', 'font', 'iframe',",
            "    'img', 'map', 'area', 'object', 'param', 'q', 'script',",
            "    'span', 'sub', 'sup',",
            "    ])",
            "",
            "phrase_tags = frozenset([",
            "    'abbr', 'acronym', 'cite', 'code', 'del', 'dfn', 'em',",
            "    'ins', 'kbd', 'samp', 'strong', 'var',",
            "    ])",
            "",
            "font_style_tags = frozenset([",
            "    'b', 'big', 'i', 's', 'small', 'strike', 'tt', 'u',",
            "    ])",
            "",
            "frame_tags = frozenset([",
            "    'frameset', 'frame', 'noframes',",
            "    ])",
            "    ",
            "html5_tags = frozenset([",
            "    'article', 'aside', 'audio', 'canvas', 'command', 'datalist',",
            "    'details', 'embed', 'figcaption', 'figure', 'footer', 'header',",
            "    'hgroup', 'keygen', 'mark', 'math', 'meter', 'nav', 'output',",
            "    'progress', 'rp', 'rt', 'ruby', 'section', 'source', 'summary',",
            "    'svg', 'time', 'track', 'video', 'wbr'",
            "    ])",
            "",
            "# These tags aren't standard",
            "nonstandard_tags = frozenset(['blink', 'marquee'])",
            "",
            "",
            "tags = (top_level_tags | head_tags | general_block_tags | list_tags",
            "        | table_tags | form_tags | special_inline_tags | phrase_tags",
            "        | font_style_tags | nonstandard_tags | html5_tags)"
        ],
        "afterPatchFile": [
            "# FIXME: this should all be confirmed against what a DTD says",
            "# (probably in a test; this may not match the DTD exactly, but we",
            "# should document just how it differs).",
            "",
            "\"\"\"",
            "Data taken from https://www.w3.org/TR/html401/index/elements.html",
            "and https://www.w3.org/community/webed/wiki/HTML/New_HTML5_Elements",
            "for html5_tags.",
            "\"\"\"",
            "",
            "empty_tags = frozenset([",
            "    'area', 'base', 'basefont', 'br', 'col', 'frame', 'hr',",
            "    'img', 'input', 'isindex', 'link', 'meta', 'param', 'source', 'track'])",
            "",
            "deprecated_tags = frozenset([",
            "    'applet', 'basefont', 'center', 'dir', 'font', 'isindex',",
            "    'menu', 's', 'strike', 'u'])",
            "",
            "# archive actually takes a space-separated list of URIs",
            "link_attrs = frozenset([",
            "    'action', 'archive', 'background', 'cite', 'classid',",
            "    'codebase', 'data', 'href', 'longdesc', 'profile', 'src',",
            "    'usemap',",
            "    # Not standard:",
            "    'dynsrc', 'lowsrc',",
            "    # HTML5 formaction",
            "    'formaction'",
            "    ])",
            "",
            "# Not in the HTML 4 spec:",
            "# onerror, onresize",
            "event_attrs = frozenset([",
            "    'onblur', 'onchange', 'onclick', 'ondblclick', 'onerror',",
            "    'onfocus', 'onkeydown', 'onkeypress', 'onkeyup', 'onload',",
            "    'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover',",
            "    'onmouseup', 'onreset', 'onresize', 'onselect', 'onsubmit',",
            "    'onunload',",
            "    ])",
            "",
            "safe_attrs = frozenset([",
            "    'abbr', 'accept', 'accept-charset', 'accesskey', 'action', 'align',",
            "    'alt', 'axis', 'border', 'cellpadding', 'cellspacing', 'char', 'charoff',",
            "    'charset', 'checked', 'cite', 'class', 'clear', 'cols', 'colspan',",
            "    'color', 'compact', 'coords', 'datetime', 'dir', 'disabled', 'enctype',",
            "    'for', 'frame', 'headers', 'height', 'href', 'hreflang', 'hspace', 'id',",
            "    'ismap', 'label', 'lang', 'longdesc', 'maxlength', 'media', 'method',",
            "    'multiple', 'name', 'nohref', 'noshade', 'nowrap', 'prompt', 'readonly',",
            "    'rel', 'rev', 'rows', 'rowspan', 'rules', 'scope', 'selected', 'shape',",
            "    'size', 'span', 'src', 'start', 'summary', 'tabindex', 'target', 'title',",
            "    'type', 'usemap', 'valign', 'value', 'vspace', 'width'])",
            "",
            "# From http://htmlhelp.com/reference/html40/olist.html",
            "top_level_tags = frozenset([",
            "    'html', 'head', 'body', 'frameset',",
            "    ])",
            "",
            "head_tags = frozenset([",
            "    'base', 'isindex', 'link', 'meta', 'script', 'style', 'title',",
            "    ])",
            "",
            "general_block_tags = frozenset([",
            "    'address',",
            "    'blockquote',",
            "    'center',",
            "    'del',",
            "    'div',",
            "    'h1',",
            "    'h2',",
            "    'h3',",
            "    'h4',",
            "    'h5',",
            "    'h6',",
            "    'hr',",
            "    'ins',",
            "    'isindex',",
            "    'noscript',",
            "    'p',",
            "    'pre',",
            "    ])",
            "",
            "list_tags = frozenset([",
            "    'dir', 'dl', 'dt', 'dd', 'li', 'menu', 'ol', 'ul',",
            "    ])",
            "",
            "table_tags = frozenset([",
            "    'table', 'caption', 'colgroup', 'col',",
            "    'thead', 'tfoot', 'tbody', 'tr', 'td', 'th',",
            "    ])",
            "",
            "# just this one from",
            "# http://www.georgehernandez.com/h/XComputers/HTML/2BlockLevel.htm",
            "block_tags = general_block_tags | list_tags | table_tags | frozenset([",
            "    # Partial form tags",
            "    'fieldset', 'form', 'legend', 'optgroup', 'option',",
            "    ])",
            "",
            "form_tags = frozenset([",
            "    'form', 'button', 'fieldset', 'legend', 'input', 'label',",
            "    'select', 'optgroup', 'option', 'textarea',",
            "    ])",
            "",
            "special_inline_tags = frozenset([",
            "    'a', 'applet', 'basefont', 'bdo', 'br', 'embed', 'font', 'iframe',",
            "    'img', 'map', 'area', 'object', 'param', 'q', 'script',",
            "    'span', 'sub', 'sup',",
            "    ])",
            "",
            "phrase_tags = frozenset([",
            "    'abbr', 'acronym', 'cite', 'code', 'del', 'dfn', 'em',",
            "    'ins', 'kbd', 'samp', 'strong', 'var',",
            "    ])",
            "",
            "font_style_tags = frozenset([",
            "    'b', 'big', 'i', 's', 'small', 'strike', 'tt', 'u',",
            "    ])",
            "",
            "frame_tags = frozenset([",
            "    'frameset', 'frame', 'noframes',",
            "    ])",
            "    ",
            "html5_tags = frozenset([",
            "    'article', 'aside', 'audio', 'canvas', 'command', 'datalist',",
            "    'details', 'embed', 'figcaption', 'figure', 'footer', 'header',",
            "    'hgroup', 'keygen', 'mark', 'math', 'meter', 'nav', 'output',",
            "    'progress', 'rp', 'rt', 'ruby', 'section', 'source', 'summary',",
            "    'svg', 'time', 'track', 'video', 'wbr'",
            "    ])",
            "",
            "# These tags aren't standard",
            "nonstandard_tags = frozenset(['blink', 'marquee'])",
            "",
            "",
            "tags = (top_level_tags | head_tags | general_block_tags | list_tags",
            "        | table_tags | form_tags | special_inline_tags | phrase_tags",
            "        | font_style_tags | nonstandard_tags | html5_tags)"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": []
    },
    "src/lxml/html/tests/test_clean.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 123,
                "afterPatchRowNumber": 123,
                "PatchRowcode": "             b'<math><style>/* deleted */</style></math>',"
            },
            "1": {
                "beforePatchRowNumber": 124,
                "afterPatchRowNumber": 124,
                "PatchRowcode": "             lxml.html.tostring(clean_html(s)))"
            },
            "2": {
                "beforePatchRowNumber": 125,
                "afterPatchRowNumber": 125,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 126,
                "PatchRowcode": "+    def test_formaction_attribute_in_button_input(self):"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 127,
                "PatchRowcode": "+        # The formaction attribute overrides the form's action and should be"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 128,
                "PatchRowcode": "+        # treated as a malicious link attribute"
            },
            "6": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 129,
                "PatchRowcode": "+        html = ('<form id=\"test\"><input type=\"submit\" formaction=\"javascript:alert(1)\"></form>'"
            },
            "7": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 130,
                "PatchRowcode": "+        '<button form=\"test\" formaction=\"javascript:alert(1)\">X</button>')"
            },
            "8": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 131,
                "PatchRowcode": "+        expected = ('<div><form id=\"test\"><input type=\"submit\" formaction=\"\"></form>'"
            },
            "9": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 132,
                "PatchRowcode": "+        '<button form=\"test\" formaction=\"\">X</button></div>')"
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 133,
                "PatchRowcode": "+        cleaner = Cleaner("
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 134,
                "PatchRowcode": "+            forms=False,"
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 135,
                "PatchRowcode": "+            safe_attrs_only=False,"
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 136,
                "PatchRowcode": "+        )"
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 137,
                "PatchRowcode": "+        self.assertEqual("
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 138,
                "PatchRowcode": "+            expected,"
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 139,
                "PatchRowcode": "+            cleaner.clean_html(html))"
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 140,
                "PatchRowcode": "+"
            },
            "18": {
                "beforePatchRowNumber": 126,
                "afterPatchRowNumber": 141,
                "PatchRowcode": " "
            },
            "19": {
                "beforePatchRowNumber": 127,
                "afterPatchRowNumber": 142,
                "PatchRowcode": " def test_suite():"
            },
            "20": {
                "beforePatchRowNumber": 128,
                "afterPatchRowNumber": 143,
                "PatchRowcode": "     suite = unittest.TestSuite()"
            }
        },
        "frontPatchFile": [
            "import unittest",
            "from lxml.tests.common_imports import make_doctest",
            "",
            "import lxml.html",
            "from lxml.html.clean import Cleaner, clean_html",
            "",
            "",
            "class CleanerTest(unittest.TestCase):",
            "    def test_allow_tags(self):",
            "        html = \"\"\"",
            "            <html>",
            "            <head>",
            "            </head>",
            "            <body>",
            "            <p>some text</p>",
            "            <table>",
            "            <tr>",
            "            <td>hello</td><td>world</td>",
            "            </tr>",
            "            <tr>",
            "            <td>hello</td><td>world</td>",
            "            </tr>",
            "            </table>",
            "            <img>",
            "            </body>",
            "            </html>",
            "            \"\"\"",
            "",
            "        html_root = lxml.html.document_fromstring(html)",
            "        cleaner = Cleaner(",
            "            remove_unknown_tags = False,",
            "            allow_tags = ['table', 'tr', 'td'])",
            "        result = cleaner.clean_html(html_root)",
            "",
            "        self.assertEqual(12-5+1, len(list(result.iter())))",
            "",
            "    def test_allow_and_remove(self):",
            "        with self.assertRaises(ValueError):",
            "            Cleaner(allow_tags=['a'], remove_unknown_tags=True)",
            "",
            "    def test_remove_unknown_tags(self):",
            "        html = \"\"\"<div><bun>lettuce, tomato, veggie patty</bun></div>\"\"\"",
            "        clean_html = \"\"\"<div>lettuce, tomato, veggie patty</div>\"\"\"",
            "        cleaner = Cleaner(remove_unknown_tags=True)",
            "        result = cleaner.clean_html(html)",
            "        self.assertEqual(",
            "            result,",
            "            clean_html,",
            "            msg=\"Unknown tags not removed. Got: %s\" % result,",
            "        )",
            "",
            "    def test_safe_attrs_included(self):",
            "        html = \"\"\"<p><span style=\"color: #00ffff;\">Cyan</span></p>\"\"\"",
            "",
            "        safe_attrs=set(lxml.html.defs.safe_attrs)",
            "        safe_attrs.add('style')",
            "",
            "        cleaner = Cleaner(",
            "            safe_attrs_only=True,",
            "            safe_attrs=safe_attrs)",
            "        result = cleaner.clean_html(html)",
            "",
            "        self.assertEqual(html, result)",
            "",
            "    def test_safe_attrs_excluded(self):",
            "        html = \"\"\"<p><span style=\"color: #00ffff;\">Cyan</span></p>\"\"\"",
            "        expected = \"\"\"<p><span>Cyan</span></p>\"\"\"",
            "",
            "        safe_attrs=set()",
            "",
            "        cleaner = Cleaner(",
            "            safe_attrs_only=True,",
            "            safe_attrs=safe_attrs)",
            "        result = cleaner.clean_html(html)",
            "",
            "        self.assertEqual(expected, result)",
            "",
            "    def test_clean_invalid_root_tag(self):",
            "        # only testing that cleaning with invalid root tags works at all",
            "        s = lxml.html.fromstring('parent <invalid tag>child</another>')",
            "        self.assertEqual('parent child', clean_html(s).text_content())",
            "",
            "        s = lxml.html.fromstring('<invalid tag>child</another>')",
            "        self.assertEqual('child', clean_html(s).text_content())",
            "",
            "    def test_clean_with_comments(self):",
            "        html = \"\"\"<p><span style=\"color: #00ffff;\">Cy<!-- xx -->an</span><!-- XXX --></p>\"\"\"",
            "        s = lxml.html.fragment_fromstring(html)",
            "",
            "        self.assertEqual(",
            "            b'<p><span>Cyan</span></p>',",
            "            lxml.html.tostring(clean_html(s)))",
            "        self.assertEqual(",
            "            '<p><span>Cyan</span></p>',",
            "            clean_html(html))",
            "",
            "        cleaner = Cleaner(comments=False)",
            "        result = cleaner.clean_html(s)",
            "        self.assertEqual(",
            "            b'<p><span>Cy<!-- xx -->an</span><!-- XXX --></p>',",
            "            lxml.html.tostring(result))",
            "        self.assertEqual(",
            "            '<p><span>Cy<!-- xx -->an</span><!-- XXX --></p>',",
            "            cleaner.clean_html(html))",
            "",
            "    def test_sneaky_noscript_in_style(self):",
            "        # This gets parsed as <noscript> -> <style>\"...</noscript>...\"</style>",
            "        # thus passing the </noscript> through into the output.",
            "        html = '<noscript><style><a title=\"</noscript><img src=x onerror=alert(1)>\">'",
            "        s = lxml.html.fragment_fromstring(html)",
            "",
            "        self.assertEqual(",
            "            b'<noscript><style>/* deleted */</style></noscript>',",
            "            lxml.html.tostring(clean_html(s)))",
            "",
            "    def test_sneaky_js_in_math_style(self):",
            "        # This gets parsed as <math> -> <style>\"...\"</style>",
            "        # thus passing any tag/script/whatever content through into the output.",
            "        html = '<math><style><img src=x onerror=alert(1)></style></math>'",
            "        s = lxml.html.fragment_fromstring(html)",
            "",
            "        self.assertEqual(",
            "            b'<math><style>/* deleted */</style></math>',",
            "            lxml.html.tostring(clean_html(s)))",
            "",
            "",
            "def test_suite():",
            "    suite = unittest.TestSuite()",
            "    suite.addTests([make_doctest('test_clean.txt')])",
            "    suite.addTests([make_doctest('test_clean_embed.txt')])",
            "    suite.addTests(unittest.makeSuite(CleanerTest))",
            "    return suite"
        ],
        "afterPatchFile": [
            "import unittest",
            "from lxml.tests.common_imports import make_doctest",
            "",
            "import lxml.html",
            "from lxml.html.clean import Cleaner, clean_html",
            "",
            "",
            "class CleanerTest(unittest.TestCase):",
            "    def test_allow_tags(self):",
            "        html = \"\"\"",
            "            <html>",
            "            <head>",
            "            </head>",
            "            <body>",
            "            <p>some text</p>",
            "            <table>",
            "            <tr>",
            "            <td>hello</td><td>world</td>",
            "            </tr>",
            "            <tr>",
            "            <td>hello</td><td>world</td>",
            "            </tr>",
            "            </table>",
            "            <img>",
            "            </body>",
            "            </html>",
            "            \"\"\"",
            "",
            "        html_root = lxml.html.document_fromstring(html)",
            "        cleaner = Cleaner(",
            "            remove_unknown_tags = False,",
            "            allow_tags = ['table', 'tr', 'td'])",
            "        result = cleaner.clean_html(html_root)",
            "",
            "        self.assertEqual(12-5+1, len(list(result.iter())))",
            "",
            "    def test_allow_and_remove(self):",
            "        with self.assertRaises(ValueError):",
            "            Cleaner(allow_tags=['a'], remove_unknown_tags=True)",
            "",
            "    def test_remove_unknown_tags(self):",
            "        html = \"\"\"<div><bun>lettuce, tomato, veggie patty</bun></div>\"\"\"",
            "        clean_html = \"\"\"<div>lettuce, tomato, veggie patty</div>\"\"\"",
            "        cleaner = Cleaner(remove_unknown_tags=True)",
            "        result = cleaner.clean_html(html)",
            "        self.assertEqual(",
            "            result,",
            "            clean_html,",
            "            msg=\"Unknown tags not removed. Got: %s\" % result,",
            "        )",
            "",
            "    def test_safe_attrs_included(self):",
            "        html = \"\"\"<p><span style=\"color: #00ffff;\">Cyan</span></p>\"\"\"",
            "",
            "        safe_attrs=set(lxml.html.defs.safe_attrs)",
            "        safe_attrs.add('style')",
            "",
            "        cleaner = Cleaner(",
            "            safe_attrs_only=True,",
            "            safe_attrs=safe_attrs)",
            "        result = cleaner.clean_html(html)",
            "",
            "        self.assertEqual(html, result)",
            "",
            "    def test_safe_attrs_excluded(self):",
            "        html = \"\"\"<p><span style=\"color: #00ffff;\">Cyan</span></p>\"\"\"",
            "        expected = \"\"\"<p><span>Cyan</span></p>\"\"\"",
            "",
            "        safe_attrs=set()",
            "",
            "        cleaner = Cleaner(",
            "            safe_attrs_only=True,",
            "            safe_attrs=safe_attrs)",
            "        result = cleaner.clean_html(html)",
            "",
            "        self.assertEqual(expected, result)",
            "",
            "    def test_clean_invalid_root_tag(self):",
            "        # only testing that cleaning with invalid root tags works at all",
            "        s = lxml.html.fromstring('parent <invalid tag>child</another>')",
            "        self.assertEqual('parent child', clean_html(s).text_content())",
            "",
            "        s = lxml.html.fromstring('<invalid tag>child</another>')",
            "        self.assertEqual('child', clean_html(s).text_content())",
            "",
            "    def test_clean_with_comments(self):",
            "        html = \"\"\"<p><span style=\"color: #00ffff;\">Cy<!-- xx -->an</span><!-- XXX --></p>\"\"\"",
            "        s = lxml.html.fragment_fromstring(html)",
            "",
            "        self.assertEqual(",
            "            b'<p><span>Cyan</span></p>',",
            "            lxml.html.tostring(clean_html(s)))",
            "        self.assertEqual(",
            "            '<p><span>Cyan</span></p>',",
            "            clean_html(html))",
            "",
            "        cleaner = Cleaner(comments=False)",
            "        result = cleaner.clean_html(s)",
            "        self.assertEqual(",
            "            b'<p><span>Cy<!-- xx -->an</span><!-- XXX --></p>',",
            "            lxml.html.tostring(result))",
            "        self.assertEqual(",
            "            '<p><span>Cy<!-- xx -->an</span><!-- XXX --></p>',",
            "            cleaner.clean_html(html))",
            "",
            "    def test_sneaky_noscript_in_style(self):",
            "        # This gets parsed as <noscript> -> <style>\"...</noscript>...\"</style>",
            "        # thus passing the </noscript> through into the output.",
            "        html = '<noscript><style><a title=\"</noscript><img src=x onerror=alert(1)>\">'",
            "        s = lxml.html.fragment_fromstring(html)",
            "",
            "        self.assertEqual(",
            "            b'<noscript><style>/* deleted */</style></noscript>',",
            "            lxml.html.tostring(clean_html(s)))",
            "",
            "    def test_sneaky_js_in_math_style(self):",
            "        # This gets parsed as <math> -> <style>\"...\"</style>",
            "        # thus passing any tag/script/whatever content through into the output.",
            "        html = '<math><style><img src=x onerror=alert(1)></style></math>'",
            "        s = lxml.html.fragment_fromstring(html)",
            "",
            "        self.assertEqual(",
            "            b'<math><style>/* deleted */</style></math>',",
            "            lxml.html.tostring(clean_html(s)))",
            "",
            "    def test_formaction_attribute_in_button_input(self):",
            "        # The formaction attribute overrides the form's action and should be",
            "        # treated as a malicious link attribute",
            "        html = ('<form id=\"test\"><input type=\"submit\" formaction=\"javascript:alert(1)\"></form>'",
            "        '<button form=\"test\" formaction=\"javascript:alert(1)\">X</button>')",
            "        expected = ('<div><form id=\"test\"><input type=\"submit\" formaction=\"\"></form>'",
            "        '<button form=\"test\" formaction=\"\">X</button></div>')",
            "        cleaner = Cleaner(",
            "            forms=False,",
            "            safe_attrs_only=False,",
            "        )",
            "        self.assertEqual(",
            "            expected,",
            "            cleaner.clean_html(html))",
            "",
            "",
            "def test_suite():",
            "    suite = unittest.TestSuite()",
            "    suite.addTests([make_doctest('test_clean.txt')])",
            "    suite.addTests([make_doctest('test_clean_embed.txt')])",
            "    suite.addTests(unittest.makeSuite(CleanerTest))",
            "    return suite"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": [
            "docassemble_base.docassemble.base.functions"
        ]
    }
}