{
    "docx/opc/oxml.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " "
            },
            "1": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 17,
                "PatchRowcode": " # configure XML parser"
            },
            "2": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 18,
                "PatchRowcode": " element_class_lookup = etree.ElementNamespaceClassLookup()"
            },
            "3": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-oxml_parser = etree.XMLParser(remove_blank_text=True)"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 19,
                "PatchRowcode": "+oxml_parser = etree.XMLParser(remove_blank_text=True, resolve_entities=False)"
            },
            "5": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " oxml_parser.set_element_class_lookup(element_class_lookup)"
            },
            "6": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 21,
                "PatchRowcode": " "
            },
            "7": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": 22,
                "PatchRowcode": " nsmap = {"
            }
        },
        "frontPatchFile": [
            "# encoding: utf-8",
            "",
            "\"\"\"",
            "Temporary stand-in for main oxml module that came across with the",
            "PackageReader transplant. Probably much will get replaced with objects from",
            "the pptx.oxml.core and then this module will either get deleted or only hold",
            "the package related custom element classes.",
            "\"\"\"",
            "",
            "from __future__ import absolute_import, print_function, unicode_literals",
            "",
            "from lxml import etree",
            "",
            "from .constants import NAMESPACE as NS, RELATIONSHIP_TARGET_MODE as RTM",
            "",
            "",
            "# configure XML parser",
            "element_class_lookup = etree.ElementNamespaceClassLookup()",
            "oxml_parser = etree.XMLParser(remove_blank_text=True)",
            "oxml_parser.set_element_class_lookup(element_class_lookup)",
            "",
            "nsmap = {",
            "    'ct': NS.OPC_CONTENT_TYPES,",
            "    'pr': NS.OPC_RELATIONSHIPS,",
            "    'r':  NS.OFC_RELATIONSHIPS,",
            "}",
            "",
            "",
            "# ===========================================================================",
            "# functions",
            "# ===========================================================================",
            "",
            "def parse_xml(text):",
            "    \"\"\"",
            "    ``etree.fromstring()`` replacement that uses oxml parser",
            "    \"\"\"",
            "    return etree.fromstring(text, oxml_parser)",
            "",
            "",
            "def qn(tag):",
            "    \"\"\"",
            "    Stands for \"qualified name\", a utility function to turn a namespace",
            "    prefixed tag name into a Clark-notation qualified tag name for lxml. For",
            "    example, ``qn('p:cSld')`` returns ``'{http://schemas.../main}cSld'``.",
            "    \"\"\"",
            "    prefix, tagroot = tag.split(':')",
            "    uri = nsmap[prefix]",
            "    return '{%s}%s' % (uri, tagroot)",
            "",
            "",
            "def serialize_part_xml(part_elm):",
            "    \"\"\"",
            "    Serialize *part_elm* etree element to XML suitable for storage as an XML",
            "    part. That is to say, no insignificant whitespace added for readability,",
            "    and an appropriate XML declaration added with UTF-8 encoding specified.",
            "    \"\"\"",
            "    return etree.tostring(part_elm, encoding='UTF-8', standalone=True)",
            "",
            "",
            "def serialize_for_reading(element):",
            "    \"\"\"",
            "    Serialize *element* to human-readable XML suitable for tests. No XML",
            "    declaration.",
            "    \"\"\"",
            "    return etree.tostring(element, encoding='unicode', pretty_print=True)",
            "",
            "",
            "# ===========================================================================",
            "# Custom element classes",
            "# ===========================================================================",
            "",
            "class BaseOxmlElement(etree.ElementBase):",
            "    \"\"\"",
            "    Base class for all custom element classes, to add standardized behavior",
            "    to all classes in one place.",
            "    \"\"\"",
            "    @property",
            "    def xml(self):",
            "        \"\"\"",
            "        Return XML string for this element, suitable for testing purposes.",
            "        Pretty printed for readability and without an XML declaration at the",
            "        top.",
            "        \"\"\"",
            "        return serialize_for_reading(self)",
            "",
            "",
            "class CT_Default(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Default>`` element, specifying the default content type to be applied",
            "    to a part with the specified extension.",
            "    \"\"\"",
            "    @property",
            "    def content_type(self):",
            "        \"\"\"",
            "        String held in the ``ContentType`` attribute of this ``<Default>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('ContentType')",
            "",
            "    @property",
            "    def extension(self):",
            "        \"\"\"",
            "        String held in the ``Extension`` attribute of this ``<Default>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('Extension')",
            "",
            "    @staticmethod",
            "    def new(ext, content_type):",
            "        \"\"\"",
            "        Return a new ``<Default>`` element with attributes set to parameter",
            "        values.",
            "        \"\"\"",
            "        xml = '<Default xmlns=\"%s\"/>' % nsmap['ct']",
            "        default = parse_xml(xml)",
            "        default.set('Extension', ext)",
            "        default.set('ContentType', content_type)",
            "        return default",
            "",
            "",
            "class CT_Override(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Override>`` element, specifying the content type to be applied for a",
            "    part with the specified partname.",
            "    \"\"\"",
            "    @property",
            "    def content_type(self):",
            "        \"\"\"",
            "        String held in the ``ContentType`` attribute of this ``<Override>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('ContentType')",
            "",
            "    @staticmethod",
            "    def new(partname, content_type):",
            "        \"\"\"",
            "        Return a new ``<Override>`` element with attributes set to parameter",
            "        values.",
            "        \"\"\"",
            "        xml = '<Override xmlns=\"%s\"/>' % nsmap['ct']",
            "        override = parse_xml(xml)",
            "        override.set('PartName', partname)",
            "        override.set('ContentType', content_type)",
            "        return override",
            "",
            "    @property",
            "    def partname(self):",
            "        \"\"\"",
            "        String held in the ``PartName`` attribute of this ``<Override>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('PartName')",
            "",
            "",
            "class CT_Relationship(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Relationship>`` element, representing a single relationship from a",
            "    source to a target part.",
            "    \"\"\"",
            "    @staticmethod",
            "    def new(rId, reltype, target, target_mode=RTM.INTERNAL):",
            "        \"\"\"",
            "        Return a new ``<Relationship>`` element.",
            "        \"\"\"",
            "        xml = '<Relationship xmlns=\"%s\"/>' % nsmap['pr']",
            "        relationship = parse_xml(xml)",
            "        relationship.set('Id', rId)",
            "        relationship.set('Type', reltype)",
            "        relationship.set('Target', target)",
            "        if target_mode == RTM.EXTERNAL:",
            "            relationship.set('TargetMode', RTM.EXTERNAL)",
            "        return relationship",
            "",
            "    @property",
            "    def rId(self):",
            "        \"\"\"",
            "        String held in the ``Id`` attribute of this ``<Relationship>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('Id')",
            "",
            "    @property",
            "    def reltype(self):",
            "        \"\"\"",
            "        String held in the ``Type`` attribute of this ``<Relationship>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('Type')",
            "",
            "    @property",
            "    def target_ref(self):",
            "        \"\"\"",
            "        String held in the ``Target`` attribute of this ``<Relationship>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('Target')",
            "",
            "    @property",
            "    def target_mode(self):",
            "        \"\"\"",
            "        String held in the ``TargetMode`` attribute of this",
            "        ``<Relationship>`` element, either ``Internal`` or ``External``.",
            "        Defaults to ``Internal``.",
            "        \"\"\"",
            "        return self.get('TargetMode', RTM.INTERNAL)",
            "",
            "",
            "class CT_Relationships(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Relationships>`` element, the root element in a .rels file.",
            "    \"\"\"",
            "    def add_rel(self, rId, reltype, target, is_external=False):",
            "        \"\"\"",
            "        Add a child ``<Relationship>`` element with attributes set according",
            "        to parameter values.",
            "        \"\"\"",
            "        target_mode = RTM.EXTERNAL if is_external else RTM.INTERNAL",
            "        relationship = CT_Relationship.new(rId, reltype, target, target_mode)",
            "        self.append(relationship)",
            "",
            "    @staticmethod",
            "    def new():",
            "        \"\"\"",
            "        Return a new ``<Relationships>`` element.",
            "        \"\"\"",
            "        xml = '<Relationships xmlns=\"%s\"/>' % nsmap['pr']",
            "        relationships = parse_xml(xml)",
            "        return relationships",
            "",
            "    @property",
            "    def Relationship_lst(self):",
            "        \"\"\"",
            "        Return a list containing all the ``<Relationship>`` child elements.",
            "        \"\"\"",
            "        return self.findall(qn('pr:Relationship'))",
            "",
            "    @property",
            "    def xml(self):",
            "        \"\"\"",
            "        Return XML string for this element, suitable for saving in a .rels",
            "        stream, not pretty printed and with an XML declaration at the top.",
            "        \"\"\"",
            "        return serialize_part_xml(self)",
            "",
            "",
            "class CT_Types(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Types>`` element, the container element for Default and Override",
            "    elements in [Content_Types].xml.",
            "    \"\"\"",
            "    def add_default(self, ext, content_type):",
            "        \"\"\"",
            "        Add a child ``<Default>`` element with attributes set to parameter",
            "        values.",
            "        \"\"\"",
            "        default = CT_Default.new(ext, content_type)",
            "        self.append(default)",
            "",
            "    def add_override(self, partname, content_type):",
            "        \"\"\"",
            "        Add a child ``<Override>`` element with attributes set to parameter",
            "        values.",
            "        \"\"\"",
            "        override = CT_Override.new(partname, content_type)",
            "        self.append(override)",
            "",
            "    @property",
            "    def defaults(self):",
            "        return self.findall(qn('ct:Default'))",
            "",
            "    @staticmethod",
            "    def new():",
            "        \"\"\"",
            "        Return a new ``<Types>`` element.",
            "        \"\"\"",
            "        xml = '<Types xmlns=\"%s\"/>' % nsmap['ct']",
            "        types = parse_xml(xml)",
            "        return types",
            "",
            "    @property",
            "    def overrides(self):",
            "        return self.findall(qn('ct:Override'))",
            "",
            "",
            "ct_namespace = element_class_lookup.get_namespace(nsmap['ct'])",
            "ct_namespace['Default'] = CT_Default",
            "ct_namespace['Override'] = CT_Override",
            "ct_namespace['Types'] = CT_Types",
            "",
            "pr_namespace = element_class_lookup.get_namespace(nsmap['pr'])",
            "pr_namespace['Relationship'] = CT_Relationship",
            "pr_namespace['Relationships'] = CT_Relationships"
        ],
        "afterPatchFile": [
            "# encoding: utf-8",
            "",
            "\"\"\"",
            "Temporary stand-in for main oxml module that came across with the",
            "PackageReader transplant. Probably much will get replaced with objects from",
            "the pptx.oxml.core and then this module will either get deleted or only hold",
            "the package related custom element classes.",
            "\"\"\"",
            "",
            "from __future__ import absolute_import, print_function, unicode_literals",
            "",
            "from lxml import etree",
            "",
            "from .constants import NAMESPACE as NS, RELATIONSHIP_TARGET_MODE as RTM",
            "",
            "",
            "# configure XML parser",
            "element_class_lookup = etree.ElementNamespaceClassLookup()",
            "oxml_parser = etree.XMLParser(remove_blank_text=True, resolve_entities=False)",
            "oxml_parser.set_element_class_lookup(element_class_lookup)",
            "",
            "nsmap = {",
            "    'ct': NS.OPC_CONTENT_TYPES,",
            "    'pr': NS.OPC_RELATIONSHIPS,",
            "    'r':  NS.OFC_RELATIONSHIPS,",
            "}",
            "",
            "",
            "# ===========================================================================",
            "# functions",
            "# ===========================================================================",
            "",
            "def parse_xml(text):",
            "    \"\"\"",
            "    ``etree.fromstring()`` replacement that uses oxml parser",
            "    \"\"\"",
            "    return etree.fromstring(text, oxml_parser)",
            "",
            "",
            "def qn(tag):",
            "    \"\"\"",
            "    Stands for \"qualified name\", a utility function to turn a namespace",
            "    prefixed tag name into a Clark-notation qualified tag name for lxml. For",
            "    example, ``qn('p:cSld')`` returns ``'{http://schemas.../main}cSld'``.",
            "    \"\"\"",
            "    prefix, tagroot = tag.split(':')",
            "    uri = nsmap[prefix]",
            "    return '{%s}%s' % (uri, tagroot)",
            "",
            "",
            "def serialize_part_xml(part_elm):",
            "    \"\"\"",
            "    Serialize *part_elm* etree element to XML suitable for storage as an XML",
            "    part. That is to say, no insignificant whitespace added for readability,",
            "    and an appropriate XML declaration added with UTF-8 encoding specified.",
            "    \"\"\"",
            "    return etree.tostring(part_elm, encoding='UTF-8', standalone=True)",
            "",
            "",
            "def serialize_for_reading(element):",
            "    \"\"\"",
            "    Serialize *element* to human-readable XML suitable for tests. No XML",
            "    declaration.",
            "    \"\"\"",
            "    return etree.tostring(element, encoding='unicode', pretty_print=True)",
            "",
            "",
            "# ===========================================================================",
            "# Custom element classes",
            "# ===========================================================================",
            "",
            "class BaseOxmlElement(etree.ElementBase):",
            "    \"\"\"",
            "    Base class for all custom element classes, to add standardized behavior",
            "    to all classes in one place.",
            "    \"\"\"",
            "    @property",
            "    def xml(self):",
            "        \"\"\"",
            "        Return XML string for this element, suitable for testing purposes.",
            "        Pretty printed for readability and without an XML declaration at the",
            "        top.",
            "        \"\"\"",
            "        return serialize_for_reading(self)",
            "",
            "",
            "class CT_Default(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Default>`` element, specifying the default content type to be applied",
            "    to a part with the specified extension.",
            "    \"\"\"",
            "    @property",
            "    def content_type(self):",
            "        \"\"\"",
            "        String held in the ``ContentType`` attribute of this ``<Default>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('ContentType')",
            "",
            "    @property",
            "    def extension(self):",
            "        \"\"\"",
            "        String held in the ``Extension`` attribute of this ``<Default>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('Extension')",
            "",
            "    @staticmethod",
            "    def new(ext, content_type):",
            "        \"\"\"",
            "        Return a new ``<Default>`` element with attributes set to parameter",
            "        values.",
            "        \"\"\"",
            "        xml = '<Default xmlns=\"%s\"/>' % nsmap['ct']",
            "        default = parse_xml(xml)",
            "        default.set('Extension', ext)",
            "        default.set('ContentType', content_type)",
            "        return default",
            "",
            "",
            "class CT_Override(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Override>`` element, specifying the content type to be applied for a",
            "    part with the specified partname.",
            "    \"\"\"",
            "    @property",
            "    def content_type(self):",
            "        \"\"\"",
            "        String held in the ``ContentType`` attribute of this ``<Override>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('ContentType')",
            "",
            "    @staticmethod",
            "    def new(partname, content_type):",
            "        \"\"\"",
            "        Return a new ``<Override>`` element with attributes set to parameter",
            "        values.",
            "        \"\"\"",
            "        xml = '<Override xmlns=\"%s\"/>' % nsmap['ct']",
            "        override = parse_xml(xml)",
            "        override.set('PartName', partname)",
            "        override.set('ContentType', content_type)",
            "        return override",
            "",
            "    @property",
            "    def partname(self):",
            "        \"\"\"",
            "        String held in the ``PartName`` attribute of this ``<Override>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('PartName')",
            "",
            "",
            "class CT_Relationship(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Relationship>`` element, representing a single relationship from a",
            "    source to a target part.",
            "    \"\"\"",
            "    @staticmethod",
            "    def new(rId, reltype, target, target_mode=RTM.INTERNAL):",
            "        \"\"\"",
            "        Return a new ``<Relationship>`` element.",
            "        \"\"\"",
            "        xml = '<Relationship xmlns=\"%s\"/>' % nsmap['pr']",
            "        relationship = parse_xml(xml)",
            "        relationship.set('Id', rId)",
            "        relationship.set('Type', reltype)",
            "        relationship.set('Target', target)",
            "        if target_mode == RTM.EXTERNAL:",
            "            relationship.set('TargetMode', RTM.EXTERNAL)",
            "        return relationship",
            "",
            "    @property",
            "    def rId(self):",
            "        \"\"\"",
            "        String held in the ``Id`` attribute of this ``<Relationship>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('Id')",
            "",
            "    @property",
            "    def reltype(self):",
            "        \"\"\"",
            "        String held in the ``Type`` attribute of this ``<Relationship>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('Type')",
            "",
            "    @property",
            "    def target_ref(self):",
            "        \"\"\"",
            "        String held in the ``Target`` attribute of this ``<Relationship>``",
            "        element.",
            "        \"\"\"",
            "        return self.get('Target')",
            "",
            "    @property",
            "    def target_mode(self):",
            "        \"\"\"",
            "        String held in the ``TargetMode`` attribute of this",
            "        ``<Relationship>`` element, either ``Internal`` or ``External``.",
            "        Defaults to ``Internal``.",
            "        \"\"\"",
            "        return self.get('TargetMode', RTM.INTERNAL)",
            "",
            "",
            "class CT_Relationships(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Relationships>`` element, the root element in a .rels file.",
            "    \"\"\"",
            "    def add_rel(self, rId, reltype, target, is_external=False):",
            "        \"\"\"",
            "        Add a child ``<Relationship>`` element with attributes set according",
            "        to parameter values.",
            "        \"\"\"",
            "        target_mode = RTM.EXTERNAL if is_external else RTM.INTERNAL",
            "        relationship = CT_Relationship.new(rId, reltype, target, target_mode)",
            "        self.append(relationship)",
            "",
            "    @staticmethod",
            "    def new():",
            "        \"\"\"",
            "        Return a new ``<Relationships>`` element.",
            "        \"\"\"",
            "        xml = '<Relationships xmlns=\"%s\"/>' % nsmap['pr']",
            "        relationships = parse_xml(xml)",
            "        return relationships",
            "",
            "    @property",
            "    def Relationship_lst(self):",
            "        \"\"\"",
            "        Return a list containing all the ``<Relationship>`` child elements.",
            "        \"\"\"",
            "        return self.findall(qn('pr:Relationship'))",
            "",
            "    @property",
            "    def xml(self):",
            "        \"\"\"",
            "        Return XML string for this element, suitable for saving in a .rels",
            "        stream, not pretty printed and with an XML declaration at the top.",
            "        \"\"\"",
            "        return serialize_part_xml(self)",
            "",
            "",
            "class CT_Types(BaseOxmlElement):",
            "    \"\"\"",
            "    ``<Types>`` element, the container element for Default and Override",
            "    elements in [Content_Types].xml.",
            "    \"\"\"",
            "    def add_default(self, ext, content_type):",
            "        \"\"\"",
            "        Add a child ``<Default>`` element with attributes set to parameter",
            "        values.",
            "        \"\"\"",
            "        default = CT_Default.new(ext, content_type)",
            "        self.append(default)",
            "",
            "    def add_override(self, partname, content_type):",
            "        \"\"\"",
            "        Add a child ``<Override>`` element with attributes set to parameter",
            "        values.",
            "        \"\"\"",
            "        override = CT_Override.new(partname, content_type)",
            "        self.append(override)",
            "",
            "    @property",
            "    def defaults(self):",
            "        return self.findall(qn('ct:Default'))",
            "",
            "    @staticmethod",
            "    def new():",
            "        \"\"\"",
            "        Return a new ``<Types>`` element.",
            "        \"\"\"",
            "        xml = '<Types xmlns=\"%s\"/>' % nsmap['ct']",
            "        types = parse_xml(xml)",
            "        return types",
            "",
            "    @property",
            "    def overrides(self):",
            "        return self.findall(qn('ct:Override'))",
            "",
            "",
            "ct_namespace = element_class_lookup.get_namespace(nsmap['ct'])",
            "ct_namespace['Default'] = CT_Default",
            "ct_namespace['Override'] = CT_Override",
            "ct_namespace['Types'] = CT_Types",
            "",
            "pr_namespace = element_class_lookup.get_namespace(nsmap['pr'])",
            "pr_namespace['Relationship'] = CT_Relationship",
            "pr_namespace['Relationships'] = CT_Relationships"
        ],
        "action": [
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "19": [
                "oxml_parser"
            ]
        },
        "addLocation": []
    },
    "docx/oxml/__init__.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 14,
                "afterPatchRowNumber": 14,
                "PatchRowcode": " "
            },
            "1": {
                "beforePatchRowNumber": 15,
                "afterPatchRowNumber": 15,
                "PatchRowcode": " # configure XML parser"
            },
            "2": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " element_class_lookup = etree.ElementNamespaceClassLookup()"
            },
            "3": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-oxml_parser = etree.XMLParser(remove_blank_text=True)"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 17,
                "PatchRowcode": "+oxml_parser = etree.XMLParser(remove_blank_text=True, resolve_entities=False)"
            },
            "5": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 18,
                "PatchRowcode": " oxml_parser.set_element_class_lookup(element_class_lookup)"
            },
            "6": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 19,
                "PatchRowcode": " "
            },
            "7": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " "
            }
        },
        "frontPatchFile": [
            "# encoding: utf-8",
            "",
            "\"\"\"",
            "Initializes oxml sub-package, including registering custom element classes",
            "corresponding to Open XML elements.",
            "\"\"\"",
            "",
            "from __future__ import absolute_import",
            "",
            "from lxml import etree",
            "",
            "from .ns import NamespacePrefixedTag, nsmap",
            "",
            "",
            "# configure XML parser",
            "element_class_lookup = etree.ElementNamespaceClassLookup()",
            "oxml_parser = etree.XMLParser(remove_blank_text=True)",
            "oxml_parser.set_element_class_lookup(element_class_lookup)",
            "",
            "",
            "def parse_xml(xml):",
            "    \"\"\"",
            "    Return root lxml element obtained by parsing XML character string in",
            "    *xml*, which can be either a Python 2.x string or unicode. The custom",
            "    parser is used, so custom element classes are produced for elements in",
            "    *xml* that have them.",
            "    \"\"\"",
            "    root_element = etree.fromstring(xml, oxml_parser)",
            "    return root_element",
            "",
            "",
            "def register_element_cls(tag, cls):",
            "    \"\"\"",
            "    Register *cls* to be constructed when the oxml parser encounters an",
            "    element with matching *tag*. *tag* is a string of the form",
            "    ``nspfx:tagroot``, e.g. ``'w:document'``.",
            "    \"\"\"",
            "    nspfx, tagroot = tag.split(':')",
            "    namespace = element_class_lookup.get_namespace(nsmap[nspfx])",
            "    namespace[tagroot] = cls",
            "",
            "",
            "def OxmlElement(nsptag_str, attrs=None, nsdecls=None):",
            "    \"\"\"",
            "    Return a 'loose' lxml element having the tag specified by *nsptag_str*.",
            "    *nsptag_str* must contain the standard namespace prefix, e.g. 'a:tbl'.",
            "    The resulting element is an instance of the custom element class for this",
            "    tag name if one is defined. A dictionary of attribute values may be",
            "    provided as *attrs*; they are set if present. All namespaces defined in",
            "    the dict *nsdecls* are declared in the element using the key as the",
            "    prefix and the value as the namespace name. If *nsdecls* is not provided,",
            "    a single namespace declaration is added based on the prefix on",
            "    *nsptag_str*.",
            "    \"\"\"",
            "    nsptag = NamespacePrefixedTag(nsptag_str)",
            "    if nsdecls is None:",
            "        nsdecls = nsptag.nsmap",
            "    return oxml_parser.makeelement(",
            "        nsptag.clark_name, attrib=attrs, nsmap=nsdecls",
            "    )",
            "",
            "",
            "# ===========================================================================",
            "# custom element class mappings",
            "# ===========================================================================",
            "",
            "from .shared import CT_DecimalNumber, CT_OnOff, CT_String",
            "",
            "",
            "from .coreprops import CT_CoreProperties",
            "register_element_cls('cp:coreProperties', CT_CoreProperties)",
            "",
            "from .document import CT_Body, CT_Document",
            "register_element_cls('w:body',     CT_Body)",
            "register_element_cls('w:document', CT_Document)",
            "",
            "from .numbering import (",
            "    CT_Num, CT_Numbering, CT_NumLvl, CT_NumPr",
            ")",
            "register_element_cls('w:abstractNumId', CT_DecimalNumber)",
            "register_element_cls('w:ilvl',          CT_DecimalNumber)",
            "register_element_cls('w:lvlOverride',   CT_NumLvl)",
            "register_element_cls('w:num',           CT_Num)",
            "register_element_cls('w:numId',         CT_DecimalNumber)",
            "register_element_cls('w:numPr',         CT_NumPr)",
            "register_element_cls('w:numbering',     CT_Numbering)",
            "register_element_cls('w:startOverride', CT_DecimalNumber)",
            "",
            "from .section import CT_PageMar, CT_PageSz, CT_SectPr, CT_SectType",
            "register_element_cls('w:pgMar',  CT_PageMar)",
            "register_element_cls('w:pgSz',   CT_PageSz)",
            "register_element_cls('w:sectPr', CT_SectPr)",
            "register_element_cls('w:type',   CT_SectType)",
            "",
            "from .shape import (",
            "    CT_Blip, CT_BlipFillProperties, CT_GraphicalObject,",
            "    CT_GraphicalObjectData, CT_Inline, CT_NonVisualDrawingProps, CT_Picture,",
            "    CT_PictureNonVisual, CT_Point2D, CT_PositiveSize2D, CT_ShapeProperties,",
            "    CT_Transform2D",
            ")",
            "register_element_cls('a:blip',        CT_Blip)",
            "register_element_cls('a:ext',         CT_PositiveSize2D)",
            "register_element_cls('a:graphic',     CT_GraphicalObject)",
            "register_element_cls('a:graphicData', CT_GraphicalObjectData)",
            "register_element_cls('a:off',         CT_Point2D)",
            "register_element_cls('a:xfrm',        CT_Transform2D)",
            "register_element_cls('pic:blipFill',  CT_BlipFillProperties)",
            "register_element_cls('pic:cNvPr',     CT_NonVisualDrawingProps)",
            "register_element_cls('pic:nvPicPr',   CT_PictureNonVisual)",
            "register_element_cls('pic:pic',       CT_Picture)",
            "register_element_cls('pic:spPr',      CT_ShapeProperties)",
            "register_element_cls('wp:docPr',      CT_NonVisualDrawingProps)",
            "register_element_cls('wp:extent',     CT_PositiveSize2D)",
            "register_element_cls('wp:inline',     CT_Inline)",
            "",
            "from .styles import CT_LatentStyles, CT_LsdException, CT_Style, CT_Styles",
            "register_element_cls('w:basedOn',        CT_String)",
            "register_element_cls('w:latentStyles',   CT_LatentStyles)",
            "register_element_cls('w:locked',         CT_OnOff)",
            "register_element_cls('w:lsdException',   CT_LsdException)",
            "register_element_cls('w:name',           CT_String)",
            "register_element_cls('w:next',           CT_String)",
            "register_element_cls('w:qFormat',        CT_OnOff)",
            "register_element_cls('w:semiHidden',     CT_OnOff)",
            "register_element_cls('w:style',          CT_Style)",
            "register_element_cls('w:styles',         CT_Styles)",
            "register_element_cls('w:uiPriority',     CT_DecimalNumber)",
            "register_element_cls('w:unhideWhenUsed', CT_OnOff)",
            "",
            "from .table import (",
            "    CT_Row, CT_Tbl, CT_TblGrid, CT_TblGridCol, CT_TblLayoutType, CT_TblPr,",
            "    CT_TblWidth, CT_Tc, CT_TcPr, CT_VMerge",
            ")",
            "register_element_cls('w:bidiVisual', CT_OnOff)",
            "register_element_cls('w:gridCol',    CT_TblGridCol)",
            "register_element_cls('w:gridSpan',   CT_DecimalNumber)",
            "register_element_cls('w:tbl',        CT_Tbl)",
            "register_element_cls('w:tblGrid',    CT_TblGrid)",
            "register_element_cls('w:tblLayout',  CT_TblLayoutType)",
            "register_element_cls('w:tblPr',      CT_TblPr)",
            "register_element_cls('w:tblStyle',   CT_String)",
            "register_element_cls('w:tc',         CT_Tc)",
            "register_element_cls('w:tcPr',       CT_TcPr)",
            "register_element_cls('w:tcW',        CT_TblWidth)",
            "register_element_cls('w:tr',         CT_Row)",
            "register_element_cls('w:vMerge',     CT_VMerge)",
            "",
            "from .text.font import (",
            "    CT_Color, CT_Fonts, CT_Highlight, CT_HpsMeasure, CT_RPr, CT_Underline,",
            "    CT_VerticalAlignRun",
            ")",
            "register_element_cls('w:b',          CT_OnOff)",
            "register_element_cls('w:bCs',        CT_OnOff)",
            "register_element_cls('w:caps',       CT_OnOff)",
            "register_element_cls('w:color',      CT_Color)",
            "register_element_cls('w:cs',         CT_OnOff)",
            "register_element_cls('w:dstrike',    CT_OnOff)",
            "register_element_cls('w:emboss',     CT_OnOff)",
            "register_element_cls('w:highlight',  CT_Highlight)",
            "register_element_cls('w:i',          CT_OnOff)",
            "register_element_cls('w:iCs',        CT_OnOff)",
            "register_element_cls('w:imprint',    CT_OnOff)",
            "register_element_cls('w:noProof',    CT_OnOff)",
            "register_element_cls('w:oMath',      CT_OnOff)",
            "register_element_cls('w:outline',    CT_OnOff)",
            "register_element_cls('w:rFonts',     CT_Fonts)",
            "register_element_cls('w:rPr',        CT_RPr)",
            "register_element_cls('w:rStyle',     CT_String)",
            "register_element_cls('w:rtl',        CT_OnOff)",
            "register_element_cls('w:shadow',     CT_OnOff)",
            "register_element_cls('w:smallCaps',  CT_OnOff)",
            "register_element_cls('w:snapToGrid', CT_OnOff)",
            "register_element_cls('w:specVanish', CT_OnOff)",
            "register_element_cls('w:strike',     CT_OnOff)",
            "register_element_cls('w:sz',         CT_HpsMeasure)",
            "register_element_cls('w:u',          CT_Underline)",
            "register_element_cls('w:vanish',     CT_OnOff)",
            "register_element_cls('w:vertAlign',  CT_VerticalAlignRun)",
            "register_element_cls('w:webHidden',  CT_OnOff)",
            "",
            "from .text.paragraph import CT_P",
            "register_element_cls('w:p', CT_P)",
            "",
            "from .text.parfmt import CT_Ind, CT_Jc, CT_PPr, CT_Spacing",
            "register_element_cls('w:ind',             CT_Ind)",
            "register_element_cls('w:jc',              CT_Jc)",
            "register_element_cls('w:keepLines',       CT_OnOff)",
            "register_element_cls('w:keepNext',        CT_OnOff)",
            "register_element_cls('w:pageBreakBefore', CT_OnOff)",
            "register_element_cls('w:pPr',             CT_PPr)",
            "register_element_cls('w:pStyle',          CT_String)",
            "register_element_cls('w:spacing',         CT_Spacing)",
            "register_element_cls('w:widowControl',    CT_OnOff)",
            "",
            "from .text.run import CT_Br, CT_R, CT_Text",
            "register_element_cls('w:br', CT_Br)",
            "register_element_cls('w:r',  CT_R)",
            "register_element_cls('w:t',  CT_Text)"
        ],
        "afterPatchFile": [
            "# encoding: utf-8",
            "",
            "\"\"\"",
            "Initializes oxml sub-package, including registering custom element classes",
            "corresponding to Open XML elements.",
            "\"\"\"",
            "",
            "from __future__ import absolute_import",
            "",
            "from lxml import etree",
            "",
            "from .ns import NamespacePrefixedTag, nsmap",
            "",
            "",
            "# configure XML parser",
            "element_class_lookup = etree.ElementNamespaceClassLookup()",
            "oxml_parser = etree.XMLParser(remove_blank_text=True, resolve_entities=False)",
            "oxml_parser.set_element_class_lookup(element_class_lookup)",
            "",
            "",
            "def parse_xml(xml):",
            "    \"\"\"",
            "    Return root lxml element obtained by parsing XML character string in",
            "    *xml*, which can be either a Python 2.x string or unicode. The custom",
            "    parser is used, so custom element classes are produced for elements in",
            "    *xml* that have them.",
            "    \"\"\"",
            "    root_element = etree.fromstring(xml, oxml_parser)",
            "    return root_element",
            "",
            "",
            "def register_element_cls(tag, cls):",
            "    \"\"\"",
            "    Register *cls* to be constructed when the oxml parser encounters an",
            "    element with matching *tag*. *tag* is a string of the form",
            "    ``nspfx:tagroot``, e.g. ``'w:document'``.",
            "    \"\"\"",
            "    nspfx, tagroot = tag.split(':')",
            "    namespace = element_class_lookup.get_namespace(nsmap[nspfx])",
            "    namespace[tagroot] = cls",
            "",
            "",
            "def OxmlElement(nsptag_str, attrs=None, nsdecls=None):",
            "    \"\"\"",
            "    Return a 'loose' lxml element having the tag specified by *nsptag_str*.",
            "    *nsptag_str* must contain the standard namespace prefix, e.g. 'a:tbl'.",
            "    The resulting element is an instance of the custom element class for this",
            "    tag name if one is defined. A dictionary of attribute values may be",
            "    provided as *attrs*; they are set if present. All namespaces defined in",
            "    the dict *nsdecls* are declared in the element using the key as the",
            "    prefix and the value as the namespace name. If *nsdecls* is not provided,",
            "    a single namespace declaration is added based on the prefix on",
            "    *nsptag_str*.",
            "    \"\"\"",
            "    nsptag = NamespacePrefixedTag(nsptag_str)",
            "    if nsdecls is None:",
            "        nsdecls = nsptag.nsmap",
            "    return oxml_parser.makeelement(",
            "        nsptag.clark_name, attrib=attrs, nsmap=nsdecls",
            "    )",
            "",
            "",
            "# ===========================================================================",
            "# custom element class mappings",
            "# ===========================================================================",
            "",
            "from .shared import CT_DecimalNumber, CT_OnOff, CT_String",
            "",
            "",
            "from .coreprops import CT_CoreProperties",
            "register_element_cls('cp:coreProperties', CT_CoreProperties)",
            "",
            "from .document import CT_Body, CT_Document",
            "register_element_cls('w:body',     CT_Body)",
            "register_element_cls('w:document', CT_Document)",
            "",
            "from .numbering import (",
            "    CT_Num, CT_Numbering, CT_NumLvl, CT_NumPr",
            ")",
            "register_element_cls('w:abstractNumId', CT_DecimalNumber)",
            "register_element_cls('w:ilvl',          CT_DecimalNumber)",
            "register_element_cls('w:lvlOverride',   CT_NumLvl)",
            "register_element_cls('w:num',           CT_Num)",
            "register_element_cls('w:numId',         CT_DecimalNumber)",
            "register_element_cls('w:numPr',         CT_NumPr)",
            "register_element_cls('w:numbering',     CT_Numbering)",
            "register_element_cls('w:startOverride', CT_DecimalNumber)",
            "",
            "from .section import CT_PageMar, CT_PageSz, CT_SectPr, CT_SectType",
            "register_element_cls('w:pgMar',  CT_PageMar)",
            "register_element_cls('w:pgSz',   CT_PageSz)",
            "register_element_cls('w:sectPr', CT_SectPr)",
            "register_element_cls('w:type',   CT_SectType)",
            "",
            "from .shape import (",
            "    CT_Blip, CT_BlipFillProperties, CT_GraphicalObject,",
            "    CT_GraphicalObjectData, CT_Inline, CT_NonVisualDrawingProps, CT_Picture,",
            "    CT_PictureNonVisual, CT_Point2D, CT_PositiveSize2D, CT_ShapeProperties,",
            "    CT_Transform2D",
            ")",
            "register_element_cls('a:blip',        CT_Blip)",
            "register_element_cls('a:ext',         CT_PositiveSize2D)",
            "register_element_cls('a:graphic',     CT_GraphicalObject)",
            "register_element_cls('a:graphicData', CT_GraphicalObjectData)",
            "register_element_cls('a:off',         CT_Point2D)",
            "register_element_cls('a:xfrm',        CT_Transform2D)",
            "register_element_cls('pic:blipFill',  CT_BlipFillProperties)",
            "register_element_cls('pic:cNvPr',     CT_NonVisualDrawingProps)",
            "register_element_cls('pic:nvPicPr',   CT_PictureNonVisual)",
            "register_element_cls('pic:pic',       CT_Picture)",
            "register_element_cls('pic:spPr',      CT_ShapeProperties)",
            "register_element_cls('wp:docPr',      CT_NonVisualDrawingProps)",
            "register_element_cls('wp:extent',     CT_PositiveSize2D)",
            "register_element_cls('wp:inline',     CT_Inline)",
            "",
            "from .styles import CT_LatentStyles, CT_LsdException, CT_Style, CT_Styles",
            "register_element_cls('w:basedOn',        CT_String)",
            "register_element_cls('w:latentStyles',   CT_LatentStyles)",
            "register_element_cls('w:locked',         CT_OnOff)",
            "register_element_cls('w:lsdException',   CT_LsdException)",
            "register_element_cls('w:name',           CT_String)",
            "register_element_cls('w:next',           CT_String)",
            "register_element_cls('w:qFormat',        CT_OnOff)",
            "register_element_cls('w:semiHidden',     CT_OnOff)",
            "register_element_cls('w:style',          CT_Style)",
            "register_element_cls('w:styles',         CT_Styles)",
            "register_element_cls('w:uiPriority',     CT_DecimalNumber)",
            "register_element_cls('w:unhideWhenUsed', CT_OnOff)",
            "",
            "from .table import (",
            "    CT_Row, CT_Tbl, CT_TblGrid, CT_TblGridCol, CT_TblLayoutType, CT_TblPr,",
            "    CT_TblWidth, CT_Tc, CT_TcPr, CT_VMerge",
            ")",
            "register_element_cls('w:bidiVisual', CT_OnOff)",
            "register_element_cls('w:gridCol',    CT_TblGridCol)",
            "register_element_cls('w:gridSpan',   CT_DecimalNumber)",
            "register_element_cls('w:tbl',        CT_Tbl)",
            "register_element_cls('w:tblGrid',    CT_TblGrid)",
            "register_element_cls('w:tblLayout',  CT_TblLayoutType)",
            "register_element_cls('w:tblPr',      CT_TblPr)",
            "register_element_cls('w:tblStyle',   CT_String)",
            "register_element_cls('w:tc',         CT_Tc)",
            "register_element_cls('w:tcPr',       CT_TcPr)",
            "register_element_cls('w:tcW',        CT_TblWidth)",
            "register_element_cls('w:tr',         CT_Row)",
            "register_element_cls('w:vMerge',     CT_VMerge)",
            "",
            "from .text.font import (",
            "    CT_Color, CT_Fonts, CT_Highlight, CT_HpsMeasure, CT_RPr, CT_Underline,",
            "    CT_VerticalAlignRun",
            ")",
            "register_element_cls('w:b',          CT_OnOff)",
            "register_element_cls('w:bCs',        CT_OnOff)",
            "register_element_cls('w:caps',       CT_OnOff)",
            "register_element_cls('w:color',      CT_Color)",
            "register_element_cls('w:cs',         CT_OnOff)",
            "register_element_cls('w:dstrike',    CT_OnOff)",
            "register_element_cls('w:emboss',     CT_OnOff)",
            "register_element_cls('w:highlight',  CT_Highlight)",
            "register_element_cls('w:i',          CT_OnOff)",
            "register_element_cls('w:iCs',        CT_OnOff)",
            "register_element_cls('w:imprint',    CT_OnOff)",
            "register_element_cls('w:noProof',    CT_OnOff)",
            "register_element_cls('w:oMath',      CT_OnOff)",
            "register_element_cls('w:outline',    CT_OnOff)",
            "register_element_cls('w:rFonts',     CT_Fonts)",
            "register_element_cls('w:rPr',        CT_RPr)",
            "register_element_cls('w:rStyle',     CT_String)",
            "register_element_cls('w:rtl',        CT_OnOff)",
            "register_element_cls('w:shadow',     CT_OnOff)",
            "register_element_cls('w:smallCaps',  CT_OnOff)",
            "register_element_cls('w:snapToGrid', CT_OnOff)",
            "register_element_cls('w:specVanish', CT_OnOff)",
            "register_element_cls('w:strike',     CT_OnOff)",
            "register_element_cls('w:sz',         CT_HpsMeasure)",
            "register_element_cls('w:u',          CT_Underline)",
            "register_element_cls('w:vanish',     CT_OnOff)",
            "register_element_cls('w:vertAlign',  CT_VerticalAlignRun)",
            "register_element_cls('w:webHidden',  CT_OnOff)",
            "",
            "from .text.paragraph import CT_P",
            "register_element_cls('w:p', CT_P)",
            "",
            "from .text.parfmt import CT_Ind, CT_Jc, CT_PPr, CT_Spacing",
            "register_element_cls('w:ind',             CT_Ind)",
            "register_element_cls('w:jc',              CT_Jc)",
            "register_element_cls('w:keepLines',       CT_OnOff)",
            "register_element_cls('w:keepNext',        CT_OnOff)",
            "register_element_cls('w:pageBreakBefore', CT_OnOff)",
            "register_element_cls('w:pPr',             CT_PPr)",
            "register_element_cls('w:pStyle',          CT_String)",
            "register_element_cls('w:spacing',         CT_Spacing)",
            "register_element_cls('w:widowControl',    CT_OnOff)",
            "",
            "from .text.run import CT_Br, CT_R, CT_Text",
            "register_element_cls('w:br', CT_Br)",
            "register_element_cls('w:r',  CT_R)",
            "register_element_cls('w:t',  CT_Text)"
        ],
        "action": [
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "17": [
                "oxml_parser"
            ]
        },
        "addLocation": []
    }
}