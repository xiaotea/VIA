{
    "wagtail/core/forms.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 1,
                "afterPatchRowNumber": 1,
                "PatchRowcode": " from django import forms"
            },
            "1": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2,
                "PatchRowcode": "+from django.utils.crypto import constant_time_compare"
            },
            "2": {
                "beforePatchRowNumber": 2,
                "afterPatchRowNumber": 3,
                "PatchRowcode": " from django.utils.translation import ugettext as _"
            },
            "3": {
                "beforePatchRowNumber": 3,
                "afterPatchRowNumber": 4,
                "PatchRowcode": " from django.utils.translation import ugettext_lazy"
            },
            "4": {
                "beforePatchRowNumber": 4,
                "afterPatchRowNumber": 5,
                "PatchRowcode": " "
            },
            "5": {
                "beforePatchRowNumber": 13,
                "afterPatchRowNumber": 14,
                "PatchRowcode": " "
            },
            "6": {
                "beforePatchRowNumber": 14,
                "afterPatchRowNumber": 15,
                "PatchRowcode": "     def clean_password(self):"
            },
            "7": {
                "beforePatchRowNumber": 15,
                "afterPatchRowNumber": 16,
                "PatchRowcode": "         data = self.cleaned_data['password']"
            },
            "8": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        if data != self.restriction.password:"
            },
            "9": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 17,
                "PatchRowcode": "+        if not constant_time_compare(data, self.restriction.password):"
            },
            "10": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 18,
                "PatchRowcode": "             raise forms.ValidationError(_(\"The password you have entered is not correct. Please try again.\"))"
            },
            "11": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 19,
                "PatchRowcode": " "
            },
            "12": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 20,
                "PatchRowcode": "         return data"
            }
        },
        "frontPatchFile": [
            "from django import forms",
            "from django.utils.translation import ugettext as _",
            "from django.utils.translation import ugettext_lazy",
            "",
            "",
            "class PasswordViewRestrictionForm(forms.Form):",
            "    password = forms.CharField(label=ugettext_lazy(\"Password\"), widget=forms.PasswordInput)",
            "    return_url = forms.CharField(widget=forms.HiddenInput)",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        self.restriction = kwargs.pop('instance')",
            "        super().__init__(*args, **kwargs)",
            "",
            "    def clean_password(self):",
            "        data = self.cleaned_data['password']",
            "        if data != self.restriction.password:",
            "            raise forms.ValidationError(_(\"The password you have entered is not correct. Please try again.\"))",
            "",
            "        return data"
        ],
        "afterPatchFile": [
            "from django import forms",
            "from django.utils.crypto import constant_time_compare",
            "from django.utils.translation import ugettext as _",
            "from django.utils.translation import ugettext_lazy",
            "",
            "",
            "class PasswordViewRestrictionForm(forms.Form):",
            "    password = forms.CharField(label=ugettext_lazy(\"Password\"), widget=forms.PasswordInput)",
            "    return_url = forms.CharField(widget=forms.HiddenInput)",
            "",
            "    def __init__(self, *args, **kwargs):",
            "        self.restriction = kwargs.pop('instance')",
            "        super().__init__(*args, **kwargs)",
            "",
            "    def clean_password(self):",
            "        data = self.cleaned_data['password']",
            "        if not constant_time_compare(data, self.restriction.password):",
            "            raise forms.ValidationError(_(\"The password you have entered is not correct. Please try again.\"))",
            "",
            "        return data"
        ],
        "action": [
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "16": [
                "PasswordViewRestrictionForm",
                "clean_password"
            ]
        },
        "addLocation": []
    }
}