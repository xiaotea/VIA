{
    "saleor/core/middleware.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 1,
                "afterPatchRowNumber": 1,
                "PatchRowcode": " import logging"
            },
            "1": {
                "beforePatchRowNumber": 2,
                "afterPatchRowNumber": 2,
                "PatchRowcode": " from datetime import date"
            },
            "2": {
                "beforePatchRowNumber": 3,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 3,
                "PatchRowcode": "+from functools import wraps"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 4,
                "PatchRowcode": "+from typing import Callable"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 5,
                "PatchRowcode": "+"
            },
            "6": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 6,
                "PatchRowcode": "+import django.contrib.auth.middleware"
            },
            "7": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 7,
                "PatchRowcode": "+import django.contrib.messages.middleware"
            },
            "8": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 8,
                "PatchRowcode": "+import django.contrib.sessions.middleware"
            },
            "9": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 9,
                "PatchRowcode": "+import django.middleware.common"
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 10,
                "PatchRowcode": "+import django.middleware.csrf"
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 11,
                "PatchRowcode": "+import django.middleware.locale"
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 12,
                "PatchRowcode": "+import django.middleware.security"
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 13,
                "PatchRowcode": "+import django_babel.middleware"
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 14,
                "PatchRowcode": "+import impersonate.middleware"
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 15,
                "PatchRowcode": "+import social_django.middleware"
            },
            "16": {
                "beforePatchRowNumber": 4,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " from django.conf import settings"
            },
            "17": {
                "beforePatchRowNumber": 5,
                "afterPatchRowNumber": 17,
                "PatchRowcode": " from django.contrib.sites.models import Site"
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 18,
                "PatchRowcode": "+from django.core.exceptions import MiddlewareNotUsed"
            },
            "19": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 19,
                "PatchRowcode": "+from django.urls import reverse"
            },
            "20": {
                "beforePatchRowNumber": 6,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " from django.utils.functional import SimpleLazyObject"
            },
            "21": {
                "beforePatchRowNumber": 7,
                "afterPatchRowNumber": 21,
                "PatchRowcode": " from django.utils.translation import get_language"
            },
            "22": {
                "beforePatchRowNumber": 8,
                "afterPatchRowNumber": 22,
                "PatchRowcode": " from django_countries.fields import Country"
            },
            "23": {
                "beforePatchRowNumber": 15,
                "afterPatchRowNumber": 29,
                "PatchRowcode": " logger = logging.getLogger(__name__)"
            },
            "24": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 30,
                "PatchRowcode": " "
            },
            "25": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 31,
                "PatchRowcode": " "
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 32,
                "PatchRowcode": "+def django_only_request_handler(get_response: Callable, handler: Callable):"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 33,
                "PatchRowcode": "+    api_path = reverse(\"api\")"
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 34,
                "PatchRowcode": "+"
            },
            "29": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 35,
                "PatchRowcode": "+    @wraps(handler)"
            },
            "30": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 36,
                "PatchRowcode": "+    def handle_request(request):"
            },
            "31": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 37,
                "PatchRowcode": "+        if request.path == api_path:"
            },
            "32": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 38,
                "PatchRowcode": "+            return get_response(request)"
            },
            "33": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 39,
                "PatchRowcode": "+        return handler(request)"
            },
            "34": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 40,
                "PatchRowcode": "+"
            },
            "35": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 41,
                "PatchRowcode": "+    return handle_request"
            },
            "36": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 42,
                "PatchRowcode": "+"
            },
            "37": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 43,
                "PatchRowcode": "+"
            },
            "38": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 44,
                "PatchRowcode": "+def django_only_middleware(middleware):"
            },
            "39": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 45,
                "PatchRowcode": "+    @wraps(middleware)"
            },
            "40": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 46,
                "PatchRowcode": "+    def wrapped(get_response):"
            },
            "41": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 47,
                "PatchRowcode": "+        handler = middleware(get_response)"
            },
            "42": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 48,
                "PatchRowcode": "+        return django_only_request_handler(get_response, handler)"
            },
            "43": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 49,
                "PatchRowcode": "+"
            },
            "44": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 50,
                "PatchRowcode": "+    return wrapped"
            },
            "45": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 51,
                "PatchRowcode": "+"
            },
            "46": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 52,
                "PatchRowcode": "+"
            },
            "47": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 53,
                "PatchRowcode": "+social_auth_exception_middleware = django_only_middleware("
            },
            "48": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 54,
                "PatchRowcode": "+    social_django.middleware.SocialAuthExceptionMiddleware"
            },
            "49": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 55,
                "PatchRowcode": "+)"
            },
            "50": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 56,
                "PatchRowcode": "+impersonate_middleware = django_only_middleware("
            },
            "51": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 57,
                "PatchRowcode": "+    impersonate.middleware.ImpersonateMiddleware"
            },
            "52": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 58,
                "PatchRowcode": "+)"
            },
            "53": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 59,
                "PatchRowcode": "+babel_locale_middleware = django_only_middleware("
            },
            "54": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 60,
                "PatchRowcode": "+    django_babel.middleware.LocaleMiddleware"
            },
            "55": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 61,
                "PatchRowcode": "+)"
            },
            "56": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 62,
                "PatchRowcode": "+django_locale_middleware = django_only_middleware("
            },
            "57": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 63,
                "PatchRowcode": "+    django.middleware.locale.LocaleMiddleware"
            },
            "58": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 64,
                "PatchRowcode": "+)"
            },
            "59": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 65,
                "PatchRowcode": "+django_messages_middleware = django_only_middleware("
            },
            "60": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 66,
                "PatchRowcode": "+    django.contrib.messages.middleware.MessageMiddleware"
            },
            "61": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 67,
                "PatchRowcode": "+)"
            },
            "62": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 68,
                "PatchRowcode": "+django_auth_middleware = django_only_middleware("
            },
            "63": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 69,
                "PatchRowcode": "+    django.contrib.auth.middleware.AuthenticationMiddleware"
            },
            "64": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 70,
                "PatchRowcode": "+)"
            },
            "65": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 71,
                "PatchRowcode": "+django_csrf_view_middleware = django_only_middleware("
            },
            "66": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 72,
                "PatchRowcode": "+    django.middleware.csrf.CsrfViewMiddleware"
            },
            "67": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 73,
                "PatchRowcode": "+)"
            },
            "68": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 74,
                "PatchRowcode": "+django_common_middleware = django_only_middleware("
            },
            "69": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 75,
                "PatchRowcode": "+    django.middleware.common.CommonMiddleware"
            },
            "70": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 76,
                "PatchRowcode": "+)"
            },
            "71": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 77,
                "PatchRowcode": "+django_security_middleware = django_only_middleware("
            },
            "72": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 78,
                "PatchRowcode": "+    django.middleware.security.SecurityMiddleware"
            },
            "73": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 79,
                "PatchRowcode": "+)"
            },
            "74": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 80,
                "PatchRowcode": "+django_session_middleware = django_only_middleware("
            },
            "75": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 81,
                "PatchRowcode": "+    django.contrib.sessions.middleware.SessionMiddleware"
            },
            "76": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 82,
                "PatchRowcode": "+)"
            },
            "77": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 83,
                "PatchRowcode": "+"
            },
            "78": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 84,
                "PatchRowcode": "+"
            },
            "79": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 85,
                "PatchRowcode": "+@django_only_middleware"
            },
            "80": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 86,
                "PatchRowcode": " def google_analytics(get_response):"
            },
            "81": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 87,
                "PatchRowcode": "     \"\"\"Report a page view to Google Analytics.\"\"\""
            },
            "82": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 88,
                "PatchRowcode": " "
            },
            "83": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 89,
                "PatchRowcode": "+    if not settings.GOOGLE_ANALYTICS_TRACKING_ID:"
            },
            "84": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 90,
                "PatchRowcode": "+        raise MiddlewareNotUsed()"
            },
            "85": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 91,
                "PatchRowcode": "+"
            },
            "86": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 92,
                "PatchRowcode": "     def middleware(request):"
            },
            "87": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": 93,
                "PatchRowcode": "         client_id = analytics.get_client_id(request)"
            },
            "88": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": 94,
                "PatchRowcode": "         path = request.path"
            },
            "89": {
                "beforePatchRowNumber": 38,
                "afterPatchRowNumber": 109,
                "PatchRowcode": "     \"\"\"Assign active discounts to `request.discounts`.\"\"\""
            },
            "90": {
                "beforePatchRowNumber": 39,
                "afterPatchRowNumber": 110,
                "PatchRowcode": " "
            },
            "91": {
                "beforePatchRowNumber": 40,
                "afterPatchRowNumber": 111,
                "PatchRowcode": "     def middleware(request):"
            },
            "92": {
                "beforePatchRowNumber": 41,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        discounts = Sale.objects.active(date.today()).prefetch_related("
            },
            "93": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 112,
                "PatchRowcode": "+        request.discounts = Sale.objects.active(date.today()).prefetch_related("
            },
            "94": {
                "beforePatchRowNumber": 42,
                "afterPatchRowNumber": 113,
                "PatchRowcode": "             \"products\", \"categories\", \"collections\""
            },
            "95": {
                "beforePatchRowNumber": 43,
                "afterPatchRowNumber": 114,
                "PatchRowcode": "         )"
            },
            "96": {
                "beforePatchRowNumber": 44,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        request.discounts = discounts"
            },
            "97": {
                "beforePatchRowNumber": 45,
                "afterPatchRowNumber": 115,
                "PatchRowcode": "         return get_response(request)"
            },
            "98": {
                "beforePatchRowNumber": 46,
                "afterPatchRowNumber": 116,
                "PatchRowcode": " "
            },
            "99": {
                "beforePatchRowNumber": 47,
                "afterPatchRowNumber": 117,
                "PatchRowcode": "     return middleware"
            },
            "100": {
                "beforePatchRowNumber": 83,
                "afterPatchRowNumber": 153,
                "PatchRowcode": "     the cache. Using this middleware solves this problem."
            },
            "101": {
                "beforePatchRowNumber": 84,
                "afterPatchRowNumber": 154,
                "PatchRowcode": "     \"\"\""
            },
            "102": {
                "beforePatchRowNumber": 85,
                "afterPatchRowNumber": 155,
                "PatchRowcode": " "
            },
            "103": {
                "beforePatchRowNumber": 86,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    def middleware(request):"
            },
            "104": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 156,
                "PatchRowcode": "+    def _get_site():"
            },
            "105": {
                "beforePatchRowNumber": 87,
                "afterPatchRowNumber": 157,
                "PatchRowcode": "         Site.objects.clear_cache()"
            },
            "106": {
                "beforePatchRowNumber": 88,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        request.site = Site.objects.get_current()"
            },
            "107": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 158,
                "PatchRowcode": "+        return Site.objects.get_current()"
            },
            "108": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 159,
                "PatchRowcode": "+"
            },
            "109": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 160,
                "PatchRowcode": "+    def middleware(request):"
            },
            "110": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 161,
                "PatchRowcode": "+        request.site = SimpleLazyObject(_get_site)"
            },
            "111": {
                "beforePatchRowNumber": 89,
                "afterPatchRowNumber": 162,
                "PatchRowcode": "         return get_response(request)"
            },
            "112": {
                "beforePatchRowNumber": 90,
                "afterPatchRowNumber": 163,
                "PatchRowcode": " "
            },
            "113": {
                "beforePatchRowNumber": 91,
                "afterPatchRowNumber": 164,
                "PatchRowcode": "     return middleware"
            }
        },
        "frontPatchFile": [
            "import logging",
            "from datetime import date",
            "",
            "from django.conf import settings",
            "from django.contrib.sites.models import Site",
            "from django.utils.functional import SimpleLazyObject",
            "from django.utils.translation import get_language",
            "from django_countries.fields import Country",
            "",
            "from ..discount.models import Sale",
            "from . import analytics",
            "from .utils import get_client_ip, get_country_by_ip, get_currency_for_country",
            "from .utils.taxes import get_taxes_for_country",
            "",
            "logger = logging.getLogger(__name__)",
            "",
            "",
            "def google_analytics(get_response):",
            "    \"\"\"Report a page view to Google Analytics.\"\"\"",
            "",
            "    def middleware(request):",
            "        client_id = analytics.get_client_id(request)",
            "        path = request.path",
            "        language = get_language()",
            "        headers = request.META",
            "        try:",
            "            analytics.report_view(",
            "                client_id, path=path, language=language, headers=headers",
            "            )",
            "        except Exception:",
            "            logger.exception(\"Unable to update analytics\")",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def discounts(get_response):",
            "    \"\"\"Assign active discounts to `request.discounts`.\"\"\"",
            "",
            "    def middleware(request):",
            "        discounts = Sale.objects.active(date.today()).prefetch_related(",
            "            \"products\", \"categories\", \"collections\"",
            "        )",
            "        request.discounts = discounts",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def country(get_response):",
            "    \"\"\"Detect the user's country and assign it to `request.country`.\"\"\"",
            "",
            "    def middleware(request):",
            "        client_ip = get_client_ip(request)",
            "        if client_ip:",
            "            request.country = get_country_by_ip(client_ip)",
            "        if not request.country:",
            "            request.country = Country(settings.DEFAULT_COUNTRY)",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def currency(get_response):",
            "    \"\"\"Take a country and assign a matching currency to `request.currency`.\"\"\"",
            "",
            "    def middleware(request):",
            "        if hasattr(request, \"country\") and request.country is not None:",
            "            request.currency = get_currency_for_country(request.country)",
            "        else:",
            "            request.currency = settings.DEFAULT_CURRENCY",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def site(get_response):",
            "    \"\"\"Clear the Sites cache and assign the current site to `request.site`.",
            "",
            "    By default django.contrib.sites caches Site instances at the module",
            "    level. This leads to problems when updating Site instances, as it's",
            "    required to restart all application servers in order to invalidate",
            "    the cache. Using this middleware solves this problem.",
            "    \"\"\"",
            "",
            "    def middleware(request):",
            "        Site.objects.clear_cache()",
            "        request.site = Site.objects.get_current()",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def taxes(get_response):",
            "    \"\"\"Assign tax rates for default country to `request.taxes`.\"\"\"",
            "",
            "    def middleware(request):",
            "        if settings.VATLAYER_ACCESS_KEY:",
            "            request.taxes = SimpleLazyObject(",
            "                lambda: get_taxes_for_country(request.country)",
            "            )",
            "        else:",
            "            request.taxes = None",
            "        return get_response(request)",
            "",
            "    return middleware"
        ],
        "afterPatchFile": [
            "import logging",
            "from datetime import date",
            "from functools import wraps",
            "from typing import Callable",
            "",
            "import django.contrib.auth.middleware",
            "import django.contrib.messages.middleware",
            "import django.contrib.sessions.middleware",
            "import django.middleware.common",
            "import django.middleware.csrf",
            "import django.middleware.locale",
            "import django.middleware.security",
            "import django_babel.middleware",
            "import impersonate.middleware",
            "import social_django.middleware",
            "from django.conf import settings",
            "from django.contrib.sites.models import Site",
            "from django.core.exceptions import MiddlewareNotUsed",
            "from django.urls import reverse",
            "from django.utils.functional import SimpleLazyObject",
            "from django.utils.translation import get_language",
            "from django_countries.fields import Country",
            "",
            "from ..discount.models import Sale",
            "from . import analytics",
            "from .utils import get_client_ip, get_country_by_ip, get_currency_for_country",
            "from .utils.taxes import get_taxes_for_country",
            "",
            "logger = logging.getLogger(__name__)",
            "",
            "",
            "def django_only_request_handler(get_response: Callable, handler: Callable):",
            "    api_path = reverse(\"api\")",
            "",
            "    @wraps(handler)",
            "    def handle_request(request):",
            "        if request.path == api_path:",
            "            return get_response(request)",
            "        return handler(request)",
            "",
            "    return handle_request",
            "",
            "",
            "def django_only_middleware(middleware):",
            "    @wraps(middleware)",
            "    def wrapped(get_response):",
            "        handler = middleware(get_response)",
            "        return django_only_request_handler(get_response, handler)",
            "",
            "    return wrapped",
            "",
            "",
            "social_auth_exception_middleware = django_only_middleware(",
            "    social_django.middleware.SocialAuthExceptionMiddleware",
            ")",
            "impersonate_middleware = django_only_middleware(",
            "    impersonate.middleware.ImpersonateMiddleware",
            ")",
            "babel_locale_middleware = django_only_middleware(",
            "    django_babel.middleware.LocaleMiddleware",
            ")",
            "django_locale_middleware = django_only_middleware(",
            "    django.middleware.locale.LocaleMiddleware",
            ")",
            "django_messages_middleware = django_only_middleware(",
            "    django.contrib.messages.middleware.MessageMiddleware",
            ")",
            "django_auth_middleware = django_only_middleware(",
            "    django.contrib.auth.middleware.AuthenticationMiddleware",
            ")",
            "django_csrf_view_middleware = django_only_middleware(",
            "    django.middleware.csrf.CsrfViewMiddleware",
            ")",
            "django_common_middleware = django_only_middleware(",
            "    django.middleware.common.CommonMiddleware",
            ")",
            "django_security_middleware = django_only_middleware(",
            "    django.middleware.security.SecurityMiddleware",
            ")",
            "django_session_middleware = django_only_middleware(",
            "    django.contrib.sessions.middleware.SessionMiddleware",
            ")",
            "",
            "",
            "@django_only_middleware",
            "def google_analytics(get_response):",
            "    \"\"\"Report a page view to Google Analytics.\"\"\"",
            "",
            "    if not settings.GOOGLE_ANALYTICS_TRACKING_ID:",
            "        raise MiddlewareNotUsed()",
            "",
            "    def middleware(request):",
            "        client_id = analytics.get_client_id(request)",
            "        path = request.path",
            "        language = get_language()",
            "        headers = request.META",
            "        try:",
            "            analytics.report_view(",
            "                client_id, path=path, language=language, headers=headers",
            "            )",
            "        except Exception:",
            "            logger.exception(\"Unable to update analytics\")",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def discounts(get_response):",
            "    \"\"\"Assign active discounts to `request.discounts`.\"\"\"",
            "",
            "    def middleware(request):",
            "        request.discounts = Sale.objects.active(date.today()).prefetch_related(",
            "            \"products\", \"categories\", \"collections\"",
            "        )",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def country(get_response):",
            "    \"\"\"Detect the user's country and assign it to `request.country`.\"\"\"",
            "",
            "    def middleware(request):",
            "        client_ip = get_client_ip(request)",
            "        if client_ip:",
            "            request.country = get_country_by_ip(client_ip)",
            "        if not request.country:",
            "            request.country = Country(settings.DEFAULT_COUNTRY)",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def currency(get_response):",
            "    \"\"\"Take a country and assign a matching currency to `request.currency`.\"\"\"",
            "",
            "    def middleware(request):",
            "        if hasattr(request, \"country\") and request.country is not None:",
            "            request.currency = get_currency_for_country(request.country)",
            "        else:",
            "            request.currency = settings.DEFAULT_CURRENCY",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def site(get_response):",
            "    \"\"\"Clear the Sites cache and assign the current site to `request.site`.",
            "",
            "    By default django.contrib.sites caches Site instances at the module",
            "    level. This leads to problems when updating Site instances, as it's",
            "    required to restart all application servers in order to invalidate",
            "    the cache. Using this middleware solves this problem.",
            "    \"\"\"",
            "",
            "    def _get_site():",
            "        Site.objects.clear_cache()",
            "        return Site.objects.get_current()",
            "",
            "    def middleware(request):",
            "        request.site = SimpleLazyObject(_get_site)",
            "        return get_response(request)",
            "",
            "    return middleware",
            "",
            "",
            "def taxes(get_response):",
            "    \"\"\"Assign tax rates for default country to `request.taxes`.\"\"\"",
            "",
            "    def middleware(request):",
            "        if settings.VATLAYER_ACCESS_KEY:",
            "            request.taxes = SimpleLazyObject(",
            "                lambda: get_taxes_for_country(request.country)",
            "            )",
            "        else:",
            "            request.taxes = None",
            "        return get_response(request)",
            "",
            "    return middleware"
        ],
        "action": [
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "3": [],
            "41": [
                "discounts",
                "middleware"
            ],
            "44": [
                "discounts",
                "middleware"
            ],
            "86": [
                "site",
                "middleware"
            ],
            "88": [
                "site",
                "middleware"
            ]
        },
        "addLocation": []
    },
    "saleor/graphql/middleware.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 1,
                "PatchRowcode": "+from functools import wraps"
            },
            "1": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2,
                "PatchRowcode": "+from typing import Callable"
            },
            "2": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 3,
                "PatchRowcode": "+"
            },
            "3": {
                "beforePatchRowNumber": 1,
                "afterPatchRowNumber": 4,
                "PatchRowcode": " from django.contrib.auth.models import AnonymousUser"
            },
            "4": {
                "beforePatchRowNumber": 2,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-from django.shortcuts import reverse"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 5,
                "PatchRowcode": "+from django.urls import reverse"
            },
            "6": {
                "beforePatchRowNumber": 3,
                "afterPatchRowNumber": 6,
                "PatchRowcode": " from graphene_django.settings import graphene_settings"
            },
            "7": {
                "beforePatchRowNumber": 4,
                "afterPatchRowNumber": 7,
                "PatchRowcode": " from graphql_jwt.middleware import JSONWebTokenMiddleware"
            },
            "8": {
                "beforePatchRowNumber": 5,
                "afterPatchRowNumber": 8,
                "PatchRowcode": " "
            },
            "9": {
                "beforePatchRowNumber": 6,
                "afterPatchRowNumber": 9,
                "PatchRowcode": " "
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 10,
                "PatchRowcode": "+def api_only_request_handler(get_response: Callable, handler: Callable):"
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 11,
                "PatchRowcode": "+    @wraps(handler)"
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 12,
                "PatchRowcode": "+    def handle_request(request):"
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 13,
                "PatchRowcode": "+        api_path = reverse(\"api\")"
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 14,
                "PatchRowcode": "+        if request.path != api_path:"
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 15,
                "PatchRowcode": "+            return get_response(request)"
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 16,
                "PatchRowcode": "+        return handler(request)"
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 17,
                "PatchRowcode": "+"
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 18,
                "PatchRowcode": "+    return handle_request"
            },
            "19": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 19,
                "PatchRowcode": "+"
            },
            "20": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 20,
                "PatchRowcode": "+"
            },
            "21": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 21,
                "PatchRowcode": "+def api_only_middleware(middleware):"
            },
            "22": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 22,
                "PatchRowcode": "+    @wraps(middleware)"
            },
            "23": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 23,
                "PatchRowcode": "+    def wrapped(get_response):"
            },
            "24": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 24,
                "PatchRowcode": "+        handler = middleware(get_response)"
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 25,
                "PatchRowcode": "+        return api_only_request_handler(get_response, handler)"
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 26,
                "PatchRowcode": "+"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 27,
                "PatchRowcode": "+    return wrapped"
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 28,
                "PatchRowcode": "+"
            },
            "29": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 29,
                "PatchRowcode": "+"
            },
            "30": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 30,
                "PatchRowcode": "+@api_only_middleware"
            },
            "31": {
                "beforePatchRowNumber": 7,
                "afterPatchRowNumber": 31,
                "PatchRowcode": " def jwt_middleware(get_response):"
            },
            "32": {
                "beforePatchRowNumber": 8,
                "afterPatchRowNumber": 32,
                "PatchRowcode": "     \"\"\"Authenticate user using JSONWebTokenMiddleware"
            },
            "33": {
                "beforePatchRowNumber": 9,
                "afterPatchRowNumber": 33,
                "PatchRowcode": "     ignoring the session-based authentication."
            },
            "34": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 42,
                "PatchRowcode": "     graphene_settings.MIDDLEWARE.remove(JSONWebTokenMiddleware)"
            },
            "35": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 43,
                "PatchRowcode": " "
            },
            "36": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 44,
                "PatchRowcode": "     def middleware(request):"
            },
            "37": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        if request.path == reverse(\"api\"):"
            },
            "38": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            # clear user authenticated by AuthenticationMiddleware"
            },
            "39": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            request._cached_user = AnonymousUser()"
            },
            "40": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            request.user = AnonymousUser()"
            },
            "41": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 45,
                "PatchRowcode": "+        # clear user authenticated by AuthenticationMiddleware"
            },
            "42": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 46,
                "PatchRowcode": "+        request._cached_user = AnonymousUser()"
            },
            "43": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 47,
                "PatchRowcode": "+        request.user = AnonymousUser()"
            },
            "44": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 48,
                "PatchRowcode": " "
            },
            "45": {
                "beforePatchRowNumber": 26,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            # authenticate using JWT middleware"
            },
            "46": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            jwt_middleware_inst.process_request(request)"
            },
            "47": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 49,
                "PatchRowcode": "+        # authenticate using JWT middleware"
            },
            "48": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 50,
                "PatchRowcode": "+        jwt_middleware_inst.process_request(request)"
            },
            "49": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": 51,
                "PatchRowcode": "         return get_response(request)"
            },
            "50": {
                "beforePatchRowNumber": 29,
                "afterPatchRowNumber": 52,
                "PatchRowcode": " "
            },
            "51": {
                "beforePatchRowNumber": 30,
                "afterPatchRowNumber": 53,
                "PatchRowcode": "     return middleware"
            }
        },
        "frontPatchFile": [
            "from django.contrib.auth.models import AnonymousUser",
            "from django.shortcuts import reverse",
            "from graphene_django.settings import graphene_settings",
            "from graphql_jwt.middleware import JSONWebTokenMiddleware",
            "",
            "",
            "def jwt_middleware(get_response):",
            "    \"\"\"Authenticate user using JSONWebTokenMiddleware",
            "    ignoring the session-based authentication.",
            "",
            "    This middleware resets authentication made by any previous middlewares",
            "    and authenticates the user",
            "    with graphql_jwt.middleware.JSONWebTokenMiddleware.",
            "    \"\"\"",
            "    # Disable warnings for django-graphene-jwt",
            "    graphene_settings.MIDDLEWARE.append(JSONWebTokenMiddleware)",
            "    jwt_middleware_inst = JSONWebTokenMiddleware(get_response=get_response)",
            "    graphene_settings.MIDDLEWARE.remove(JSONWebTokenMiddleware)",
            "",
            "    def middleware(request):",
            "        if request.path == reverse(\"api\"):",
            "            # clear user authenticated by AuthenticationMiddleware",
            "            request._cached_user = AnonymousUser()",
            "            request.user = AnonymousUser()",
            "",
            "            # authenticate using JWT middleware",
            "            jwt_middleware_inst.process_request(request)",
            "        return get_response(request)",
            "",
            "    return middleware"
        ],
        "afterPatchFile": [
            "from functools import wraps",
            "from typing import Callable",
            "",
            "from django.contrib.auth.models import AnonymousUser",
            "from django.urls import reverse",
            "from graphene_django.settings import graphene_settings",
            "from graphql_jwt.middleware import JSONWebTokenMiddleware",
            "",
            "",
            "def api_only_request_handler(get_response: Callable, handler: Callable):",
            "    @wraps(handler)",
            "    def handle_request(request):",
            "        api_path = reverse(\"api\")",
            "        if request.path != api_path:",
            "            return get_response(request)",
            "        return handler(request)",
            "",
            "    return handle_request",
            "",
            "",
            "def api_only_middleware(middleware):",
            "    @wraps(middleware)",
            "    def wrapped(get_response):",
            "        handler = middleware(get_response)",
            "        return api_only_request_handler(get_response, handler)",
            "",
            "    return wrapped",
            "",
            "",
            "@api_only_middleware",
            "def jwt_middleware(get_response):",
            "    \"\"\"Authenticate user using JSONWebTokenMiddleware",
            "    ignoring the session-based authentication.",
            "",
            "    This middleware resets authentication made by any previous middlewares",
            "    and authenticates the user",
            "    with graphql_jwt.middleware.JSONWebTokenMiddleware.",
            "    \"\"\"",
            "    # Disable warnings for django-graphene-jwt",
            "    graphene_settings.MIDDLEWARE.append(JSONWebTokenMiddleware)",
            "    jwt_middleware_inst = JSONWebTokenMiddleware(get_response=get_response)",
            "    graphene_settings.MIDDLEWARE.remove(JSONWebTokenMiddleware)",
            "",
            "    def middleware(request):",
            "        # clear user authenticated by AuthenticationMiddleware",
            "        request._cached_user = AnonymousUser()",
            "        request.user = AnonymousUser()",
            "",
            "        # authenticate using JWT middleware",
            "        jwt_middleware_inst.process_request(request)",
            "        return get_response(request)",
            "",
            "    return middleware"
        ],
        "action": [
            "-1",
            "-1",
            "-1",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "2": [],
            "21": [
                "jwt_middleware",
                "middleware"
            ],
            "22": [
                "jwt_middleware",
                "middleware"
            ],
            "23": [
                "jwt_middleware",
                "middleware"
            ],
            "24": [
                "jwt_middleware",
                "middleware"
            ],
            "26": [
                "jwt_middleware",
                "middleware"
            ],
            "27": [
                "jwt_middleware",
                "middleware"
            ]
        },
        "addLocation": []
    },
    "saleor/settings.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 195,
                "afterPatchRowNumber": 195,
                "PatchRowcode": " SECRET_KEY = os.environ.get(\"SECRET_KEY\")"
            },
            "1": {
                "beforePatchRowNumber": 196,
                "afterPatchRowNumber": 196,
                "PatchRowcode": " "
            },
            "2": {
                "beforePatchRowNumber": 197,
                "afterPatchRowNumber": 197,
                "PatchRowcode": " MIDDLEWARE = ["
            },
            "3": {
                "beforePatchRowNumber": 198,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"django.contrib.sessions.middleware.SessionMiddleware\","
            },
            "4": {
                "beforePatchRowNumber": 199,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"django.middleware.security.SecurityMiddleware\","
            },
            "5": {
                "beforePatchRowNumber": 200,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"django.middleware.common.CommonMiddleware\","
            },
            "6": {
                "beforePatchRowNumber": 201,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"django.middleware.csrf.CsrfViewMiddleware\","
            },
            "7": {
                "beforePatchRowNumber": 202,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"django.contrib.auth.middleware.AuthenticationMiddleware\","
            },
            "8": {
                "beforePatchRowNumber": 203,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"django.contrib.messages.middleware.MessageMiddleware\","
            },
            "9": {
                "beforePatchRowNumber": 204,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"django.middleware.locale.LocaleMiddleware\","
            },
            "10": {
                "beforePatchRowNumber": 205,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"django_babel.middleware.LocaleMiddleware\","
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 198,
                "PatchRowcode": "+    \"saleor.core.middleware.django_session_middleware\","
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 199,
                "PatchRowcode": "+    \"saleor.core.middleware.django_security_middleware\","
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 200,
                "PatchRowcode": "+    \"saleor.core.middleware.django_common_middleware\","
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 201,
                "PatchRowcode": "+    \"saleor.core.middleware.django_csrf_view_middleware\","
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 202,
                "PatchRowcode": "+    \"saleor.core.middleware.django_auth_middleware\","
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 203,
                "PatchRowcode": "+    \"saleor.core.middleware.django_messages_middleware\","
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 204,
                "PatchRowcode": "+    \"saleor.core.middleware.django_locale_middleware\","
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 205,
                "PatchRowcode": "+    \"saleor.core.middleware.babel_locale_middleware\","
            },
            "19": {
                "beforePatchRowNumber": 206,
                "afterPatchRowNumber": 206,
                "PatchRowcode": "     \"saleor.core.middleware.discounts\","
            },
            "20": {
                "beforePatchRowNumber": 207,
                "afterPatchRowNumber": 207,
                "PatchRowcode": "     \"saleor.core.middleware.google_analytics\","
            },
            "21": {
                "beforePatchRowNumber": 208,
                "afterPatchRowNumber": 208,
                "PatchRowcode": "     \"saleor.core.middleware.country\","
            },
            "22": {
                "beforePatchRowNumber": 209,
                "afterPatchRowNumber": 209,
                "PatchRowcode": "     \"saleor.core.middleware.currency\","
            },
            "23": {
                "beforePatchRowNumber": 210,
                "afterPatchRowNumber": 210,
                "PatchRowcode": "     \"saleor.core.middleware.site\","
            },
            "24": {
                "beforePatchRowNumber": 211,
                "afterPatchRowNumber": 211,
                "PatchRowcode": "     \"saleor.core.middleware.taxes\","
            },
            "25": {
                "beforePatchRowNumber": 212,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"social_django.middleware.SocialAuthExceptionMiddleware\","
            },
            "26": {
                "beforePatchRowNumber": 213,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"impersonate.middleware.ImpersonateMiddleware\","
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 212,
                "PatchRowcode": "+    \"saleor.core.middleware.social_auth_exception_middleware\","
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 213,
                "PatchRowcode": "+    \"saleor.core.middleware.impersonate_middleware\","
            },
            "29": {
                "beforePatchRowNumber": 214,
                "afterPatchRowNumber": 214,
                "PatchRowcode": "     \"saleor.graphql.middleware.jwt_middleware\","
            },
            "30": {
                "beforePatchRowNumber": 215,
                "afterPatchRowNumber": 215,
                "PatchRowcode": " ]"
            },
            "31": {
                "beforePatchRowNumber": 216,
                "afterPatchRowNumber": 216,
                "PatchRowcode": " "
            }
        },
        "frontPatchFile": [
            "import ast",
            "import os.path",
            "",
            "import dj_database_url",
            "import dj_email_url",
            "import django_cache_url",
            "from django.contrib.messages import constants as messages",
            "from django.utils.translation import gettext_lazy as _, pgettext_lazy",
            "from django_prices.templatetags.prices_i18n import get_currency_fraction",
            "",
            "from . import __version__",
            "",
            "",
            "def get_list(text):",
            "    return [item.strip() for item in text.split(\",\")]",
            "",
            "",
            "def get_bool_from_env(name, default_value):",
            "    if name in os.environ:",
            "        value = os.environ[name]",
            "        try:",
            "            return ast.literal_eval(value)",
            "        except ValueError as e:",
            "            raise ValueError(\"{} is an invalid value for {}\".format(value, name)) from e",
            "    return default_value",
            "",
            "",
            "DEBUG = get_bool_from_env(\"DEBUG\", True)",
            "",
            "SITE_ID = 1",
            "",
            "PROJECT_ROOT = os.path.normpath(os.path.join(os.path.dirname(__file__), \"..\"))",
            "",
            "ROOT_URLCONF = \"saleor.urls\"",
            "",
            "WSGI_APPLICATION = \"saleor.wsgi.application\"",
            "",
            "ADMINS = (",
            "    # ('Your Name', 'your_email@example.com'),",
            ")",
            "MANAGERS = ADMINS",
            "",
            "INTERNAL_IPS = get_list(os.environ.get(\"INTERNAL_IPS\", \"127.0.0.1\"))",
            "",
            "# Some cloud providers (Heroku) export REDIS_URL variable instead of CACHE_URL",
            "REDIS_URL = os.environ.get(\"REDIS_URL\")",
            "if REDIS_URL:",
            "    CACHE_URL = os.environ.setdefault(\"CACHE_URL\", REDIS_URL)",
            "CACHES = {\"default\": django_cache_url.config()}",
            "",
            "DATABASES = {",
            "    \"default\": dj_database_url.config(",
            "        default=\"postgres://saleor:saleor@localhost:5432/saleor\", conn_max_age=600",
            "    )",
            "}",
            "",
            "",
            "TIME_ZONE = \"America/Chicago\"",
            "LANGUAGE_CODE = \"en\"",
            "LANGUAGES = [",
            "    (\"ar\", _(\"Arabic\")),",
            "    (\"az\", _(\"Azerbaijani\")),",
            "    (\"bg\", _(\"Bulgarian\")),",
            "    (\"bn\", _(\"Bengali\")),",
            "    (\"ca\", _(\"Catalan\")),",
            "    (\"cs\", _(\"Czech\")),",
            "    (\"da\", _(\"Danish\")),",
            "    (\"de\", _(\"German\")),",
            "    (\"en\", _(\"English\")),",
            "    (\"es\", _(\"Spanish\")),",
            "    (\"es-co\", _(\"Colombian Spanish\")),",
            "    (\"et\", _(\"Estonian\")),",
            "    (\"fa\", _(\"Persian\")),",
            "    (\"fr\", _(\"French\")),",
            "    (\"hi\", _(\"Hindi\")),",
            "    (\"hu\", _(\"Hungarian\")),",
            "    (\"hy\", _(\"Armenian\")),",
            "    (\"id\", _(\"Indonesian\")),",
            "    (\"it\", _(\"Italian\")),",
            "    (\"ja\", _(\"Japanese\")),",
            "    (\"ko\", _(\"Korean\")),",
            "    (\"lt\", _(\"Lithuanian\")),",
            "    (\"mn\", _(\"Mongolian\")),",
            "    (\"nb\", _(\"Norwegian\")),",
            "    (\"nl\", _(\"Dutch\")),",
            "    (\"pl\", _(\"Polish\")),",
            "    (\"pt\", _(\"Portuguese\")),",
            "    (\"pt-br\", _(\"Brazilian Portuguese\")),",
            "    (\"ro\", _(\"Romanian\")),",
            "    (\"ru\", _(\"Russian\")),",
            "    (\"sk\", _(\"Slovak\")),",
            "    (\"sq\", _(\"Albanian\")),",
            "    (\"sr\", _(\"Serbian\")),",
            "    (\"sw\", _(\"Swahili\")),",
            "    (\"sv\", _(\"Swedish\")),",
            "    (\"th\", _(\"Thai\")),",
            "    (\"tr\", _(\"Turkish\")),",
            "    (\"uk\", _(\"Ukrainian\")),",
            "    (\"vi\", _(\"Vietnamese\")),",
            "    (\"zh-hans\", _(\"Simplified Chinese\")),",
            "    (\"zh-hant\", _(\"Traditional Chinese\")),",
            "]",
            "LOCALE_PATHS = [os.path.join(PROJECT_ROOT, \"locale\")]",
            "USE_I18N = True",
            "USE_L10N = True",
            "USE_TZ = True",
            "",
            "FORM_RENDERER = \"django.forms.renderers.TemplatesSetting\"",
            "",
            "EMAIL_URL = os.environ.get(\"EMAIL_URL\")",
            "SENDGRID_USERNAME = os.environ.get(\"SENDGRID_USERNAME\")",
            "SENDGRID_PASSWORD = os.environ.get(\"SENDGRID_PASSWORD\")",
            "if not EMAIL_URL and SENDGRID_USERNAME and SENDGRID_PASSWORD:",
            "    EMAIL_URL = \"smtp://%s:%s@smtp.sendgrid.net:587/?tls=True\" % (",
            "        SENDGRID_USERNAME,",
            "        SENDGRID_PASSWORD,",
            "    )",
            "email_config = dj_email_url.parse(EMAIL_URL or \"console://\")",
            "",
            "EMAIL_FILE_PATH = email_config[\"EMAIL_FILE_PATH\"]",
            "EMAIL_HOST_USER = email_config[\"EMAIL_HOST_USER\"]",
            "EMAIL_HOST_PASSWORD = email_config[\"EMAIL_HOST_PASSWORD\"]",
            "EMAIL_HOST = email_config[\"EMAIL_HOST\"]",
            "EMAIL_PORT = email_config[\"EMAIL_PORT\"]",
            "EMAIL_BACKEND = email_config[\"EMAIL_BACKEND\"]",
            "EMAIL_USE_TLS = email_config[\"EMAIL_USE_TLS\"]",
            "EMAIL_USE_SSL = email_config[\"EMAIL_USE_SSL\"]",
            "",
            "ENABLE_SSL = get_bool_from_env(\"ENABLE_SSL\", False)",
            "",
            "if ENABLE_SSL:",
            "    SECURE_SSL_REDIRECT = not DEBUG",
            "",
            "DEFAULT_FROM_EMAIL = os.environ.get(\"DEFAULT_FROM_EMAIL\", EMAIL_HOST_USER)",
            "ORDER_FROM_EMAIL = os.getenv(\"ORDER_FROM_EMAIL\", DEFAULT_FROM_EMAIL)",
            "",
            "MEDIA_ROOT = os.path.join(PROJECT_ROOT, \"media\")",
            "MEDIA_URL = os.environ.get(\"MEDIA_URL\", \"/media/\")",
            "",
            "STATIC_ROOT = os.path.join(PROJECT_ROOT, \"static\")",
            "STATIC_URL = os.environ.get(\"STATIC_URL\", \"/static/\")",
            "STATICFILES_DIRS = [",
            "    (\"assets\", os.path.join(PROJECT_ROOT, \"saleor\", \"static\", \"assets\")),",
            "    (\"favicons\", os.path.join(PROJECT_ROOT, \"saleor\", \"static\", \"favicons\")),",
            "    (\"images\", os.path.join(PROJECT_ROOT, \"saleor\", \"static\", \"images\")),",
            "    (",
            "        \"dashboard/images\",",
            "        os.path.join(PROJECT_ROOT, \"saleor\", \"static\", \"dashboard\", \"images\"),",
            "    ),",
            "]",
            "STATICFILES_FINDERS = [",
            "    \"django.contrib.staticfiles.finders.FileSystemFinder\",",
            "    \"django.contrib.staticfiles.finders.AppDirectoriesFinder\",",
            "]",
            "",
            "context_processors = [",
            "    \"django.contrib.auth.context_processors.auth\",",
            "    \"django.template.context_processors.debug\",",
            "    \"django.template.context_processors.i18n\",",
            "    \"django.template.context_processors.media\",",
            "    \"django.template.context_processors.static\",",
            "    \"django.template.context_processors.tz\",",
            "    \"django.contrib.messages.context_processors.messages\",",
            "    \"django.template.context_processors.request\",",
            "    \"saleor.core.context_processors.default_currency\",",
            "    \"saleor.checkout.context_processors.checkout_counter\",",
            "    \"saleor.core.context_processors.search_enabled\",",
            "    \"saleor.site.context_processors.site\",",
            "    \"social_django.context_processors.backends\",",
            "    \"social_django.context_processors.login_redirect\",",
            "]",
            "",
            "loaders = [",
            "    \"django.template.loaders.filesystem.Loader\",",
            "    \"django.template.loaders.app_directories.Loader\",",
            "]",
            "",
            "if not DEBUG:",
            "    loaders = [(\"django.template.loaders.cached.Loader\", loaders)]",
            "",
            "TEMPLATES = [",
            "    {",
            "        \"BACKEND\": \"django.template.backends.django.DjangoTemplates\",",
            "        \"DIRS\": [os.path.join(PROJECT_ROOT, \"templates\")],",
            "        \"OPTIONS\": {",
            "            \"debug\": DEBUG,",
            "            \"context_processors\": context_processors,",
            "            \"loaders\": loaders,",
            "            \"string_if_invalid\": '<< MISSING VARIABLE \"%s\" >>' if DEBUG else \"\",",
            "        },",
            "    }",
            "]",
            "",
            "# Make this unique, and don't share it with anybody.",
            "SECRET_KEY = os.environ.get(\"SECRET_KEY\")",
            "",
            "MIDDLEWARE = [",
            "    \"django.contrib.sessions.middleware.SessionMiddleware\",",
            "    \"django.middleware.security.SecurityMiddleware\",",
            "    \"django.middleware.common.CommonMiddleware\",",
            "    \"django.middleware.csrf.CsrfViewMiddleware\",",
            "    \"django.contrib.auth.middleware.AuthenticationMiddleware\",",
            "    \"django.contrib.messages.middleware.MessageMiddleware\",",
            "    \"django.middleware.locale.LocaleMiddleware\",",
            "    \"django_babel.middleware.LocaleMiddleware\",",
            "    \"saleor.core.middleware.discounts\",",
            "    \"saleor.core.middleware.google_analytics\",",
            "    \"saleor.core.middleware.country\",",
            "    \"saleor.core.middleware.currency\",",
            "    \"saleor.core.middleware.site\",",
            "    \"saleor.core.middleware.taxes\",",
            "    \"social_django.middleware.SocialAuthExceptionMiddleware\",",
            "    \"impersonate.middleware.ImpersonateMiddleware\",",
            "    \"saleor.graphql.middleware.jwt_middleware\",",
            "]",
            "",
            "INSTALLED_APPS = [",
            "    # External apps that need to go before django's",
            "    \"storages\",",
            "    # Django modules",
            "    \"django.contrib.contenttypes\",",
            "    \"django.contrib.sessions\",",
            "    \"django.contrib.messages\",",
            "    \"django.contrib.sitemaps\",",
            "    \"django.contrib.sites\",",
            "    \"django.contrib.staticfiles\",",
            "    \"django.contrib.auth\",",
            "    \"django.contrib.postgres\",",
            "    \"django.forms\",",
            "    # Local apps",
            "    \"saleor.account\",",
            "    \"saleor.discount\",",
            "    \"saleor.product\",",
            "    \"saleor.checkout\",",
            "    \"saleor.core\",",
            "    \"saleor.graphql\",",
            "    \"saleor.menu\",",
            "    \"saleor.order\",",
            "    \"saleor.dashboard\",",
            "    \"saleor.seo\",",
            "    \"saleor.shipping\",",
            "    \"saleor.search\",",
            "    \"saleor.site\",",
            "    \"saleor.data_feeds\",",
            "    \"saleor.page\",",
            "    \"saleor.payment\",",
            "    # External apps",
            "    \"versatileimagefield\",",
            "    \"django_babel\",",
            "    \"bootstrap4\",",
            "    \"django_measurement\",",
            "    \"django_prices\",",
            "    \"django_prices_openexchangerates\",",
            "    \"django_prices_vatlayer\",",
            "    \"graphene_django\",",
            "    \"mptt\",",
            "    \"webpack_loader\",",
            "    \"social_django\",",
            "    \"django_countries\",",
            "    \"django_filters\",",
            "    \"django_celery_results\",",
            "    \"impersonate\",",
            "    \"phonenumber_field\",",
            "    \"captcha\",",
            "]",
            "",
            "",
            "ENABLE_DEBUG_TOOLBAR = get_bool_from_env(\"ENABLE_DEBUG_TOOLBAR\", False)",
            "if ENABLE_DEBUG_TOOLBAR:",
            "    MIDDLEWARE.append(\"debug_toolbar.middleware.DebugToolbarMiddleware\")",
            "    INSTALLED_APPS.append(\"debug_toolbar\")",
            "    DEBUG_TOOLBAR_PANELS = [",
            "        # adds a request history to the debug toolbar",
            "        \"ddt_request_history.panels.request_history.RequestHistoryPanel\",",
            "        \"debug_toolbar.panels.versions.VersionsPanel\",",
            "        \"debug_toolbar.panels.timer.TimerPanel\",",
            "        \"debug_toolbar.panels.settings.SettingsPanel\",",
            "        \"debug_toolbar.panels.headers.HeadersPanel\",",
            "        \"debug_toolbar.panels.request.RequestPanel\",",
            "        \"debug_toolbar.panels.sql.SQLPanel\",",
            "        \"debug_toolbar.panels.templates.TemplatesPanel\",",
            "        \"debug_toolbar.panels.staticfiles.StaticFilesPanel\",",
            "        \"debug_toolbar.panels.cache.CachePanel\",",
            "        \"debug_toolbar.panels.signals.SignalsPanel\",",
            "        \"debug_toolbar.panels.logging.LoggingPanel\",",
            "        \"debug_toolbar.panels.redirects.RedirectsPanel\",",
            "        \"debug_toolbar.panels.profiling.ProfilingPanel\",",
            "    ]",
            "    DEBUG_TOOLBAR_CONFIG = {\"RESULTS_CACHE_SIZE\": 100}",
            "",
            "ENABLE_SILK = get_bool_from_env(\"ENABLE_SILK\", False)",
            "if ENABLE_SILK:",
            "    MIDDLEWARE.insert(0, \"silk.middleware.SilkyMiddleware\")",
            "    INSTALLED_APPS.append(\"silk\")",
            "",
            "LOGGING = {",
            "    \"version\": 1,",
            "    \"disable_existing_loggers\": False,",
            "    \"root\": {\"level\": \"INFO\", \"handlers\": [\"console\"]},",
            "    \"formatters\": {",
            "        \"verbose\": {",
            "            \"format\": (",
            "                \"%(levelname)s %(name)s %(message)s\" \" [PID:%(process)d:%(threadName)s]\"",
            "            )",
            "        },",
            "        \"simple\": {\"format\": \"%(levelname)s %(message)s\"},",
            "    },",
            "    \"filters\": {\"require_debug_false\": {\"()\": \"django.utils.log.RequireDebugFalse\"}},",
            "    \"handlers\": {",
            "        \"mail_admins\": {",
            "            \"level\": \"ERROR\",",
            "            \"filters\": [\"require_debug_false\"],",
            "            \"class\": \"django.utils.log.AdminEmailHandler\",",
            "        },",
            "        \"console\": {",
            "            \"level\": \"DEBUG\",",
            "            \"class\": \"logging.StreamHandler\",",
            "            \"formatter\": \"verbose\",",
            "        },",
            "    },",
            "    \"loggers\": {",
            "        \"django\": {",
            "            \"handlers\": [\"console\", \"mail_admins\"],",
            "            \"level\": \"INFO\",",
            "            \"propagate\": True,",
            "        },",
            "        \"django.server\": {\"handlers\": [\"console\"], \"level\": \"INFO\", \"propagate\": True},",
            "        \"saleor\": {\"handlers\": [\"console\"], \"level\": \"DEBUG\", \"propagate\": True},",
            "    },",
            "}",
            "",
            "AUTH_USER_MODEL = \"account.User\"",
            "",
            "LOGIN_URL = \"/account/login/\"",
            "",
            "DEFAULT_COUNTRY = os.environ.get(\"DEFAULT_COUNTRY\", \"US\")",
            "DEFAULT_CURRENCY = os.environ.get(\"DEFAULT_CURRENCY\", \"USD\")",
            "DEFAULT_DECIMAL_PLACES = get_currency_fraction(DEFAULT_CURRENCY)",
            "DEFAULT_MAX_DIGITS = 12",
            "AVAILABLE_CURRENCIES = [DEFAULT_CURRENCY]",
            "COUNTRIES_OVERRIDE = {",
            "    \"EU\": pgettext_lazy(",
            "        \"Name of political and economical union of european countries\", \"European Union\"",
            "    )",
            "}",
            "",
            "OPENEXCHANGERATES_API_KEY = os.environ.get(\"OPENEXCHANGERATES_API_KEY\")",
            "",
            "# VAT configuration",
            "# Enabling vat requires valid vatlayer access key.",
            "# If you are subscribed to a paid vatlayer plan, you can enable HTTPS.",
            "VATLAYER_ACCESS_KEY = os.environ.get(\"VATLAYER_ACCESS_KEY\")",
            "VATLAYER_USE_HTTPS = get_bool_from_env(\"VATLAYER_USE_HTTPS\", False)",
            "",
            "ACCOUNT_ACTIVATION_DAYS = 3",
            "",
            "LOGIN_REDIRECT_URL = \"home\"",
            "",
            "GOOGLE_ANALYTICS_TRACKING_ID = os.environ.get(\"GOOGLE_ANALYTICS_TRACKING_ID\")",
            "",
            "",
            "def get_host():",
            "    from django.contrib.sites.models import Site",
            "",
            "    return Site.objects.get_current().domain",
            "",
            "",
            "PAYMENT_HOST = get_host",
            "",
            "PAYMENT_MODEL = \"order.Payment\"",
            "",
            "SESSION_SERIALIZER = \"django.contrib.sessions.serializers.JSONSerializer\"",
            "",
            "# Do not use cached session if locmem cache backend is used but fallback to use",
            "# default django.contrib.sessions.backends.db instead",
            "if not CACHES[\"default\"][\"BACKEND\"].endswith(\"LocMemCache\"):",
            "    SESSION_ENGINE = \"django.contrib.sessions.backends.cached_db\"",
            "",
            "MESSAGE_TAGS = {messages.ERROR: \"danger\"}",
            "",
            "LOW_STOCK_THRESHOLD = 10",
            "MAX_CHECKOUT_LINE_QUANTITY = int(os.environ.get(\"MAX_CHECKOUT_LINE_QUANTITY\", 50))",
            "",
            "PAGINATE_BY = 16",
            "DASHBOARD_PAGINATE_BY = 30",
            "DASHBOARD_SEARCH_LIMIT = 5",
            "",
            "bootstrap4 = {",
            "    \"set_placeholder\": False,",
            "    \"set_required\": False,",
            "    \"success_css_class\": \"\",",
            "    \"form_renderers\": {\"default\": \"saleor.core.utils.form_renderer.FormRenderer\"},",
            "}",
            "",
            "TEST_RUNNER = \"tests.runner.PytestTestRunner\"",
            "",
            "ALLOWED_HOSTS = get_list(os.environ.get(\"ALLOWED_HOSTS\", \"localhost,127.0.0.1\"))",
            "ALLOWED_GRAPHQL_ORIGINS = os.environ.get(\"ALLOWED_GRAPHQL_ORIGINS\", \"*\")",
            "",
            "SECURE_PROXY_SSL_HEADER = (\"HTTP_X_FORWARDED_PROTO\", \"https\")",
            "",
            "# Amazon S3 configuration",
            "AWS_ACCESS_KEY_ID = os.environ.get(\"AWS_ACCESS_KEY_ID\")",
            "AWS_LOCATION = os.environ.get(\"AWS_LOCATION\", \"\")",
            "AWS_MEDIA_BUCKET_NAME = os.environ.get(\"AWS_MEDIA_BUCKET_NAME\")",
            "AWS_MEDIA_CUSTOM_DOMAIN = os.environ.get(\"AWS_MEDIA_CUSTOM_DOMAIN\")",
            "AWS_QUERYSTRING_AUTH = get_bool_from_env(\"AWS_QUERYSTRING_AUTH\", False)",
            "AWS_S3_CUSTOM_DOMAIN = os.environ.get(\"AWS_STATIC_CUSTOM_DOMAIN\")",
            "AWS_S3_ENDPOINT_URL = os.environ.get(\"AWS_S3_ENDPOINT_URL\", None)",
            "AWS_SECRET_ACCESS_KEY = os.environ.get(\"AWS_SECRET_ACCESS_KEY\")",
            "AWS_STORAGE_BUCKET_NAME = os.environ.get(\"AWS_STORAGE_BUCKET_NAME\")",
            "AWS_DEFAULT_ACL = os.environ.get(\"AWS_DEFAULT_ACL\", None)",
            "",
            "if AWS_STORAGE_BUCKET_NAME:",
            "    STATICFILES_STORAGE = \"storages.backends.s3boto3.S3Boto3Storage\"",
            "",
            "if AWS_MEDIA_BUCKET_NAME:",
            "    DEFAULT_FILE_STORAGE = \"saleor.core.storages.S3MediaStorage\"",
            "    THUMBNAIL_DEFAULT_STORAGE = DEFAULT_FILE_STORAGE",
            "",
            "MESSAGE_STORAGE = \"django.contrib.messages.storage.session.SessionStorage\"",
            "",
            "VERSATILEIMAGEFIELD_RENDITION_KEY_SETS = {",
            "    \"products\": [",
            "        (\"product_gallery\", \"thumbnail__540x540\"),",
            "        (\"product_gallery_2x\", \"thumbnail__1080x1080\"),",
            "        (\"product_small\", \"thumbnail__60x60\"),",
            "        (\"product_small_2x\", \"thumbnail__120x120\"),",
            "        (\"product_list\", \"thumbnail__255x255\"),",
            "        (\"product_list_2x\", \"thumbnail__510x510\"),",
            "    ],",
            "    \"background_images\": [(\"header_image\", \"thumbnail__1080x440\")],",
            "    \"user_avatars\": [(\"default\", \"thumbnail__445x445\")],",
            "}",
            "",
            "VERSATILEIMAGEFIELD_SETTINGS = {",
            "    # Images should be pre-generated on Production environment",
            "    \"create_images_on_demand\": get_bool_from_env(\"CREATE_IMAGES_ON_DEMAND\", DEBUG)",
            "}",
            "",
            "PLACEHOLDER_IMAGES = {",
            "    60: \"images/placeholder60x60.png\",",
            "    120: \"images/placeholder120x120.png\",",
            "    255: \"images/placeholder255x255.png\",",
            "    540: \"images/placeholder540x540.png\",",
            "    1080: \"images/placeholder1080x1080.png\",",
            "}",
            "",
            "DEFAULT_PLACEHOLDER = \"images/placeholder255x255.png\"",
            "",
            "WEBPACK_LOADER = {",
            "    \"DEFAULT\": {",
            "        \"CACHE\": not DEBUG,",
            "        \"BUNDLE_DIR_NAME\": \"assets/\",",
            "        \"STATS_FILE\": os.path.join(PROJECT_ROOT, \"webpack-bundle.json\"),",
            "        \"POLL_INTERVAL\": 0.1,",
            "        \"IGNORE\": [r\".+\\.hot-update\\.js\", r\".+\\.map\"],",
            "    }",
            "}",
            "",
            "",
            "LOGOUT_ON_PASSWORD_CHANGE = False",
            "",
            "# SEARCH CONFIGURATION",
            "DB_SEARCH_ENABLED = True",
            "",
            "# support deployment-dependant elastic enviroment variable",
            "ES_URL = (",
            "    os.environ.get(\"ELASTICSEARCH_URL\")",
            "    or os.environ.get(\"SEARCHBOX_URL\")",
            "    or os.environ.get(\"BONSAI_URL\")",
            ")",
            "",
            "ENABLE_SEARCH = bool(ES_URL) or DB_SEARCH_ENABLED  # global search disabling",
            "",
            "SEARCH_BACKEND = \"saleor.search.backends.postgresql\"",
            "",
            "if ES_URL:",
            "    SEARCH_BACKEND = \"saleor.search.backends.elasticsearch\"",
            "    INSTALLED_APPS.append(\"django_elasticsearch_dsl\")",
            "    ELASTICSEARCH_DSL = {\"default\": {\"hosts\": ES_URL}}",
            "",
            "AUTHENTICATION_BACKENDS = [",
            "    \"saleor.account.backends.facebook.CustomFacebookOAuth2\",",
            "    \"saleor.account.backends.google.CustomGoogleOAuth2\",",
            "    \"graphql_jwt.backends.JSONWebTokenBackend\",",
            "    \"django.contrib.auth.backends.ModelBackend\",",
            "]",
            "",
            "SOCIAL_AUTH_PIPELINE = [",
            "    \"social_core.pipeline.social_auth.social_details\",",
            "    \"social_core.pipeline.social_auth.social_uid\",",
            "    \"social_core.pipeline.social_auth.auth_allowed\",",
            "    \"social_core.pipeline.social_auth.social_user\",",
            "    \"social_core.pipeline.social_auth.associate_by_email\",",
            "    \"social_core.pipeline.user.create_user\",",
            "    \"social_core.pipeline.social_auth.associate_user\",",
            "    \"social_core.pipeline.social_auth.load_extra_data\",",
            "    \"social_core.pipeline.user.user_details\",",
            "]",
            "",
            "SOCIAL_AUTH_USERNAME_IS_FULL_EMAIL = True",
            "SOCIAL_AUTH_USER_MODEL = AUTH_USER_MODEL",
            "SOCIAL_AUTH_FACEBOOK_SCOPE = [\"email\"]",
            "SOCIAL_AUTH_FACEBOOK_PROFILE_EXTRA_PARAMS = {\"fields\": \"id, email\"}",
            "# As per March 2018, Facebook requires all traffic to go through HTTPS only",
            "SOCIAL_AUTH_REDIRECT_IS_HTTPS = True",
            "",
            "# CELERY SETTINGS",
            "CELERY_BROKER_URL = (",
            "    os.environ.get(\"CELERY_BROKER_URL\", os.environ.get(\"CLOUDAMQP_URL\")) or \"\"",
            ")",
            "CELERY_TASK_ALWAYS_EAGER = not CELERY_BROKER_URL",
            "CELERY_ACCEPT_CONTENT = [\"json\"]",
            "CELERY_TASK_SERIALIZER = \"json\"",
            "CELERY_RESULT_SERIALIZER = \"json\"",
            "CELERY_RESULT_BACKEND = \"django-db\"",
            "",
            "# Impersonate module settings",
            "IMPERSONATE = {",
            "    \"URI_EXCLUSIONS\": [r\"^dashboard/\"],",
            "    \"CUSTOM_USER_QUERYSET\": \"saleor.account.impersonate.get_impersonatable_users\",  # noqa",
            "    \"USE_HTTP_REFERER\": True,",
            "    \"CUSTOM_ALLOW\": \"saleor.account.impersonate.can_impersonate\",",
            "}",
            "",
            "",
            "# Rich-text editor",
            "ALLOWED_TAGS = [",
            "    \"a\",",
            "    \"b\",",
            "    \"blockquote\",",
            "    \"br\",",
            "    \"em\",",
            "    \"h2\",",
            "    \"h3\",",
            "    \"i\",",
            "    \"img\",",
            "    \"li\",",
            "    \"ol\",",
            "    \"p\",",
            "    \"strong\",",
            "    \"ul\",",
            "]",
            "ALLOWED_ATTRIBUTES = {\"*\": [\"align\", \"style\"], \"a\": [\"href\", \"title\"], \"img\": [\"src\"]}",
            "ALLOWED_STYLES = [\"text-align\"]",
            "",
            "",
            "# Slugs for menus precreated in Django migrations",
            "DEFAULT_MENUS = {\"top_menu_name\": \"navbar\", \"bottom_menu_name\": \"footer\"}",
            "",
            "# This enable the new 'No Captcha reCaptcha' version (the simple checkbox)",
            "# instead of the old (deprecated) one. For more information see:",
            "#   https://github.com/praekelt/django-recaptcha/blob/34af16ba1e/README.rst",
            "NOCAPTCHA = True",
            "",
            "# Set Google's reCaptcha keys",
            "RECAPTCHA_PUBLIC_KEY = os.environ.get(\"RECAPTCHA_PUBLIC_KEY\")",
            "RECAPTCHA_PRIVATE_KEY = os.environ.get(\"RECAPTCHA_PRIVATE_KEY\")",
            "",
            "",
            "#  Sentry",
            "SENTRY_DSN = os.environ.get(\"SENTRY_DSN\")",
            "if SENTRY_DSN:",
            "    INSTALLED_APPS.append(\"raven.contrib.django.raven_compat\")",
            "    RAVEN_CONFIG = {\"dsn\": SENTRY_DSN, \"release\": __version__}",
            "",
            "",
            "SERIALIZATION_MODULES = {\"json\": \"saleor.core.utils.json_serializer\"}",
            "",
            "",
            "DUMMY = \"dummy\"",
            "BRAINTREE = \"braintree\"",
            "RAZORPAY = \"razorpay\"",
            "STRIPE = \"stripe\"",
            "",
            "CHECKOUT_PAYMENT_GATEWAYS = {",
            "    DUMMY: pgettext_lazy(\"Payment method name\", \"Dummy gateway\")",
            "}",
            "",
            "PAYMENT_GATEWAYS = {",
            "    DUMMY: {",
            "        \"module\": \"saleor.payment.gateways.dummy\",",
            "        \"config\": {",
            "            \"auto_capture\": True,",
            "            \"connection_params\": {},",
            "            \"template_path\": \"order/payment/dummy.html\",",
            "        },",
            "    },",
            "    BRAINTREE: {",
            "        \"module\": \"saleor.payment.gateways.braintree\",",
            "        \"config\": {",
            "            \"auto_capture\": True,",
            "            \"template_path\": \"order/payment/braintree.html\",",
            "            \"connection_params\": {",
            "                \"sandbox_mode\": get_bool_from_env(\"BRAINTREE_SANDBOX_MODE\", True),",
            "                \"merchant_id\": os.environ.get(\"BRAINTREE_MERCHANT_ID\"),",
            "                \"public_key\": os.environ.get(\"BRAINTREE_PUBLIC_KEY\"),",
            "                \"private_key\": os.environ.get(\"BRAINTREE_PRIVATE_KEY\"),",
            "            },",
            "        },",
            "    },",
            "    RAZORPAY: {",
            "        \"module\": \"saleor.payment.gateways.razorpay\",",
            "        \"config\": {",
            "            \"auto_capture\": None,",
            "            \"template_path\": \"order/payment/razorpay.html\",",
            "            \"connection_params\": {",
            "                \"public_key\": os.environ.get(\"RAZORPAY_PUBLIC_KEY\"),",
            "                \"secret_key\": os.environ.get(\"RAZORPAY_SECRET_KEY\"),",
            "                \"prefill\": get_bool_from_env(\"RAZORPAY_PREFILL\", True),",
            "                \"store_name\": os.environ.get(\"RAZORPAY_STORE_NAME\"),",
            "                \"store_image\": os.environ.get(\"RAZORPAY_STORE_IMAGE\"),",
            "            },",
            "        },",
            "    },",
            "    STRIPE: {",
            "        \"module\": \"saleor.payment.gateways.stripe\",",
            "        \"config\": {",
            "            \"auto_capture\": True,",
            "            \"template_path\": \"order/payment/stripe.html\",",
            "            \"connection_params\": {",
            "                \"public_key\": os.environ.get(\"STRIPE_PUBLIC_KEY\"),",
            "                \"secret_key\": os.environ.get(\"STRIPE_SECRET_KEY\"),",
            "                \"store_name\": os.environ.get(\"STRIPE_STORE_NAME\", \"Saleor\"),",
            "                \"store_image\": os.environ.get(\"STRIPE_STORE_IMAGE\", None),",
            "                \"prefill\": get_bool_from_env(\"STRIPE_PREFILL\", True),",
            "                \"remember_me\": os.environ.get(\"STRIPE_REMEMBER_ME\", True),",
            "                \"locale\": os.environ.get(\"STRIPE_LOCALE\", \"auto\"),",
            "                \"enable_billing_address\": os.environ.get(",
            "                    \"STRIPE_ENABLE_BILLING_ADDRESS\", False",
            "                ),",
            "                \"enable_shipping_address\": os.environ.get(",
            "                    \"STRIPE_ENABLE_SHIPPING_ADDRESS\", False",
            "                ),",
            "            },",
            "        },",
            "    },",
            "}",
            "",
            "GRAPHENE = {",
            "    \"RELAY_CONNECTION_ENFORCE_FIRST_OR_LAST\": True,",
            "    \"RELAY_CONNECTION_MAX_LIMIT\": 100,",
            "}"
        ],
        "afterPatchFile": [
            "import ast",
            "import os.path",
            "",
            "import dj_database_url",
            "import dj_email_url",
            "import django_cache_url",
            "from django.contrib.messages import constants as messages",
            "from django.utils.translation import gettext_lazy as _, pgettext_lazy",
            "from django_prices.templatetags.prices_i18n import get_currency_fraction",
            "",
            "from . import __version__",
            "",
            "",
            "def get_list(text):",
            "    return [item.strip() for item in text.split(\",\")]",
            "",
            "",
            "def get_bool_from_env(name, default_value):",
            "    if name in os.environ:",
            "        value = os.environ[name]",
            "        try:",
            "            return ast.literal_eval(value)",
            "        except ValueError as e:",
            "            raise ValueError(\"{} is an invalid value for {}\".format(value, name)) from e",
            "    return default_value",
            "",
            "",
            "DEBUG = get_bool_from_env(\"DEBUG\", True)",
            "",
            "SITE_ID = 1",
            "",
            "PROJECT_ROOT = os.path.normpath(os.path.join(os.path.dirname(__file__), \"..\"))",
            "",
            "ROOT_URLCONF = \"saleor.urls\"",
            "",
            "WSGI_APPLICATION = \"saleor.wsgi.application\"",
            "",
            "ADMINS = (",
            "    # ('Your Name', 'your_email@example.com'),",
            ")",
            "MANAGERS = ADMINS",
            "",
            "INTERNAL_IPS = get_list(os.environ.get(\"INTERNAL_IPS\", \"127.0.0.1\"))",
            "",
            "# Some cloud providers (Heroku) export REDIS_URL variable instead of CACHE_URL",
            "REDIS_URL = os.environ.get(\"REDIS_URL\")",
            "if REDIS_URL:",
            "    CACHE_URL = os.environ.setdefault(\"CACHE_URL\", REDIS_URL)",
            "CACHES = {\"default\": django_cache_url.config()}",
            "",
            "DATABASES = {",
            "    \"default\": dj_database_url.config(",
            "        default=\"postgres://saleor:saleor@localhost:5432/saleor\", conn_max_age=600",
            "    )",
            "}",
            "",
            "",
            "TIME_ZONE = \"America/Chicago\"",
            "LANGUAGE_CODE = \"en\"",
            "LANGUAGES = [",
            "    (\"ar\", _(\"Arabic\")),",
            "    (\"az\", _(\"Azerbaijani\")),",
            "    (\"bg\", _(\"Bulgarian\")),",
            "    (\"bn\", _(\"Bengali\")),",
            "    (\"ca\", _(\"Catalan\")),",
            "    (\"cs\", _(\"Czech\")),",
            "    (\"da\", _(\"Danish\")),",
            "    (\"de\", _(\"German\")),",
            "    (\"en\", _(\"English\")),",
            "    (\"es\", _(\"Spanish\")),",
            "    (\"es-co\", _(\"Colombian Spanish\")),",
            "    (\"et\", _(\"Estonian\")),",
            "    (\"fa\", _(\"Persian\")),",
            "    (\"fr\", _(\"French\")),",
            "    (\"hi\", _(\"Hindi\")),",
            "    (\"hu\", _(\"Hungarian\")),",
            "    (\"hy\", _(\"Armenian\")),",
            "    (\"id\", _(\"Indonesian\")),",
            "    (\"it\", _(\"Italian\")),",
            "    (\"ja\", _(\"Japanese\")),",
            "    (\"ko\", _(\"Korean\")),",
            "    (\"lt\", _(\"Lithuanian\")),",
            "    (\"mn\", _(\"Mongolian\")),",
            "    (\"nb\", _(\"Norwegian\")),",
            "    (\"nl\", _(\"Dutch\")),",
            "    (\"pl\", _(\"Polish\")),",
            "    (\"pt\", _(\"Portuguese\")),",
            "    (\"pt-br\", _(\"Brazilian Portuguese\")),",
            "    (\"ro\", _(\"Romanian\")),",
            "    (\"ru\", _(\"Russian\")),",
            "    (\"sk\", _(\"Slovak\")),",
            "    (\"sq\", _(\"Albanian\")),",
            "    (\"sr\", _(\"Serbian\")),",
            "    (\"sw\", _(\"Swahili\")),",
            "    (\"sv\", _(\"Swedish\")),",
            "    (\"th\", _(\"Thai\")),",
            "    (\"tr\", _(\"Turkish\")),",
            "    (\"uk\", _(\"Ukrainian\")),",
            "    (\"vi\", _(\"Vietnamese\")),",
            "    (\"zh-hans\", _(\"Simplified Chinese\")),",
            "    (\"zh-hant\", _(\"Traditional Chinese\")),",
            "]",
            "LOCALE_PATHS = [os.path.join(PROJECT_ROOT, \"locale\")]",
            "USE_I18N = True",
            "USE_L10N = True",
            "USE_TZ = True",
            "",
            "FORM_RENDERER = \"django.forms.renderers.TemplatesSetting\"",
            "",
            "EMAIL_URL = os.environ.get(\"EMAIL_URL\")",
            "SENDGRID_USERNAME = os.environ.get(\"SENDGRID_USERNAME\")",
            "SENDGRID_PASSWORD = os.environ.get(\"SENDGRID_PASSWORD\")",
            "if not EMAIL_URL and SENDGRID_USERNAME and SENDGRID_PASSWORD:",
            "    EMAIL_URL = \"smtp://%s:%s@smtp.sendgrid.net:587/?tls=True\" % (",
            "        SENDGRID_USERNAME,",
            "        SENDGRID_PASSWORD,",
            "    )",
            "email_config = dj_email_url.parse(EMAIL_URL or \"console://\")",
            "",
            "EMAIL_FILE_PATH = email_config[\"EMAIL_FILE_PATH\"]",
            "EMAIL_HOST_USER = email_config[\"EMAIL_HOST_USER\"]",
            "EMAIL_HOST_PASSWORD = email_config[\"EMAIL_HOST_PASSWORD\"]",
            "EMAIL_HOST = email_config[\"EMAIL_HOST\"]",
            "EMAIL_PORT = email_config[\"EMAIL_PORT\"]",
            "EMAIL_BACKEND = email_config[\"EMAIL_BACKEND\"]",
            "EMAIL_USE_TLS = email_config[\"EMAIL_USE_TLS\"]",
            "EMAIL_USE_SSL = email_config[\"EMAIL_USE_SSL\"]",
            "",
            "ENABLE_SSL = get_bool_from_env(\"ENABLE_SSL\", False)",
            "",
            "if ENABLE_SSL:",
            "    SECURE_SSL_REDIRECT = not DEBUG",
            "",
            "DEFAULT_FROM_EMAIL = os.environ.get(\"DEFAULT_FROM_EMAIL\", EMAIL_HOST_USER)",
            "ORDER_FROM_EMAIL = os.getenv(\"ORDER_FROM_EMAIL\", DEFAULT_FROM_EMAIL)",
            "",
            "MEDIA_ROOT = os.path.join(PROJECT_ROOT, \"media\")",
            "MEDIA_URL = os.environ.get(\"MEDIA_URL\", \"/media/\")",
            "",
            "STATIC_ROOT = os.path.join(PROJECT_ROOT, \"static\")",
            "STATIC_URL = os.environ.get(\"STATIC_URL\", \"/static/\")",
            "STATICFILES_DIRS = [",
            "    (\"assets\", os.path.join(PROJECT_ROOT, \"saleor\", \"static\", \"assets\")),",
            "    (\"favicons\", os.path.join(PROJECT_ROOT, \"saleor\", \"static\", \"favicons\")),",
            "    (\"images\", os.path.join(PROJECT_ROOT, \"saleor\", \"static\", \"images\")),",
            "    (",
            "        \"dashboard/images\",",
            "        os.path.join(PROJECT_ROOT, \"saleor\", \"static\", \"dashboard\", \"images\"),",
            "    ),",
            "]",
            "STATICFILES_FINDERS = [",
            "    \"django.contrib.staticfiles.finders.FileSystemFinder\",",
            "    \"django.contrib.staticfiles.finders.AppDirectoriesFinder\",",
            "]",
            "",
            "context_processors = [",
            "    \"django.contrib.auth.context_processors.auth\",",
            "    \"django.template.context_processors.debug\",",
            "    \"django.template.context_processors.i18n\",",
            "    \"django.template.context_processors.media\",",
            "    \"django.template.context_processors.static\",",
            "    \"django.template.context_processors.tz\",",
            "    \"django.contrib.messages.context_processors.messages\",",
            "    \"django.template.context_processors.request\",",
            "    \"saleor.core.context_processors.default_currency\",",
            "    \"saleor.checkout.context_processors.checkout_counter\",",
            "    \"saleor.core.context_processors.search_enabled\",",
            "    \"saleor.site.context_processors.site\",",
            "    \"social_django.context_processors.backends\",",
            "    \"social_django.context_processors.login_redirect\",",
            "]",
            "",
            "loaders = [",
            "    \"django.template.loaders.filesystem.Loader\",",
            "    \"django.template.loaders.app_directories.Loader\",",
            "]",
            "",
            "if not DEBUG:",
            "    loaders = [(\"django.template.loaders.cached.Loader\", loaders)]",
            "",
            "TEMPLATES = [",
            "    {",
            "        \"BACKEND\": \"django.template.backends.django.DjangoTemplates\",",
            "        \"DIRS\": [os.path.join(PROJECT_ROOT, \"templates\")],",
            "        \"OPTIONS\": {",
            "            \"debug\": DEBUG,",
            "            \"context_processors\": context_processors,",
            "            \"loaders\": loaders,",
            "            \"string_if_invalid\": '<< MISSING VARIABLE \"%s\" >>' if DEBUG else \"\",",
            "        },",
            "    }",
            "]",
            "",
            "# Make this unique, and don't share it with anybody.",
            "SECRET_KEY = os.environ.get(\"SECRET_KEY\")",
            "",
            "MIDDLEWARE = [",
            "    \"saleor.core.middleware.django_session_middleware\",",
            "    \"saleor.core.middleware.django_security_middleware\",",
            "    \"saleor.core.middleware.django_common_middleware\",",
            "    \"saleor.core.middleware.django_csrf_view_middleware\",",
            "    \"saleor.core.middleware.django_auth_middleware\",",
            "    \"saleor.core.middleware.django_messages_middleware\",",
            "    \"saleor.core.middleware.django_locale_middleware\",",
            "    \"saleor.core.middleware.babel_locale_middleware\",",
            "    \"saleor.core.middleware.discounts\",",
            "    \"saleor.core.middleware.google_analytics\",",
            "    \"saleor.core.middleware.country\",",
            "    \"saleor.core.middleware.currency\",",
            "    \"saleor.core.middleware.site\",",
            "    \"saleor.core.middleware.taxes\",",
            "    \"saleor.core.middleware.social_auth_exception_middleware\",",
            "    \"saleor.core.middleware.impersonate_middleware\",",
            "    \"saleor.graphql.middleware.jwt_middleware\",",
            "]",
            "",
            "INSTALLED_APPS = [",
            "    # External apps that need to go before django's",
            "    \"storages\",",
            "    # Django modules",
            "    \"django.contrib.contenttypes\",",
            "    \"django.contrib.sessions\",",
            "    \"django.contrib.messages\",",
            "    \"django.contrib.sitemaps\",",
            "    \"django.contrib.sites\",",
            "    \"django.contrib.staticfiles\",",
            "    \"django.contrib.auth\",",
            "    \"django.contrib.postgres\",",
            "    \"django.forms\",",
            "    # Local apps",
            "    \"saleor.account\",",
            "    \"saleor.discount\",",
            "    \"saleor.product\",",
            "    \"saleor.checkout\",",
            "    \"saleor.core\",",
            "    \"saleor.graphql\",",
            "    \"saleor.menu\",",
            "    \"saleor.order\",",
            "    \"saleor.dashboard\",",
            "    \"saleor.seo\",",
            "    \"saleor.shipping\",",
            "    \"saleor.search\",",
            "    \"saleor.site\",",
            "    \"saleor.data_feeds\",",
            "    \"saleor.page\",",
            "    \"saleor.payment\",",
            "    # External apps",
            "    \"versatileimagefield\",",
            "    \"django_babel\",",
            "    \"bootstrap4\",",
            "    \"django_measurement\",",
            "    \"django_prices\",",
            "    \"django_prices_openexchangerates\",",
            "    \"django_prices_vatlayer\",",
            "    \"graphene_django\",",
            "    \"mptt\",",
            "    \"webpack_loader\",",
            "    \"social_django\",",
            "    \"django_countries\",",
            "    \"django_filters\",",
            "    \"django_celery_results\",",
            "    \"impersonate\",",
            "    \"phonenumber_field\",",
            "    \"captcha\",",
            "]",
            "",
            "",
            "ENABLE_DEBUG_TOOLBAR = get_bool_from_env(\"ENABLE_DEBUG_TOOLBAR\", False)",
            "if ENABLE_DEBUG_TOOLBAR:",
            "    MIDDLEWARE.append(\"debug_toolbar.middleware.DebugToolbarMiddleware\")",
            "    INSTALLED_APPS.append(\"debug_toolbar\")",
            "    DEBUG_TOOLBAR_PANELS = [",
            "        # adds a request history to the debug toolbar",
            "        \"ddt_request_history.panels.request_history.RequestHistoryPanel\",",
            "        \"debug_toolbar.panels.versions.VersionsPanel\",",
            "        \"debug_toolbar.panels.timer.TimerPanel\",",
            "        \"debug_toolbar.panels.settings.SettingsPanel\",",
            "        \"debug_toolbar.panels.headers.HeadersPanel\",",
            "        \"debug_toolbar.panels.request.RequestPanel\",",
            "        \"debug_toolbar.panels.sql.SQLPanel\",",
            "        \"debug_toolbar.panels.templates.TemplatesPanel\",",
            "        \"debug_toolbar.panels.staticfiles.StaticFilesPanel\",",
            "        \"debug_toolbar.panels.cache.CachePanel\",",
            "        \"debug_toolbar.panels.signals.SignalsPanel\",",
            "        \"debug_toolbar.panels.logging.LoggingPanel\",",
            "        \"debug_toolbar.panels.redirects.RedirectsPanel\",",
            "        \"debug_toolbar.panels.profiling.ProfilingPanel\",",
            "    ]",
            "    DEBUG_TOOLBAR_CONFIG = {\"RESULTS_CACHE_SIZE\": 100}",
            "",
            "ENABLE_SILK = get_bool_from_env(\"ENABLE_SILK\", False)",
            "if ENABLE_SILK:",
            "    MIDDLEWARE.insert(0, \"silk.middleware.SilkyMiddleware\")",
            "    INSTALLED_APPS.append(\"silk\")",
            "",
            "LOGGING = {",
            "    \"version\": 1,",
            "    \"disable_existing_loggers\": False,",
            "    \"root\": {\"level\": \"INFO\", \"handlers\": [\"console\"]},",
            "    \"formatters\": {",
            "        \"verbose\": {",
            "            \"format\": (",
            "                \"%(levelname)s %(name)s %(message)s\" \" [PID:%(process)d:%(threadName)s]\"",
            "            )",
            "        },",
            "        \"simple\": {\"format\": \"%(levelname)s %(message)s\"},",
            "    },",
            "    \"filters\": {\"require_debug_false\": {\"()\": \"django.utils.log.RequireDebugFalse\"}},",
            "    \"handlers\": {",
            "        \"mail_admins\": {",
            "            \"level\": \"ERROR\",",
            "            \"filters\": [\"require_debug_false\"],",
            "            \"class\": \"django.utils.log.AdminEmailHandler\",",
            "        },",
            "        \"console\": {",
            "            \"level\": \"DEBUG\",",
            "            \"class\": \"logging.StreamHandler\",",
            "            \"formatter\": \"verbose\",",
            "        },",
            "    },",
            "    \"loggers\": {",
            "        \"django\": {",
            "            \"handlers\": [\"console\", \"mail_admins\"],",
            "            \"level\": \"INFO\",",
            "            \"propagate\": True,",
            "        },",
            "        \"django.server\": {\"handlers\": [\"console\"], \"level\": \"INFO\", \"propagate\": True},",
            "        \"saleor\": {\"handlers\": [\"console\"], \"level\": \"DEBUG\", \"propagate\": True},",
            "    },",
            "}",
            "",
            "AUTH_USER_MODEL = \"account.User\"",
            "",
            "LOGIN_URL = \"/account/login/\"",
            "",
            "DEFAULT_COUNTRY = os.environ.get(\"DEFAULT_COUNTRY\", \"US\")",
            "DEFAULT_CURRENCY = os.environ.get(\"DEFAULT_CURRENCY\", \"USD\")",
            "DEFAULT_DECIMAL_PLACES = get_currency_fraction(DEFAULT_CURRENCY)",
            "DEFAULT_MAX_DIGITS = 12",
            "AVAILABLE_CURRENCIES = [DEFAULT_CURRENCY]",
            "COUNTRIES_OVERRIDE = {",
            "    \"EU\": pgettext_lazy(",
            "        \"Name of political and economical union of european countries\", \"European Union\"",
            "    )",
            "}",
            "",
            "OPENEXCHANGERATES_API_KEY = os.environ.get(\"OPENEXCHANGERATES_API_KEY\")",
            "",
            "# VAT configuration",
            "# Enabling vat requires valid vatlayer access key.",
            "# If you are subscribed to a paid vatlayer plan, you can enable HTTPS.",
            "VATLAYER_ACCESS_KEY = os.environ.get(\"VATLAYER_ACCESS_KEY\")",
            "VATLAYER_USE_HTTPS = get_bool_from_env(\"VATLAYER_USE_HTTPS\", False)",
            "",
            "ACCOUNT_ACTIVATION_DAYS = 3",
            "",
            "LOGIN_REDIRECT_URL = \"home\"",
            "",
            "GOOGLE_ANALYTICS_TRACKING_ID = os.environ.get(\"GOOGLE_ANALYTICS_TRACKING_ID\")",
            "",
            "",
            "def get_host():",
            "    from django.contrib.sites.models import Site",
            "",
            "    return Site.objects.get_current().domain",
            "",
            "",
            "PAYMENT_HOST = get_host",
            "",
            "PAYMENT_MODEL = \"order.Payment\"",
            "",
            "SESSION_SERIALIZER = \"django.contrib.sessions.serializers.JSONSerializer\"",
            "",
            "# Do not use cached session if locmem cache backend is used but fallback to use",
            "# default django.contrib.sessions.backends.db instead",
            "if not CACHES[\"default\"][\"BACKEND\"].endswith(\"LocMemCache\"):",
            "    SESSION_ENGINE = \"django.contrib.sessions.backends.cached_db\"",
            "",
            "MESSAGE_TAGS = {messages.ERROR: \"danger\"}",
            "",
            "LOW_STOCK_THRESHOLD = 10",
            "MAX_CHECKOUT_LINE_QUANTITY = int(os.environ.get(\"MAX_CHECKOUT_LINE_QUANTITY\", 50))",
            "",
            "PAGINATE_BY = 16",
            "DASHBOARD_PAGINATE_BY = 30",
            "DASHBOARD_SEARCH_LIMIT = 5",
            "",
            "bootstrap4 = {",
            "    \"set_placeholder\": False,",
            "    \"set_required\": False,",
            "    \"success_css_class\": \"\",",
            "    \"form_renderers\": {\"default\": \"saleor.core.utils.form_renderer.FormRenderer\"},",
            "}",
            "",
            "TEST_RUNNER = \"tests.runner.PytestTestRunner\"",
            "",
            "ALLOWED_HOSTS = get_list(os.environ.get(\"ALLOWED_HOSTS\", \"localhost,127.0.0.1\"))",
            "ALLOWED_GRAPHQL_ORIGINS = os.environ.get(\"ALLOWED_GRAPHQL_ORIGINS\", \"*\")",
            "",
            "SECURE_PROXY_SSL_HEADER = (\"HTTP_X_FORWARDED_PROTO\", \"https\")",
            "",
            "# Amazon S3 configuration",
            "AWS_ACCESS_KEY_ID = os.environ.get(\"AWS_ACCESS_KEY_ID\")",
            "AWS_LOCATION = os.environ.get(\"AWS_LOCATION\", \"\")",
            "AWS_MEDIA_BUCKET_NAME = os.environ.get(\"AWS_MEDIA_BUCKET_NAME\")",
            "AWS_MEDIA_CUSTOM_DOMAIN = os.environ.get(\"AWS_MEDIA_CUSTOM_DOMAIN\")",
            "AWS_QUERYSTRING_AUTH = get_bool_from_env(\"AWS_QUERYSTRING_AUTH\", False)",
            "AWS_S3_CUSTOM_DOMAIN = os.environ.get(\"AWS_STATIC_CUSTOM_DOMAIN\")",
            "AWS_S3_ENDPOINT_URL = os.environ.get(\"AWS_S3_ENDPOINT_URL\", None)",
            "AWS_SECRET_ACCESS_KEY = os.environ.get(\"AWS_SECRET_ACCESS_KEY\")",
            "AWS_STORAGE_BUCKET_NAME = os.environ.get(\"AWS_STORAGE_BUCKET_NAME\")",
            "AWS_DEFAULT_ACL = os.environ.get(\"AWS_DEFAULT_ACL\", None)",
            "",
            "if AWS_STORAGE_BUCKET_NAME:",
            "    STATICFILES_STORAGE = \"storages.backends.s3boto3.S3Boto3Storage\"",
            "",
            "if AWS_MEDIA_BUCKET_NAME:",
            "    DEFAULT_FILE_STORAGE = \"saleor.core.storages.S3MediaStorage\"",
            "    THUMBNAIL_DEFAULT_STORAGE = DEFAULT_FILE_STORAGE",
            "",
            "MESSAGE_STORAGE = \"django.contrib.messages.storage.session.SessionStorage\"",
            "",
            "VERSATILEIMAGEFIELD_RENDITION_KEY_SETS = {",
            "    \"products\": [",
            "        (\"product_gallery\", \"thumbnail__540x540\"),",
            "        (\"product_gallery_2x\", \"thumbnail__1080x1080\"),",
            "        (\"product_small\", \"thumbnail__60x60\"),",
            "        (\"product_small_2x\", \"thumbnail__120x120\"),",
            "        (\"product_list\", \"thumbnail__255x255\"),",
            "        (\"product_list_2x\", \"thumbnail__510x510\"),",
            "    ],",
            "    \"background_images\": [(\"header_image\", \"thumbnail__1080x440\")],",
            "    \"user_avatars\": [(\"default\", \"thumbnail__445x445\")],",
            "}",
            "",
            "VERSATILEIMAGEFIELD_SETTINGS = {",
            "    # Images should be pre-generated on Production environment",
            "    \"create_images_on_demand\": get_bool_from_env(\"CREATE_IMAGES_ON_DEMAND\", DEBUG)",
            "}",
            "",
            "PLACEHOLDER_IMAGES = {",
            "    60: \"images/placeholder60x60.png\",",
            "    120: \"images/placeholder120x120.png\",",
            "    255: \"images/placeholder255x255.png\",",
            "    540: \"images/placeholder540x540.png\",",
            "    1080: \"images/placeholder1080x1080.png\",",
            "}",
            "",
            "DEFAULT_PLACEHOLDER = \"images/placeholder255x255.png\"",
            "",
            "WEBPACK_LOADER = {",
            "    \"DEFAULT\": {",
            "        \"CACHE\": not DEBUG,",
            "        \"BUNDLE_DIR_NAME\": \"assets/\",",
            "        \"STATS_FILE\": os.path.join(PROJECT_ROOT, \"webpack-bundle.json\"),",
            "        \"POLL_INTERVAL\": 0.1,",
            "        \"IGNORE\": [r\".+\\.hot-update\\.js\", r\".+\\.map\"],",
            "    }",
            "}",
            "",
            "",
            "LOGOUT_ON_PASSWORD_CHANGE = False",
            "",
            "# SEARCH CONFIGURATION",
            "DB_SEARCH_ENABLED = True",
            "",
            "# support deployment-dependant elastic enviroment variable",
            "ES_URL = (",
            "    os.environ.get(\"ELASTICSEARCH_URL\")",
            "    or os.environ.get(\"SEARCHBOX_URL\")",
            "    or os.environ.get(\"BONSAI_URL\")",
            ")",
            "",
            "ENABLE_SEARCH = bool(ES_URL) or DB_SEARCH_ENABLED  # global search disabling",
            "",
            "SEARCH_BACKEND = \"saleor.search.backends.postgresql\"",
            "",
            "if ES_URL:",
            "    SEARCH_BACKEND = \"saleor.search.backends.elasticsearch\"",
            "    INSTALLED_APPS.append(\"django_elasticsearch_dsl\")",
            "    ELASTICSEARCH_DSL = {\"default\": {\"hosts\": ES_URL}}",
            "",
            "AUTHENTICATION_BACKENDS = [",
            "    \"saleor.account.backends.facebook.CustomFacebookOAuth2\",",
            "    \"saleor.account.backends.google.CustomGoogleOAuth2\",",
            "    \"graphql_jwt.backends.JSONWebTokenBackend\",",
            "    \"django.contrib.auth.backends.ModelBackend\",",
            "]",
            "",
            "SOCIAL_AUTH_PIPELINE = [",
            "    \"social_core.pipeline.social_auth.social_details\",",
            "    \"social_core.pipeline.social_auth.social_uid\",",
            "    \"social_core.pipeline.social_auth.auth_allowed\",",
            "    \"social_core.pipeline.social_auth.social_user\",",
            "    \"social_core.pipeline.social_auth.associate_by_email\",",
            "    \"social_core.pipeline.user.create_user\",",
            "    \"social_core.pipeline.social_auth.associate_user\",",
            "    \"social_core.pipeline.social_auth.load_extra_data\",",
            "    \"social_core.pipeline.user.user_details\",",
            "]",
            "",
            "SOCIAL_AUTH_USERNAME_IS_FULL_EMAIL = True",
            "SOCIAL_AUTH_USER_MODEL = AUTH_USER_MODEL",
            "SOCIAL_AUTH_FACEBOOK_SCOPE = [\"email\"]",
            "SOCIAL_AUTH_FACEBOOK_PROFILE_EXTRA_PARAMS = {\"fields\": \"id, email\"}",
            "# As per March 2018, Facebook requires all traffic to go through HTTPS only",
            "SOCIAL_AUTH_REDIRECT_IS_HTTPS = True",
            "",
            "# CELERY SETTINGS",
            "CELERY_BROKER_URL = (",
            "    os.environ.get(\"CELERY_BROKER_URL\", os.environ.get(\"CLOUDAMQP_URL\")) or \"\"",
            ")",
            "CELERY_TASK_ALWAYS_EAGER = not CELERY_BROKER_URL",
            "CELERY_ACCEPT_CONTENT = [\"json\"]",
            "CELERY_TASK_SERIALIZER = \"json\"",
            "CELERY_RESULT_SERIALIZER = \"json\"",
            "CELERY_RESULT_BACKEND = \"django-db\"",
            "",
            "# Impersonate module settings",
            "IMPERSONATE = {",
            "    \"URI_EXCLUSIONS\": [r\"^dashboard/\"],",
            "    \"CUSTOM_USER_QUERYSET\": \"saleor.account.impersonate.get_impersonatable_users\",  # noqa",
            "    \"USE_HTTP_REFERER\": True,",
            "    \"CUSTOM_ALLOW\": \"saleor.account.impersonate.can_impersonate\",",
            "}",
            "",
            "",
            "# Rich-text editor",
            "ALLOWED_TAGS = [",
            "    \"a\",",
            "    \"b\",",
            "    \"blockquote\",",
            "    \"br\",",
            "    \"em\",",
            "    \"h2\",",
            "    \"h3\",",
            "    \"i\",",
            "    \"img\",",
            "    \"li\",",
            "    \"ol\",",
            "    \"p\",",
            "    \"strong\",",
            "    \"ul\",",
            "]",
            "ALLOWED_ATTRIBUTES = {\"*\": [\"align\", \"style\"], \"a\": [\"href\", \"title\"], \"img\": [\"src\"]}",
            "ALLOWED_STYLES = [\"text-align\"]",
            "",
            "",
            "# Slugs for menus precreated in Django migrations",
            "DEFAULT_MENUS = {\"top_menu_name\": \"navbar\", \"bottom_menu_name\": \"footer\"}",
            "",
            "# This enable the new 'No Captcha reCaptcha' version (the simple checkbox)",
            "# instead of the old (deprecated) one. For more information see:",
            "#   https://github.com/praekelt/django-recaptcha/blob/34af16ba1e/README.rst",
            "NOCAPTCHA = True",
            "",
            "# Set Google's reCaptcha keys",
            "RECAPTCHA_PUBLIC_KEY = os.environ.get(\"RECAPTCHA_PUBLIC_KEY\")",
            "RECAPTCHA_PRIVATE_KEY = os.environ.get(\"RECAPTCHA_PRIVATE_KEY\")",
            "",
            "",
            "#  Sentry",
            "SENTRY_DSN = os.environ.get(\"SENTRY_DSN\")",
            "if SENTRY_DSN:",
            "    INSTALLED_APPS.append(\"raven.contrib.django.raven_compat\")",
            "    RAVEN_CONFIG = {\"dsn\": SENTRY_DSN, \"release\": __version__}",
            "",
            "",
            "SERIALIZATION_MODULES = {\"json\": \"saleor.core.utils.json_serializer\"}",
            "",
            "",
            "DUMMY = \"dummy\"",
            "BRAINTREE = \"braintree\"",
            "RAZORPAY = \"razorpay\"",
            "STRIPE = \"stripe\"",
            "",
            "CHECKOUT_PAYMENT_GATEWAYS = {",
            "    DUMMY: pgettext_lazy(\"Payment method name\", \"Dummy gateway\")",
            "}",
            "",
            "PAYMENT_GATEWAYS = {",
            "    DUMMY: {",
            "        \"module\": \"saleor.payment.gateways.dummy\",",
            "        \"config\": {",
            "            \"auto_capture\": True,",
            "            \"connection_params\": {},",
            "            \"template_path\": \"order/payment/dummy.html\",",
            "        },",
            "    },",
            "    BRAINTREE: {",
            "        \"module\": \"saleor.payment.gateways.braintree\",",
            "        \"config\": {",
            "            \"auto_capture\": True,",
            "            \"template_path\": \"order/payment/braintree.html\",",
            "            \"connection_params\": {",
            "                \"sandbox_mode\": get_bool_from_env(\"BRAINTREE_SANDBOX_MODE\", True),",
            "                \"merchant_id\": os.environ.get(\"BRAINTREE_MERCHANT_ID\"),",
            "                \"public_key\": os.environ.get(\"BRAINTREE_PUBLIC_KEY\"),",
            "                \"private_key\": os.environ.get(\"BRAINTREE_PRIVATE_KEY\"),",
            "            },",
            "        },",
            "    },",
            "    RAZORPAY: {",
            "        \"module\": \"saleor.payment.gateways.razorpay\",",
            "        \"config\": {",
            "            \"auto_capture\": None,",
            "            \"template_path\": \"order/payment/razorpay.html\",",
            "            \"connection_params\": {",
            "                \"public_key\": os.environ.get(\"RAZORPAY_PUBLIC_KEY\"),",
            "                \"secret_key\": os.environ.get(\"RAZORPAY_SECRET_KEY\"),",
            "                \"prefill\": get_bool_from_env(\"RAZORPAY_PREFILL\", True),",
            "                \"store_name\": os.environ.get(\"RAZORPAY_STORE_NAME\"),",
            "                \"store_image\": os.environ.get(\"RAZORPAY_STORE_IMAGE\"),",
            "            },",
            "        },",
            "    },",
            "    STRIPE: {",
            "        \"module\": \"saleor.payment.gateways.stripe\",",
            "        \"config\": {",
            "            \"auto_capture\": True,",
            "            \"template_path\": \"order/payment/stripe.html\",",
            "            \"connection_params\": {",
            "                \"public_key\": os.environ.get(\"STRIPE_PUBLIC_KEY\"),",
            "                \"secret_key\": os.environ.get(\"STRIPE_SECRET_KEY\"),",
            "                \"store_name\": os.environ.get(\"STRIPE_STORE_NAME\", \"Saleor\"),",
            "                \"store_image\": os.environ.get(\"STRIPE_STORE_IMAGE\", None),",
            "                \"prefill\": get_bool_from_env(\"STRIPE_PREFILL\", True),",
            "                \"remember_me\": os.environ.get(\"STRIPE_REMEMBER_ME\", True),",
            "                \"locale\": os.environ.get(\"STRIPE_LOCALE\", \"auto\"),",
            "                \"enable_billing_address\": os.environ.get(",
            "                    \"STRIPE_ENABLE_BILLING_ADDRESS\", False",
            "                ),",
            "                \"enable_shipping_address\": os.environ.get(",
            "                    \"STRIPE_ENABLE_SHIPPING_ADDRESS\", False",
            "                ),",
            "            },",
            "        },",
            "    },",
            "}",
            "",
            "GRAPHENE = {",
            "    \"RELAY_CONNECTION_ENFORCE_FIRST_OR_LAST\": True,",
            "    \"RELAY_CONNECTION_MAX_LIMIT\": 100,",
            "}"
        ],
        "action": [
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "198": [],
            "199": [],
            "200": [],
            "201": [],
            "202": [],
            "203": [],
            "204": [],
            "205": [],
            "212": [],
            "213": []
        },
        "addLocation": []
    }
}