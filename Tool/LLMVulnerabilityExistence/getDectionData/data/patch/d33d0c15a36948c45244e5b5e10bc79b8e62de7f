{
    "examples/example_plugin/example_plugin/jobs.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 113,
                "afterPatchRowNumber": 113,
                "PatchRowcode": "                 self.log_failure(obj=obj, message=f\"User '{user}' does not have permission to add a Site.\")"
            },
            "1": {
                "beforePatchRowNumber": 114,
                "afterPatchRowNumber": 114,
                "PatchRowcode": "             else:"
            },
            "2": {
                "beforePatchRowNumber": 115,
                "afterPatchRowNumber": 115,
                "PatchRowcode": "                 self._run_site_job(obj)"
            },
            "3": {
                "beforePatchRowNumber": 116,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        if isinstance(obj, Device):"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 116,
                "PatchRowcode": "+        elif isinstance(obj, Device):"
            },
            "5": {
                "beforePatchRowNumber": 117,
                "afterPatchRowNumber": 117,
                "PatchRowcode": "             if not user.has_perm(\"dcim.add_device\"):"
            },
            "6": {
                "beforePatchRowNumber": 118,
                "afterPatchRowNumber": 118,
                "PatchRowcode": "                 self.log_failure(obj=obj, message=f\"User '{user}' does not have permission to add a Device.\")"
            },
            "7": {
                "beforePatchRowNumber": 119,
                "afterPatchRowNumber": 119,
                "PatchRowcode": "             else:"
            },
            "8": {
                "beforePatchRowNumber": 120,
                "afterPatchRowNumber": 120,
                "PatchRowcode": "                 self._run_device_job(obj)"
            },
            "9": {
                "beforePatchRowNumber": 121,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.log_failure(obj=obj, message=f\"Unable to run Job Button for type {type(obj).__name__}.\")"
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 121,
                "PatchRowcode": "+        else:"
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 122,
                "PatchRowcode": "+            self.log_failure(obj=obj, message=f\"Unable to run Job Button for type {type(obj).__name__}.\")"
            },
            "12": {
                "beforePatchRowNumber": 122,
                "afterPatchRowNumber": 123,
                "PatchRowcode": " "
            },
            "13": {
                "beforePatchRowNumber": 123,
                "afterPatchRowNumber": 124,
                "PatchRowcode": " "
            },
            "14": {
                "beforePatchRowNumber": 124,
                "afterPatchRowNumber": 125,
                "PatchRowcode": " jobs = ("
            }
        },
        "frontPatchFile": [
            "import time",
            "",
            "from django.conf import settings",
            "",
            "from nautobot.dcim.models import Device, Site",
            "from nautobot.extras.choices import ObjectChangeActionChoices",
            "from nautobot.extras.jobs import IntegerVar, Job, JobHookReceiver, JobButtonReceiver",
            "",
            "",
            "name = \"ExamplePlugin jobs\"",
            "",
            "",
            "class ExampleJob(Job):",
            "    # specify template_name to override the default job scheduling template",
            "    template_name = \"example_plugin/example_with_custom_template.html\"",
            "",
            "    class Meta:",
            "        name = \"Example job, does nothing\"",
            "        description = \"\"\"",
            "            Markdown Formatting",
            "",
            "            *This is italicized*",
            "        \"\"\"",
            "",
            "",
            "class ExampleHiddenJob(Job):",
            "    class Meta:",
            "        hidden = True",
            "        name = \"Example hidden job\"",
            "        description = \"I should not show in the UI!\"",
            "",
            "",
            "class ExampleLoggingJob(Job):",
            "    interval = IntegerVar(default=4, description=\"The time in seconds to sleep.\")",
            "",
            "    class Meta:",
            "        name = \"Example logging job.\"",
            "        description = \"I log stuff to demonstrate how UI logging works.\"",
            "        task_queues = [",
            "            settings.CELERY_TASK_DEFAULT_QUEUE,",
            "            \"priority\",",
            "            \"bulk\",",
            "        ]",
            "",
            "    def run(self, data, commit):",
            "        interval = data[\"interval\"]",
            "        self.log_debug(message=f\"Running for {interval} seconds.\")",
            "        for step in range(1, interval + 1):",
            "            time.sleep(1)",
            "            self.log_info(message=f\"Step {step}\")",
            "        self.log_success(obj=None)",
            "        return f\"Ran for {interval} seconds\"",
            "",
            "",
            "class ExampleJobHookReceiver(JobHookReceiver):",
            "    class Meta:",
            "        name = \"Example job hook receiver\"",
            "        description = \"Validate changes to object serial field\"",
            "",
            "    def receive_job_hook(self, change, action, changed_object):",
            "        # return on delete action",
            "        if action == ObjectChangeActionChoices.ACTION_DELETE:",
            "            return",
            "",
            "        # log diff output",
            "        snapshots = change.get_snapshots()",
            "        self.log_info(f\"DIFF: {snapshots['differences']}\")",
            "",
            "        # validate changes to serial field",
            "        if \"serial\" in snapshots[\"differences\"][\"added\"]:",
            "            old_serial = snapshots[\"differences\"][\"removed\"][\"serial\"]",
            "            new_serial = snapshots[\"differences\"][\"added\"][\"serial\"]",
            "            self.log_info(f\"{changed_object} serial has been changed from {old_serial} to {new_serial}\")",
            "",
            "            # Check the new serial is valid and revert if necessary",
            "            if not self.validate_serial(new_serial):",
            "                changed_object.serial = old_serial",
            "                changed_object.save()",
            "                self.log_info(f\"{changed_object} serial {new_serial} was not valid. Reverted to {old_serial}\")",
            "",
            "            self.log_success(message=f\"Serial validation completed for {changed_object}\")",
            "",
            "    def validate_serial(self, serial):",
            "        # add business logic to validate serial",
            "        return False",
            "",
            "",
            "class ExampleSimpleJobButtonReceiver(JobButtonReceiver):",
            "    class Meta:",
            "        name = \"Example Simple Job Button Receiver\"",
            "",
            "    def receive_job_button(self, obj):",
            "        self.log_info(obj=obj, message=\"Running Job Button Receiver.\")",
            "        # Add job logic here",
            "",
            "",
            "class ExampleComplexJobButtonReceiver(JobButtonReceiver):",
            "    class Meta:",
            "        name = \"Example Complex Job Button Receiver\"",
            "",
            "    def _run_site_job(self, obj):",
            "        self.log_info(obj=obj, message=\"Running Site Job Button Receiver.\")",
            "        # Run Site Job function",
            "",
            "    def _run_device_job(self, obj):",
            "        self.log_info(obj=obj, message=\"Running Device Job Button Receiver.\")",
            "        # Run Device Job function",
            "",
            "    def receive_job_button(self, obj):",
            "        user = self.request.user",
            "        if isinstance(obj, Site):",
            "            if not user.has_perm(\"dcim.add_site\"):",
            "                self.log_failure(obj=obj, message=f\"User '{user}' does not have permission to add a Site.\")",
            "            else:",
            "                self._run_site_job(obj)",
            "        if isinstance(obj, Device):",
            "            if not user.has_perm(\"dcim.add_device\"):",
            "                self.log_failure(obj=obj, message=f\"User '{user}' does not have permission to add a Device.\")",
            "            else:",
            "                self._run_device_job(obj)",
            "        self.log_failure(obj=obj, message=f\"Unable to run Job Button for type {type(obj).__name__}.\")",
            "",
            "",
            "jobs = (",
            "    ExampleJob,",
            "    ExampleHiddenJob,",
            "    ExampleLoggingJob,",
            "    ExampleJobHookReceiver,",
            "    ExampleSimpleJobButtonReceiver,",
            "    ExampleComplexJobButtonReceiver,",
            ")"
        ],
        "afterPatchFile": [
            "import time",
            "",
            "from django.conf import settings",
            "",
            "from nautobot.dcim.models import Device, Site",
            "from nautobot.extras.choices import ObjectChangeActionChoices",
            "from nautobot.extras.jobs import IntegerVar, Job, JobHookReceiver, JobButtonReceiver",
            "",
            "",
            "name = \"ExamplePlugin jobs\"",
            "",
            "",
            "class ExampleJob(Job):",
            "    # specify template_name to override the default job scheduling template",
            "    template_name = \"example_plugin/example_with_custom_template.html\"",
            "",
            "    class Meta:",
            "        name = \"Example job, does nothing\"",
            "        description = \"\"\"",
            "            Markdown Formatting",
            "",
            "            *This is italicized*",
            "        \"\"\"",
            "",
            "",
            "class ExampleHiddenJob(Job):",
            "    class Meta:",
            "        hidden = True",
            "        name = \"Example hidden job\"",
            "        description = \"I should not show in the UI!\"",
            "",
            "",
            "class ExampleLoggingJob(Job):",
            "    interval = IntegerVar(default=4, description=\"The time in seconds to sleep.\")",
            "",
            "    class Meta:",
            "        name = \"Example logging job.\"",
            "        description = \"I log stuff to demonstrate how UI logging works.\"",
            "        task_queues = [",
            "            settings.CELERY_TASK_DEFAULT_QUEUE,",
            "            \"priority\",",
            "            \"bulk\",",
            "        ]",
            "",
            "    def run(self, data, commit):",
            "        interval = data[\"interval\"]",
            "        self.log_debug(message=f\"Running for {interval} seconds.\")",
            "        for step in range(1, interval + 1):",
            "            time.sleep(1)",
            "            self.log_info(message=f\"Step {step}\")",
            "        self.log_success(obj=None)",
            "        return f\"Ran for {interval} seconds\"",
            "",
            "",
            "class ExampleJobHookReceiver(JobHookReceiver):",
            "    class Meta:",
            "        name = \"Example job hook receiver\"",
            "        description = \"Validate changes to object serial field\"",
            "",
            "    def receive_job_hook(self, change, action, changed_object):",
            "        # return on delete action",
            "        if action == ObjectChangeActionChoices.ACTION_DELETE:",
            "            return",
            "",
            "        # log diff output",
            "        snapshots = change.get_snapshots()",
            "        self.log_info(f\"DIFF: {snapshots['differences']}\")",
            "",
            "        # validate changes to serial field",
            "        if \"serial\" in snapshots[\"differences\"][\"added\"]:",
            "            old_serial = snapshots[\"differences\"][\"removed\"][\"serial\"]",
            "            new_serial = snapshots[\"differences\"][\"added\"][\"serial\"]",
            "            self.log_info(f\"{changed_object} serial has been changed from {old_serial} to {new_serial}\")",
            "",
            "            # Check the new serial is valid and revert if necessary",
            "            if not self.validate_serial(new_serial):",
            "                changed_object.serial = old_serial",
            "                changed_object.save()",
            "                self.log_info(f\"{changed_object} serial {new_serial} was not valid. Reverted to {old_serial}\")",
            "",
            "            self.log_success(message=f\"Serial validation completed for {changed_object}\")",
            "",
            "    def validate_serial(self, serial):",
            "        # add business logic to validate serial",
            "        return False",
            "",
            "",
            "class ExampleSimpleJobButtonReceiver(JobButtonReceiver):",
            "    class Meta:",
            "        name = \"Example Simple Job Button Receiver\"",
            "",
            "    def receive_job_button(self, obj):",
            "        self.log_info(obj=obj, message=\"Running Job Button Receiver.\")",
            "        # Add job logic here",
            "",
            "",
            "class ExampleComplexJobButtonReceiver(JobButtonReceiver):",
            "    class Meta:",
            "        name = \"Example Complex Job Button Receiver\"",
            "",
            "    def _run_site_job(self, obj):",
            "        self.log_info(obj=obj, message=\"Running Site Job Button Receiver.\")",
            "        # Run Site Job function",
            "",
            "    def _run_device_job(self, obj):",
            "        self.log_info(obj=obj, message=\"Running Device Job Button Receiver.\")",
            "        # Run Device Job function",
            "",
            "    def receive_job_button(self, obj):",
            "        user = self.request.user",
            "        if isinstance(obj, Site):",
            "            if not user.has_perm(\"dcim.add_site\"):",
            "                self.log_failure(obj=obj, message=f\"User '{user}' does not have permission to add a Site.\")",
            "            else:",
            "                self._run_site_job(obj)",
            "        elif isinstance(obj, Device):",
            "            if not user.has_perm(\"dcim.add_device\"):",
            "                self.log_failure(obj=obj, message=f\"User '{user}' does not have permission to add a Device.\")",
            "            else:",
            "                self._run_device_job(obj)",
            "        else:",
            "            self.log_failure(obj=obj, message=f\"Unable to run Job Button for type {type(obj).__name__}.\")",
            "",
            "",
            "jobs = (",
            "    ExampleJob,",
            "    ExampleHiddenJob,",
            "    ExampleLoggingJob,",
            "    ExampleJobHookReceiver,",
            "    ExampleSimpleJobButtonReceiver,",
            "    ExampleComplexJobButtonReceiver,",
            ")"
        ],
        "action": [
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "116": [
                "ExampleComplexJobButtonReceiver",
                "receive_job_button"
            ],
            "121": [
                "ExampleComplexJobButtonReceiver",
                "receive_job_button"
            ]
        },
        "addLocation": []
    },
    "nautobot/extras/templatetags/job_buttons.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 6,
                "afterPatchRowNumber": 6,
                "PatchRowcode": " from django.utils.html import format_html"
            },
            "1": {
                "beforePatchRowNumber": 7,
                "afterPatchRowNumber": 7,
                "PatchRowcode": " from django.utils.safestring import mark_safe"
            },
            "2": {
                "beforePatchRowNumber": 8,
                "afterPatchRowNumber": 8,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": 9,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-from nautobot.extras.models import JobButton"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 9,
                "PatchRowcode": "+from nautobot.extras.models import Job, JobButton"
            },
            "5": {
                "beforePatchRowNumber": 10,
                "afterPatchRowNumber": 10,
                "PatchRowcode": " from nautobot.utilities.utils import render_jinja2"
            },
            "6": {
                "beforePatchRowNumber": 11,
                "afterPatchRowNumber": 11,
                "PatchRowcode": " "
            },
            "7": {
                "beforePatchRowNumber": 12,
                "afterPatchRowNumber": 12,
                "PatchRowcode": " "
            },
            "8": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": 27,
                "PatchRowcode": " <input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{csrf_token}\">"
            },
            "9": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": 28,
                "PatchRowcode": " <input type=\"hidden\" name=\"object_pk\" value=\"{object_pk}\">"
            },
            "10": {
                "beforePatchRowNumber": 29,
                "afterPatchRowNumber": 29,
                "PatchRowcode": " <input type=\"hidden\" name=\"object_model_name\" value=\"{object_model_name}\">"
            },
            "11": {
                "beforePatchRowNumber": 30,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-<input type=\"hidden\" name=\"redirect_path\" value=\"{redirect_path}\">"
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 30,
                "PatchRowcode": "+<input type=\"hidden\" name=\"_schedule_type\" value=\"immediately\">"
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 31,
                "PatchRowcode": "+<input type=\"hidden\" name=\"_return_url\" value=\"{redirect_path}\">"
            },
            "14": {
                "beforePatchRowNumber": 31,
                "afterPatchRowNumber": 32,
                "PatchRowcode": " \"\"\""
            },
            "15": {
                "beforePatchRowNumber": 32,
                "afterPatchRowNumber": 33,
                "PatchRowcode": " "
            },
            "16": {
                "beforePatchRowNumber": 33,
                "afterPatchRowNumber": 34,
                "PatchRowcode": " NO_CONFIRM_BUTTON = \"\"\""
            },
            "17": {
                "beforePatchRowNumber": 69,
                "afterPatchRowNumber": 70,
                "PatchRowcode": " </div>"
            },
            "18": {
                "beforePatchRowNumber": 70,
                "afterPatchRowNumber": 71,
                "PatchRowcode": " \"\"\""
            },
            "19": {
                "beforePatchRowNumber": 71,
                "afterPatchRowNumber": 72,
                "PatchRowcode": " "
            },
            "20": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 73,
                "PatchRowcode": "+SAFE_EMPTY_STR = mark_safe(\"\")  # noqa: S308"
            },
            "21": {
                "beforePatchRowNumber": 72,
                "afterPatchRowNumber": 74,
                "PatchRowcode": " "
            },
            "22": {
                "beforePatchRowNumber": 73,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-@register.simple_tag(takes_context=True)"
            },
            "23": {
                "beforePatchRowNumber": 74,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-def job_buttons(context, obj):"
            },
            "24": {
                "beforePatchRowNumber": 75,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    \"\"\""
            },
            "25": {
                "beforePatchRowNumber": 76,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    Render all applicable job buttons for the given object."
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 75,
                "PatchRowcode": "+"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 76,
                "PatchRowcode": "+def _render_job_button_for_obj(job_button, obj, context, content_type):"
            },
            "28": {
                "beforePatchRowNumber": 77,
                "afterPatchRowNumber": 77,
                "PatchRowcode": "     \"\"\""
            },
            "29": {
                "beforePatchRowNumber": 78,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    content_type = ContentType.objects.get_for_model(obj)"
            },
            "30": {
                "beforePatchRowNumber": 79,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    buttons = JobButton.objects.filter(content_types=content_type)"
            },
            "31": {
                "beforePatchRowNumber": 80,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    if not buttons:"
            },
            "32": {
                "beforePatchRowNumber": 81,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        return \"\""
            },
            "33": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 78,
                "PatchRowcode": "+    Helper method for job_buttons templatetag to reduce repetition of code."
            },
            "34": {
                "beforePatchRowNumber": 82,
                "afterPatchRowNumber": 79,
                "PatchRowcode": " "
            },
            "35": {
                "beforePatchRowNumber": 83,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    # Pass select context data when rendering the JobButton"
            },
            "36": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 80,
                "PatchRowcode": "+    Returns:"
            },
            "37": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 81,
                "PatchRowcode": "+       (str, str): (button_html, form_html)"
            },
            "38": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 82,
                "PatchRowcode": "+    \"\"\""
            },
            "39": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 83,
                "PatchRowcode": "+    # Pass select context data when rendering the JobButton text as Jinja2"
            },
            "40": {
                "beforePatchRowNumber": 84,
                "afterPatchRowNumber": 84,
                "PatchRowcode": "     button_context = {"
            },
            "41": {
                "beforePatchRowNumber": 85,
                "afterPatchRowNumber": 85,
                "PatchRowcode": "         \"obj\": obj,"
            },
            "42": {
                "beforePatchRowNumber": 86,
                "afterPatchRowNumber": 86,
                "PatchRowcode": "         \"debug\": context.get(\"debug\", False),  # django.template.context_processors.debug"
            },
            "43": {
                "beforePatchRowNumber": 87,
                "afterPatchRowNumber": 87,
                "PatchRowcode": "         \"request\": context[\"request\"],  # django.template.context_processors.request"
            },
            "44": {
                "beforePatchRowNumber": 88,
                "afterPatchRowNumber": 88,
                "PatchRowcode": "         \"user\": context[\"user\"],  # django.contrib.auth.context_processors.auth"
            },
            "45": {
                "beforePatchRowNumber": 89,
                "afterPatchRowNumber": 89,
                "PatchRowcode": "         \"perms\": context[\"perms\"],  # django.contrib.auth.context_processors.auth"
            },
            "46": {
                "beforePatchRowNumber": 90,
                "afterPatchRowNumber": 90,
                "PatchRowcode": "     }"
            },
            "47": {
                "beforePatchRowNumber": 91,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    buttons_html = forms_html = mark_safe(\"\")  # noqa: S308"
            },
            "48": {
                "beforePatchRowNumber": 92,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    group_names = OrderedDict()"
            },
            "49": {
                "beforePatchRowNumber": 93,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "50": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 91,
                "PatchRowcode": "+    try:"
            },
            "51": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 92,
                "PatchRowcode": "+        text_rendered = render_jinja2(job_button.text, button_context)"
            },
            "52": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 93,
                "PatchRowcode": "+    except Exception as exc:"
            },
            "53": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 94,
                "PatchRowcode": "+        return ("
            },
            "54": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 95,
                "PatchRowcode": "+            format_html("
            },
            "55": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 96,
                "PatchRowcode": "+                '<a class=\"btn btn-sm btn-{}\" disabled=\"disabled\" title=\"{}\"><i class=\"mdi mdi-alert\"></i> {}</a>\\n',"
            },
            "56": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 97,
                "PatchRowcode": "+                \"default\" if not job_button.group_name else \"link\","
            },
            "57": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 98,
                "PatchRowcode": "+                exc,"
            },
            "58": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 99,
                "PatchRowcode": "+                job_button.name,"
            },
            "59": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 100,
                "PatchRowcode": "+            ),"
            },
            "60": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 101,
                "PatchRowcode": "+            SAFE_EMPTY_STR,"
            },
            "61": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 102,
                "PatchRowcode": "+        )"
            },
            "62": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 103,
                "PatchRowcode": "+"
            },
            "63": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 104,
                "PatchRowcode": "+    if not text_rendered:"
            },
            "64": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 105,
                "PatchRowcode": "+        return (SAFE_EMPTY_STR, SAFE_EMPTY_STR)"
            },
            "65": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 106,
                "PatchRowcode": "+"
            },
            "66": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 107,
                "PatchRowcode": "+    # Disable buttons if the user doesn't have permission to run the underlying Job."
            },
            "67": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 108,
                "PatchRowcode": "+    has_run_perm = Job.objects.check_perms(context[\"user\"], instance=job_button.job, action=\"run\")"
            },
            "68": {
                "beforePatchRowNumber": 94,
                "afterPatchRowNumber": 109,
                "PatchRowcode": "     hidden_inputs = format_html("
            },
            "69": {
                "beforePatchRowNumber": 95,
                "afterPatchRowNumber": 110,
                "PatchRowcode": "         HIDDEN_INPUTS,"
            },
            "70": {
                "beforePatchRowNumber": 96,
                "afterPatchRowNumber": 111,
                "PatchRowcode": "         csrf_token=context[\"csrf_token\"],"
            },
            "71": {
                "beforePatchRowNumber": 97,
                "afterPatchRowNumber": 112,
                "PatchRowcode": "         object_pk=obj.pk,"
            },
            "72": {
                "beforePatchRowNumber": 98,
                "afterPatchRowNumber": 113,
                "PatchRowcode": "         object_model_name=f\"{content_type.app_label}.{content_type.model}\","
            },
            "73": {
                "beforePatchRowNumber": 99,
                "afterPatchRowNumber": 114,
                "PatchRowcode": "         redirect_path=context[\"request\"].path,"
            },
            "74": {
                "beforePatchRowNumber": 100,
                "afterPatchRowNumber": 115,
                "PatchRowcode": "     )"
            },
            "75": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 116,
                "PatchRowcode": "+    template_args = {"
            },
            "76": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 117,
                "PatchRowcode": "+        \"button_id\": job_button.pk,"
            },
            "77": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 118,
                "PatchRowcode": "+        \"button_text\": text_rendered,"
            },
            "78": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 119,
                "PatchRowcode": "+        \"button_class\": job_button.button_class if not job_button.group_name else \"link\","
            },
            "79": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 120,
                "PatchRowcode": "+        \"button_url\": reverse(\"extras:job_run\", kwargs={\"slug\": job_button.job.slug}),"
            },
            "80": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 121,
                "PatchRowcode": "+        \"object\": obj,"
            },
            "81": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 122,
                "PatchRowcode": "+        \"job\": job_button.job,"
            },
            "82": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 123,
                "PatchRowcode": "+        \"hidden_inputs\": hidden_inputs,"
            },
            "83": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 124,
                "PatchRowcode": "+        \"disabled\": \"\" if has_run_perm else \"disabled\","
            },
            "84": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 125,
                "PatchRowcode": "+    }"
            },
            "85": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 126,
                "PatchRowcode": "+"
            },
            "86": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 127,
                "PatchRowcode": "+    if job_button.confirmation:"
            },
            "87": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 128,
                "PatchRowcode": "+        return ("
            },
            "88": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 129,
                "PatchRowcode": "+            format_html(CONFIRM_BUTTON, **template_args),"
            },
            "89": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 130,
                "PatchRowcode": "+            format_html(CONFIRM_MODAL, **template_args),"
            },
            "90": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 131,
                "PatchRowcode": "+        )"
            },
            "91": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 132,
                "PatchRowcode": "+    else:"
            },
            "92": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 133,
                "PatchRowcode": "+        return ("
            },
            "93": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 134,
                "PatchRowcode": "+            format_html(NO_CONFIRM_BUTTON, **template_args),"
            },
            "94": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 135,
                "PatchRowcode": "+            format_html(NO_CONFIRM_FORM, **template_args),"
            },
            "95": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 136,
                "PatchRowcode": "+        )"
            },
            "96": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 137,
                "PatchRowcode": "+"
            },
            "97": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 138,
                "PatchRowcode": "+"
            },
            "98": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 139,
                "PatchRowcode": "+@register.simple_tag(takes_context=True)"
            },
            "99": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 140,
                "PatchRowcode": "+def job_buttons(context, obj):"
            },
            "100": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 141,
                "PatchRowcode": "+    \"\"\""
            },
            "101": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 142,
                "PatchRowcode": "+    Render all applicable job buttons for the given object."
            },
            "102": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 143,
                "PatchRowcode": "+    \"\"\""
            },
            "103": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 144,
                "PatchRowcode": "+    content_type = ContentType.objects.get_for_model(obj)"
            },
            "104": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 145,
                "PatchRowcode": "+    # We will enforce \"run\" permission later in deciding which buttons to show as disabled."
            },
            "105": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 146,
                "PatchRowcode": "+    buttons = JobButton.objects.filter(content_types=content_type)"
            },
            "106": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 147,
                "PatchRowcode": "+    if not buttons:"
            },
            "107": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 148,
                "PatchRowcode": "+        return SAFE_EMPTY_STR"
            },
            "108": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 149,
                "PatchRowcode": "+"
            },
            "109": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 150,
                "PatchRowcode": "+    buttons_html = forms_html = SAFE_EMPTY_STR"
            },
            "110": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 151,
                "PatchRowcode": "+    group_names = OrderedDict()"
            },
            "111": {
                "beforePatchRowNumber": 101,
                "afterPatchRowNumber": 152,
                "PatchRowcode": " "
            },
            "112": {
                "beforePatchRowNumber": 102,
                "afterPatchRowNumber": 153,
                "PatchRowcode": "     for jb in buttons:"
            },
            "113": {
                "beforePatchRowNumber": 103,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        template_args = {"
            },
            "114": {
                "beforePatchRowNumber": 104,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            \"button_id\": jb.pk,"
            },
            "115": {
                "beforePatchRowNumber": 105,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            \"button_text\": jb.text,"
            },
            "116": {
                "beforePatchRowNumber": 106,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            \"button_class\": jb.button_class,"
            },
            "117": {
                "beforePatchRowNumber": 107,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            \"button_url\": reverse(\"extras:jobbutton_run\", kwargs={\"pk\": jb.pk}),"
            },
            "118": {
                "beforePatchRowNumber": 108,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            \"object\": obj,"
            },
            "119": {
                "beforePatchRowNumber": 109,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            \"job\": jb.job,"
            },
            "120": {
                "beforePatchRowNumber": 110,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            \"hidden_inputs\": hidden_inputs,"
            },
            "121": {
                "beforePatchRowNumber": 111,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            \"disabled\": \"\" if context[\"user\"].has_perms((\"extras.run_jobbutton\", \"extras.run_job\")) else \"disabled\","
            },
            "122": {
                "beforePatchRowNumber": 112,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        }"
            },
            "123": {
                "beforePatchRowNumber": 113,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "124": {
                "beforePatchRowNumber": 114,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        # Organize job buttons by group"
            },
            "125": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 154,
                "PatchRowcode": "+        # Organize job buttons by group for later processing"
            },
            "126": {
                "beforePatchRowNumber": 115,
                "afterPatchRowNumber": 155,
                "PatchRowcode": "         if jb.group_name:"
            },
            "127": {
                "beforePatchRowNumber": 116,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            group_names.setdefault(jb.group_name, [])"
            },
            "128": {
                "beforePatchRowNumber": 117,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            group_names[jb.group_name].append(jb)"
            },
            "129": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 156,
                "PatchRowcode": "+            group_names.setdefault(jb.group_name, []).append(jb)"
            },
            "130": {
                "beforePatchRowNumber": 118,
                "afterPatchRowNumber": 157,
                "PatchRowcode": " "
            },
            "131": {
                "beforePatchRowNumber": 119,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        # Add non-grouped buttons"
            },
            "132": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 158,
                "PatchRowcode": "+        # Render and add non-grouped buttons"
            },
            "133": {
                "beforePatchRowNumber": 120,
                "afterPatchRowNumber": 159,
                "PatchRowcode": "         else:"
            },
            "134": {
                "beforePatchRowNumber": 121,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            try:"
            },
            "135": {
                "beforePatchRowNumber": 122,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                text_rendered = render_jinja2(jb.text, button_context)"
            },
            "136": {
                "beforePatchRowNumber": 123,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                if text_rendered:"
            },
            "137": {
                "beforePatchRowNumber": 124,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    template_args[\"button_text\"] = text_rendered"
            },
            "138": {
                "beforePatchRowNumber": 125,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    if jb.confirmation:"
            },
            "139": {
                "beforePatchRowNumber": 126,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        buttons_html += format_html(CONFIRM_BUTTON, **template_args)"
            },
            "140": {
                "beforePatchRowNumber": 127,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        forms_html += format_html(CONFIRM_MODAL, **template_args)"
            },
            "141": {
                "beforePatchRowNumber": 128,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    else:"
            },
            "142": {
                "beforePatchRowNumber": 129,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        buttons_html += format_html(NO_CONFIRM_BUTTON, **template_args)"
            },
            "143": {
                "beforePatchRowNumber": 130,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        forms_html += format_html(NO_CONFIRM_FORM, **template_args)"
            },
            "144": {
                "beforePatchRowNumber": 131,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            except Exception as e:"
            },
            "145": {
                "beforePatchRowNumber": 132,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                buttons_html += format_html("
            },
            "146": {
                "beforePatchRowNumber": 133,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    '<a class=\"btn btn-sm btn-default\" disabled=\"disabled\" title=\"{}\">'"
            },
            "147": {
                "beforePatchRowNumber": 134,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    '<i class=\"mdi mdi-alert\"></i> {}</a>\\n',"
            },
            "148": {
                "beforePatchRowNumber": 135,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    e,"
            },
            "149": {
                "beforePatchRowNumber": 136,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    jb.name,"
            },
            "150": {
                "beforePatchRowNumber": 137,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                )"
            },
            "151": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 160,
                "PatchRowcode": "+            button_html, form_html = _render_job_button_for_obj(jb, obj, context, content_type)"
            },
            "152": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 161,
                "PatchRowcode": "+            buttons_html += button_html"
            },
            "153": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 162,
                "PatchRowcode": "+            forms_html += form_html"
            },
            "154": {
                "beforePatchRowNumber": 138,
                "afterPatchRowNumber": 163,
                "PatchRowcode": " "
            },
            "155": {
                "beforePatchRowNumber": 139,
                "afterPatchRowNumber": 164,
                "PatchRowcode": "     # Add grouped buttons to template"
            },
            "156": {
                "beforePatchRowNumber": 140,
                "afterPatchRowNumber": 165,
                "PatchRowcode": "     for group_name, buttons in group_names.items():"
            },
            "157": {
                "beforePatchRowNumber": 141,
                "afterPatchRowNumber": 166,
                "PatchRowcode": "         group_button_class = buttons[0].button_class"
            },
            "158": {
                "beforePatchRowNumber": 142,
                "afterPatchRowNumber": 167,
                "PatchRowcode": " "
            },
            "159": {
                "beforePatchRowNumber": 143,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        buttons_rendered = mark_safe(\"\")  # noqa: S308"
            },
            "160": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 168,
                "PatchRowcode": "+        buttons_rendered = SAFE_EMPTY_STR"
            },
            "161": {
                "beforePatchRowNumber": 144,
                "afterPatchRowNumber": 169,
                "PatchRowcode": " "
            },
            "162": {
                "beforePatchRowNumber": 145,
                "afterPatchRowNumber": 170,
                "PatchRowcode": "         for jb in buttons:"
            },
            "163": {
                "beforePatchRowNumber": 146,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            template_args = {"
            },
            "164": {
                "beforePatchRowNumber": 147,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                \"button_id\": jb.pk,"
            },
            "165": {
                "beforePatchRowNumber": 148,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                \"button_text\": jb.text,"
            },
            "166": {
                "beforePatchRowNumber": 149,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                \"button_class\": \"link\","
            },
            "167": {
                "beforePatchRowNumber": 150,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                \"button_url\": reverse(\"extras:jobbutton_run\", kwargs={\"pk\": jb.pk}),"
            },
            "168": {
                "beforePatchRowNumber": 151,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                \"object\": obj,"
            },
            "169": {
                "beforePatchRowNumber": 152,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                \"job\": jb.job,"
            },
            "170": {
                "beforePatchRowNumber": 153,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                \"hidden_inputs\": hidden_inputs,"
            },
            "171": {
                "beforePatchRowNumber": 154,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                \"disabled\": \"\" if context[\"user\"].has_perms((\"extras.run_jobbutton\", \"extras.run_job\")) else \"disabled\","
            },
            "172": {
                "beforePatchRowNumber": 155,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            }"
            },
            "173": {
                "beforePatchRowNumber": 156,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            try:"
            },
            "174": {
                "beforePatchRowNumber": 157,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                text_rendered = render_jinja2(jb.text, button_context)"
            },
            "175": {
                "beforePatchRowNumber": 158,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                if text_rendered:"
            },
            "176": {
                "beforePatchRowNumber": 159,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    template_args[\"button_text\"] = text_rendered"
            },
            "177": {
                "beforePatchRowNumber": 160,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    if jb.confirmation:"
            },
            "178": {
                "beforePatchRowNumber": 161,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        buttons_rendered += ("
            },
            "179": {
                "beforePatchRowNumber": 162,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                            mark_safe(\"<li>\")  # noqa: S308"
            },
            "180": {
                "beforePatchRowNumber": 163,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                            + format_html(CONFIRM_BUTTON, **template_args)"
            },
            "181": {
                "beforePatchRowNumber": 164,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                            + mark_safe(\"</li>\")  # noqa: S308"
            },
            "182": {
                "beforePatchRowNumber": 165,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        )"
            },
            "183": {
                "beforePatchRowNumber": 166,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        forms_html += format_html(CONFIRM_MODAL, **template_args)"
            },
            "184": {
                "beforePatchRowNumber": 167,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    else:"
            },
            "185": {
                "beforePatchRowNumber": 168,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        buttons_rendered += ("
            },
            "186": {
                "beforePatchRowNumber": 169,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                            mark_safe(\"<li>\")  # noqa: S308"
            },
            "187": {
                "beforePatchRowNumber": 170,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                            + format_html(NO_CONFIRM_BUTTON, **template_args)"
            },
            "188": {
                "beforePatchRowNumber": 171,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                            + mark_safe(\"</li>\")  # noqa: S308"
            },
            "189": {
                "beforePatchRowNumber": 172,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        )"
            },
            "190": {
                "beforePatchRowNumber": 173,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        forms_html += format_html(NO_CONFIRM_FORM, **template_args)"
            },
            "191": {
                "beforePatchRowNumber": 174,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            except Exception as e:"
            },
            "192": {
                "beforePatchRowNumber": 175,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                buttons_rendered += format_html("
            },
            "193": {
                "beforePatchRowNumber": 176,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    '<li><a disabled=\"disabled\" title=\"{}\"><span class=\"text-muted\">'"
            },
            "194": {
                "beforePatchRowNumber": 177,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    '<i class=\"mdi mdi-alert\"></i> {}</span></a></li>',"
            },
            "195": {
                "beforePatchRowNumber": 178,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    e,"
            },
            "196": {
                "beforePatchRowNumber": 179,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    jb.name,"
            },
            "197": {
                "beforePatchRowNumber": 180,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                )"
            },
            "198": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 171,
                "PatchRowcode": "+            # Render grouped buttons as list items"
            },
            "199": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 172,
                "PatchRowcode": "+            button_html, form_html = _render_job_button_for_obj(jb, obj, context, content_type)"
            },
            "200": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 173,
                "PatchRowcode": "+            buttons_rendered += format_html(\"<li>{}</li>\", button_html)"
            },
            "201": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 174,
                "PatchRowcode": "+            forms_html += form_html"
            },
            "202": {
                "beforePatchRowNumber": 181,
                "afterPatchRowNumber": 175,
                "PatchRowcode": " "
            },
            "203": {
                "beforePatchRowNumber": 182,
                "afterPatchRowNumber": 176,
                "PatchRowcode": "         if buttons_rendered:"
            },
            "204": {
                "beforePatchRowNumber": 183,
                "afterPatchRowNumber": 177,
                "PatchRowcode": "             buttons_html += format_html("
            }
        },
        "frontPatchFile": [
            "from collections import OrderedDict",
            "",
            "from django import template",
            "from django.contrib.contenttypes.models import ContentType",
            "from django.urls import reverse",
            "from django.utils.html import format_html",
            "from django.utils.safestring import mark_safe",
            "",
            "from nautobot.extras.models import JobButton",
            "from nautobot.utilities.utils import render_jinja2",
            "",
            "",
            "register = template.Library()",
            "",
            "GROUP_DROPDOWN = \"\"\"",
            "<div class=\"btn-group\">",
            "  <button type=\"button\" class=\"btn btn-sm btn-{group_button_class} dropdown-toggle\" data-toggle=\"dropdown\">",
            "    {group_name} <span class=\"caret\"></span>",
            "  </button>",
            "  <ul class=\"dropdown-menu pull-right\">",
            "    {grouped_buttons}",
            "  </ul>",
            "</div>",
            "\"\"\"",
            "",
            "HIDDEN_INPUTS = \"\"\"",
            "<input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{csrf_token}\">",
            "<input type=\"hidden\" name=\"object_pk\" value=\"{object_pk}\">",
            "<input type=\"hidden\" name=\"object_model_name\" value=\"{object_model_name}\">",
            "<input type=\"hidden\" name=\"redirect_path\" value=\"{redirect_path}\">",
            "\"\"\"",
            "",
            "NO_CONFIRM_BUTTON = \"\"\"",
            "<button type=\"submit\" form=\"form_id_{button_id}\" class=\"btn btn-sm btn-{button_class}\" {disabled}>{button_text}</button>",
            "\"\"\"",
            "",
            "NO_CONFIRM_FORM = \"\"\"",
            "<form id=\"form_id_{button_id}\" action=\"{button_url}\" method=\"post\" class=\"form\">",
            "  {hidden_inputs}",
            "</form>",
            "\"\"\"",
            "",
            "CONFIRM_BUTTON = \"\"\"",
            "<button type=\"button\" class=\"btn btn-sm btn-{button_class}\" data-toggle=\"modal\" data-target=\"#confirm_modal_id_{button_id}\" {disabled}>",
            "  {button_text}",
            "</button>",
            "\"\"\"",
            "",
            "CONFIRM_MODAL = \"\"\"",
            "<div class=\"modal fade\" id=\"confirm_modal_id_{button_id}\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"confirm_modal_label_{button_id}\">",
            "  <div class=\"modal-dialog\" role=\"document\">",
            "    <div class=\"modal-content\">",
            "      <div class=\"modal-header\">",
            "        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>",
            "        <h4 class=\"modal-title\" id=\"confirm_modal_label_{button_id}\">Confirmation</h4>",
            "      </div>",
            "      <form id=\"form_id_{button_id}\" action=\"{button_url}\" method=\"post\" class=\"form\">",
            "        <div class=\"modal-body\">",
            "          {hidden_inputs}",
            "          Run Job <strong>'{job}'</strong> with object <strong>'{object}'</strong>?",
            "        </div>",
            "        <div class=\"modal-footer\">",
            "          <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancel</button>",
            "          <button type=\"submit\" class=\"btn btn-primary\">Confirm</button>",
            "        </div>",
            "      </form>",
            "    </div>",
            "  </div>",
            "</div>",
            "\"\"\"",
            "",
            "",
            "@register.simple_tag(takes_context=True)",
            "def job_buttons(context, obj):",
            "    \"\"\"",
            "    Render all applicable job buttons for the given object.",
            "    \"\"\"",
            "    content_type = ContentType.objects.get_for_model(obj)",
            "    buttons = JobButton.objects.filter(content_types=content_type)",
            "    if not buttons:",
            "        return \"\"",
            "",
            "    # Pass select context data when rendering the JobButton",
            "    button_context = {",
            "        \"obj\": obj,",
            "        \"debug\": context.get(\"debug\", False),  # django.template.context_processors.debug",
            "        \"request\": context[\"request\"],  # django.template.context_processors.request",
            "        \"user\": context[\"user\"],  # django.contrib.auth.context_processors.auth",
            "        \"perms\": context[\"perms\"],  # django.contrib.auth.context_processors.auth",
            "    }",
            "    buttons_html = forms_html = mark_safe(\"\")  # noqa: S308",
            "    group_names = OrderedDict()",
            "",
            "    hidden_inputs = format_html(",
            "        HIDDEN_INPUTS,",
            "        csrf_token=context[\"csrf_token\"],",
            "        object_pk=obj.pk,",
            "        object_model_name=f\"{content_type.app_label}.{content_type.model}\",",
            "        redirect_path=context[\"request\"].path,",
            "    )",
            "",
            "    for jb in buttons:",
            "        template_args = {",
            "            \"button_id\": jb.pk,",
            "            \"button_text\": jb.text,",
            "            \"button_class\": jb.button_class,",
            "            \"button_url\": reverse(\"extras:jobbutton_run\", kwargs={\"pk\": jb.pk}),",
            "            \"object\": obj,",
            "            \"job\": jb.job,",
            "            \"hidden_inputs\": hidden_inputs,",
            "            \"disabled\": \"\" if context[\"user\"].has_perms((\"extras.run_jobbutton\", \"extras.run_job\")) else \"disabled\",",
            "        }",
            "",
            "        # Organize job buttons by group",
            "        if jb.group_name:",
            "            group_names.setdefault(jb.group_name, [])",
            "            group_names[jb.group_name].append(jb)",
            "",
            "        # Add non-grouped buttons",
            "        else:",
            "            try:",
            "                text_rendered = render_jinja2(jb.text, button_context)",
            "                if text_rendered:",
            "                    template_args[\"button_text\"] = text_rendered",
            "                    if jb.confirmation:",
            "                        buttons_html += format_html(CONFIRM_BUTTON, **template_args)",
            "                        forms_html += format_html(CONFIRM_MODAL, **template_args)",
            "                    else:",
            "                        buttons_html += format_html(NO_CONFIRM_BUTTON, **template_args)",
            "                        forms_html += format_html(NO_CONFIRM_FORM, **template_args)",
            "            except Exception as e:",
            "                buttons_html += format_html(",
            "                    '<a class=\"btn btn-sm btn-default\" disabled=\"disabled\" title=\"{}\">'",
            "                    '<i class=\"mdi mdi-alert\"></i> {}</a>\\n',",
            "                    e,",
            "                    jb.name,",
            "                )",
            "",
            "    # Add grouped buttons to template",
            "    for group_name, buttons in group_names.items():",
            "        group_button_class = buttons[0].button_class",
            "",
            "        buttons_rendered = mark_safe(\"\")  # noqa: S308",
            "",
            "        for jb in buttons:",
            "            template_args = {",
            "                \"button_id\": jb.pk,",
            "                \"button_text\": jb.text,",
            "                \"button_class\": \"link\",",
            "                \"button_url\": reverse(\"extras:jobbutton_run\", kwargs={\"pk\": jb.pk}),",
            "                \"object\": obj,",
            "                \"job\": jb.job,",
            "                \"hidden_inputs\": hidden_inputs,",
            "                \"disabled\": \"\" if context[\"user\"].has_perms((\"extras.run_jobbutton\", \"extras.run_job\")) else \"disabled\",",
            "            }",
            "            try:",
            "                text_rendered = render_jinja2(jb.text, button_context)",
            "                if text_rendered:",
            "                    template_args[\"button_text\"] = text_rendered",
            "                    if jb.confirmation:",
            "                        buttons_rendered += (",
            "                            mark_safe(\"<li>\")  # noqa: S308",
            "                            + format_html(CONFIRM_BUTTON, **template_args)",
            "                            + mark_safe(\"</li>\")  # noqa: S308",
            "                        )",
            "                        forms_html += format_html(CONFIRM_MODAL, **template_args)",
            "                    else:",
            "                        buttons_rendered += (",
            "                            mark_safe(\"<li>\")  # noqa: S308",
            "                            + format_html(NO_CONFIRM_BUTTON, **template_args)",
            "                            + mark_safe(\"</li>\")  # noqa: S308",
            "                        )",
            "                        forms_html += format_html(NO_CONFIRM_FORM, **template_args)",
            "            except Exception as e:",
            "                buttons_rendered += format_html(",
            "                    '<li><a disabled=\"disabled\" title=\"{}\"><span class=\"text-muted\">'",
            "                    '<i class=\"mdi mdi-alert\"></i> {}</span></a></li>',",
            "                    e,",
            "                    jb.name,",
            "                )",
            "",
            "        if buttons_rendered:",
            "            buttons_html += format_html(",
            "                GROUP_DROPDOWN,",
            "                group_button_class=group_button_class,",
            "                group_name=group_name,",
            "                grouped_buttons=buttons_rendered,",
            "            )",
            "",
            "    # We want all of the buttons first and then any modals and forms so the buttons render properly",
            "    return buttons_html + forms_html"
        ],
        "afterPatchFile": [
            "from collections import OrderedDict",
            "",
            "from django import template",
            "from django.contrib.contenttypes.models import ContentType",
            "from django.urls import reverse",
            "from django.utils.html import format_html",
            "from django.utils.safestring import mark_safe",
            "",
            "from nautobot.extras.models import Job, JobButton",
            "from nautobot.utilities.utils import render_jinja2",
            "",
            "",
            "register = template.Library()",
            "",
            "GROUP_DROPDOWN = \"\"\"",
            "<div class=\"btn-group\">",
            "  <button type=\"button\" class=\"btn btn-sm btn-{group_button_class} dropdown-toggle\" data-toggle=\"dropdown\">",
            "    {group_name} <span class=\"caret\"></span>",
            "  </button>",
            "  <ul class=\"dropdown-menu pull-right\">",
            "    {grouped_buttons}",
            "  </ul>",
            "</div>",
            "\"\"\"",
            "",
            "HIDDEN_INPUTS = \"\"\"",
            "<input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"{csrf_token}\">",
            "<input type=\"hidden\" name=\"object_pk\" value=\"{object_pk}\">",
            "<input type=\"hidden\" name=\"object_model_name\" value=\"{object_model_name}\">",
            "<input type=\"hidden\" name=\"_schedule_type\" value=\"immediately\">",
            "<input type=\"hidden\" name=\"_return_url\" value=\"{redirect_path}\">",
            "\"\"\"",
            "",
            "NO_CONFIRM_BUTTON = \"\"\"",
            "<button type=\"submit\" form=\"form_id_{button_id}\" class=\"btn btn-sm btn-{button_class}\" {disabled}>{button_text}</button>",
            "\"\"\"",
            "",
            "NO_CONFIRM_FORM = \"\"\"",
            "<form id=\"form_id_{button_id}\" action=\"{button_url}\" method=\"post\" class=\"form\">",
            "  {hidden_inputs}",
            "</form>",
            "\"\"\"",
            "",
            "CONFIRM_BUTTON = \"\"\"",
            "<button type=\"button\" class=\"btn btn-sm btn-{button_class}\" data-toggle=\"modal\" data-target=\"#confirm_modal_id_{button_id}\" {disabled}>",
            "  {button_text}",
            "</button>",
            "\"\"\"",
            "",
            "CONFIRM_MODAL = \"\"\"",
            "<div class=\"modal fade\" id=\"confirm_modal_id_{button_id}\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"confirm_modal_label_{button_id}\">",
            "  <div class=\"modal-dialog\" role=\"document\">",
            "    <div class=\"modal-content\">",
            "      <div class=\"modal-header\">",
            "        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>",
            "        <h4 class=\"modal-title\" id=\"confirm_modal_label_{button_id}\">Confirmation</h4>",
            "      </div>",
            "      <form id=\"form_id_{button_id}\" action=\"{button_url}\" method=\"post\" class=\"form\">",
            "        <div class=\"modal-body\">",
            "          {hidden_inputs}",
            "          Run Job <strong>'{job}'</strong> with object <strong>'{object}'</strong>?",
            "        </div>",
            "        <div class=\"modal-footer\">",
            "          <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancel</button>",
            "          <button type=\"submit\" class=\"btn btn-primary\">Confirm</button>",
            "        </div>",
            "      </form>",
            "    </div>",
            "  </div>",
            "</div>",
            "\"\"\"",
            "",
            "SAFE_EMPTY_STR = mark_safe(\"\")  # noqa: S308",
            "",
            "",
            "def _render_job_button_for_obj(job_button, obj, context, content_type):",
            "    \"\"\"",
            "    Helper method for job_buttons templatetag to reduce repetition of code.",
            "",
            "    Returns:",
            "       (str, str): (button_html, form_html)",
            "    \"\"\"",
            "    # Pass select context data when rendering the JobButton text as Jinja2",
            "    button_context = {",
            "        \"obj\": obj,",
            "        \"debug\": context.get(\"debug\", False),  # django.template.context_processors.debug",
            "        \"request\": context[\"request\"],  # django.template.context_processors.request",
            "        \"user\": context[\"user\"],  # django.contrib.auth.context_processors.auth",
            "        \"perms\": context[\"perms\"],  # django.contrib.auth.context_processors.auth",
            "    }",
            "    try:",
            "        text_rendered = render_jinja2(job_button.text, button_context)",
            "    except Exception as exc:",
            "        return (",
            "            format_html(",
            "                '<a class=\"btn btn-sm btn-{}\" disabled=\"disabled\" title=\"{}\"><i class=\"mdi mdi-alert\"></i> {}</a>\\n',",
            "                \"default\" if not job_button.group_name else \"link\",",
            "                exc,",
            "                job_button.name,",
            "            ),",
            "            SAFE_EMPTY_STR,",
            "        )",
            "",
            "    if not text_rendered:",
            "        return (SAFE_EMPTY_STR, SAFE_EMPTY_STR)",
            "",
            "    # Disable buttons if the user doesn't have permission to run the underlying Job.",
            "    has_run_perm = Job.objects.check_perms(context[\"user\"], instance=job_button.job, action=\"run\")",
            "    hidden_inputs = format_html(",
            "        HIDDEN_INPUTS,",
            "        csrf_token=context[\"csrf_token\"],",
            "        object_pk=obj.pk,",
            "        object_model_name=f\"{content_type.app_label}.{content_type.model}\",",
            "        redirect_path=context[\"request\"].path,",
            "    )",
            "    template_args = {",
            "        \"button_id\": job_button.pk,",
            "        \"button_text\": text_rendered,",
            "        \"button_class\": job_button.button_class if not job_button.group_name else \"link\",",
            "        \"button_url\": reverse(\"extras:job_run\", kwargs={\"slug\": job_button.job.slug}),",
            "        \"object\": obj,",
            "        \"job\": job_button.job,",
            "        \"hidden_inputs\": hidden_inputs,",
            "        \"disabled\": \"\" if has_run_perm else \"disabled\",",
            "    }",
            "",
            "    if job_button.confirmation:",
            "        return (",
            "            format_html(CONFIRM_BUTTON, **template_args),",
            "            format_html(CONFIRM_MODAL, **template_args),",
            "        )",
            "    else:",
            "        return (",
            "            format_html(NO_CONFIRM_BUTTON, **template_args),",
            "            format_html(NO_CONFIRM_FORM, **template_args),",
            "        )",
            "",
            "",
            "@register.simple_tag(takes_context=True)",
            "def job_buttons(context, obj):",
            "    \"\"\"",
            "    Render all applicable job buttons for the given object.",
            "    \"\"\"",
            "    content_type = ContentType.objects.get_for_model(obj)",
            "    # We will enforce \"run\" permission later in deciding which buttons to show as disabled.",
            "    buttons = JobButton.objects.filter(content_types=content_type)",
            "    if not buttons:",
            "        return SAFE_EMPTY_STR",
            "",
            "    buttons_html = forms_html = SAFE_EMPTY_STR",
            "    group_names = OrderedDict()",
            "",
            "    for jb in buttons:",
            "        # Organize job buttons by group for later processing",
            "        if jb.group_name:",
            "            group_names.setdefault(jb.group_name, []).append(jb)",
            "",
            "        # Render and add non-grouped buttons",
            "        else:",
            "            button_html, form_html = _render_job_button_for_obj(jb, obj, context, content_type)",
            "            buttons_html += button_html",
            "            forms_html += form_html",
            "",
            "    # Add grouped buttons to template",
            "    for group_name, buttons in group_names.items():",
            "        group_button_class = buttons[0].button_class",
            "",
            "        buttons_rendered = SAFE_EMPTY_STR",
            "",
            "        for jb in buttons:",
            "            # Render grouped buttons as list items",
            "            button_html, form_html = _render_job_button_for_obj(jb, obj, context, content_type)",
            "            buttons_rendered += format_html(\"<li>{}</li>\", button_html)",
            "            forms_html += form_html",
            "",
            "        if buttons_rendered:",
            "            buttons_html += format_html(",
            "                GROUP_DROPDOWN,",
            "                group_button_class=group_button_class,",
            "                group_name=group_name,",
            "                grouped_buttons=buttons_rendered,",
            "            )",
            "",
            "    # We want all of the buttons first and then any modals and forms so the buttons render properly",
            "    return buttons_html + forms_html"
        ],
        "action": [
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "2",
            "2",
            "2",
            "0",
            "2",
            "2",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "9": [],
            "30": [],
            "73": [],
            "74": [
                "job_buttons"
            ],
            "75": [
                "job_buttons"
            ],
            "76": [
                "job_buttons"
            ],
            "78": [
                "job_buttons"
            ],
            "79": [
                "job_buttons"
            ],
            "80": [
                "job_buttons"
            ],
            "81": [
                "job_buttons"
            ],
            "83": [
                "job_buttons"
            ],
            "91": [
                "job_buttons"
            ],
            "92": [
                "job_buttons"
            ],
            "93": [
                "job_buttons"
            ],
            "103": [
                "job_buttons"
            ],
            "104": [
                "job_buttons"
            ],
            "105": [
                "job_buttons"
            ],
            "106": [
                "job_buttons"
            ],
            "107": [
                "job_buttons"
            ],
            "108": [
                "job_buttons"
            ],
            "109": [
                "job_buttons"
            ],
            "110": [
                "job_buttons"
            ],
            "111": [
                "job_buttons"
            ],
            "112": [
                "job_buttons"
            ],
            "113": [
                "job_buttons"
            ],
            "114": [
                "job_buttons"
            ],
            "116": [
                "job_buttons"
            ],
            "117": [
                "job_buttons"
            ],
            "119": [
                "job_buttons"
            ],
            "121": [
                "job_buttons"
            ],
            "122": [
                "job_buttons"
            ],
            "123": [
                "job_buttons"
            ],
            "124": [
                "job_buttons"
            ],
            "125": [
                "job_buttons"
            ],
            "126": [
                "job_buttons"
            ],
            "127": [
                "job_buttons"
            ],
            "128": [
                "job_buttons"
            ],
            "129": [
                "job_buttons"
            ],
            "130": [
                "job_buttons"
            ],
            "131": [
                "job_buttons"
            ],
            "132": [
                "job_buttons"
            ],
            "133": [
                "job_buttons"
            ],
            "134": [
                "job_buttons"
            ],
            "135": [
                "job_buttons"
            ],
            "136": [
                "job_buttons"
            ],
            "137": [
                "job_buttons"
            ],
            "143": [
                "job_buttons"
            ],
            "146": [
                "job_buttons"
            ],
            "147": [
                "job_buttons"
            ],
            "148": [
                "job_buttons"
            ],
            "149": [
                "job_buttons"
            ],
            "150": [
                "job_buttons"
            ],
            "151": [
                "job_buttons"
            ],
            "152": [
                "job_buttons"
            ],
            "153": [
                "job_buttons"
            ],
            "154": [
                "job_buttons"
            ],
            "155": [
                "job_buttons"
            ],
            "156": [
                "job_buttons"
            ],
            "157": [
                "job_buttons"
            ],
            "158": [
                "job_buttons"
            ],
            "159": [
                "job_buttons"
            ],
            "160": [
                "job_buttons"
            ],
            "161": [
                "job_buttons"
            ],
            "162": [
                "job_buttons"
            ],
            "163": [
                "job_buttons"
            ],
            "164": [
                "job_buttons"
            ],
            "165": [
                "job_buttons"
            ],
            "166": [
                "job_buttons"
            ],
            "167": [
                "job_buttons"
            ],
            "168": [
                "job_buttons"
            ],
            "169": [
                "job_buttons"
            ],
            "170": [
                "job_buttons"
            ],
            "171": [
                "job_buttons"
            ],
            "172": [
                "job_buttons"
            ],
            "173": [
                "job_buttons"
            ],
            "174": [
                "job_buttons"
            ],
            "175": [
                "job_buttons"
            ],
            "176": [
                "job_buttons"
            ],
            "177": [
                "job_buttons"
            ],
            "178": [
                "job_buttons"
            ],
            "179": [
                "job_buttons"
            ],
            "180": [
                "job_buttons"
            ]
        },
        "addLocation": []
    },
    "nautobot/extras/tests/test_views.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 56,
                "afterPatchRowNumber": 56,
                "PatchRowcode": "     Tag,"
            },
            "1": {
                "beforePatchRowNumber": 57,
                "afterPatchRowNumber": 57,
                "PatchRowcode": "     Webhook,"
            },
            "2": {
                "beforePatchRowNumber": 58,
                "afterPatchRowNumber": 58,
                "PatchRowcode": " )"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 59,
                "PatchRowcode": "+from nautobot.extras.templatetags.job_buttons import NO_CONFIRM_BUTTON"
            },
            "4": {
                "beforePatchRowNumber": 59,
                "afterPatchRowNumber": 60,
                "PatchRowcode": " from nautobot.extras.tests.constants import BIG_GRAPHQL_DEVICE_QUERY"
            },
            "5": {
                "beforePatchRowNumber": 60,
                "afterPatchRowNumber": 61,
                "PatchRowcode": " from nautobot.extras.tests.test_relationships import RequiredRelationshipTestMixin"
            },
            "6": {
                "beforePatchRowNumber": 61,
                "afterPatchRowNumber": 62,
                "PatchRowcode": " from nautobot.extras.utils import get_job_content_type, TaggableClassesQuery"
            },
            "7": {
                "beforePatchRowNumber": 2012,
                "afterPatchRowNumber": 2013,
                "PatchRowcode": " "
            },
            "8": {
                "beforePatchRowNumber": 2013,
                "afterPatchRowNumber": 2014,
                "PatchRowcode": "     def setUp(self):"
            },
            "9": {
                "beforePatchRowNumber": 2014,
                "afterPatchRowNumber": 2015,
                "PatchRowcode": "         super().setUp()"
            },
            "10": {
                "beforePatchRowNumber": 2015,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button = JobButton("
            },
            "11": {
                "beforePatchRowNumber": 2016,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            name=\"JobButton\","
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2016,
                "PatchRowcode": "+        self.job_button_1 = JobButton("
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2017,
                "PatchRowcode": "+            name=\"JobButton 1\","
            },
            "14": {
                "beforePatchRowNumber": 2017,
                "afterPatchRowNumber": 2018,
                "PatchRowcode": "             text=\"JobButton {{ obj.name }}\","
            },
            "15": {
                "beforePatchRowNumber": 2018,
                "afterPatchRowNumber": 2019,
                "PatchRowcode": "             job=Job.objects.get(job_class_name=\"TestJobButtonReceiverSimple\"),"
            },
            "16": {
                "beforePatchRowNumber": 2019,
                "afterPatchRowNumber": 2020,
                "PatchRowcode": "             confirmation=False,"
            },
            "17": {
                "beforePatchRowNumber": 2020,
                "afterPatchRowNumber": 2021,
                "PatchRowcode": "         )"
            },
            "18": {
                "beforePatchRowNumber": 2021,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.validated_save()"
            },
            "19": {
                "beforePatchRowNumber": 2022,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.content_types.add(ContentType.objects.get_for_model(LocationType))"
            },
            "20": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2022,
                "PatchRowcode": "+        self.job_button_1.validated_save()"
            },
            "21": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2023,
                "PatchRowcode": "+        self.job_button_1.content_types.add(ContentType.objects.get_for_model(LocationType))"
            },
            "22": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2024,
                "PatchRowcode": "+"
            },
            "23": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2025,
                "PatchRowcode": "+        self.job_button_2 = JobButton("
            },
            "24": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2026,
                "PatchRowcode": "+            name=\"JobButton 2\","
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2027,
                "PatchRowcode": "+            text=\"Click me!\","
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2028,
                "PatchRowcode": "+            job=Job.objects.get(job_class_name=\"TestJobButtonReceiverComplex\"),"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2029,
                "PatchRowcode": "+            confirmation=False,"
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2030,
                "PatchRowcode": "+        )"
            },
            "29": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2031,
                "PatchRowcode": "+        self.job_button_2.validated_save()"
            },
            "30": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2032,
                "PatchRowcode": "+        self.job_button_2.content_types.add(ContentType.objects.get_for_model(LocationType))"
            },
            "31": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2033,
                "PatchRowcode": "+"
            },
            "32": {
                "beforePatchRowNumber": 2023,
                "afterPatchRowNumber": 2034,
                "PatchRowcode": "         self.location_type = LocationType.objects.get(name=\"Campus\")"
            },
            "33": {
                "beforePatchRowNumber": 2024,
                "afterPatchRowNumber": 2035,
                "PatchRowcode": " "
            },
            "34": {
                "beforePatchRowNumber": 2025,
                "afterPatchRowNumber": 2036,
                "PatchRowcode": "     def test_view_object_with_job_button(self):"
            },
            "35": {
                "beforePatchRowNumber": 2028,
                "afterPatchRowNumber": 2039,
                "PatchRowcode": "         self.assertEqual(response.status_code, 200)"
            },
            "36": {
                "beforePatchRowNumber": 2029,
                "afterPatchRowNumber": 2040,
                "PatchRowcode": "         content = extract_page_body(response.content.decode(response.charset))"
            },
            "37": {
                "beforePatchRowNumber": 2030,
                "afterPatchRowNumber": 2041,
                "PatchRowcode": "         self.assertIn(f\"JobButton {self.location_type.name}\", content, content)"
            },
            "38": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2042,
                "PatchRowcode": "+        self.assertIn(\"Click me!\", content, content)"
            },
            "39": {
                "beforePatchRowNumber": 2031,
                "afterPatchRowNumber": 2043,
                "PatchRowcode": " "
            },
            "40": {
                "beforePatchRowNumber": 2032,
                "afterPatchRowNumber": 2044,
                "PatchRowcode": "     def test_view_object_with_unsafe_text(self):"
            },
            "41": {
                "beforePatchRowNumber": 2033,
                "afterPatchRowNumber": 2045,
                "PatchRowcode": "         \"\"\"Ensure that JobButton text can't be used as a vector for XSS.\"\"\""
            },
            "42": {
                "beforePatchRowNumber": 2034,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.text = '<script>alert(\"Hello world!\")</script>'"
            },
            "43": {
                "beforePatchRowNumber": 2035,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.validated_save()"
            },
            "44": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2046,
                "PatchRowcode": "+        self.job_button_1.text = '<script>alert(\"Hello world!\")</script>'"
            },
            "45": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2047,
                "PatchRowcode": "+        self.job_button_1.validated_save()"
            },
            "46": {
                "beforePatchRowNumber": 2036,
                "afterPatchRowNumber": 2048,
                "PatchRowcode": "         response = self.client.get(self.location_type.get_absolute_url(), follow=True)"
            },
            "47": {
                "beforePatchRowNumber": 2037,
                "afterPatchRowNumber": 2049,
                "PatchRowcode": "         self.assertEqual(response.status_code, 200)"
            },
            "48": {
                "beforePatchRowNumber": 2038,
                "afterPatchRowNumber": 2050,
                "PatchRowcode": "         content = extract_page_body(response.content.decode(response.charset))"
            },
            "49": {
                "beforePatchRowNumber": 2039,
                "afterPatchRowNumber": 2051,
                "PatchRowcode": "         self.assertNotIn(\"<script>alert\", content, content)"
            },
            "50": {
                "beforePatchRowNumber": 2040,
                "afterPatchRowNumber": 2052,
                "PatchRowcode": "         self.assertIn(\"&lt;script&gt;alert\", content, content)"
            },
            "51": {
                "beforePatchRowNumber": 2041,
                "afterPatchRowNumber": 2053,
                "PatchRowcode": " "
            },
            "52": {
                "beforePatchRowNumber": 2042,
                "afterPatchRowNumber": 2054,
                "PatchRowcode": "         # Make sure grouped rendering is safe too"
            },
            "53": {
                "beforePatchRowNumber": 2043,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.group = '<script>alert(\"Goodbye\")</script>'"
            },
            "54": {
                "beforePatchRowNumber": 2044,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.validated_save()"
            },
            "55": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2055,
                "PatchRowcode": "+        self.job_button_1.group_name = '<script>alert(\"Goodbye\")</script>'"
            },
            "56": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2056,
                "PatchRowcode": "+        self.job_button_1.validated_save()"
            },
            "57": {
                "beforePatchRowNumber": 2045,
                "afterPatchRowNumber": 2057,
                "PatchRowcode": "         response = self.client.get(self.location_type.get_absolute_url(), follow=True)"
            },
            "58": {
                "beforePatchRowNumber": 2046,
                "afterPatchRowNumber": 2058,
                "PatchRowcode": "         self.assertEqual(response.status_code, 200)"
            },
            "59": {
                "beforePatchRowNumber": 2047,
                "afterPatchRowNumber": 2059,
                "PatchRowcode": "         content = extract_page_body(response.content.decode(response.charset))"
            },
            "60": {
                "beforePatchRowNumber": 2050,
                "afterPatchRowNumber": 2062,
                "PatchRowcode": " "
            },
            "61": {
                "beforePatchRowNumber": 2051,
                "afterPatchRowNumber": 2063,
                "PatchRowcode": "     def test_view_object_with_unsafe_name(self):"
            },
            "62": {
                "beforePatchRowNumber": 2052,
                "afterPatchRowNumber": 2064,
                "PatchRowcode": "         \"\"\"Ensure that JobButton names can't be used as a vector for XSS.\"\"\""
            },
            "63": {
                "beforePatchRowNumber": 2053,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.text = \"JobButton {{ obj\""
            },
            "64": {
                "beforePatchRowNumber": 2054,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.name = '<script>alert(\"Yo\")</script>'"
            },
            "65": {
                "beforePatchRowNumber": 2055,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        self.job_button.validated_save()"
            },
            "66": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2065,
                "PatchRowcode": "+        self.job_button_1.text = \"JobButton {{ obj\""
            },
            "67": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2066,
                "PatchRowcode": "+        self.job_button_1.name = '<script>alert(\"Yo\")</script>'"
            },
            "68": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2067,
                "PatchRowcode": "+        self.job_button_1.validated_save()"
            },
            "69": {
                "beforePatchRowNumber": 2056,
                "afterPatchRowNumber": 2068,
                "PatchRowcode": "         response = self.client.get(self.location_type.get_absolute_url(), follow=True)"
            },
            "70": {
                "beforePatchRowNumber": 2057,
                "afterPatchRowNumber": 2069,
                "PatchRowcode": "         self.assertEqual(response.status_code, 200)"
            },
            "71": {
                "beforePatchRowNumber": 2058,
                "afterPatchRowNumber": 2070,
                "PatchRowcode": "         content = extract_page_body(response.content.decode(response.charset))"
            },
            "72": {
                "beforePatchRowNumber": 2059,
                "afterPatchRowNumber": 2071,
                "PatchRowcode": "         self.assertNotIn(\"<script>alert\", content, content)"
            },
            "73": {
                "beforePatchRowNumber": 2060,
                "afterPatchRowNumber": 2072,
                "PatchRowcode": "         self.assertIn(\"&lt;script&gt;alert\", content, content)"
            },
            "74": {
                "beforePatchRowNumber": 2061,
                "afterPatchRowNumber": 2073,
                "PatchRowcode": " "
            },
            "75": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2074,
                "PatchRowcode": "+    def test_render_constrained_run_permissions(self):"
            },
            "76": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2075,
                "PatchRowcode": "+        obj_perm = ObjectPermission("
            },
            "77": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2076,
                "PatchRowcode": "+            name=\"Test permission\","
            },
            "78": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2077,
                "PatchRowcode": "+            constraints={\"pk\": self.job_button_1.job.pk},"
            },
            "79": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2078,
                "PatchRowcode": "+            actions=[\"run\"],"
            },
            "80": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2079,
                "PatchRowcode": "+        )"
            },
            "81": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2080,
                "PatchRowcode": "+        obj_perm.save()"
            },
            "82": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2081,
                "PatchRowcode": "+        obj_perm.users.add(self.user)"
            },
            "83": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2082,
                "PatchRowcode": "+        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))"
            },
            "84": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2083,
                "PatchRowcode": "+"
            },
            "85": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2084,
                "PatchRowcode": "+        with self.subTest(\"Ungrouped buttons\"):"
            },
            "86": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2085,
                "PatchRowcode": "+            response = self.client.get(self.location_type.get_absolute_url(), follow=True)"
            },
            "87": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2086,
                "PatchRowcode": "+            self.assertEqual(response.status_code, 200)"
            },
            "88": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2087,
                "PatchRowcode": "+            content = extract_page_body(response.content.decode(response.charset))"
            },
            "89": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2088,
                "PatchRowcode": "+            self.assertInHTML("
            },
            "90": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2089,
                "PatchRowcode": "+                NO_CONFIRM_BUTTON.format("
            },
            "91": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2090,
                "PatchRowcode": "+                    button_id=self.job_button_1.pk,"
            },
            "92": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2091,
                "PatchRowcode": "+                    button_text=f\"JobButton {self.location_type.name}\","
            },
            "93": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2092,
                "PatchRowcode": "+                    button_class=self.job_button_1.button_class,"
            },
            "94": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2093,
                "PatchRowcode": "+                    disabled=\"\","
            },
            "95": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2094,
                "PatchRowcode": "+                ),"
            },
            "96": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2095,
                "PatchRowcode": "+                content,"
            },
            "97": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2096,
                "PatchRowcode": "+            )"
            },
            "98": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2097,
                "PatchRowcode": "+            self.assertInHTML("
            },
            "99": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2098,
                "PatchRowcode": "+                NO_CONFIRM_BUTTON.format("
            },
            "100": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2099,
                "PatchRowcode": "+                    button_id=self.job_button_2.pk,"
            },
            "101": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2100,
                "PatchRowcode": "+                    button_text=\"Click me!\","
            },
            "102": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2101,
                "PatchRowcode": "+                    button_class=self.job_button_2.button_class,"
            },
            "103": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2102,
                "PatchRowcode": "+                    disabled=\"disabled\","
            },
            "104": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2103,
                "PatchRowcode": "+                ),"
            },
            "105": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2104,
                "PatchRowcode": "+                content,"
            },
            "106": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2105,
                "PatchRowcode": "+            )"
            },
            "107": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2106,
                "PatchRowcode": "+"
            },
            "108": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2107,
                "PatchRowcode": "+        with self.subTest(\"Grouped buttons\"):"
            },
            "109": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2108,
                "PatchRowcode": "+            self.job_button_1.group_name = \"Grouping\""
            },
            "110": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2109,
                "PatchRowcode": "+            self.job_button_1.validated_save()"
            },
            "111": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2110,
                "PatchRowcode": "+            self.job_button_2.group_name = \"Grouping\""
            },
            "112": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2111,
                "PatchRowcode": "+            self.job_button_2.validated_save()"
            },
            "113": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2112,
                "PatchRowcode": "+"
            },
            "114": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2113,
                "PatchRowcode": "+            response = self.client.get(self.location_type.get_absolute_url(), follow=True)"
            },
            "115": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2114,
                "PatchRowcode": "+            self.assertEqual(response.status_code, 200)"
            },
            "116": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2115,
                "PatchRowcode": "+            content = extract_page_body(response.content.decode(response.charset))"
            },
            "117": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2116,
                "PatchRowcode": "+            self.assertInHTML("
            },
            "118": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2117,
                "PatchRowcode": "+                \"<li>\""
            },
            "119": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2118,
                "PatchRowcode": "+                + NO_CONFIRM_BUTTON.format("
            },
            "120": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2119,
                "PatchRowcode": "+                    button_id=self.job_button_1.pk,"
            },
            "121": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2120,
                "PatchRowcode": "+                    button_text=f\"JobButton {self.location_type.name}\","
            },
            "122": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2121,
                "PatchRowcode": "+                    button_class=\"link\","
            },
            "123": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2122,
                "PatchRowcode": "+                    disabled=\"\","
            },
            "124": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2123,
                "PatchRowcode": "+                )"
            },
            "125": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2124,
                "PatchRowcode": "+                + \"</li>\","
            },
            "126": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2125,
                "PatchRowcode": "+                content,"
            },
            "127": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2126,
                "PatchRowcode": "+            )"
            },
            "128": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2127,
                "PatchRowcode": "+            self.assertInHTML("
            },
            "129": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2128,
                "PatchRowcode": "+                \"<li>\""
            },
            "130": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2129,
                "PatchRowcode": "+                + NO_CONFIRM_BUTTON.format("
            },
            "131": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2130,
                "PatchRowcode": "+                    button_id=self.job_button_2.pk,"
            },
            "132": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2131,
                "PatchRowcode": "+                    button_text=\"Click me!\","
            },
            "133": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2132,
                "PatchRowcode": "+                    button_class=\"link\","
            },
            "134": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2133,
                "PatchRowcode": "+                    disabled=\"disabled\","
            },
            "135": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2134,
                "PatchRowcode": "+                )"
            },
            "136": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2135,
                "PatchRowcode": "+                + \"</li>\","
            },
            "137": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2136,
                "PatchRowcode": "+                content,"
            },
            "138": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2137,
                "PatchRowcode": "+            )"
            },
            "139": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 2138,
                "PatchRowcode": "+"
            },
            "140": {
                "beforePatchRowNumber": 2062,
                "afterPatchRowNumber": 2139,
                "PatchRowcode": " "
            },
            "141": {
                "beforePatchRowNumber": 2063,
                "afterPatchRowNumber": 2140,
                "PatchRowcode": " # TODO: Convert to StandardTestCases.Views"
            },
            "142": {
                "beforePatchRowNumber": 2064,
                "afterPatchRowNumber": 2141,
                "PatchRowcode": " class ObjectChangeTestCase(TestCase):"
            }
        },
        "frontPatchFile": [
            "from datetime import datetime, timedelta",
            "import urllib.parse",
            "import uuid",
            "",
            "from django.contrib.auth import get_user_model",
            "from django.contrib.contenttypes.models import ContentType",
            "from django.core.exceptions import ValidationError",
            "from django.test import override_settings",
            "from django.urls import reverse",
            "from django.utils import timezone",
            "from django.utils.html import format_html",
            "from unittest import mock",
            "",
            "from nautobot.dcim.models import (",
            "    ConsolePort,",
            "    Device,",
            "    DeviceRole,",
            "    DeviceType,",
            "    Interface,",
            "    LocationType,",
            "    Manufacturer,",
            "    Site,",
            ")",
            "from nautobot.dcim.tests import test_views",
            "from nautobot.extras.choices import (",
            "    CustomFieldTypeChoices,",
            "    JobExecutionType,",
            "    JobSourceChoices,",
            "    ObjectChangeActionChoices,",
            "    SecretsGroupAccessTypeChoices,",
            "    SecretsGroupSecretTypeChoices,",
            ")",
            "from nautobot.extras.constants import HTTP_CONTENT_TYPE_JSON",
            "from nautobot.extras.models import (",
            "    ComputedField,",
            "    ConfigContext,",
            "    ConfigContextSchema,",
            "    CustomField,",
            "    CustomLink,",
            "    DynamicGroup,",
            "    ExportTemplate,",
            "    GitRepository,",
            "    GraphQLQuery,",
            "    Job,",
            "    JobButton,",
            "    JobResult,",
            "    Note,",
            "    ObjectChange,",
            "    Relationship,",
            "    RelationshipAssociation,",
            "    ScheduledJob,",
            "    Secret,",
            "    SecretsGroup,",
            "    SecretsGroupAssociation,",
            "    Status,",
            "    Tag,",
            "    Webhook,",
            ")",
            "from nautobot.extras.tests.constants import BIG_GRAPHQL_DEVICE_QUERY",
            "from nautobot.extras.tests.test_relationships import RequiredRelationshipTestMixin",
            "from nautobot.extras.utils import get_job_content_type, TaggableClassesQuery",
            "from nautobot.ipam.factory import VLANFactory",
            "from nautobot.ipam.models import VLAN, VLANGroup",
            "from nautobot.users.models import ObjectPermission",
            "from nautobot.utilities.testing import ViewTestCases, TestCase, extract_page_body, extract_form_failures",
            "from nautobot.utilities.testing.utils import disable_warnings, post_data",
            "from nautobot.utilities.utils import slugify_dashes_to_underscores",
            "",
            "",
            "# Use the proper swappable User model",
            "User = get_user_model()",
            "",
            "",
            "class ComputedFieldTestCase(",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = ComputedField",
            "    slug_source = \"label\"",
            "    slugify_function = staticmethod(slugify_dashes_to_underscores)",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = ContentType.objects.get_for_model(Site)",
            "",
            "        computed_fields = (",
            "            ComputedField(",
            "                content_type=obj_type,",
            "                label=\"Computed Field One\",",
            "                slug=\"computed_field_one\",",
            "                template=\"Site name is {{ obj.name }}\",",
            "                fallback_value=\"Template error\",",
            "                weight=100,",
            "            ),",
            "            ComputedField(",
            "                content_type=obj_type,",
            "                slug=\"computed_field_two\",",
            "                label=\"Computed Field Two\",",
            "                template=\"Site name is {{ obj.name }}\",",
            "                fallback_value=\"Template error\",",
            "                weight=100,",
            "            ),",
            "            ComputedField(",
            "                content_type=obj_type,",
            "                slug=\"computed_field_three\",",
            "                label=\"Computed Field Three\",",
            "                template=\"Site name is {{ obj.name }}\",",
            "                weight=100,",
            "            ),",
            "            ComputedField(",
            "                content_type=obj_type,",
            "                label=\"Computed Field Five\",",
            "                template=\"Site name is {{ obj.name }}\",",
            "                fallback_value=\"Template error\",",
            "                weight=100,",
            "            ),",
            "        )",
            "",
            "        cls.site1 = Site(name=\"NYC\")",
            "        cls.site1.save()",
            "",
            "        for cf in computed_fields:",
            "            cf.save()",
            "",
            "        cls.form_data = {",
            "            \"content_type\": obj_type.pk,",
            "            \"slug\": \"computed_field_four\",",
            "            \"label\": \"Computed Field Four\",",
            "            \"template\": \"{{ obj.name }} is the best Site!\",",
            "            \"fallback_value\": \":skull_emoji:\",",
            "            \"weight\": 100,",
            "        }",
            "",
            "        cls.slug_test_object = \"Computed Field Five\"",
            "",
            "",
            "class ComputedFieldRenderingTestCase(TestCase):",
            "    \"\"\"Tests for the inclusion of ComputedFields, distinct from tests of the ComputedField views themselves.\"\"\"",
            "",
            "    user_permissions = [\"dcim.view_locationtype\"]",
            "",
            "    def setUp(self):",
            "        super().setUp()",
            "        self.computedfield = ComputedField(",
            "            content_type=ContentType.objects.get_for_model(LocationType),",
            "            slug=\"test\",",
            "            label=\"Computed Field\",",
            "            template=\"FOO {{ obj.name }} BAR\",",
            "            fallback_value=\"Fallback Value\",",
            "            weight=100,",
            "        )",
            "        self.computedfield.validated_save()",
            "        self.location_type = LocationType.objects.get(name=\"Campus\")",
            "",
            "    def test_view_object_with_computed_field(self):",
            "        \"\"\"Ensure that the computed field template is rendered.\"\"\"",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(f\"FOO {self.location_type.name} BAR\", content, content)",
            "",
            "    def test_view_object_with_computed_field_fallback_value(self):",
            "        \"\"\"Ensure that the fallback_value is rendered if the template fails to render.\"\"\"",
            "        # Make the template invalid to demonstrate the fallback value",
            "        self.computedfield.template = \"FOO {{ obj.\"",
            "        self.computedfield.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"Fallback Value\", content, content)",
            "",
            "    def test_view_object_with_computed_field_unsafe_template(self):",
            "        \"\"\"Ensure that computed field templates can't be used as an XSS vector.\"\"\"",
            "        self.computedfield.template = '<script>alert(\"Hello world!\"</script>'",
            "        self.computedfield.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "    def test_view_object_with_computed_field_unsafe_fallback_value(self):",
            "        \"\"\"Ensure that computed field fallback values can't be used as an XSS vector.\"\"\"",
            "        self.computedfield.template = \"FOO {{ obj.\"",
            "        self.computedfield.fallback_value = '<script>alert(\"Hello world!\"</script>'",
            "        self.computedfield.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "",
            "# TODO: Change base class to PrimaryObjectViewTestCase",
            "# Blocked by absence of standard create/edit, bulk create views",
            "class ConfigContextTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkEditObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = ConfigContext",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        site = Site.objects.first()",
            "",
            "        # Create three ConfigContexts",
            "        for i in range(1, 4):",
            "            configcontext = ConfigContext(name=f\"Config Context {i}\", data={\"foo\": i})",
            "            configcontext.save()",
            "            configcontext.sites.add(site)",
            "",
            "        cls.form_data = {",
            "            \"name\": \"Config Context X\",",
            "            \"weight\": 200,",
            "            \"description\": \"A new config context\",",
            "            \"is_active\": True,",
            "            \"regions\": [],",
            "            \"sites\": [site.pk],",
            "            \"roles\": [],",
            "            \"device_types\": [],",
            "            \"platforms\": [],",
            "            \"tenant_groups\": [],",
            "            \"tenants\": [],",
            "            \"tags\": [],",
            "            \"data\": '{\"foo\": 123}',",
            "        }",
            "",
            "        cls.bulk_edit_data = {",
            "            \"weight\": 300,",
            "            \"is_active\": False,",
            "            \"description\": \"New description\",",
            "        }",
            "",
            "    def test_schema_validation_pass(self):",
            "        \"\"\"",
            "        Given a config context schema",
            "        And a config context that conforms to that schema",
            "        Assert that the config context passes schema validation via full_clean()",
            "        \"\"\"",
            "        schema = ConfigContextSchema.objects.create(",
            "            name=\"Schema 1\", slug=\"schema-1\", data_schema={\"type\": \"object\", \"properties\": {\"foo\": {\"type\": \"string\"}}}",
            "        )",
            "        self.add_permissions(\"extras.add_configcontext\")",
            "        self.add_permissions(\"extras.view_configcontextschema\")",
            "",
            "        form_data = {",
            "            \"name\": \"Config Context with schema\",",
            "            \"weight\": 200,",
            "            \"description\": \"A new config context\",",
            "            \"is_active\": True,",
            "            \"regions\": [],",
            "            \"sites\": [],",
            "            \"roles\": [],",
            "            \"device_types\": [],",
            "            \"platforms\": [],",
            "            \"tenant_groups\": [],",
            "            \"tenants\": [],",
            "            \"tags\": [],",
            "            \"data\": '{\"foo\": \"bar\"}',",
            "            \"schema\": schema.pk,",
            "        }",
            "",
            "        # Try POST with model-level permission",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(form_data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 302)",
            "        self.assertEqual(self._get_queryset().get(name=\"Config Context with schema\").schema.pk, schema.pk)",
            "",
            "    def test_schema_validation_fails(self):",
            "        \"\"\"",
            "        Given a config context schema",
            "        And a config context that *does not* conform to that schema",
            "        Assert that the config context fails schema validation via full_clean()",
            "        \"\"\"",
            "        schema = ConfigContextSchema.objects.create(",
            "            name=\"Schema 1\", slug=\"schema-1\", data_schema={\"type\": \"object\", \"properties\": {\"foo\": {\"type\": \"integer\"}}}",
            "        )",
            "        self.add_permissions(\"extras.add_configcontext\")",
            "        self.add_permissions(\"extras.view_configcontextschema\")",
            "",
            "        form_data = {",
            "            \"name\": \"Config Context with bad schema\",",
            "            \"weight\": 200,",
            "            \"description\": \"A new config context\",",
            "            \"is_active\": True,",
            "            \"regions\": [],",
            "            \"sites\": [],",
            "            \"roles\": [],",
            "            \"device_types\": [],",
            "            \"platforms\": [],",
            "            \"tenant_groups\": [],",
            "            \"tenants\": [],",
            "            \"tags\": [],",
            "            \"data\": '{\"foo\": \"bar\"}',",
            "            \"schema\": schema.pk,",
            "        }",
            "",
            "        # Try POST with model-level permission",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(form_data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 200)",
            "        self.assertEqual(self._get_queryset().filter(name=\"Config Context with schema\").count(), 0)",
            "",
            "",
            "# This OrganizationalObjectViewTestCase less BulkImportObjectsViewTestCase",
            "# because it doesn't make sense to support CSV for schemas.",
            "class ConfigContextSchemaTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.BulkEditObjectsViewTestCase,",
            "):",
            "    model = ConfigContextSchema",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        # Create three ConfigContextSchema records",
            "        ConfigContextSchema.objects.create(",
            "            name=\"Schema 1\", slug=\"schema-1\", data_schema={\"type\": \"object\", \"properties\": {\"foo\": {\"type\": \"string\"}}}",
            "        )",
            "        ConfigContextSchema.objects.create(",
            "            name=\"Schema 2\", slug=\"schema-2\", data_schema={\"type\": \"object\", \"properties\": {\"bar\": {\"type\": \"string\"}}}",
            "        )",
            "        ConfigContextSchema.objects.create(",
            "            name=\"Schema 3\", slug=\"schema-3\", data_schema={\"type\": \"object\", \"properties\": {\"baz\": {\"type\": \"string\"}}}",
            "        )",
            "        ConfigContextSchema.objects.create(",
            "            name=\"Schema 4\", data_schema={\"type\": \"object\", \"properties\": {\"baz\": {\"type\": \"string\"}}}",
            "        )",
            "",
            "        cls.form_data = {",
            "            \"name\": \"Schema X\",",
            "            \"slug\": \"schema-x\",",
            "            \"data_schema\": '{\"type\": \"object\",\"properties\": {\"baz\": {\"type\": \"string\"}}}',  # Intentionally misformatted (missing space) to ensure proper formatting on output",
            "        }",
            "",
            "        cls.bulk_edit_data = {",
            "            \"description\": \"New description\",",
            "        }",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"Schema 4\"",
            "",
            "",
            "class CustomLinkTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = CustomLink",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = ContentType.objects.get_for_model(Site)",
            "",
            "        customlinks = (",
            "            CustomLink(",
            "                content_type=obj_type,",
            "                name=\"customlink-1\",",
            "                text=\"customlink text 1\",",
            "                target_url=\"http://customlink1.com\",",
            "                weight=100,",
            "                button_class=\"default\",",
            "                new_window=False,",
            "            ),",
            "            CustomLink(",
            "                content_type=obj_type,",
            "                name=\"customlink-2\",",
            "                text=\"customlink text 2\",",
            "                target_url=\"http://customlink2.com\",",
            "                weight=100,",
            "                button_class=\"default\",",
            "                new_window=False,",
            "            ),",
            "            CustomLink(",
            "                content_type=obj_type,",
            "                name=\"customlink-3\",",
            "                text=\"customlink text 3\",",
            "                target_url=\"http://customlink3.com\",",
            "                weight=100,",
            "                button_class=\"default\",",
            "                new_window=False,",
            "            ),",
            "        )",
            "",
            "        for link in customlinks:",
            "            link.save()",
            "",
            "        cls.form_data = {",
            "            \"content_type\": obj_type.pk,",
            "            \"name\": \"customlink-4\",",
            "            \"text\": \"customlink text 4\",",
            "            \"target_url\": \"http://customlink4.com\",",
            "            \"weight\": 100,",
            "            \"button_class\": \"default\",",
            "            \"new_window\": False,",
            "        }",
            "",
            "",
            "class CustomFieldTestCase(",
            "    # No NotesViewTestCase or BulkImportObjectsViewTestCase, at least for now",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = CustomField",
            "    slug_source = \"label\"",
            "    slugify_function = staticmethod(slugify_dashes_to_underscores)",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = ContentType.objects.get_for_model(Site)",
            "",
            "        custom_fields = [",
            "            CustomField(",
            "                type=CustomFieldTypeChoices.TYPE_BOOLEAN,",
            "                name=\"Custom Field Boolean\",",
            "                label=\"Custom Field Boolean\",",
            "                default=\"\",",
            "            ),",
            "            CustomField(",
            "                type=CustomFieldTypeChoices.TYPE_TEXT,",
            "                name=\"Custom Field Text\",",
            "                label=\"Custom Field Text\",",
            "                default=\"\",",
            "            ),",
            "            CustomField(",
            "                type=CustomFieldTypeChoices.TYPE_INTEGER,",
            "                name=\"Custom Field Integer\",",
            "                label=\"Custom Field Integer\",",
            "                default=\"\",",
            "            ),",
            "            CustomField(",
            "                type=CustomFieldTypeChoices.TYPE_TEXT,",
            "                # https://github.com/nautobot/nautobot/issues/1962",
            "                name=\"Custom field? With special / unusual characters!\",",
            "                default=\"\",",
            "            ),",
            "        ]",
            "",
            "        cls.slug_test_object = \"Custom Field Integer\"",
            "",
            "        for custom_field in custom_fields:",
            "            custom_field.validated_save()",
            "            custom_field.content_types.set([obj_type])",
            "",
            "        cls.form_data = {",
            "            \"content_types\": [obj_type.pk],",
            "            \"type\": CustomFieldTypeChoices.TYPE_BOOLEAN,  # type is mandatory but cannot be changed once set.",
            "            \"slug\": \"custom_field_boolean\",  # slug is mandatory but cannot be changed once set.",
            "            \"label\": \"Custom Field Boolean\",",
            "            \"default\": None,",
            "            \"filter_logic\": \"loose\",",
            "            \"weight\": 100,",
            "            # These are the \"management_form\" fields required by the dynamic CustomFieldChoice formsets.",
            "            \"choices-TOTAL_FORMS\": \"0\",  # Set to 0 so validation succeeds until we need it",
            "            \"choices-INITIAL_FORMS\": \"1\",",
            "            \"choices-MIN_NUM_FORMS\": \"0\",",
            "            \"choices-MAX_NUM_FORMS\": \"1000\",",
            "        }",
            "",
            "    def test_create_object_without_permission(self):",
            "        # Can't have two CustomFields with the same \"slug\"",
            "        self.form_data = self.form_data.copy()",
            "        self.form_data[\"slug\"] = \"custom_field_boolean_2\"",
            "        super().test_create_object_without_permission()",
            "",
            "    def test_create_object_with_permission(self):",
            "        # Can't have two CustomFields with the same \"slug\"",
            "        self.form_data = self.form_data.copy()",
            "        self.form_data[\"slug\"] = \"custom_field_boolean_2\"",
            "        super().test_create_object_with_permission()",
            "        instance = self._get_queryset().get(slug=\"custom_field_boolean_2\")",
            "        # 2.0 TODO: #824 removal of `name` field altogether",
            "        # Assure that `name` was auto-populated from the given slug",
            "        self.assertEqual(instance.name, instance.slug)",
            "",
            "    def test_create_object_with_constrained_permission(self):",
            "        # Can't have two CustomFields with the same \"slug\"",
            "        self.form_data = self.form_data.copy()",
            "        self.form_data[\"slug\"] = \"custom_field_boolean_2\"",
            "        super().test_create_object_with_constrained_permission()",
            "",
            "",
            "class CustomLinkRenderingTestCase(TestCase):",
            "    \"\"\"Tests for the inclusion of CustomLinks, distinct from tests of the CustomLink views themselves.\"\"\"",
            "",
            "    user_permissions = [\"dcim.view_site\"]",
            "",
            "    def test_view_object_with_custom_link(self):",
            "        customlink = CustomLink(",
            "            content_type=ContentType.objects.get_for_model(Site),",
            "            name=\"Test\",",
            "            text=\"FOO {{ obj.name }} BAR\",",
            "            target_url=\"http://example.com/?site={{ obj.slug }}\",",
            "            new_window=False,",
            "        )",
            "        customlink.save()",
            "",
            "        site = Site(name=\"Test Site\", slug=\"test-site\")",
            "        site.save()",
            "",
            "        response = self.client.get(site.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(f\"FOO {site.name} BAR\", content, content)",
            "",
            "    def test_view_object_with_unsafe_custom_link_text(self):",
            "        \"\"\"Ensure that custom links can't be used as a vector for injecting scripts or breaking HTML.\"\"\"",
            "        customlink = CustomLink(",
            "            content_type=ContentType.objects.get_for_model(Site),",
            "            name=\"Test\",",
            "            text='<script>alert(\"Hello world!\")</script>',",
            "            target_url=\"http://example.com/?location=None\",",
            "            new_window=False,",
            "        )",
            "        customlink.validated_save()",
            "        site = Site(name=\"Test Site\", slug=\"test-site\")",
            "        site.save()",
            "",
            "        response = self.client.get(site.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "        self.assertIn(format_html('<a href=\"{}\"', customlink.target_url), content, content)",
            "",
            "    def test_view_object_with_unsafe_custom_link_url(self):",
            "        \"\"\"Ensure that custom links can't be used as a vector for injecting scripts or breaking HTML.\"\"\"",
            "        customlink = CustomLink(",
            "            content_type=ContentType.objects.get_for_model(Site),",
            "            name=\"Test\",",
            "            text=\"Hello\",",
            "            target_url='\"><script>alert(\"Hello world!\")</script><a href=\"',",
            "            new_window=False,",
            "        )",
            "        customlink.validated_save()",
            "        site = Site(name=\"Test Site\", slug=\"test-site\")",
            "        site.save()",
            "",
            "        response = self.client.get(site.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "        self.assertIn(format_html('<a href=\"{}\"', customlink.target_url), content, content)",
            "",
            "    def test_view_object_with_unsafe_custom_link_name(self):",
            "        \"\"\"Ensure that custom links can't be used as a vector for injecting scripts or breaking HTML.\"\"\"",
            "        customlink = CustomLink(",
            "            content_type=ContentType.objects.get_for_model(Site),",
            "            name='<script>alert(\"Hello World\")</script>',",
            "            text=\"Hello\",",
            "            target_url=\"http://example.com/?site={{ obj.name \",  # intentionally bad jinja2 to trigger error case",
            "            new_window=False,",
            "        )",
            "        customlink.validated_save()",
            "        site = Site(name=\"Test Site\", slug=\"test-site\")",
            "        site.save()",
            "",
            "        response = self.client.get(site.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "",
            "class DynamicGroupTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    # NOTE: This isn't using `ViewTestCases.PrimaryObjectViewTestCase` because bulk-import/edit",
            "    # views for DynamicGroup do not make sense at this time, primarily because `content_type` is",
            "    # immutable after create.",
            "):",
            "    model = DynamicGroup",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        content_type = ContentType.objects.get_for_model(Device)",
            "",
            "        # DynamicGroup objects to test.",
            "        DynamicGroup.objects.create(name=\"DG 1\", slug=\"dg-1\", content_type=content_type)",
            "        DynamicGroup.objects.create(name=\"DG 2\", slug=\"dg-2\", content_type=content_type)",
            "        DynamicGroup.objects.create(name=\"DG 3\", slug=\"dg-3\", content_type=content_type)",
            "",
            "        cls.form_data = {",
            "            \"name\": \"new_dynamic_group\",",
            "            \"slug\": \"new-dynamic-group\",",
            "            \"description\": \"I am a new dynamic group object.\",",
            "            \"content_type\": content_type.pk,",
            "            # Management form fields required for the dynamic formset",
            "            \"dynamic_group_memberships-TOTAL_FORMS\": \"0\",",
            "            \"dynamic_group_memberships-INITIAL_FORMS\": \"1\",",
            "            \"dynamic_group_memberships-MIN_NUM_FORMS\": \"0\",",
            "            \"dynamic_group_memberships-MAX_NUM_FORMS\": \"1000\",",
            "        }",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_edit_saved_filter(self):",
            "        \"\"\"Test that editing a filter works using the edit view.\"\"\"",
            "        self.add_permissions(\"extras.add_dynamicgroup\", \"extras.change_dynamicgroup\")",
            "",
            "        # Create the object first.",
            "        data = self.form_data.copy()",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 302)",
            "",
            "        # Now update it.",
            "        instance = self._get_queryset().get(name=data[\"name\"])",
            "        data[\"filter-serial\"] = \"abc123\"",
            "        request = {",
            "            \"path\": self._get_url(\"edit\", instance),",
            "            \"data\": post_data(data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 302)",
            "",
            "        instance.refresh_from_db()",
            "        self.assertEqual(instance.filter, {\"serial\": data[\"filter-serial\"]})",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_filter_by_content_type(self):",
            "        \"\"\"",
            "        Test that filtering by `content_type` in the UI succeeds.",
            "",
            "        This is a regression test for https://github.com/nautobot/nautobot/issues/3612",
            "        \"\"\"",
            "        path = self._get_url(\"list\")",
            "        response = self.client.get(path + \"?content_type=dcim.device\")",
            "        self.assertHttpStatus(response, 200)",
            "",
            "",
            "class ExportTemplateTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = ExportTemplate",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = ContentType.objects.get_for_model(Site)",
            "",
            "        templates = (",
            "            ExportTemplate(",
            "                name=\"template-1\",",
            "                template_code=\"template-1 test1\",",
            "                content_type=obj_type,",
            "            ),",
            "            ExportTemplate(",
            "                name=\"template-2\",",
            "                template_code=\"template-2 test2\",",
            "                content_type=obj_type,",
            "            ),",
            "            ExportTemplate(",
            "                name=\"template-3\",",
            "                template_code=\"template-3 test3\",",
            "                content_type=obj_type,",
            "            ),",
            "        )",
            "",
            "        for template in templates:",
            "            template.save()",
            "",
            "        cls.form_data = {",
            "            \"name\": \"template-4\",",
            "            \"content_type\": obj_type.pk,",
            "            \"template_code\": \"template-4 test4\",",
            "        }",
            "",
            "",
            "class GitRepositoryTestCase(",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.BulkImportObjectsViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = GitRepository",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        secrets_groups = (",
            "            SecretsGroup.objects.create(name=\"Secrets Group 1\", slug=\"secrets-group-1\"),",
            "            SecretsGroup.objects.create(name=\"Secrets Group 2\", slug=\"secrets-group-2\"),",
            "        )",
            "",
            "        # Create four GitRepository records",
            "        repos = (",
            "            GitRepository(name=\"Repo 1\", slug=\"repo-1\", remote_url=\"https://example.com/repo1.git\"),",
            "            GitRepository(name=\"Repo 2\", slug=\"repo-2\", remote_url=\"https://example.com/repo2.git\"),",
            "            GitRepository(name=\"Repo 3\", slug=\"repo-3\", remote_url=\"https://example.com/repo3.git\"),",
            "            GitRepository(name=\"Repo 4\", remote_url=\"https://example.com/repo4.git\", secrets_group=secrets_groups[0]),",
            "        )",
            "        for repo in repos:",
            "            repo.save(trigger_resync=False)",
            "",
            "        cls.form_data = {",
            "            \"name\": \"A new Git repository\",",
            "            \"slug\": \"a-new-git-repository\",",
            "            \"remote_url\": \"http://example.com/a_new_git_repository.git\",",
            "            \"branch\": \"develop\",",
            "            \"_token\": \"1234567890abcdef1234567890abcdef\",",
            "            \"secrets_group\": secrets_groups[1].pk,",
            "            \"provided_contents\": [",
            "                \"extras.configcontext\",",
            "                \"extras.job\",",
            "                \"extras.exporttemplate\",",
            "            ],",
            "        }",
            "",
            "        cls.csv_data = (",
            "            \"name,slug,remote_url,branch,secrets_group,provided_contents\",",
            "            \"Git Repository 5,git-repo-5,https://example.com,main,,extras.configcontext\",",
            "            \"Git Repository 6,git-repo-6,https://example.com,develop,Secrets Group 2,\",",
            "            'Git Repository 7,git-repo-7,https://example.com,next,Secrets Group 2,\"extras.job,extras.exporttemplate\"',",
            "        )",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"Repo 4\"",
            "",
            "",
            "class NoteTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "):",
            "    model = Note",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        content_type = ContentType.objects.get_for_model(Site)",
            "        cls.site = Site.objects.first()",
            "        user = User.objects.first()",
            "",
            "        # Notes Objects to test",
            "        Note.objects.create(",
            "            note=\"Site has been placed on maintenance.\",",
            "            user=user,",
            "            assigned_object_type=content_type,",
            "            assigned_object_id=cls.site.pk,",
            "        )",
            "        Note.objects.create(",
            "            note=\"Site maintenance has ended.\",",
            "            user=user,",
            "            assigned_object_type=content_type,",
            "            assigned_object_id=cls.site.pk,",
            "        )",
            "        Note.objects.create(",
            "            note=\"Site is under duress.\",",
            "            user=user,",
            "            assigned_object_type=content_type,",
            "            assigned_object_id=cls.site.pk,",
            "        )",
            "",
            "        cls.form_data = {",
            "            \"note\": \"This is Site note.\",",
            "            \"assigned_object_type\": content_type.pk,",
            "            \"assigned_object_id\": cls.site.pk,",
            "        }",
            "        cls.expected_object_note = '<textarea name=\"object_note\" cols=\"40\" rows=\"10\" class=\"form-control\" placeholder=\"Note\" id=\"id_object_note\"></textarea>'",
            "",
            "    def test_note_on_bulk_update_perms(self):",
            "        self.add_permissions(\"dcim.add_site\", \"extras.add_note\")",
            "        response = self.client.get(reverse(\"dcim:site_add\"))",
            "        self.assertContains(response, self.expected_object_note, html=True)",
            "",
            "    def test_note_on_bulk_update_no_perms(self):",
            "        self.add_permissions(\"dcim.add_site\")",
            "        response = self.client.get(reverse(\"dcim:site_add\"))",
            "        self.assertNotContains(response, self.expected_object_note, html=True)",
            "",
            "    def test_note_on_create_edit_perms(self):",
            "        self.add_permissions(\"dcim.change_site\", \"extras.add_note\")",
            "        response = self.client.post(reverse(\"dcim:site_bulk_edit\"), data={\"pk\": self.site.pk})",
            "        self.assertContains(response, self.expected_object_note, html=True)",
            "",
            "    def test_note_on_create_edit_no_perms(self):",
            "        self.add_permissions(\"dcim.change_site\")",
            "        response = self.client.post(reverse(\"dcim:site_bulk_edit\"), data={\"pk\": self.site.pk})",
            "        self.assertNotContains(response, self.expected_object_note, html=True)",
            "",
            "",
            "# Not a full-fledged PrimaryObjectViewTestCase as there's no BulkEditView for Secrets",
            "class SecretTestCase(",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkImportObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = Secret",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        secrets = (",
            "            Secret(",
            "                name=\"View Test 1\",",
            "                provider=\"environment-variable\",",
            "                parameters={\"variable\": \"VIEW_TEST_1\"},",
            "                tags=[t.pk for t in Tag.objects.get_for_model(Secret)],",
            "            ),",
            "            Secret(",
            "                name=\"View Test 2\",",
            "                provider=\"environment-variable\",",
            "                parameters={\"variable\": \"VIEW_TEST_2\"},",
            "            ),",
            "            Secret(",
            "                name=\"View Test 3\",",
            "                provider=\"environment-variable\",",
            "                parameters={\"variable\": \"VIEW_TEST_3\"},",
            "            ),",
            "        )",
            "",
            "        for secret in secrets:",
            "            secret.validated_save()",
            "",
            "        cls.form_data = {",
            "            \"name\": \"View Test 4\",",
            "            \"slug\": \"view-test-4\",",
            "            \"provider\": \"environment-variable\",",
            "            \"parameters\": '{\"variable\": \"VIEW_TEST_4\"}',",
            "        }",
            "",
            "        cls.csv_data = (",
            "            \"name,slug,provider,parameters\",",
            "            'View Test 5,view-test-5,environment-variable,{\"variable\": \"VIEW_TEST_5\"}',",
            "            'View Test 6,,environment-variable,{\"variable\": \"VIEW_TEST_6\"}',",
            "            'View Test 7,,environment-variable,{\"variable\": \"VIEW_TEST_7\"}',",
            "        )",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"View Test 3\"",
            "",
            "",
            "# Not a full-fledged OrganizationalObjectViewTestCase as there's no BulkImportView for SecretsGroups",
            "class SecretsGroupTestCase(",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = SecretsGroup",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        secrets_groups = (",
            "            SecretsGroup.objects.create(name=\"Group 1\", slug=\"group-1\", description=\"First Group\"),",
            "            SecretsGroup.objects.create(name=\"Group 2\", slug=\"group-2\"),",
            "            SecretsGroup.objects.create(name=\"Group 3\", slug=\"group-3\"),",
            "        )",
            "",
            "        secrets = (",
            "            Secret.objects.create(name=\"secret 1\", slug=\"secret-1\", provider=\"text-file\", parameters={\"path\": \"/tmp\"}),",
            "            Secret.objects.create(name=\"secret 2\", slug=\"secret-2\", provider=\"text-file\", parameters={\"path\": \"/tmp\"}),",
            "            Secret.objects.create(name=\"secret 3\", slug=\"secret-3\", provider=\"text-file\", parameters={\"path\": \"/tmp\"}),",
            "        )",
            "",
            "        SecretsGroupAssociation.objects.create(",
            "            group=secrets_groups[0],",
            "            secret=secrets[0],",
            "            access_type=SecretsGroupAccessTypeChoices.TYPE_GENERIC,",
            "            secret_type=SecretsGroupSecretTypeChoices.TYPE_USERNAME,",
            "        )",
            "        SecretsGroupAssociation.objects.create(",
            "            group=secrets_groups[0],",
            "            secret=secrets[1],",
            "            access_type=SecretsGroupAccessTypeChoices.TYPE_GENERIC,",
            "            secret_type=SecretsGroupSecretTypeChoices.TYPE_PASSWORD,",
            "        )",
            "        SecretsGroupAssociation.objects.create(",
            "            group=secrets_groups[1],",
            "            secret=secrets[1],",
            "            access_type=SecretsGroupAccessTypeChoices.TYPE_GENERIC,",
            "            secret_type=SecretsGroupSecretTypeChoices.TYPE_PASSWORD,",
            "        )",
            "",
            "        cls.form_data = {",
            "            \"name\": \"Group 4\",",
            "            \"slug\": \"group-4\",",
            "            \"description\": \"Some description\",",
            "            # Management form fields required for the dynamic Secret formset",
            "            \"secretsgroupassociation_set-TOTAL_FORMS\": \"0\",",
            "            \"secretsgroupassociation_set-INITIAL_FORMS\": \"1\",",
            "            \"secretsgroupassociation_set-MIN_NUM_FORMS\": \"0\",",
            "            \"secretsgroupassociation_set-MAX_NUM_FORMS\": \"1000\",",
            "        }",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"Group 3\"",
            "",
            "",
            "class GraphQLQueriesTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = GraphQLQuery",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        graphqlqueries = (",
            "            GraphQLQuery(",
            "                name=\"graphql-query-1\",",
            "                slug=\"graphql-query-1\",",
            "                query=\"{ query: sites {name} }\",",
            "            ),",
            "            GraphQLQuery(",
            "                name=\"graphql-query-2\",",
            "                slug=\"graphql-query-2\",",
            "                query='{ devices(role: \"edge\") { id, name, device_role { name slug } } }',",
            "            ),",
            "            GraphQLQuery(",
            "                name=\"graphql-query-3\",",
            "                slug=\"graphql-query-3\",",
            "                query=BIG_GRAPHQL_DEVICE_QUERY,",
            "            ),",
            "            GraphQLQuery(",
            "                name=\"Graphql Query 5\",",
            "                query='{ devices(role: \"edge\") { id, name, device_role { name slug } } }',",
            "            ),",
            "        )",
            "",
            "        for query in graphqlqueries:",
            "            query.full_clean()",
            "            query.save()",
            "",
            "        cls.form_data = {",
            "            \"name\": \"graphql-query-4\",",
            "            \"slug\": \"graphql-query-4\",",
            "            \"query\": \"{query: sites {name}}\",",
            "        }",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"Graphql Query 5\"",
            "",
            "",
            "#",
            "# Jobs, Scheduling, and Approvals",
            "#",
            "",
            "",
            "class ScheduledJobTestCase(",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = ScheduledJob",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        user = User.objects.create(username=\"user1\", is_active=True)",
            "        ScheduledJob.objects.create(",
            "            name=\"test1\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=user,",
            "            start_time=datetime.now(),",
            "        )",
            "        ScheduledJob.objects.create(",
            "            name=\"test2\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=user,",
            "            start_time=datetime.now(),",
            "        )",
            "        ScheduledJob.objects.create(",
            "            name=\"test3\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=user,",
            "            start_time=datetime.now(),",
            "        )",
            "",
            "    def test_only_enabled_is_listed(self):",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        # this should not appear, since it\u2019s not enabled",
            "        ScheduledJob.objects.create(",
            "            enabled=False,",
            "            name=\"test4\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            start_time=datetime.now(),",
            "        )",
            "",
            "        response = self.client.get(self._get_url(\"list\"))",
            "        self.assertHttpStatus(response, 200)",
            "        self.assertNotIn(\"test4\", extract_page_body(response.content.decode(response.charset)))",
            "",
            "    def test_non_valid_crontab_syntax(self):",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        def scheduled_job_factory(name, crontab):",
            "            ScheduledJob.objects.create(",
            "                enabled=True,",
            "                name=name,",
            "                task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "                job_class=\"local/test_pass/TestPass\",",
            "                interval=JobExecutionType.TYPE_CUSTOM,",
            "                user=self.user,",
            "                start_time=timezone.now(),",
            "                crontab=crontab,",
            "            )",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test5\", None)",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test6\", \"\")",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test7\", \"not_enough_values_to_unpack\")",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test8\", \"one too many values to unpack\")",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test9\", \"-1 * * * *\")",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test10\", \"invalid literal * * *\")",
            "",
            "    def test_valid_crontab_syntax(self):",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        ScheduledJob.objects.create(",
            "            enabled=True,",
            "            name=\"test11\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_CUSTOM,",
            "            user=self.user,",
            "            start_time=datetime.now(),",
            "            crontab=\"*/15 9,17 3 * 1-5\",",
            "        )",
            "",
            "        response = self.client.get(self._get_url(\"list\"))",
            "        self.assertHttpStatus(response, 200)",
            "        self.assertIn(\"test11\", extract_page_body(response.content.decode(response.charset)))",
            "",
            "",
            "class ApprovalQueueTestCase(",
            "    # It would be nice to use ViewTestCases.GetObjectViewTestCase as well,",
            "    # but we can't directly use it as it uses instance.get_absolute_url() rather than self._get_url(\"view\", instance)",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = ScheduledJob",
            "    # Many interactions with a ScheduledJob also require permissions to view the associated Job",
            "    user_permissions = (\"extras.view_job\",)",
            "",
            "    def _get_url(self, action, instance=None):",
            "        if action == \"list\":",
            "            return reverse(\"extras:scheduledjob_approval_queue_list\")",
            "        if action == \"view\" and instance is not None:",
            "            return reverse(\"extras:scheduledjob_approval_request_view\", kwargs={\"pk\": instance.pk})",
            "        raise ValueError(\"This override is only valid for list and view test cases\")",
            "",
            "    def setUp(self):",
            "        super().setUp()",
            "        self.job_model = Job.objects.get_for_class_path(\"local/test_pass/TestPass\")",
            "        self.job_model_2 = Job.objects.get_for_class_path(\"local/test_fail/TestFail\")",
            "        self.job_model_3 = Job.objects.get_for_class_path(\"local/test_read_only_pass/TestReadOnlyPass\")",
            "",
            "        ScheduledJob.objects.create(",
            "            name=\"test1\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_model=self.job_model,",
            "            job_class=self.job_model.class_path,",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            approval_required=True,",
            "            start_time=datetime.now(),",
            "        )",
            "        ScheduledJob.objects.create(",
            "            name=\"test2\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_model=self.job_model_2,",
            "            job_class=self.job_model_2.class_path,",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            approval_required=True,",
            "            start_time=datetime.now(),",
            "        )",
            "        ScheduledJob.objects.create(",
            "            name=\"test3\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_model=self.job_model_3,",
            "            job_class=self.job_model_3.class_path,",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            approval_required=True,",
            "            start_time=datetime.now(),",
            "        )",
            "",
            "    def test_only_approvable_is_listed(self):",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        ScheduledJob.objects.create(",
            "            name=\"test4\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_model=self.job_model,",
            "            job_class=self.job_model.class_path,",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            approval_required=False,",
            "            start_time=datetime.now(),",
            "        )",
            "",
            "        response = self.client.get(self._get_url(\"list\"))",
            "        self.assertHttpStatus(response, 200)",
            "        self.assertNotIn(\"test4\", extract_page_body(response.content.decode(response.charset)))",
            "",
            "    #",
            "    # Reimplementations of ViewTestCases.GetObjectViewTestCase test functions.",
            "    # Needed because those use instance.get_absolute_url() instead of self._get_url(\"view\", instance)...",
            "    #",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_get_object_anonymous(self):",
            "        self.client.logout()",
            "        response = self.client.get(self._get_url(\"view\", self._get_queryset().first()))",
            "        self.assertHttpStatus(response, 200)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_object_without_permission(self):",
            "        instance = self._get_queryset().first()",
            "",
            "        with disable_warnings(\"django.request\"):",
            "            self.assertHttpStatus(self.client.get(self._get_url(\"view\", instance)), 403)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_object_with_permission(self):",
            "        instance = self._get_queryset().first()",
            "",
            "        # Add model-level permission",
            "        obj_perm = ObjectPermission(name=\"Test permission\", actions=[\"view\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(self.model))",
            "",
            "        # Try GET with model-level permission",
            "        response = self.client.get(self._get_url(\"view\", instance))",
            "        self.assertHttpStatus(response, 200)",
            "",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "",
            "        # The object's display name or string representation should appear in the response",
            "        self.assertIn(getattr(instance, \"display\", str(instance)), response_body, msg=response_body)",
            "",
            "        # skip GetObjectViewTestCase checks for Relationships and Custom Fields since this isn't actually a detail view",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_object_with_constrained_permission(self):",
            "        instance1, instance2 = self._get_queryset().all()[:2]",
            "",
            "        # Add object-level permission",
            "        obj_perm = ObjectPermission(",
            "            name=\"Test permission\",",
            "            constraints={\"pk\": instance1.pk},",
            "            # To get a different rendering flow than the \"test_get_object_with_permission\" test above,",
            "            # enable additional permissions for this object so that interaction buttons are rendered.",
            "            actions=[\"view\", \"add\", \"change\", \"delete\"],",
            "        )",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(self.model))",
            "",
            "        # Try GET to permitted object",
            "        self.assertHttpStatus(self.client.get(self._get_url(\"view\", instance1)), 200)",
            "",
            "        # Try GET to non-permitted object",
            "        self.assertHttpStatus(self.client.get(self._get_url(\"view\", instance2)), 404)",
            "",
            "    #",
            "    # Additional test cases specific to the job approval view",
            "    #",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_anonymous(self):",
            "        \"\"\"Anonymous users may not take any action with regard to job approval requests.\"\"\"",
            "        self.client.logout()",
            "        response = self.client.post(self._get_url(\"view\", self._get_queryset().first()))",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission to run jobs\", response_body)",
            "        # No job was submitted",
            "        self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_post_dry_run_not_runnable(self):",
            "        \"\"\"A non-enabled job cannot be dry-run.\"\"\"",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "        instance = self._get_queryset().first()",
            "        data = {\"_dry_run\": True}",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"This job cannot be run at this time\", response_body)",
            "        # No job was submitted",
            "        self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_post_dry_run_needs_job_run_permission(self):",
            "        \"\"\"A user without run_job permission cannot dry-run a job.\"\"\"",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "        instance = self._get_queryset().first()",
            "        instance.job_model.enabled = True",
            "        instance.job_model.save()",
            "        data = {\"_dry_run\": True}",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission to run this job\", response_body)",
            "        # No job was submitted",
            "        self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_post_dry_run_needs_specific_job_run_permission(self):",
            "        \"\"\"A user without run_job permission FOR THAT SPECIFIC JOB cannot dry-run a job.\"\"\"",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "        instance1, instance2 = self._get_queryset().all()[:2]",
            "        data = {\"_dry_run\": True}",
            "        obj_perm = ObjectPermission(name=\"Test permission\", constraints={\"pk\": instance1.job_model.pk}, actions=[\"run\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "        instance1.job_model.enabled = True",
            "        instance1.job_model.save()",
            "        instance2.job_model.enabled = True",
            "        instance2.job_model.save()",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance2), data)",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission to run this job\", response_body)",
            "        # No job was submitted",
            "        self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_post_dry_run_success(self, _):",
            "        \"\"\"Successfully request a dry run based on object-based run_job permissions.\"\"\"",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "        instance = self._get_queryset().first()",
            "        instance.job_model.enabled = True",
            "        instance.job_model.save()",
            "        obj_perm = ObjectPermission(name=\"Test permission\", constraints={\"pk\": instance.job_model.pk}, actions=[\"run\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "        data = {\"_dry_run\": True}",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        # Job was submitted",
            "        self.assertEqual(",
            "            1, len(JobResult.objects.all()), msg=extract_page_body(response.content.decode(response.charset))",
            "        )",
            "        job_result = JobResult.objects.first()",
            "        self.assertEqual(job_result.job_model, instance.job_model)",
            "        self.assertEqual(job_result.user, self.user)",
            "        self.assertRedirects(response, reverse(\"extras:jobresult\", kwargs={\"pk\": job_result.pk}))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_deny_different_user_lacking_permissions(self):",
            "        \"\"\"A user needs both delete_scheduledjob and approve_job permissions to deny a job request.\"\"\"",
            "        user1 = User.objects.create_user(username=\"testuser1\")",
            "        user2 = User.objects.create_user(username=\"testuser2\")",
            "",
            "        # Give both users view_scheduledjob permission",
            "        obj_perm = ObjectPermission(name=\"View\", actions=[\"view\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user1, user2)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user1 delete_scheduledjob permission but not approve_job permission",
            "        obj_perm = ObjectPermission(name=\"Delete\", actions=[\"delete\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user1)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user2 approve_job permission but not delete_scheduledjob permission",
            "        obj_perm = ObjectPermission(name=\"Approve\", actions=[\"approve\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user2)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        instance = self._get_queryset().first()",
            "        data = {\"_deny\": True}",
            "",
            "        for user in (user1, user2):",
            "            self.client.force_login(user)",
            "            response = self.client.post(self._get_url(\"view\", instance), data)",
            "            self.assertHttpStatus(response, 200, msg=str(user))",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"You do not have permission\", response_body, msg=str(user))",
            "            # Request was not deleted",
            "            self.assertEqual(1, len(ScheduledJob.objects.filter(pk=instance.pk)), msg=str(user))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_deny_different_user_permitted(self):",
            "        \"\"\"A user with appropriate permissions can deny a job request.\"\"\"",
            "        user = User.objects.create_user(username=\"testuser1\")",
            "        instance = self._get_queryset().first()",
            "",
            "        # Give user view_scheduledjob and delete_scheduledjob permissions",
            "        obj_perm = ObjectPermission(name=\"View\", actions=[\"view\", \"delete\"], constraints={\"pk\": instance.pk})",
            "        obj_perm.save()",
            "        obj_perm.users.add(user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user approve_job permission",
            "        obj_perm = ObjectPermission(name=\"Approve\", actions=[\"approve\"], constraints={\"pk\": instance.job_model.pk})",
            "        obj_perm.save()",
            "        obj_perm.users.add(user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        data = {\"_deny\": True}",
            "",
            "        self.client.force_login(user)",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertRedirects(response, reverse(\"extras:scheduledjob_approval_queue_list\"))",
            "        # Request was deleted",
            "        self.assertEqual(0, len(ScheduledJob.objects.filter(pk=instance.pk)))",
            "",
            "        # Check object-based permissions are enforced for a different instance",
            "        instance = self._get_queryset().first()",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200, msg=str(user))",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission\", response_body, msg=str(user))",
            "        # Request was not deleted",
            "        self.assertEqual(1, len(ScheduledJob.objects.filter(pk=instance.pk)), msg=str(user))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_approve_cannot_self_approve(self):",
            "        self.add_permissions(\"extras.change_scheduledjob\")",
            "        self.add_permissions(\"extras.approve_job\")",
            "        instance = self._get_queryset().first()",
            "        data = {\"_approve\": True}",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You cannot approve your own job request\", response_body)",
            "        # Job was not approved",
            "        instance.refresh_from_db()",
            "        self.assertIsNone(instance.approved_by_user)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_approve_different_user_lacking_permissions(self):",
            "        \"\"\"A user needs both change_scheduledjob and approve_job permissions to approve a job request.\"\"\"",
            "        user1 = User.objects.create_user(username=\"testuser1\")",
            "        user2 = User.objects.create_user(username=\"testuser2\")",
            "",
            "        # Give both users view_scheduledjob permission",
            "        obj_perm = ObjectPermission(name=\"View\", actions=[\"view\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user1, user2)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user1 change_scheduledjob permission but not approve_job permission",
            "        obj_perm = ObjectPermission(name=\"Change\", actions=[\"change\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user1)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user2 approve_job permission but not change_scheduledjob permission",
            "        obj_perm = ObjectPermission(name=\"Approve\", actions=[\"approve\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user2)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        instance = self._get_queryset().first()",
            "        data = {\"_approve\": True}",
            "",
            "        for user in (user1, user2):",
            "            self.client.force_login(user)",
            "            response = self.client.post(self._get_url(\"view\", instance), data)",
            "            self.assertHttpStatus(response, 200, msg=str(user))",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"You do not have permission\", response_body, msg=str(user))",
            "            # Job was not approved",
            "            instance.refresh_from_db()",
            "            self.assertIsNone(instance.approved_by_user)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_approve_different_user_permitted(self):",
            "        \"\"\"A user with appropriate permissions can approve a job request.\"\"\"",
            "        user = User.objects.create_user(username=\"testuser1\")",
            "        instance = self._get_queryset().first()",
            "",
            "        # Give user view_scheduledjob and change_scheduledjob permissions",
            "        obj_perm = ObjectPermission(name=\"View\", actions=[\"view\", \"change\"], constraints={\"pk\": instance.pk})",
            "        obj_perm.save()",
            "        obj_perm.users.add(user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user approve_job permission",
            "        obj_perm = ObjectPermission(name=\"Approve\", actions=[\"approve\"], constraints={\"pk\": instance.job_model.pk})",
            "        obj_perm.save()",
            "        obj_perm.users.add(user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        data = {\"_approve\": True}",
            "",
            "        self.client.force_login(user)",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertRedirects(response, reverse(\"extras:scheduledjob_approval_queue_list\"))",
            "        # Job was scheduled",
            "        instance.refresh_from_db()",
            "        self.assertEqual(instance.approved_by_user, user)",
            "",
            "        # Check object-based permissions are enforced for a different instance",
            "        instance = self._get_queryset().last()",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200, msg=str(user))",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission\", response_body, msg=str(user))",
            "        # Job was not scheduled",
            "        instance.refresh_from_db()",
            "        self.assertIsNone(instance.approved_by_user)",
            "",
            "",
            "class JobResultTestCase(",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = JobResult",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = get_job_content_type()",
            "        JobResult.objects.create(",
            "            name=\"local/test_pass/TestPass\",",
            "            job_id=uuid.uuid4(),",
            "            obj_type=obj_type,",
            "        )",
            "        JobResult.objects.create(",
            "            name=\"local/test_fail/TestFail\",",
            "            job_id=uuid.uuid4(),",
            "            obj_type=obj_type,",
            "        )",
            "        JobResult.objects.create(",
            "            name=\"local/test_read_only_fail/TestReadOnlyFail\",",
            "            job_id=uuid.uuid4(),",
            "            obj_type=obj_type,",
            "        )",
            "",
            "",
            "class JobTestCase(",
            "    # note no CreateObjectViewTestCase - we do not support user creation of Job records",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    \"\"\"",
            "    The Job view test cases.",
            "    \"\"\"",
            "",
            "    model = Job",
            "",
            "    def _get_queryset(self):",
            "        \"\"\"Don't include hidden Jobs, non-installed Jobs, JobHookReceivers or JobButtonReceivers as they won't appear in the UI by default.\"\"\"",
            "        return self.model.objects.filter(",
            "            installed=True, hidden=False, is_job_hook_receiver=False, is_job_button_receiver=False",
            "        )",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        # Job model objects are automatically created during database migrations",
            "",
            "        # But we do need to make sure the ones we're testing are flagged appropriately",
            "        cls.test_pass = Job.objects.get(job_class_name=\"TestPass\")",
            "        cls.test_pass.enabled = True",
            "        cls.test_pass.save()",
            "",
            "        cls.run_urls = (",
            "            # Legacy URL (job class path based)",
            "            reverse(\"extras:job\", kwargs={\"class_path\": cls.test_pass.class_path}),",
            "            # Current URL (job model slug based)",
            "            reverse(\"extras:job_run\", kwargs={\"slug\": cls.test_pass.slug}),",
            "        )",
            "",
            "        cls.test_required_args = Job.objects.get(job_class_name=\"TestRequired\")",
            "        cls.test_required_args.enabled = True",
            "        cls.test_required_args.save()",
            "",
            "        cls.extra_run_urls = (",
            "            # Legacy URL (job class path based)",
            "            reverse(\"extras:job\", kwargs={\"class_path\": cls.test_required_args.class_path}),",
            "            # Current URL (job model slug based)",
            "            reverse(\"extras:job_run\", kwargs={\"slug\": cls.test_required_args.slug}),",
            "        )",
            "",
            "        # Create an entry for a non-installed Job as well",
            "        cls.test_not_installed = Job(",
            "            source=JobSourceChoices.SOURCE_LOCAL,",
            "            module_name=\"nonexistent\",",
            "            job_class_name=\"NoSuchJob\",",
            "            grouping=\"Nonexistent Jobs\",",
            "            name=\"No such job\",",
            "            enabled=True,",
            "            installed=False,",
            "        )",
            "        cls.test_not_installed.validated_save()",
            "",
            "        cls.data_run_immediately = {",
            "            \"_schedule_type\": \"immediately\",",
            "        }",
            "",
            "        cls.form_data = {",
            "            \"slug\": \"custom-job-slug\",",
            "            \"enabled\": True,",
            "            \"grouping_override\": True,",
            "            \"grouping\": \"Overridden Grouping\",",
            "            \"name_override\": True,",
            "            \"name\": \"Overridden Name\",",
            "            \"description_override\": True,",
            "            \"description\": \"This is an overridden description of a job.\",",
            "            \"commit_default_override\": True,",
            "            \"commit_default\": False,",
            "            \"hidden_override\": True,",
            "            \"hidden\": False,",
            "            \"read_only_override\": True,",
            "            \"read_only\": False,",
            "            \"approval_required_override\": True,",
            "            \"approval_required\": True,",
            "            \"soft_time_limit_override\": True,",
            "            \"soft_time_limit\": 350,",
            "            \"time_limit_override\": True,",
            "            \"time_limit\": 650,",
            "            \"has_sensitive_variables\": False,",
            "            \"has_sensitive_variables_override\": True,",
            "            \"task_queues\": \"overridden,priority\",",
            "            \"task_queues_override\": True,",
            "        }",
            "",
            "    #",
            "    # Additional test cases for the \"job\" (legacy run) and \"job_run\" (updated run) views follow",
            "    #",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_run_without_permission(self):",
            "        for run_url in self.run_urls:",
            "            self.assertHttpStatus(self.client.get(run_url), 403, msg=run_url)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_run_with_permission(self):",
            "        \"\"\"",
            "        Get view with appropriate global permissions.",
            "",
            "        Note that this view is conditional on run_job permission, not view_job permission,",
            "        so EXEMPT_VIEW_PERMISSIONS=[\"*\"] does NOT apply here.",
            "        \"\"\"",
            "        self.add_permissions(\"extras.run_job\")",
            "        for run_url in self.run_urls:",
            "            response = self.client.get(run_url)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"TestPass\", response_body)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_run_with_constrained_permission(self):",
            "        \"\"\"Get view with appropriate object-based permissions.\"\"\"",
            "        obj_perm = ObjectPermission(",
            "            name=\"Job permission\",",
            "            constraints={\"module_name\": self.test_pass.module_name},",
            "            actions=[\"run\"],",
            "        )",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        # Try GET with a permitted object",
            "        for run_url in self.run_urls:",
            "            self.assertHttpStatus(self.client.get(run_url), 200, msg=run_url)",
            "",
            "        # Try GET with a non-permitted object",
            "        for run_url in self.extra_run_urls:",
            "            self.assertHttpStatus(self.client.get(run_url), 404, msg=run_url)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_run_without_permission(self):",
            "        for run_url in self.run_urls:",
            "            self.assertHttpStatus(self.client.post(run_url), 403, msg=run_url)",
            "",
            "    def test_run_missing_schedule(self):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(errors, [\"_schedule_type: This field is required.\"])",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=0)",
            "    def test_run_now_no_worker(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"Celery worker process not running.\", content)",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_jobresult\")",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "",
            "            result = JobResult.objects.latest()",
            "            self.assertRedirects(response, reverse(\"extras:jobresult\", kwargs={\"pk\": result.pk}))",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now_constrained_permissions(self, _):",
            "        obj_perm = ObjectPermission(",
            "            name=\"Job permission\",",
            "            constraints={\"module_name\": self.test_pass.module_name},",
            "            actions=[\"run\"],",
            "        )",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        self.add_permissions(\"extras.view_jobresult\")",
            "",
            "        # Try POST with a permitted object",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "",
            "            result = JobResult.objects.latest()",
            "            self.assertIsNotNone(result, msg=run_url)",
            "            self.assertRedirects(response, reverse(\"extras:jobresult\", kwargs={\"pk\": result.pk}))",
            "",
            "        # Try POST with a non-permitted object",
            "        for run_url in self.extra_run_urls:",
            "            self.assertHttpStatus(self.client.post(run_url, self.data_run_immediately), 404, msg=run_url)",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now_not_installed(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in (",
            "            reverse(\"extras:job\", kwargs={\"class_path\": self.test_not_installed.class_path}),",
            "            reverse(\"extras:job_run\", kwargs={\"slug\": self.test_not_installed.slug}),",
            "        ):",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "            self.assertEqual(response.status_code, 200, msg=run_url)",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"Job is not presently installed\", response_body)",
            "",
            "            self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now_not_enabled(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in (",
            "            reverse(\"extras:job\", kwargs={\"class_path\": \"local/test_fail/TestFail\"}),",
            "            reverse(\"extras:job_run\", kwargs={\"slug\": Job.objects.get(job_class_name=\"TestFail\").slug}),",
            "        ):",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "            self.assertEqual(response.status_code, 200, msg=run_url)",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"Job is not enabled to be run\", response_body)",
            "",
            "            self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    def test_run_now_missing_args(self):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in self.extra_run_urls:",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(errors, [\"var: This field is required.\"])",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now_with_args(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_jobresult\")",
            "",
            "        data = {",
            "            \"_schedule_type\": \"immediately\",",
            "            \"var\": \"12\",",
            "        }",
            "",
            "        for run_url in self.extra_run_urls:",
            "            response = self.client.post(run_url, data)",
            "",
            "            result = JobResult.objects.latest()",
            "            self.assertRedirects(response, reverse(\"extras:jobresult\", kwargs={\"pk\": result.pk}))",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later_missing_name(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(errors, [\"_schedule_name: Please provide a name for the job schedule.\"])",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later_missing_date(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(",
            "                errors,",
            "                [",
            "                    \"_schedule_start_time: Please enter a valid date and time greater than or equal to the current date and time.\"",
            "                ],",
            "            )",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later_date_passed(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "            \"_schedule_start_time\": str(datetime.now() - timedelta(minutes=1)),",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(",
            "                errors,",
            "                [",
            "                    \"_schedule_start_time: Please enter a valid date and time greater than or equal to the current date and time.\"",
            "                ],",
            "            )",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        start_time = timezone.now() + timedelta(minutes=1)",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "            \"_schedule_start_time\": str(start_time),",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertRedirects(response, reverse(\"extras:scheduledjob_list\"))",
            "",
            "            scheduled = ScheduledJob.objects.last()",
            "            self.assertEqual(scheduled.name, \"test\")",
            "            self.assertEqual(scheduled.start_time, start_time)",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later_sets_scheduled_job_kwargs_pk(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        start_time = timezone.now() + timedelta(minutes=1)",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "            \"_schedule_start_time\": str(start_time),",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertRedirects(response, reverse(\"extras:scheduledjob_list\"))",
            "",
            "            scheduled = ScheduledJob.objects.last()",
            "            self.assertEqual(scheduled.kwargs[\"scheduled_job_pk\"], str(scheduled.pk))",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_job_with_sensitive_variables_for_future(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        self.test_pass.has_sensitive_variables = True",
            "        self.test_pass.has_sensitive_variables_override = True",
            "        self.test_pass.validated_save()",
            "",
            "        start_time = timezone.now() + timedelta(minutes=1)",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "            \"_schedule_start_time\": str(start_time),",
            "        }",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=self.run_urls[1])",
            "",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"Unable to schedule job: Job may have sensitive input variables.\", content)",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_job_with_invalid_task_queue(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_jobresult\")",
            "",
            "        self.test_pass.task_queues = []",
            "        self.test_pass.task_queues_override = True",
            "        self.test_pass.validated_save()",
            "",
            "        data = {",
            "            \"_schedule_type\": \"immediately\",",
            "            \"_task_queue\": \"invalid\",",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(",
            "                errors,",
            "                [\"_task_queue: Select a valid choice. invalid is not one of the available choices.\"],",
            "            )",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_job_with_sensitive_variables_and_requires_approval(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        self.test_pass.has_sensitive_variables = True",
            "        self.test_pass.approval_required = True",
            "        self.test_pass.save()",
            "",
            "        data = {",
            "            \"_schedule_type\": \"immediately\",",
            "        }",
            "        for run_url in self.run_urls:",
            "            # Assert warning message shows in get",
            "            response = self.client.get(run_url)",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(",
            "                \"This job is flagged as possibly having sensitive variables but is also flagged as requiring approval.\",",
            "                content,",
            "            )",
            "",
            "            # Assert run button is disabled",
            "            self.assertInHTML(",
            "                \"\"\"",
            "                <button type=\"submit\" name=\"_run\" id=\"id__run\" class=\"btn btn-primary\" disabled=\"disabled\">",
            "                    <i class=\"mdi mdi-play\"></i> Run Job Now",
            "                </button>",
            "                \"\"\",",
            "                content,",
            "            )",
            "            # Assert error message shows after post",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=self.run_urls[1])",
            "",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(",
            "                \"Unable to run or schedule job: \"",
            "                \"This job is flagged as possibly having sensitive variables but is also flagged as requiring approval.\"",
            "                \"One of these two flags must be removed before this job can be scheduled or run.\",",
            "                content,",
            "            )",
            "",
            "    def test_job_object_change_log_view(self):",
            "        \"\"\"Assert Job change log view displays appropriate header\"\"\"",
            "        instance = self.test_pass",
            "        self.add_permissions(\"extras.view_objectchange\", \"extras.view_job\")",
            "        response = self.client.get(instance.get_changelog_url())",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "",
            "        self.assertHttpStatus(response, 200)",
            "        self.assertIn(f\"<h1>{instance.name} - Change Log</h1>\", content)",
            "",
            "",
            "class JobButtonTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = JobButton",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        job_buttons = (",
            "            JobButton.objects.create(",
            "                name=\"JobButton1\",",
            "                text=\"JobButton1\",",
            "                job=Job.objects.get(job_class_name=\"TestJobButtonReceiverSimple\"),",
            "                confirmation=True,",
            "            ),",
            "            JobButton.objects.create(",
            "                name=\"JobButton2\",",
            "                text=\"JobButton2\",",
            "                job=Job.objects.get(job_class_name=\"TestJobButtonReceiverSimple\"),",
            "                confirmation=False,",
            "            ),",
            "            JobButton.objects.create(",
            "                name=\"JobButton3\",",
            "                text=\"JobButton3\",",
            "                job=Job.objects.get(job_class_name=\"TestJobButtonReceiverComplex\"),",
            "                confirmation=True,",
            "                weight=50,",
            "            ),",
            "        )",
            "",
            "        site_ct = ContentType.objects.get_for_model(Site)",
            "        for jb in job_buttons:",
            "            jb.content_types.set([site_ct])",
            "",
            "        cls.form_data = {",
            "            \"content_types\": [site_ct.pk],",
            "            \"name\": \"jobbutton-4\",",
            "            \"text\": \"jobbutton text 4\",",
            "            \"job\": Job.objects.get(job_class_name=\"TestJobButtonReceiverComplex\").pk,",
            "            \"weight\": 100,",
            "            \"button_class\": \"default\",",
            "            \"confirmation\": False,",
            "        }",
            "",
            "",
            "class JobButtonRenderingTestCase(TestCase):",
            "    \"\"\"Tests for the rendering of JobButtons, distinct from tests of the JobButton views themselves.\"\"\"",
            "",
            "    user_permissions = [\"dcim.view_locationtype\"]",
            "",
            "    def setUp(self):",
            "        super().setUp()",
            "        self.job_button = JobButton(",
            "            name=\"JobButton\",",
            "            text=\"JobButton {{ obj.name }}\",",
            "            job=Job.objects.get(job_class_name=\"TestJobButtonReceiverSimple\"),",
            "            confirmation=False,",
            "        )",
            "        self.job_button.validated_save()",
            "        self.job_button.content_types.add(ContentType.objects.get_for_model(LocationType))",
            "        self.location_type = LocationType.objects.get(name=\"Campus\")",
            "",
            "    def test_view_object_with_job_button(self):",
            "        \"\"\"Ensure that the job button is rendered.\"\"\"",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(f\"JobButton {self.location_type.name}\", content, content)",
            "",
            "    def test_view_object_with_unsafe_text(self):",
            "        \"\"\"Ensure that JobButton text can't be used as a vector for XSS.\"\"\"",
            "        self.job_button.text = '<script>alert(\"Hello world!\")</script>'",
            "        self.job_button.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "        # Make sure grouped rendering is safe too",
            "        self.job_button.group = '<script>alert(\"Goodbye\")</script>'",
            "        self.job_button.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "    def test_view_object_with_unsafe_name(self):",
            "        \"\"\"Ensure that JobButton names can't be used as a vector for XSS.\"\"\"",
            "        self.job_button.text = \"JobButton {{ obj\"",
            "        self.job_button.name = '<script>alert(\"Yo\")</script>'",
            "        self.job_button.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "",
            "# TODO: Convert to StandardTestCases.Views",
            "class ObjectChangeTestCase(TestCase):",
            "    user_permissions = (\"extras.view_objectchange\",)",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        site = Site(name=\"Site 1\", slug=\"site-1\")",
            "        site.save()",
            "",
            "        # Create three ObjectChanges",
            "        user = User.objects.create_user(username=\"testuser2\")",
            "        for _ in range(1, 4):",
            "            oc = site.to_objectchange(action=ObjectChangeActionChoices.ACTION_UPDATE)",
            "            oc.user = user",
            "            oc.request_id = uuid.uuid4()",
            "            oc.save()",
            "",
            "    def test_objectchange_list(self):",
            "        url = reverse(\"extras:objectchange_list\")",
            "        params = {",
            "            \"user\": User.objects.first().pk,",
            "        }",
            "",
            "        response = self.client.get(f\"{url}?{urllib.parse.urlencode(params)}\")",
            "        self.assertHttpStatus(response, 200)",
            "",
            "    def test_objectchange(self):",
            "        objectchange = ObjectChange.objects.first()",
            "        response = self.client.get(objectchange.get_absolute_url())",
            "        self.assertHttpStatus(response, 200)",
            "",
            "",
            "class RelationshipTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    RequiredRelationshipTestMixin,",
            "):",
            "    model = Relationship",
            "    slug_source = \"name\"",
            "    slugify_function = staticmethod(slugify_dashes_to_underscores)",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        interface_type = ContentType.objects.get_for_model(Interface)",
            "        device_type = ContentType.objects.get_for_model(Device)",
            "        vlan_type = ContentType.objects.get_for_model(VLAN)",
            "",
            "        Relationship(",
            "            name=\"Device VLANs\",",
            "            slug=\"device-vlans\",",
            "            type=\"many-to-many\",",
            "            source_type=device_type,",
            "            destination_type=vlan_type,",
            "        ).validated_save()",
            "        Relationship(",
            "            name=\"Primary VLAN\",",
            "            slug=\"primary-vlan\",",
            "            type=\"one-to-many\",",
            "            source_type=vlan_type,",
            "            destination_type=device_type,",
            "        ).validated_save()",
            "        Relationship(",
            "            name=\"Primary Interface\",",
            "            type=\"one-to-one\",",
            "            source_type=device_type,",
            "            destination_type=interface_type,",
            "        ).validated_save()",
            "",
            "        cls.form_data = {",
            "            \"name\": \"VLAN-to-Interface\",",
            "            \"slug\": \"vlan-to-interface\",",
            "            \"type\": \"many-to-many\",",
            "            \"source_type\": vlan_type.pk,",
            "            \"source_label\": \"Interfaces\",",
            "            \"source_hidden\": False,",
            "            \"source_filter\": '{\"status\": [\"active\"]}',",
            "            \"destination_type\": interface_type.pk,",
            "            \"destination_label\": \"VLANs\",",
            "            \"destination_hidden\": True,",
            "            \"destination_filter\": None,",
            "        }",
            "",
            "        cls.slug_test_object = \"Primary Interface\"",
            "",
            "    def test_required_relationships(self):",
            "        \"\"\"",
            "        1. Try creating an object when no required target object exists",
            "        2. Try creating an object without specifying required target object(s)",
            "        3. Try creating an object when all required data is present",
            "        4. Test bulk edit",
            "        \"\"\"",
            "",
            "        # Parameterized tests (for creating and updating single objects):",
            "        self.required_relationships_test(interact_with=\"ui\")",
            "",
            "        # 4. Bulk create/edit tests:",
            "",
            "        vlans = VLANFactory.create_batch(6)",
            "",
            "        # Try deleting all devices and then editing the 6 VLANs (fails):",
            "        Device.objects.all().delete()",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"), data={\"pk\": [str(vlan.id) for vlan in vlans], \"_apply\": [\"\"]}",
            "        )",
            "        self.assertContains(response, \"VLANs require at least one device, but no devices exist yet.\")",
            "",
            "        # Create test device for association",
            "        device_for_association = test_views.create_test_device(\"VLAN Required Device\")",
            "",
            "        # Try editing all 6 VLANs without adding the required device(fails):",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"), data={\"pk\": [str(vlan.id) for vlan in vlans], \"_apply\": [\"\"]}",
            "        )",
            "        self.assertContains(",
            "            response,",
            "            \"6 VLANs require a device for the required relationship &quot;VLANs require at least one Device&quot;\",",
            "        )",
            "",
            "        # Try editing 3 VLANs without adding the required device(fails):",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"), data={\"pk\": [str(vlan.id) for vlan in vlans[:3]], \"_apply\": [\"\"]}",
            "        )",
            "        self.assertContains(",
            "            response,",
            "            \"These VLANs require a device for the required \"",
            "            \"relationship &quot;VLANs require at least one Device&quot;\",",
            "        )",
            "        for vlan in vlans[:3]:",
            "            self.assertContains(response, f\"{str(vlan)}\")",
            "",
            "        # Try editing 6 VLANs and adding the required device (succeeds):",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"),",
            "            data={",
            "                \"pk\": [str(vlan.id) for vlan in vlans],",
            "                \"add_cr_vlans-devices-m2m__source\": [str(device_for_association.id)],",
            "                \"_apply\": [\"\"],",
            "            },",
            "            follow=True,",
            "        )",
            "        self.assertContains(response, \"Updated 6 VLANs\")",
            "",
            "        # Try editing 6 VLANs and removing the required device (fails):",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"),",
            "            data={",
            "                \"pk\": [str(vlan.id) for vlan in vlans],",
            "                \"remove_cr_vlans-devices-m2m__source\": [str(device_for_association.id)],",
            "                \"_apply\": [\"\"],",
            "            },",
            "        )",
            "        self.assertContains(",
            "            response,",
            "            \"6 VLANs require a device for the required relationship &quot;VLANs require at least one Device&quot;\",",
            "        )",
            "",
            "",
            "class RelationshipAssociationTestCase(",
            "    # TODO? ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    # TODO? ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    # TODO? ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = RelationshipAssociation",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        device_type = ContentType.objects.get_for_model(Device)",
            "        vlan_type = ContentType.objects.get_for_model(VLAN)",
            "",
            "        relationship = Relationship(",
            "            name=\"Device VLANs\",",
            "            slug=\"device-vlans\",",
            "            type=\"many-to-many\",",
            "            source_type=device_type,",
            "            destination_type=vlan_type,",
            "        )",
            "        relationship.validated_save()",
            "        manufacturer = Manufacturer.objects.create(name=\"Manufacturer 1\", slug=\"manufacturer-1\")",
            "        devicetype = DeviceType.objects.create(manufacturer=manufacturer, model=\"Device Type 1\", slug=\"device-type-1\")",
            "        devicerole = DeviceRole.objects.create(name=\"Device Role 1\", slug=\"device-role-1\")",
            "        site = Site.objects.first()",
            "        devices = (",
            "            Device.objects.create(name=\"Device 1\", device_type=devicetype, device_role=devicerole, site=site),",
            "            Device.objects.create(name=\"Device 2\", device_type=devicetype, device_role=devicerole, site=site),",
            "            Device.objects.create(name=\"Device 3\", device_type=devicetype, device_role=devicerole, site=site),",
            "        )",
            "        vlans = (",
            "            VLAN.objects.create(vid=1, name=\"VLAN 1\"),",
            "            VLAN.objects.create(vid=2, name=\"VLAN 2\"),",
            "            VLAN.objects.create(vid=3, name=\"VLAN 3\"),",
            "        )",
            "",
            "        RelationshipAssociation(",
            "            relationship=relationship,",
            "            source_type=device_type,",
            "            source_id=devices[0].pk,",
            "            destination_type=vlan_type,",
            "            destination_id=vlans[0].pk,",
            "        ).validated_save()",
            "        RelationshipAssociation(",
            "            relationship=relationship,",
            "            source_type=device_type,",
            "            source_id=devices[1].pk,",
            "            destination_type=vlan_type,",
            "            destination_id=vlans[1].pk,",
            "        ).validated_save()",
            "        RelationshipAssociation(",
            "            relationship=relationship,",
            "            source_type=device_type,",
            "            source_id=devices[2].pk,",
            "            destination_type=vlan_type,",
            "            destination_id=vlans[2].pk,",
            "        ).validated_save()",
            "",
            "",
            "class StatusTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = Status",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        # Status objects to test.",
            "        content_type = ContentType.objects.get_for_model(Device)",
            "",
            "        cls.form_data = {",
            "            \"name\": \"new_status\",",
            "            \"slug\": \"new-status\",",
            "            \"description\": \"I am a new status object.\",",
            "            \"color\": \"ffcc00\",",
            "            \"content_types\": [content_type.pk],",
            "        }",
            "",
            "        cls.csv_data = (",
            "            \"name,slug,color,content_types\"",
            "            'test_status1,test-status1,ffffff,\"dcim.device\"'",
            "            'test_status2,test-status2,ffffff,\"dcim.device,dcim.rack\"'",
            "            'test_status3,test-status3,ffffff,\"dcim.device,dcim.site\"'",
            "            'test_status4,,ffffff,\"dcim.device,dcim.site\"'",
            "        )",
            "",
            "        cls.bulk_edit_data = {",
            "            \"color\": \"000000\",",
            "        }",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = Status.objects.first().name",
            "",
            "",
            "class TagTestCase(ViewTestCases.OrganizationalObjectViewTestCase):",
            "    model = Tag",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        cls.form_data = {",
            "            \"name\": \"Tag X\",",
            "            \"slug\": \"tag-x\",",
            "            \"color\": \"c0c0c0\",",
            "            \"comments\": \"Some comments\",",
            "            \"content_types\": [ct.id for ct in TaggableClassesQuery().as_queryset()],",
            "        }",
            "",
            "        cls.csv_data = (",
            "            \"name,slug,color,description\",",
            "            \"Tag 4,tag-4,ff0000,Fourth tag\",",
            "            \"Tag 5,tag-5,00ff00,Fifth tag\",",
            "            \"Tag 6,tag-6,0000ff,Sixth tag\",",
            "        )",
            "",
            "        cls.bulk_edit_data = {",
            "            \"color\": \"00ff00\",",
            "        }",
            "",
            "    def test_create_tags_with_content_types(self):",
            "        self.add_permissions(\"extras.add_tag\")",
            "        site_content_type = ContentType.objects.get_for_model(Site)",
            "",
            "        form_data = {",
            "            **self.form_data,",
            "            \"content_types\": [site_content_type.id],",
            "        }",
            "",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(form_data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 302)",
            "",
            "        tag = Tag.objects.filter(slug=self.form_data[\"slug\"])",
            "        self.assertTrue(tag.exists())",
            "        self.assertEqual(tag[0].content_types.first(), site_content_type)",
            "",
            "    def test_create_tags_with_invalid_content_types(self):",
            "        self.add_permissions(\"extras.add_tag\")",
            "        vlangroup_content_type = ContentType.objects.get_for_model(VLANGroup)",
            "",
            "        form_data = {",
            "            **self.form_data,",
            "            \"content_types\": [vlangroup_content_type.id],",
            "        }",
            "",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(form_data),",
            "        }",
            "",
            "        response = self.client.post(**request)",
            "        tag = Tag.objects.filter(slug=self.form_data[\"slug\"])",
            "        self.assertFalse(tag.exists())",
            "        self.assertIn(\"content_types: Select a valid choice\", str(response.content))",
            "",
            "    def test_update_tags_remove_content_type(self):",
            "        \"\"\"Test removing a tag content_type that is been tagged to a model\"\"\"",
            "        self.add_permissions(\"extras.change_tag\")",
            "",
            "        tag_1 = Tag.objects.get_for_model(Site).first()",
            "        site = Site.objects.first()",
            "        site.tags.add(tag_1)",
            "",
            "        form_data = {",
            "            \"name\": tag_1.name,",
            "            \"slug\": tag_1.slug,",
            "            \"color\": \"c0c0c0\",",
            "            \"content_types\": [ContentType.objects.get_for_model(Device).id],",
            "        }",
            "",
            "        request = {",
            "            \"path\": self._get_url(\"edit\", tag_1),",
            "            \"data\": post_data(form_data),",
            "        }",
            "",
            "        response = self.client.post(**request)",
            "        self.assertHttpStatus(",
            "            response, 200, [\"content_types: Unable to remove dcim.site. Dependent objects were found.\"]",
            "        )",
            "",
            "",
            "class WebhookTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = Webhook",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        webhooks = (",
            "            Webhook(",
            "                name=\"webhook-1\",",
            "                enabled=True,",
            "                type_create=True,",
            "                payload_url=\"http://test-url.com/test-1\",",
            "                http_content_type=HTTP_CONTENT_TYPE_JSON,",
            "            ),",
            "            Webhook(",
            "                name=\"webhook-2\",",
            "                enabled=True,",
            "                type_update=True,",
            "                payload_url=\"http://test-url.com/test-2\",",
            "                http_content_type=HTTP_CONTENT_TYPE_JSON,",
            "            ),",
            "            Webhook(",
            "                name=\"webhook-3\",",
            "                enabled=True,",
            "                type_delete=True,",
            "                payload_url=\"http://test-url.com/test-3\",",
            "                http_content_type=HTTP_CONTENT_TYPE_JSON,",
            "            ),",
            "        )",
            "",
            "        obj_type = ContentType.objects.get_for_model(ConsolePort)",
            "",
            "        for webhook in webhooks:",
            "            webhook.save()",
            "            webhook.content_types.set([obj_type])",
            "",
            "        cls.form_data = {",
            "            \"name\": \"webhook-4\",",
            "            \"content_types\": [obj_type.pk],",
            "            \"enabled\": True,",
            "            \"type_create\": True,",
            "            \"payload_url\": \"http://test-url.com/test-4\",",
            "            \"http_method\": \"POST\",",
            "            \"http_content_type\": \"application/json\",",
            "        }"
        ],
        "afterPatchFile": [
            "from datetime import datetime, timedelta",
            "import urllib.parse",
            "import uuid",
            "",
            "from django.contrib.auth import get_user_model",
            "from django.contrib.contenttypes.models import ContentType",
            "from django.core.exceptions import ValidationError",
            "from django.test import override_settings",
            "from django.urls import reverse",
            "from django.utils import timezone",
            "from django.utils.html import format_html",
            "from unittest import mock",
            "",
            "from nautobot.dcim.models import (",
            "    ConsolePort,",
            "    Device,",
            "    DeviceRole,",
            "    DeviceType,",
            "    Interface,",
            "    LocationType,",
            "    Manufacturer,",
            "    Site,",
            ")",
            "from nautobot.dcim.tests import test_views",
            "from nautobot.extras.choices import (",
            "    CustomFieldTypeChoices,",
            "    JobExecutionType,",
            "    JobSourceChoices,",
            "    ObjectChangeActionChoices,",
            "    SecretsGroupAccessTypeChoices,",
            "    SecretsGroupSecretTypeChoices,",
            ")",
            "from nautobot.extras.constants import HTTP_CONTENT_TYPE_JSON",
            "from nautobot.extras.models import (",
            "    ComputedField,",
            "    ConfigContext,",
            "    ConfigContextSchema,",
            "    CustomField,",
            "    CustomLink,",
            "    DynamicGroup,",
            "    ExportTemplate,",
            "    GitRepository,",
            "    GraphQLQuery,",
            "    Job,",
            "    JobButton,",
            "    JobResult,",
            "    Note,",
            "    ObjectChange,",
            "    Relationship,",
            "    RelationshipAssociation,",
            "    ScheduledJob,",
            "    Secret,",
            "    SecretsGroup,",
            "    SecretsGroupAssociation,",
            "    Status,",
            "    Tag,",
            "    Webhook,",
            ")",
            "from nautobot.extras.templatetags.job_buttons import NO_CONFIRM_BUTTON",
            "from nautobot.extras.tests.constants import BIG_GRAPHQL_DEVICE_QUERY",
            "from nautobot.extras.tests.test_relationships import RequiredRelationshipTestMixin",
            "from nautobot.extras.utils import get_job_content_type, TaggableClassesQuery",
            "from nautobot.ipam.factory import VLANFactory",
            "from nautobot.ipam.models import VLAN, VLANGroup",
            "from nautobot.users.models import ObjectPermission",
            "from nautobot.utilities.testing import ViewTestCases, TestCase, extract_page_body, extract_form_failures",
            "from nautobot.utilities.testing.utils import disable_warnings, post_data",
            "from nautobot.utilities.utils import slugify_dashes_to_underscores",
            "",
            "",
            "# Use the proper swappable User model",
            "User = get_user_model()",
            "",
            "",
            "class ComputedFieldTestCase(",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = ComputedField",
            "    slug_source = \"label\"",
            "    slugify_function = staticmethod(slugify_dashes_to_underscores)",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = ContentType.objects.get_for_model(Site)",
            "",
            "        computed_fields = (",
            "            ComputedField(",
            "                content_type=obj_type,",
            "                label=\"Computed Field One\",",
            "                slug=\"computed_field_one\",",
            "                template=\"Site name is {{ obj.name }}\",",
            "                fallback_value=\"Template error\",",
            "                weight=100,",
            "            ),",
            "            ComputedField(",
            "                content_type=obj_type,",
            "                slug=\"computed_field_two\",",
            "                label=\"Computed Field Two\",",
            "                template=\"Site name is {{ obj.name }}\",",
            "                fallback_value=\"Template error\",",
            "                weight=100,",
            "            ),",
            "            ComputedField(",
            "                content_type=obj_type,",
            "                slug=\"computed_field_three\",",
            "                label=\"Computed Field Three\",",
            "                template=\"Site name is {{ obj.name }}\",",
            "                weight=100,",
            "            ),",
            "            ComputedField(",
            "                content_type=obj_type,",
            "                label=\"Computed Field Five\",",
            "                template=\"Site name is {{ obj.name }}\",",
            "                fallback_value=\"Template error\",",
            "                weight=100,",
            "            ),",
            "        )",
            "",
            "        cls.site1 = Site(name=\"NYC\")",
            "        cls.site1.save()",
            "",
            "        for cf in computed_fields:",
            "            cf.save()",
            "",
            "        cls.form_data = {",
            "            \"content_type\": obj_type.pk,",
            "            \"slug\": \"computed_field_four\",",
            "            \"label\": \"Computed Field Four\",",
            "            \"template\": \"{{ obj.name }} is the best Site!\",",
            "            \"fallback_value\": \":skull_emoji:\",",
            "            \"weight\": 100,",
            "        }",
            "",
            "        cls.slug_test_object = \"Computed Field Five\"",
            "",
            "",
            "class ComputedFieldRenderingTestCase(TestCase):",
            "    \"\"\"Tests for the inclusion of ComputedFields, distinct from tests of the ComputedField views themselves.\"\"\"",
            "",
            "    user_permissions = [\"dcim.view_locationtype\"]",
            "",
            "    def setUp(self):",
            "        super().setUp()",
            "        self.computedfield = ComputedField(",
            "            content_type=ContentType.objects.get_for_model(LocationType),",
            "            slug=\"test\",",
            "            label=\"Computed Field\",",
            "            template=\"FOO {{ obj.name }} BAR\",",
            "            fallback_value=\"Fallback Value\",",
            "            weight=100,",
            "        )",
            "        self.computedfield.validated_save()",
            "        self.location_type = LocationType.objects.get(name=\"Campus\")",
            "",
            "    def test_view_object_with_computed_field(self):",
            "        \"\"\"Ensure that the computed field template is rendered.\"\"\"",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(f\"FOO {self.location_type.name} BAR\", content, content)",
            "",
            "    def test_view_object_with_computed_field_fallback_value(self):",
            "        \"\"\"Ensure that the fallback_value is rendered if the template fails to render.\"\"\"",
            "        # Make the template invalid to demonstrate the fallback value",
            "        self.computedfield.template = \"FOO {{ obj.\"",
            "        self.computedfield.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"Fallback Value\", content, content)",
            "",
            "    def test_view_object_with_computed_field_unsafe_template(self):",
            "        \"\"\"Ensure that computed field templates can't be used as an XSS vector.\"\"\"",
            "        self.computedfield.template = '<script>alert(\"Hello world!\"</script>'",
            "        self.computedfield.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "    def test_view_object_with_computed_field_unsafe_fallback_value(self):",
            "        \"\"\"Ensure that computed field fallback values can't be used as an XSS vector.\"\"\"",
            "        self.computedfield.template = \"FOO {{ obj.\"",
            "        self.computedfield.fallback_value = '<script>alert(\"Hello world!\"</script>'",
            "        self.computedfield.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "",
            "# TODO: Change base class to PrimaryObjectViewTestCase",
            "# Blocked by absence of standard create/edit, bulk create views",
            "class ConfigContextTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkEditObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = ConfigContext",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        site = Site.objects.first()",
            "",
            "        # Create three ConfigContexts",
            "        for i in range(1, 4):",
            "            configcontext = ConfigContext(name=f\"Config Context {i}\", data={\"foo\": i})",
            "            configcontext.save()",
            "            configcontext.sites.add(site)",
            "",
            "        cls.form_data = {",
            "            \"name\": \"Config Context X\",",
            "            \"weight\": 200,",
            "            \"description\": \"A new config context\",",
            "            \"is_active\": True,",
            "            \"regions\": [],",
            "            \"sites\": [site.pk],",
            "            \"roles\": [],",
            "            \"device_types\": [],",
            "            \"platforms\": [],",
            "            \"tenant_groups\": [],",
            "            \"tenants\": [],",
            "            \"tags\": [],",
            "            \"data\": '{\"foo\": 123}',",
            "        }",
            "",
            "        cls.bulk_edit_data = {",
            "            \"weight\": 300,",
            "            \"is_active\": False,",
            "            \"description\": \"New description\",",
            "        }",
            "",
            "    def test_schema_validation_pass(self):",
            "        \"\"\"",
            "        Given a config context schema",
            "        And a config context that conforms to that schema",
            "        Assert that the config context passes schema validation via full_clean()",
            "        \"\"\"",
            "        schema = ConfigContextSchema.objects.create(",
            "            name=\"Schema 1\", slug=\"schema-1\", data_schema={\"type\": \"object\", \"properties\": {\"foo\": {\"type\": \"string\"}}}",
            "        )",
            "        self.add_permissions(\"extras.add_configcontext\")",
            "        self.add_permissions(\"extras.view_configcontextschema\")",
            "",
            "        form_data = {",
            "            \"name\": \"Config Context with schema\",",
            "            \"weight\": 200,",
            "            \"description\": \"A new config context\",",
            "            \"is_active\": True,",
            "            \"regions\": [],",
            "            \"sites\": [],",
            "            \"roles\": [],",
            "            \"device_types\": [],",
            "            \"platforms\": [],",
            "            \"tenant_groups\": [],",
            "            \"tenants\": [],",
            "            \"tags\": [],",
            "            \"data\": '{\"foo\": \"bar\"}',",
            "            \"schema\": schema.pk,",
            "        }",
            "",
            "        # Try POST with model-level permission",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(form_data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 302)",
            "        self.assertEqual(self._get_queryset().get(name=\"Config Context with schema\").schema.pk, schema.pk)",
            "",
            "    def test_schema_validation_fails(self):",
            "        \"\"\"",
            "        Given a config context schema",
            "        And a config context that *does not* conform to that schema",
            "        Assert that the config context fails schema validation via full_clean()",
            "        \"\"\"",
            "        schema = ConfigContextSchema.objects.create(",
            "            name=\"Schema 1\", slug=\"schema-1\", data_schema={\"type\": \"object\", \"properties\": {\"foo\": {\"type\": \"integer\"}}}",
            "        )",
            "        self.add_permissions(\"extras.add_configcontext\")",
            "        self.add_permissions(\"extras.view_configcontextschema\")",
            "",
            "        form_data = {",
            "            \"name\": \"Config Context with bad schema\",",
            "            \"weight\": 200,",
            "            \"description\": \"A new config context\",",
            "            \"is_active\": True,",
            "            \"regions\": [],",
            "            \"sites\": [],",
            "            \"roles\": [],",
            "            \"device_types\": [],",
            "            \"platforms\": [],",
            "            \"tenant_groups\": [],",
            "            \"tenants\": [],",
            "            \"tags\": [],",
            "            \"data\": '{\"foo\": \"bar\"}',",
            "            \"schema\": schema.pk,",
            "        }",
            "",
            "        # Try POST with model-level permission",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(form_data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 200)",
            "        self.assertEqual(self._get_queryset().filter(name=\"Config Context with schema\").count(), 0)",
            "",
            "",
            "# This OrganizationalObjectViewTestCase less BulkImportObjectsViewTestCase",
            "# because it doesn't make sense to support CSV for schemas.",
            "class ConfigContextSchemaTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.BulkEditObjectsViewTestCase,",
            "):",
            "    model = ConfigContextSchema",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        # Create three ConfigContextSchema records",
            "        ConfigContextSchema.objects.create(",
            "            name=\"Schema 1\", slug=\"schema-1\", data_schema={\"type\": \"object\", \"properties\": {\"foo\": {\"type\": \"string\"}}}",
            "        )",
            "        ConfigContextSchema.objects.create(",
            "            name=\"Schema 2\", slug=\"schema-2\", data_schema={\"type\": \"object\", \"properties\": {\"bar\": {\"type\": \"string\"}}}",
            "        )",
            "        ConfigContextSchema.objects.create(",
            "            name=\"Schema 3\", slug=\"schema-3\", data_schema={\"type\": \"object\", \"properties\": {\"baz\": {\"type\": \"string\"}}}",
            "        )",
            "        ConfigContextSchema.objects.create(",
            "            name=\"Schema 4\", data_schema={\"type\": \"object\", \"properties\": {\"baz\": {\"type\": \"string\"}}}",
            "        )",
            "",
            "        cls.form_data = {",
            "            \"name\": \"Schema X\",",
            "            \"slug\": \"schema-x\",",
            "            \"data_schema\": '{\"type\": \"object\",\"properties\": {\"baz\": {\"type\": \"string\"}}}',  # Intentionally misformatted (missing space) to ensure proper formatting on output",
            "        }",
            "",
            "        cls.bulk_edit_data = {",
            "            \"description\": \"New description\",",
            "        }",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"Schema 4\"",
            "",
            "",
            "class CustomLinkTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = CustomLink",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = ContentType.objects.get_for_model(Site)",
            "",
            "        customlinks = (",
            "            CustomLink(",
            "                content_type=obj_type,",
            "                name=\"customlink-1\",",
            "                text=\"customlink text 1\",",
            "                target_url=\"http://customlink1.com\",",
            "                weight=100,",
            "                button_class=\"default\",",
            "                new_window=False,",
            "            ),",
            "            CustomLink(",
            "                content_type=obj_type,",
            "                name=\"customlink-2\",",
            "                text=\"customlink text 2\",",
            "                target_url=\"http://customlink2.com\",",
            "                weight=100,",
            "                button_class=\"default\",",
            "                new_window=False,",
            "            ),",
            "            CustomLink(",
            "                content_type=obj_type,",
            "                name=\"customlink-3\",",
            "                text=\"customlink text 3\",",
            "                target_url=\"http://customlink3.com\",",
            "                weight=100,",
            "                button_class=\"default\",",
            "                new_window=False,",
            "            ),",
            "        )",
            "",
            "        for link in customlinks:",
            "            link.save()",
            "",
            "        cls.form_data = {",
            "            \"content_type\": obj_type.pk,",
            "            \"name\": \"customlink-4\",",
            "            \"text\": \"customlink text 4\",",
            "            \"target_url\": \"http://customlink4.com\",",
            "            \"weight\": 100,",
            "            \"button_class\": \"default\",",
            "            \"new_window\": False,",
            "        }",
            "",
            "",
            "class CustomFieldTestCase(",
            "    # No NotesViewTestCase or BulkImportObjectsViewTestCase, at least for now",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = CustomField",
            "    slug_source = \"label\"",
            "    slugify_function = staticmethod(slugify_dashes_to_underscores)",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = ContentType.objects.get_for_model(Site)",
            "",
            "        custom_fields = [",
            "            CustomField(",
            "                type=CustomFieldTypeChoices.TYPE_BOOLEAN,",
            "                name=\"Custom Field Boolean\",",
            "                label=\"Custom Field Boolean\",",
            "                default=\"\",",
            "            ),",
            "            CustomField(",
            "                type=CustomFieldTypeChoices.TYPE_TEXT,",
            "                name=\"Custom Field Text\",",
            "                label=\"Custom Field Text\",",
            "                default=\"\",",
            "            ),",
            "            CustomField(",
            "                type=CustomFieldTypeChoices.TYPE_INTEGER,",
            "                name=\"Custom Field Integer\",",
            "                label=\"Custom Field Integer\",",
            "                default=\"\",",
            "            ),",
            "            CustomField(",
            "                type=CustomFieldTypeChoices.TYPE_TEXT,",
            "                # https://github.com/nautobot/nautobot/issues/1962",
            "                name=\"Custom field? With special / unusual characters!\",",
            "                default=\"\",",
            "            ),",
            "        ]",
            "",
            "        cls.slug_test_object = \"Custom Field Integer\"",
            "",
            "        for custom_field in custom_fields:",
            "            custom_field.validated_save()",
            "            custom_field.content_types.set([obj_type])",
            "",
            "        cls.form_data = {",
            "            \"content_types\": [obj_type.pk],",
            "            \"type\": CustomFieldTypeChoices.TYPE_BOOLEAN,  # type is mandatory but cannot be changed once set.",
            "            \"slug\": \"custom_field_boolean\",  # slug is mandatory but cannot be changed once set.",
            "            \"label\": \"Custom Field Boolean\",",
            "            \"default\": None,",
            "            \"filter_logic\": \"loose\",",
            "            \"weight\": 100,",
            "            # These are the \"management_form\" fields required by the dynamic CustomFieldChoice formsets.",
            "            \"choices-TOTAL_FORMS\": \"0\",  # Set to 0 so validation succeeds until we need it",
            "            \"choices-INITIAL_FORMS\": \"1\",",
            "            \"choices-MIN_NUM_FORMS\": \"0\",",
            "            \"choices-MAX_NUM_FORMS\": \"1000\",",
            "        }",
            "",
            "    def test_create_object_without_permission(self):",
            "        # Can't have two CustomFields with the same \"slug\"",
            "        self.form_data = self.form_data.copy()",
            "        self.form_data[\"slug\"] = \"custom_field_boolean_2\"",
            "        super().test_create_object_without_permission()",
            "",
            "    def test_create_object_with_permission(self):",
            "        # Can't have two CustomFields with the same \"slug\"",
            "        self.form_data = self.form_data.copy()",
            "        self.form_data[\"slug\"] = \"custom_field_boolean_2\"",
            "        super().test_create_object_with_permission()",
            "        instance = self._get_queryset().get(slug=\"custom_field_boolean_2\")",
            "        # 2.0 TODO: #824 removal of `name` field altogether",
            "        # Assure that `name` was auto-populated from the given slug",
            "        self.assertEqual(instance.name, instance.slug)",
            "",
            "    def test_create_object_with_constrained_permission(self):",
            "        # Can't have two CustomFields with the same \"slug\"",
            "        self.form_data = self.form_data.copy()",
            "        self.form_data[\"slug\"] = \"custom_field_boolean_2\"",
            "        super().test_create_object_with_constrained_permission()",
            "",
            "",
            "class CustomLinkRenderingTestCase(TestCase):",
            "    \"\"\"Tests for the inclusion of CustomLinks, distinct from tests of the CustomLink views themselves.\"\"\"",
            "",
            "    user_permissions = [\"dcim.view_site\"]",
            "",
            "    def test_view_object_with_custom_link(self):",
            "        customlink = CustomLink(",
            "            content_type=ContentType.objects.get_for_model(Site),",
            "            name=\"Test\",",
            "            text=\"FOO {{ obj.name }} BAR\",",
            "            target_url=\"http://example.com/?site={{ obj.slug }}\",",
            "            new_window=False,",
            "        )",
            "        customlink.save()",
            "",
            "        site = Site(name=\"Test Site\", slug=\"test-site\")",
            "        site.save()",
            "",
            "        response = self.client.get(site.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(f\"FOO {site.name} BAR\", content, content)",
            "",
            "    def test_view_object_with_unsafe_custom_link_text(self):",
            "        \"\"\"Ensure that custom links can't be used as a vector for injecting scripts or breaking HTML.\"\"\"",
            "        customlink = CustomLink(",
            "            content_type=ContentType.objects.get_for_model(Site),",
            "            name=\"Test\",",
            "            text='<script>alert(\"Hello world!\")</script>',",
            "            target_url=\"http://example.com/?location=None\",",
            "            new_window=False,",
            "        )",
            "        customlink.validated_save()",
            "        site = Site(name=\"Test Site\", slug=\"test-site\")",
            "        site.save()",
            "",
            "        response = self.client.get(site.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "        self.assertIn(format_html('<a href=\"{}\"', customlink.target_url), content, content)",
            "",
            "    def test_view_object_with_unsafe_custom_link_url(self):",
            "        \"\"\"Ensure that custom links can't be used as a vector for injecting scripts or breaking HTML.\"\"\"",
            "        customlink = CustomLink(",
            "            content_type=ContentType.objects.get_for_model(Site),",
            "            name=\"Test\",",
            "            text=\"Hello\",",
            "            target_url='\"><script>alert(\"Hello world!\")</script><a href=\"',",
            "            new_window=False,",
            "        )",
            "        customlink.validated_save()",
            "        site = Site(name=\"Test Site\", slug=\"test-site\")",
            "        site.save()",
            "",
            "        response = self.client.get(site.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "        self.assertIn(format_html('<a href=\"{}\"', customlink.target_url), content, content)",
            "",
            "    def test_view_object_with_unsafe_custom_link_name(self):",
            "        \"\"\"Ensure that custom links can't be used as a vector for injecting scripts or breaking HTML.\"\"\"",
            "        customlink = CustomLink(",
            "            content_type=ContentType.objects.get_for_model(Site),",
            "            name='<script>alert(\"Hello World\")</script>',",
            "            text=\"Hello\",",
            "            target_url=\"http://example.com/?site={{ obj.name \",  # intentionally bad jinja2 to trigger error case",
            "            new_window=False,",
            "        )",
            "        customlink.validated_save()",
            "        site = Site(name=\"Test Site\", slug=\"test-site\")",
            "        site.save()",
            "",
            "        response = self.client.get(site.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "",
            "class DynamicGroupTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    # NOTE: This isn't using `ViewTestCases.PrimaryObjectViewTestCase` because bulk-import/edit",
            "    # views for DynamicGroup do not make sense at this time, primarily because `content_type` is",
            "    # immutable after create.",
            "):",
            "    model = DynamicGroup",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        content_type = ContentType.objects.get_for_model(Device)",
            "",
            "        # DynamicGroup objects to test.",
            "        DynamicGroup.objects.create(name=\"DG 1\", slug=\"dg-1\", content_type=content_type)",
            "        DynamicGroup.objects.create(name=\"DG 2\", slug=\"dg-2\", content_type=content_type)",
            "        DynamicGroup.objects.create(name=\"DG 3\", slug=\"dg-3\", content_type=content_type)",
            "",
            "        cls.form_data = {",
            "            \"name\": \"new_dynamic_group\",",
            "            \"slug\": \"new-dynamic-group\",",
            "            \"description\": \"I am a new dynamic group object.\",",
            "            \"content_type\": content_type.pk,",
            "            # Management form fields required for the dynamic formset",
            "            \"dynamic_group_memberships-TOTAL_FORMS\": \"0\",",
            "            \"dynamic_group_memberships-INITIAL_FORMS\": \"1\",",
            "            \"dynamic_group_memberships-MIN_NUM_FORMS\": \"0\",",
            "            \"dynamic_group_memberships-MAX_NUM_FORMS\": \"1000\",",
            "        }",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_edit_saved_filter(self):",
            "        \"\"\"Test that editing a filter works using the edit view.\"\"\"",
            "        self.add_permissions(\"extras.add_dynamicgroup\", \"extras.change_dynamicgroup\")",
            "",
            "        # Create the object first.",
            "        data = self.form_data.copy()",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 302)",
            "",
            "        # Now update it.",
            "        instance = self._get_queryset().get(name=data[\"name\"])",
            "        data[\"filter-serial\"] = \"abc123\"",
            "        request = {",
            "            \"path\": self._get_url(\"edit\", instance),",
            "            \"data\": post_data(data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 302)",
            "",
            "        instance.refresh_from_db()",
            "        self.assertEqual(instance.filter, {\"serial\": data[\"filter-serial\"]})",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_filter_by_content_type(self):",
            "        \"\"\"",
            "        Test that filtering by `content_type` in the UI succeeds.",
            "",
            "        This is a regression test for https://github.com/nautobot/nautobot/issues/3612",
            "        \"\"\"",
            "        path = self._get_url(\"list\")",
            "        response = self.client.get(path + \"?content_type=dcim.device\")",
            "        self.assertHttpStatus(response, 200)",
            "",
            "",
            "class ExportTemplateTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = ExportTemplate",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = ContentType.objects.get_for_model(Site)",
            "",
            "        templates = (",
            "            ExportTemplate(",
            "                name=\"template-1\",",
            "                template_code=\"template-1 test1\",",
            "                content_type=obj_type,",
            "            ),",
            "            ExportTemplate(",
            "                name=\"template-2\",",
            "                template_code=\"template-2 test2\",",
            "                content_type=obj_type,",
            "            ),",
            "            ExportTemplate(",
            "                name=\"template-3\",",
            "                template_code=\"template-3 test3\",",
            "                content_type=obj_type,",
            "            ),",
            "        )",
            "",
            "        for template in templates:",
            "            template.save()",
            "",
            "        cls.form_data = {",
            "            \"name\": \"template-4\",",
            "            \"content_type\": obj_type.pk,",
            "            \"template_code\": \"template-4 test4\",",
            "        }",
            "",
            "",
            "class GitRepositoryTestCase(",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.BulkImportObjectsViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = GitRepository",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        secrets_groups = (",
            "            SecretsGroup.objects.create(name=\"Secrets Group 1\", slug=\"secrets-group-1\"),",
            "            SecretsGroup.objects.create(name=\"Secrets Group 2\", slug=\"secrets-group-2\"),",
            "        )",
            "",
            "        # Create four GitRepository records",
            "        repos = (",
            "            GitRepository(name=\"Repo 1\", slug=\"repo-1\", remote_url=\"https://example.com/repo1.git\"),",
            "            GitRepository(name=\"Repo 2\", slug=\"repo-2\", remote_url=\"https://example.com/repo2.git\"),",
            "            GitRepository(name=\"Repo 3\", slug=\"repo-3\", remote_url=\"https://example.com/repo3.git\"),",
            "            GitRepository(name=\"Repo 4\", remote_url=\"https://example.com/repo4.git\", secrets_group=secrets_groups[0]),",
            "        )",
            "        for repo in repos:",
            "            repo.save(trigger_resync=False)",
            "",
            "        cls.form_data = {",
            "            \"name\": \"A new Git repository\",",
            "            \"slug\": \"a-new-git-repository\",",
            "            \"remote_url\": \"http://example.com/a_new_git_repository.git\",",
            "            \"branch\": \"develop\",",
            "            \"_token\": \"1234567890abcdef1234567890abcdef\",",
            "            \"secrets_group\": secrets_groups[1].pk,",
            "            \"provided_contents\": [",
            "                \"extras.configcontext\",",
            "                \"extras.job\",",
            "                \"extras.exporttemplate\",",
            "            ],",
            "        }",
            "",
            "        cls.csv_data = (",
            "            \"name,slug,remote_url,branch,secrets_group,provided_contents\",",
            "            \"Git Repository 5,git-repo-5,https://example.com,main,,extras.configcontext\",",
            "            \"Git Repository 6,git-repo-6,https://example.com,develop,Secrets Group 2,\",",
            "            'Git Repository 7,git-repo-7,https://example.com,next,Secrets Group 2,\"extras.job,extras.exporttemplate\"',",
            "        )",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"Repo 4\"",
            "",
            "",
            "class NoteTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "):",
            "    model = Note",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        content_type = ContentType.objects.get_for_model(Site)",
            "        cls.site = Site.objects.first()",
            "        user = User.objects.first()",
            "",
            "        # Notes Objects to test",
            "        Note.objects.create(",
            "            note=\"Site has been placed on maintenance.\",",
            "            user=user,",
            "            assigned_object_type=content_type,",
            "            assigned_object_id=cls.site.pk,",
            "        )",
            "        Note.objects.create(",
            "            note=\"Site maintenance has ended.\",",
            "            user=user,",
            "            assigned_object_type=content_type,",
            "            assigned_object_id=cls.site.pk,",
            "        )",
            "        Note.objects.create(",
            "            note=\"Site is under duress.\",",
            "            user=user,",
            "            assigned_object_type=content_type,",
            "            assigned_object_id=cls.site.pk,",
            "        )",
            "",
            "        cls.form_data = {",
            "            \"note\": \"This is Site note.\",",
            "            \"assigned_object_type\": content_type.pk,",
            "            \"assigned_object_id\": cls.site.pk,",
            "        }",
            "        cls.expected_object_note = '<textarea name=\"object_note\" cols=\"40\" rows=\"10\" class=\"form-control\" placeholder=\"Note\" id=\"id_object_note\"></textarea>'",
            "",
            "    def test_note_on_bulk_update_perms(self):",
            "        self.add_permissions(\"dcim.add_site\", \"extras.add_note\")",
            "        response = self.client.get(reverse(\"dcim:site_add\"))",
            "        self.assertContains(response, self.expected_object_note, html=True)",
            "",
            "    def test_note_on_bulk_update_no_perms(self):",
            "        self.add_permissions(\"dcim.add_site\")",
            "        response = self.client.get(reverse(\"dcim:site_add\"))",
            "        self.assertNotContains(response, self.expected_object_note, html=True)",
            "",
            "    def test_note_on_create_edit_perms(self):",
            "        self.add_permissions(\"dcim.change_site\", \"extras.add_note\")",
            "        response = self.client.post(reverse(\"dcim:site_bulk_edit\"), data={\"pk\": self.site.pk})",
            "        self.assertContains(response, self.expected_object_note, html=True)",
            "",
            "    def test_note_on_create_edit_no_perms(self):",
            "        self.add_permissions(\"dcim.change_site\")",
            "        response = self.client.post(reverse(\"dcim:site_bulk_edit\"), data={\"pk\": self.site.pk})",
            "        self.assertNotContains(response, self.expected_object_note, html=True)",
            "",
            "",
            "# Not a full-fledged PrimaryObjectViewTestCase as there's no BulkEditView for Secrets",
            "class SecretTestCase(",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkImportObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = Secret",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        secrets = (",
            "            Secret(",
            "                name=\"View Test 1\",",
            "                provider=\"environment-variable\",",
            "                parameters={\"variable\": \"VIEW_TEST_1\"},",
            "                tags=[t.pk for t in Tag.objects.get_for_model(Secret)],",
            "            ),",
            "            Secret(",
            "                name=\"View Test 2\",",
            "                provider=\"environment-variable\",",
            "                parameters={\"variable\": \"VIEW_TEST_2\"},",
            "            ),",
            "            Secret(",
            "                name=\"View Test 3\",",
            "                provider=\"environment-variable\",",
            "                parameters={\"variable\": \"VIEW_TEST_3\"},",
            "            ),",
            "        )",
            "",
            "        for secret in secrets:",
            "            secret.validated_save()",
            "",
            "        cls.form_data = {",
            "            \"name\": \"View Test 4\",",
            "            \"slug\": \"view-test-4\",",
            "            \"provider\": \"environment-variable\",",
            "            \"parameters\": '{\"variable\": \"VIEW_TEST_4\"}',",
            "        }",
            "",
            "        cls.csv_data = (",
            "            \"name,slug,provider,parameters\",",
            "            'View Test 5,view-test-5,environment-variable,{\"variable\": \"VIEW_TEST_5\"}',",
            "            'View Test 6,,environment-variable,{\"variable\": \"VIEW_TEST_6\"}',",
            "            'View Test 7,,environment-variable,{\"variable\": \"VIEW_TEST_7\"}',",
            "        )",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"View Test 3\"",
            "",
            "",
            "# Not a full-fledged OrganizationalObjectViewTestCase as there's no BulkImportView for SecretsGroups",
            "class SecretsGroupTestCase(",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = SecretsGroup",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        secrets_groups = (",
            "            SecretsGroup.objects.create(name=\"Group 1\", slug=\"group-1\", description=\"First Group\"),",
            "            SecretsGroup.objects.create(name=\"Group 2\", slug=\"group-2\"),",
            "            SecretsGroup.objects.create(name=\"Group 3\", slug=\"group-3\"),",
            "        )",
            "",
            "        secrets = (",
            "            Secret.objects.create(name=\"secret 1\", slug=\"secret-1\", provider=\"text-file\", parameters={\"path\": \"/tmp\"}),",
            "            Secret.objects.create(name=\"secret 2\", slug=\"secret-2\", provider=\"text-file\", parameters={\"path\": \"/tmp\"}),",
            "            Secret.objects.create(name=\"secret 3\", slug=\"secret-3\", provider=\"text-file\", parameters={\"path\": \"/tmp\"}),",
            "        )",
            "",
            "        SecretsGroupAssociation.objects.create(",
            "            group=secrets_groups[0],",
            "            secret=secrets[0],",
            "            access_type=SecretsGroupAccessTypeChoices.TYPE_GENERIC,",
            "            secret_type=SecretsGroupSecretTypeChoices.TYPE_USERNAME,",
            "        )",
            "        SecretsGroupAssociation.objects.create(",
            "            group=secrets_groups[0],",
            "            secret=secrets[1],",
            "            access_type=SecretsGroupAccessTypeChoices.TYPE_GENERIC,",
            "            secret_type=SecretsGroupSecretTypeChoices.TYPE_PASSWORD,",
            "        )",
            "        SecretsGroupAssociation.objects.create(",
            "            group=secrets_groups[1],",
            "            secret=secrets[1],",
            "            access_type=SecretsGroupAccessTypeChoices.TYPE_GENERIC,",
            "            secret_type=SecretsGroupSecretTypeChoices.TYPE_PASSWORD,",
            "        )",
            "",
            "        cls.form_data = {",
            "            \"name\": \"Group 4\",",
            "            \"slug\": \"group-4\",",
            "            \"description\": \"Some description\",",
            "            # Management form fields required for the dynamic Secret formset",
            "            \"secretsgroupassociation_set-TOTAL_FORMS\": \"0\",",
            "            \"secretsgroupassociation_set-INITIAL_FORMS\": \"1\",",
            "            \"secretsgroupassociation_set-MIN_NUM_FORMS\": \"0\",",
            "            \"secretsgroupassociation_set-MAX_NUM_FORMS\": \"1000\",",
            "        }",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"Group 3\"",
            "",
            "",
            "class GraphQLQueriesTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = GraphQLQuery",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        graphqlqueries = (",
            "            GraphQLQuery(",
            "                name=\"graphql-query-1\",",
            "                slug=\"graphql-query-1\",",
            "                query=\"{ query: sites {name} }\",",
            "            ),",
            "            GraphQLQuery(",
            "                name=\"graphql-query-2\",",
            "                slug=\"graphql-query-2\",",
            "                query='{ devices(role: \"edge\") { id, name, device_role { name slug } } }',",
            "            ),",
            "            GraphQLQuery(",
            "                name=\"graphql-query-3\",",
            "                slug=\"graphql-query-3\",",
            "                query=BIG_GRAPHQL_DEVICE_QUERY,",
            "            ),",
            "            GraphQLQuery(",
            "                name=\"Graphql Query 5\",",
            "                query='{ devices(role: \"edge\") { id, name, device_role { name slug } } }',",
            "            ),",
            "        )",
            "",
            "        for query in graphqlqueries:",
            "            query.full_clean()",
            "            query.save()",
            "",
            "        cls.form_data = {",
            "            \"name\": \"graphql-query-4\",",
            "            \"slug\": \"graphql-query-4\",",
            "            \"query\": \"{query: sites {name}}\",",
            "        }",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = \"Graphql Query 5\"",
            "",
            "",
            "#",
            "# Jobs, Scheduling, and Approvals",
            "#",
            "",
            "",
            "class ScheduledJobTestCase(",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = ScheduledJob",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        user = User.objects.create(username=\"user1\", is_active=True)",
            "        ScheduledJob.objects.create(",
            "            name=\"test1\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=user,",
            "            start_time=datetime.now(),",
            "        )",
            "        ScheduledJob.objects.create(",
            "            name=\"test2\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=user,",
            "            start_time=datetime.now(),",
            "        )",
            "        ScheduledJob.objects.create(",
            "            name=\"test3\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=user,",
            "            start_time=datetime.now(),",
            "        )",
            "",
            "    def test_only_enabled_is_listed(self):",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        # this should not appear, since it\u2019s not enabled",
            "        ScheduledJob.objects.create(",
            "            enabled=False,",
            "            name=\"test4\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            start_time=datetime.now(),",
            "        )",
            "",
            "        response = self.client.get(self._get_url(\"list\"))",
            "        self.assertHttpStatus(response, 200)",
            "        self.assertNotIn(\"test4\", extract_page_body(response.content.decode(response.charset)))",
            "",
            "    def test_non_valid_crontab_syntax(self):",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        def scheduled_job_factory(name, crontab):",
            "            ScheduledJob.objects.create(",
            "                enabled=True,",
            "                name=name,",
            "                task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "                job_class=\"local/test_pass/TestPass\",",
            "                interval=JobExecutionType.TYPE_CUSTOM,",
            "                user=self.user,",
            "                start_time=timezone.now(),",
            "                crontab=crontab,",
            "            )",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test5\", None)",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test6\", \"\")",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test7\", \"not_enough_values_to_unpack\")",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test8\", \"one too many values to unpack\")",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test9\", \"-1 * * * *\")",
            "",
            "        with self.assertRaises(ValidationError):",
            "            scheduled_job_factory(\"test10\", \"invalid literal * * *\")",
            "",
            "    def test_valid_crontab_syntax(self):",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        ScheduledJob.objects.create(",
            "            enabled=True,",
            "            name=\"test11\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_class=\"local/test_pass/TestPass\",",
            "            interval=JobExecutionType.TYPE_CUSTOM,",
            "            user=self.user,",
            "            start_time=datetime.now(),",
            "            crontab=\"*/15 9,17 3 * 1-5\",",
            "        )",
            "",
            "        response = self.client.get(self._get_url(\"list\"))",
            "        self.assertHttpStatus(response, 200)",
            "        self.assertIn(\"test11\", extract_page_body(response.content.decode(response.charset)))",
            "",
            "",
            "class ApprovalQueueTestCase(",
            "    # It would be nice to use ViewTestCases.GetObjectViewTestCase as well,",
            "    # but we can't directly use it as it uses instance.get_absolute_url() rather than self._get_url(\"view\", instance)",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = ScheduledJob",
            "    # Many interactions with a ScheduledJob also require permissions to view the associated Job",
            "    user_permissions = (\"extras.view_job\",)",
            "",
            "    def _get_url(self, action, instance=None):",
            "        if action == \"list\":",
            "            return reverse(\"extras:scheduledjob_approval_queue_list\")",
            "        if action == \"view\" and instance is not None:",
            "            return reverse(\"extras:scheduledjob_approval_request_view\", kwargs={\"pk\": instance.pk})",
            "        raise ValueError(\"This override is only valid for list and view test cases\")",
            "",
            "    def setUp(self):",
            "        super().setUp()",
            "        self.job_model = Job.objects.get_for_class_path(\"local/test_pass/TestPass\")",
            "        self.job_model_2 = Job.objects.get_for_class_path(\"local/test_fail/TestFail\")",
            "        self.job_model_3 = Job.objects.get_for_class_path(\"local/test_read_only_pass/TestReadOnlyPass\")",
            "",
            "        ScheduledJob.objects.create(",
            "            name=\"test1\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_model=self.job_model,",
            "            job_class=self.job_model.class_path,",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            approval_required=True,",
            "            start_time=datetime.now(),",
            "        )",
            "        ScheduledJob.objects.create(",
            "            name=\"test2\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_model=self.job_model_2,",
            "            job_class=self.job_model_2.class_path,",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            approval_required=True,",
            "            start_time=datetime.now(),",
            "        )",
            "        ScheduledJob.objects.create(",
            "            name=\"test3\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_model=self.job_model_3,",
            "            job_class=self.job_model_3.class_path,",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            approval_required=True,",
            "            start_time=datetime.now(),",
            "        )",
            "",
            "    def test_only_approvable_is_listed(self):",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        ScheduledJob.objects.create(",
            "            name=\"test4\",",
            "            task=\"nautobot.extras.jobs.scheduled_job_handler\",",
            "            job_model=self.job_model,",
            "            job_class=self.job_model.class_path,",
            "            interval=JobExecutionType.TYPE_IMMEDIATELY,",
            "            user=self.user,",
            "            approval_required=False,",
            "            start_time=datetime.now(),",
            "        )",
            "",
            "        response = self.client.get(self._get_url(\"list\"))",
            "        self.assertHttpStatus(response, 200)",
            "        self.assertNotIn(\"test4\", extract_page_body(response.content.decode(response.charset)))",
            "",
            "    #",
            "    # Reimplementations of ViewTestCases.GetObjectViewTestCase test functions.",
            "    # Needed because those use instance.get_absolute_url() instead of self._get_url(\"view\", instance)...",
            "    #",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_get_object_anonymous(self):",
            "        self.client.logout()",
            "        response = self.client.get(self._get_url(\"view\", self._get_queryset().first()))",
            "        self.assertHttpStatus(response, 200)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_object_without_permission(self):",
            "        instance = self._get_queryset().first()",
            "",
            "        with disable_warnings(\"django.request\"):",
            "            self.assertHttpStatus(self.client.get(self._get_url(\"view\", instance)), 403)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_object_with_permission(self):",
            "        instance = self._get_queryset().first()",
            "",
            "        # Add model-level permission",
            "        obj_perm = ObjectPermission(name=\"Test permission\", actions=[\"view\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(self.model))",
            "",
            "        # Try GET with model-level permission",
            "        response = self.client.get(self._get_url(\"view\", instance))",
            "        self.assertHttpStatus(response, 200)",
            "",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "",
            "        # The object's display name or string representation should appear in the response",
            "        self.assertIn(getattr(instance, \"display\", str(instance)), response_body, msg=response_body)",
            "",
            "        # skip GetObjectViewTestCase checks for Relationships and Custom Fields since this isn't actually a detail view",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_object_with_constrained_permission(self):",
            "        instance1, instance2 = self._get_queryset().all()[:2]",
            "",
            "        # Add object-level permission",
            "        obj_perm = ObjectPermission(",
            "            name=\"Test permission\",",
            "            constraints={\"pk\": instance1.pk},",
            "            # To get a different rendering flow than the \"test_get_object_with_permission\" test above,",
            "            # enable additional permissions for this object so that interaction buttons are rendered.",
            "            actions=[\"view\", \"add\", \"change\", \"delete\"],",
            "        )",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(self.model))",
            "",
            "        # Try GET to permitted object",
            "        self.assertHttpStatus(self.client.get(self._get_url(\"view\", instance1)), 200)",
            "",
            "        # Try GET to non-permitted object",
            "        self.assertHttpStatus(self.client.get(self._get_url(\"view\", instance2)), 404)",
            "",
            "    #",
            "    # Additional test cases specific to the job approval view",
            "    #",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_anonymous(self):",
            "        \"\"\"Anonymous users may not take any action with regard to job approval requests.\"\"\"",
            "        self.client.logout()",
            "        response = self.client.post(self._get_url(\"view\", self._get_queryset().first()))",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission to run jobs\", response_body)",
            "        # No job was submitted",
            "        self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_post_dry_run_not_runnable(self):",
            "        \"\"\"A non-enabled job cannot be dry-run.\"\"\"",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "        instance = self._get_queryset().first()",
            "        data = {\"_dry_run\": True}",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"This job cannot be run at this time\", response_body)",
            "        # No job was submitted",
            "        self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_post_dry_run_needs_job_run_permission(self):",
            "        \"\"\"A user without run_job permission cannot dry-run a job.\"\"\"",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "        instance = self._get_queryset().first()",
            "        instance.job_model.enabled = True",
            "        instance.job_model.save()",
            "        data = {\"_dry_run\": True}",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission to run this job\", response_body)",
            "        # No job was submitted",
            "        self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_post_dry_run_needs_specific_job_run_permission(self):",
            "        \"\"\"A user without run_job permission FOR THAT SPECIFIC JOB cannot dry-run a job.\"\"\"",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "        instance1, instance2 = self._get_queryset().all()[:2]",
            "        data = {\"_dry_run\": True}",
            "        obj_perm = ObjectPermission(name=\"Test permission\", constraints={\"pk\": instance1.job_model.pk}, actions=[\"run\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "        instance1.job_model.enabled = True",
            "        instance1.job_model.save()",
            "        instance2.job_model.enabled = True",
            "        instance2.job_model.save()",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance2), data)",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission to run this job\", response_body)",
            "        # No job was submitted",
            "        self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_post_dry_run_success(self, _):",
            "        \"\"\"Successfully request a dry run based on object-based run_job permissions.\"\"\"",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "        instance = self._get_queryset().first()",
            "        instance.job_model.enabled = True",
            "        instance.job_model.save()",
            "        obj_perm = ObjectPermission(name=\"Test permission\", constraints={\"pk\": instance.job_model.pk}, actions=[\"run\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "        data = {\"_dry_run\": True}",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        # Job was submitted",
            "        self.assertEqual(",
            "            1, len(JobResult.objects.all()), msg=extract_page_body(response.content.decode(response.charset))",
            "        )",
            "        job_result = JobResult.objects.first()",
            "        self.assertEqual(job_result.job_model, instance.job_model)",
            "        self.assertEqual(job_result.user, self.user)",
            "        self.assertRedirects(response, reverse(\"extras:jobresult\", kwargs={\"pk\": job_result.pk}))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_deny_different_user_lacking_permissions(self):",
            "        \"\"\"A user needs both delete_scheduledjob and approve_job permissions to deny a job request.\"\"\"",
            "        user1 = User.objects.create_user(username=\"testuser1\")",
            "        user2 = User.objects.create_user(username=\"testuser2\")",
            "",
            "        # Give both users view_scheduledjob permission",
            "        obj_perm = ObjectPermission(name=\"View\", actions=[\"view\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user1, user2)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user1 delete_scheduledjob permission but not approve_job permission",
            "        obj_perm = ObjectPermission(name=\"Delete\", actions=[\"delete\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user1)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user2 approve_job permission but not delete_scheduledjob permission",
            "        obj_perm = ObjectPermission(name=\"Approve\", actions=[\"approve\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user2)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        instance = self._get_queryset().first()",
            "        data = {\"_deny\": True}",
            "",
            "        for user in (user1, user2):",
            "            self.client.force_login(user)",
            "            response = self.client.post(self._get_url(\"view\", instance), data)",
            "            self.assertHttpStatus(response, 200, msg=str(user))",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"You do not have permission\", response_body, msg=str(user))",
            "            # Request was not deleted",
            "            self.assertEqual(1, len(ScheduledJob.objects.filter(pk=instance.pk)), msg=str(user))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_deny_different_user_permitted(self):",
            "        \"\"\"A user with appropriate permissions can deny a job request.\"\"\"",
            "        user = User.objects.create_user(username=\"testuser1\")",
            "        instance = self._get_queryset().first()",
            "",
            "        # Give user view_scheduledjob and delete_scheduledjob permissions",
            "        obj_perm = ObjectPermission(name=\"View\", actions=[\"view\", \"delete\"], constraints={\"pk\": instance.pk})",
            "        obj_perm.save()",
            "        obj_perm.users.add(user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user approve_job permission",
            "        obj_perm = ObjectPermission(name=\"Approve\", actions=[\"approve\"], constraints={\"pk\": instance.job_model.pk})",
            "        obj_perm.save()",
            "        obj_perm.users.add(user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        data = {\"_deny\": True}",
            "",
            "        self.client.force_login(user)",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertRedirects(response, reverse(\"extras:scheduledjob_approval_queue_list\"))",
            "        # Request was deleted",
            "        self.assertEqual(0, len(ScheduledJob.objects.filter(pk=instance.pk)))",
            "",
            "        # Check object-based permissions are enforced for a different instance",
            "        instance = self._get_queryset().first()",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200, msg=str(user))",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission\", response_body, msg=str(user))",
            "        # Request was not deleted",
            "        self.assertEqual(1, len(ScheduledJob.objects.filter(pk=instance.pk)), msg=str(user))",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_approve_cannot_self_approve(self):",
            "        self.add_permissions(\"extras.change_scheduledjob\")",
            "        self.add_permissions(\"extras.approve_job\")",
            "        instance = self._get_queryset().first()",
            "        data = {\"_approve\": True}",
            "",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200)",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You cannot approve your own job request\", response_body)",
            "        # Job was not approved",
            "        instance.refresh_from_db()",
            "        self.assertIsNone(instance.approved_by_user)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_approve_different_user_lacking_permissions(self):",
            "        \"\"\"A user needs both change_scheduledjob and approve_job permissions to approve a job request.\"\"\"",
            "        user1 = User.objects.create_user(username=\"testuser1\")",
            "        user2 = User.objects.create_user(username=\"testuser2\")",
            "",
            "        # Give both users view_scheduledjob permission",
            "        obj_perm = ObjectPermission(name=\"View\", actions=[\"view\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user1, user2)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user1 change_scheduledjob permission but not approve_job permission",
            "        obj_perm = ObjectPermission(name=\"Change\", actions=[\"change\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user1)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user2 approve_job permission but not change_scheduledjob permission",
            "        obj_perm = ObjectPermission(name=\"Approve\", actions=[\"approve\"])",
            "        obj_perm.save()",
            "        obj_perm.users.add(user2)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        instance = self._get_queryset().first()",
            "        data = {\"_approve\": True}",
            "",
            "        for user in (user1, user2):",
            "            self.client.force_login(user)",
            "            response = self.client.post(self._get_url(\"view\", instance), data)",
            "            self.assertHttpStatus(response, 200, msg=str(user))",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"You do not have permission\", response_body, msg=str(user))",
            "            # Job was not approved",
            "            instance.refresh_from_db()",
            "            self.assertIsNone(instance.approved_by_user)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
            "    def test_post_approve_different_user_permitted(self):",
            "        \"\"\"A user with appropriate permissions can approve a job request.\"\"\"",
            "        user = User.objects.create_user(username=\"testuser1\")",
            "        instance = self._get_queryset().first()",
            "",
            "        # Give user view_scheduledjob and change_scheduledjob permissions",
            "        obj_perm = ObjectPermission(name=\"View\", actions=[\"view\", \"change\"], constraints={\"pk\": instance.pk})",
            "        obj_perm.save()",
            "        obj_perm.users.add(user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(ScheduledJob))",
            "",
            "        # Give user approve_job permission",
            "        obj_perm = ObjectPermission(name=\"Approve\", actions=[\"approve\"], constraints={\"pk\": instance.job_model.pk})",
            "        obj_perm.save()",
            "        obj_perm.users.add(user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        data = {\"_approve\": True}",
            "",
            "        self.client.force_login(user)",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertRedirects(response, reverse(\"extras:scheduledjob_approval_queue_list\"))",
            "        # Job was scheduled",
            "        instance.refresh_from_db()",
            "        self.assertEqual(instance.approved_by_user, user)",
            "",
            "        # Check object-based permissions are enforced for a different instance",
            "        instance = self._get_queryset().last()",
            "        response = self.client.post(self._get_url(\"view\", instance), data)",
            "        self.assertHttpStatus(response, 200, msg=str(user))",
            "        response_body = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(\"You do not have permission\", response_body, msg=str(user))",
            "        # Job was not scheduled",
            "        instance.refresh_from_db()",
            "        self.assertIsNone(instance.approved_by_user)",
            "",
            "",
            "class JobResultTestCase(",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "):",
            "    model = JobResult",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        obj_type = get_job_content_type()",
            "        JobResult.objects.create(",
            "            name=\"local/test_pass/TestPass\",",
            "            job_id=uuid.uuid4(),",
            "            obj_type=obj_type,",
            "        )",
            "        JobResult.objects.create(",
            "            name=\"local/test_fail/TestFail\",",
            "            job_id=uuid.uuid4(),",
            "            obj_type=obj_type,",
            "        )",
            "        JobResult.objects.create(",
            "            name=\"local/test_read_only_fail/TestReadOnlyFail\",",
            "            job_id=uuid.uuid4(),",
            "            obj_type=obj_type,",
            "        )",
            "",
            "",
            "class JobTestCase(",
            "    # note no CreateObjectViewTestCase - we do not support user creation of Job records",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    \"\"\"",
            "    The Job view test cases.",
            "    \"\"\"",
            "",
            "    model = Job",
            "",
            "    def _get_queryset(self):",
            "        \"\"\"Don't include hidden Jobs, non-installed Jobs, JobHookReceivers or JobButtonReceivers as they won't appear in the UI by default.\"\"\"",
            "        return self.model.objects.filter(",
            "            installed=True, hidden=False, is_job_hook_receiver=False, is_job_button_receiver=False",
            "        )",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        # Job model objects are automatically created during database migrations",
            "",
            "        # But we do need to make sure the ones we're testing are flagged appropriately",
            "        cls.test_pass = Job.objects.get(job_class_name=\"TestPass\")",
            "        cls.test_pass.enabled = True",
            "        cls.test_pass.save()",
            "",
            "        cls.run_urls = (",
            "            # Legacy URL (job class path based)",
            "            reverse(\"extras:job\", kwargs={\"class_path\": cls.test_pass.class_path}),",
            "            # Current URL (job model slug based)",
            "            reverse(\"extras:job_run\", kwargs={\"slug\": cls.test_pass.slug}),",
            "        )",
            "",
            "        cls.test_required_args = Job.objects.get(job_class_name=\"TestRequired\")",
            "        cls.test_required_args.enabled = True",
            "        cls.test_required_args.save()",
            "",
            "        cls.extra_run_urls = (",
            "            # Legacy URL (job class path based)",
            "            reverse(\"extras:job\", kwargs={\"class_path\": cls.test_required_args.class_path}),",
            "            # Current URL (job model slug based)",
            "            reverse(\"extras:job_run\", kwargs={\"slug\": cls.test_required_args.slug}),",
            "        )",
            "",
            "        # Create an entry for a non-installed Job as well",
            "        cls.test_not_installed = Job(",
            "            source=JobSourceChoices.SOURCE_LOCAL,",
            "            module_name=\"nonexistent\",",
            "            job_class_name=\"NoSuchJob\",",
            "            grouping=\"Nonexistent Jobs\",",
            "            name=\"No such job\",",
            "            enabled=True,",
            "            installed=False,",
            "        )",
            "        cls.test_not_installed.validated_save()",
            "",
            "        cls.data_run_immediately = {",
            "            \"_schedule_type\": \"immediately\",",
            "        }",
            "",
            "        cls.form_data = {",
            "            \"slug\": \"custom-job-slug\",",
            "            \"enabled\": True,",
            "            \"grouping_override\": True,",
            "            \"grouping\": \"Overridden Grouping\",",
            "            \"name_override\": True,",
            "            \"name\": \"Overridden Name\",",
            "            \"description_override\": True,",
            "            \"description\": \"This is an overridden description of a job.\",",
            "            \"commit_default_override\": True,",
            "            \"commit_default\": False,",
            "            \"hidden_override\": True,",
            "            \"hidden\": False,",
            "            \"read_only_override\": True,",
            "            \"read_only\": False,",
            "            \"approval_required_override\": True,",
            "            \"approval_required\": True,",
            "            \"soft_time_limit_override\": True,",
            "            \"soft_time_limit\": 350,",
            "            \"time_limit_override\": True,",
            "            \"time_limit\": 650,",
            "            \"has_sensitive_variables\": False,",
            "            \"has_sensitive_variables_override\": True,",
            "            \"task_queues\": \"overridden,priority\",",
            "            \"task_queues_override\": True,",
            "        }",
            "",
            "    #",
            "    # Additional test cases for the \"job\" (legacy run) and \"job_run\" (updated run) views follow",
            "    #",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_run_without_permission(self):",
            "        for run_url in self.run_urls:",
            "            self.assertHttpStatus(self.client.get(run_url), 403, msg=run_url)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_run_with_permission(self):",
            "        \"\"\"",
            "        Get view with appropriate global permissions.",
            "",
            "        Note that this view is conditional on run_job permission, not view_job permission,",
            "        so EXEMPT_VIEW_PERMISSIONS=[\"*\"] does NOT apply here.",
            "        \"\"\"",
            "        self.add_permissions(\"extras.run_job\")",
            "        for run_url in self.run_urls:",
            "            response = self.client.get(run_url)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"TestPass\", response_body)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_get_run_with_constrained_permission(self):",
            "        \"\"\"Get view with appropriate object-based permissions.\"\"\"",
            "        obj_perm = ObjectPermission(",
            "            name=\"Job permission\",",
            "            constraints={\"module_name\": self.test_pass.module_name},",
            "            actions=[\"run\"],",
            "        )",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        # Try GET with a permitted object",
            "        for run_url in self.run_urls:",
            "            self.assertHttpStatus(self.client.get(run_url), 200, msg=run_url)",
            "",
            "        # Try GET with a non-permitted object",
            "        for run_url in self.extra_run_urls:",
            "            self.assertHttpStatus(self.client.get(run_url), 404, msg=run_url)",
            "",
            "    @override_settings(EXEMPT_VIEW_PERMISSIONS=[])",
            "    def test_run_without_permission(self):",
            "        for run_url in self.run_urls:",
            "            self.assertHttpStatus(self.client.post(run_url), 403, msg=run_url)",
            "",
            "    def test_run_missing_schedule(self):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(errors, [\"_schedule_type: This field is required.\"])",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=0)",
            "    def test_run_now_no_worker(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"Celery worker process not running.\", content)",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_jobresult\")",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "",
            "            result = JobResult.objects.latest()",
            "            self.assertRedirects(response, reverse(\"extras:jobresult\", kwargs={\"pk\": result.pk}))",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now_constrained_permissions(self, _):",
            "        obj_perm = ObjectPermission(",
            "            name=\"Job permission\",",
            "            constraints={\"module_name\": self.test_pass.module_name},",
            "            actions=[\"run\"],",
            "        )",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        self.add_permissions(\"extras.view_jobresult\")",
            "",
            "        # Try POST with a permitted object",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "",
            "            result = JobResult.objects.latest()",
            "            self.assertIsNotNone(result, msg=run_url)",
            "            self.assertRedirects(response, reverse(\"extras:jobresult\", kwargs={\"pk\": result.pk}))",
            "",
            "        # Try POST with a non-permitted object",
            "        for run_url in self.extra_run_urls:",
            "            self.assertHttpStatus(self.client.post(run_url, self.data_run_immediately), 404, msg=run_url)",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now_not_installed(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in (",
            "            reverse(\"extras:job\", kwargs={\"class_path\": self.test_not_installed.class_path}),",
            "            reverse(\"extras:job_run\", kwargs={\"slug\": self.test_not_installed.slug}),",
            "        ):",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "            self.assertEqual(response.status_code, 200, msg=run_url)",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"Job is not presently installed\", response_body)",
            "",
            "            self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now_not_enabled(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in (",
            "            reverse(\"extras:job\", kwargs={\"class_path\": \"local/test_fail/TestFail\"}),",
            "            reverse(\"extras:job_run\", kwargs={\"slug\": Job.objects.get(job_class_name=\"TestFail\").slug}),",
            "        ):",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "            self.assertEqual(response.status_code, 200, msg=run_url)",
            "            response_body = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"Job is not enabled to be run\", response_body)",
            "",
            "            self.assertEqual(0, len(JobResult.objects.all()))",
            "",
            "    def test_run_now_missing_args(self):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        for run_url in self.extra_run_urls:",
            "            response = self.client.post(run_url, self.data_run_immediately)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(errors, [\"var: This field is required.\"])",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_now_with_args(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_jobresult\")",
            "",
            "        data = {",
            "            \"_schedule_type\": \"immediately\",",
            "            \"var\": \"12\",",
            "        }",
            "",
            "        for run_url in self.extra_run_urls:",
            "            response = self.client.post(run_url, data)",
            "",
            "            result = JobResult.objects.latest()",
            "            self.assertRedirects(response, reverse(\"extras:jobresult\", kwargs={\"pk\": result.pk}))",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later_missing_name(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(errors, [\"_schedule_name: Please provide a name for the job schedule.\"])",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later_missing_date(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(",
            "                errors,",
            "                [",
            "                    \"_schedule_start_time: Please enter a valid date and time greater than or equal to the current date and time.\"",
            "                ],",
            "            )",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later_date_passed(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "            \"_schedule_start_time\": str(datetime.now() - timedelta(minutes=1)),",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(",
            "                errors,",
            "                [",
            "                    \"_schedule_start_time: Please enter a valid date and time greater than or equal to the current date and time.\"",
            "                ],",
            "            )",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        start_time = timezone.now() + timedelta(minutes=1)",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "            \"_schedule_start_time\": str(start_time),",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertRedirects(response, reverse(\"extras:scheduledjob_list\"))",
            "",
            "            scheduled = ScheduledJob.objects.last()",
            "            self.assertEqual(scheduled.name, \"test\")",
            "            self.assertEqual(scheduled.start_time, start_time)",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_later_sets_scheduled_job_kwargs_pk(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        start_time = timezone.now() + timedelta(minutes=1)",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "            \"_schedule_start_time\": str(start_time),",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertRedirects(response, reverse(\"extras:scheduledjob_list\"))",
            "",
            "            scheduled = ScheduledJob.objects.last()",
            "            self.assertEqual(scheduled.kwargs[\"scheduled_job_pk\"], str(scheduled.pk))",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_job_with_sensitive_variables_for_future(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        self.test_pass.has_sensitive_variables = True",
            "        self.test_pass.has_sensitive_variables_override = True",
            "        self.test_pass.validated_save()",
            "",
            "        start_time = timezone.now() + timedelta(minutes=1)",
            "        data = {",
            "            \"_schedule_type\": \"future\",",
            "            \"_schedule_name\": \"test\",",
            "            \"_schedule_start_time\": str(start_time),",
            "        }",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=self.run_urls[1])",
            "",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(\"Unable to schedule job: Job may have sensitive input variables.\", content)",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_job_with_invalid_task_queue(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_jobresult\")",
            "",
            "        self.test_pass.task_queues = []",
            "        self.test_pass.task_queues_override = True",
            "        self.test_pass.validated_save()",
            "",
            "        data = {",
            "            \"_schedule_type\": \"immediately\",",
            "            \"_task_queue\": \"invalid\",",
            "        }",
            "",
            "        for run_url in self.run_urls:",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=run_url)",
            "",
            "            errors = extract_form_failures(response.content.decode(response.charset))",
            "            self.assertEqual(",
            "                errors,",
            "                [\"_task_queue: Select a valid choice. invalid is not one of the available choices.\"],",
            "            )",
            "",
            "    @mock.patch(\"nautobot.extras.views.get_worker_count\", return_value=1)",
            "    def test_run_job_with_sensitive_variables_and_requires_approval(self, _):",
            "        self.add_permissions(\"extras.run_job\")",
            "        self.add_permissions(\"extras.view_scheduledjob\")",
            "",
            "        self.test_pass.has_sensitive_variables = True",
            "        self.test_pass.approval_required = True",
            "        self.test_pass.save()",
            "",
            "        data = {",
            "            \"_schedule_type\": \"immediately\",",
            "        }",
            "        for run_url in self.run_urls:",
            "            # Assert warning message shows in get",
            "            response = self.client.get(run_url)",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(",
            "                \"This job is flagged as possibly having sensitive variables but is also flagged as requiring approval.\",",
            "                content,",
            "            )",
            "",
            "            # Assert run button is disabled",
            "            self.assertInHTML(",
            "                \"\"\"",
            "                <button type=\"submit\" name=\"_run\" id=\"id__run\" class=\"btn btn-primary\" disabled=\"disabled\">",
            "                    <i class=\"mdi mdi-play\"></i> Run Job Now",
            "                </button>",
            "                \"\"\",",
            "                content,",
            "            )",
            "            # Assert error message shows after post",
            "            response = self.client.post(run_url, data)",
            "            self.assertHttpStatus(response, 200, msg=self.run_urls[1])",
            "",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertIn(",
            "                \"Unable to run or schedule job: \"",
            "                \"This job is flagged as possibly having sensitive variables but is also flagged as requiring approval.\"",
            "                \"One of these two flags must be removed before this job can be scheduled or run.\",",
            "                content,",
            "            )",
            "",
            "    def test_job_object_change_log_view(self):",
            "        \"\"\"Assert Job change log view displays appropriate header\"\"\"",
            "        instance = self.test_pass",
            "        self.add_permissions(\"extras.view_objectchange\", \"extras.view_job\")",
            "        response = self.client.get(instance.get_changelog_url())",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "",
            "        self.assertHttpStatus(response, 200)",
            "        self.assertIn(f\"<h1>{instance.name} - Change Log</h1>\", content)",
            "",
            "",
            "class JobButtonTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = JobButton",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        job_buttons = (",
            "            JobButton.objects.create(",
            "                name=\"JobButton1\",",
            "                text=\"JobButton1\",",
            "                job=Job.objects.get(job_class_name=\"TestJobButtonReceiverSimple\"),",
            "                confirmation=True,",
            "            ),",
            "            JobButton.objects.create(",
            "                name=\"JobButton2\",",
            "                text=\"JobButton2\",",
            "                job=Job.objects.get(job_class_name=\"TestJobButtonReceiverSimple\"),",
            "                confirmation=False,",
            "            ),",
            "            JobButton.objects.create(",
            "                name=\"JobButton3\",",
            "                text=\"JobButton3\",",
            "                job=Job.objects.get(job_class_name=\"TestJobButtonReceiverComplex\"),",
            "                confirmation=True,",
            "                weight=50,",
            "            ),",
            "        )",
            "",
            "        site_ct = ContentType.objects.get_for_model(Site)",
            "        for jb in job_buttons:",
            "            jb.content_types.set([site_ct])",
            "",
            "        cls.form_data = {",
            "            \"content_types\": [site_ct.pk],",
            "            \"name\": \"jobbutton-4\",",
            "            \"text\": \"jobbutton text 4\",",
            "            \"job\": Job.objects.get(job_class_name=\"TestJobButtonReceiverComplex\").pk,",
            "            \"weight\": 100,",
            "            \"button_class\": \"default\",",
            "            \"confirmation\": False,",
            "        }",
            "",
            "",
            "class JobButtonRenderingTestCase(TestCase):",
            "    \"\"\"Tests for the rendering of JobButtons, distinct from tests of the JobButton views themselves.\"\"\"",
            "",
            "    user_permissions = [\"dcim.view_locationtype\"]",
            "",
            "    def setUp(self):",
            "        super().setUp()",
            "        self.job_button_1 = JobButton(",
            "            name=\"JobButton 1\",",
            "            text=\"JobButton {{ obj.name }}\",",
            "            job=Job.objects.get(job_class_name=\"TestJobButtonReceiverSimple\"),",
            "            confirmation=False,",
            "        )",
            "        self.job_button_1.validated_save()",
            "        self.job_button_1.content_types.add(ContentType.objects.get_for_model(LocationType))",
            "",
            "        self.job_button_2 = JobButton(",
            "            name=\"JobButton 2\",",
            "            text=\"Click me!\",",
            "            job=Job.objects.get(job_class_name=\"TestJobButtonReceiverComplex\"),",
            "            confirmation=False,",
            "        )",
            "        self.job_button_2.validated_save()",
            "        self.job_button_2.content_types.add(ContentType.objects.get_for_model(LocationType))",
            "",
            "        self.location_type = LocationType.objects.get(name=\"Campus\")",
            "",
            "    def test_view_object_with_job_button(self):",
            "        \"\"\"Ensure that the job button is rendered.\"\"\"",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertIn(f\"JobButton {self.location_type.name}\", content, content)",
            "        self.assertIn(\"Click me!\", content, content)",
            "",
            "    def test_view_object_with_unsafe_text(self):",
            "        \"\"\"Ensure that JobButton text can't be used as a vector for XSS.\"\"\"",
            "        self.job_button_1.text = '<script>alert(\"Hello world!\")</script>'",
            "        self.job_button_1.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "        # Make sure grouped rendering is safe too",
            "        self.job_button_1.group_name = '<script>alert(\"Goodbye\")</script>'",
            "        self.job_button_1.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "    def test_view_object_with_unsafe_name(self):",
            "        \"\"\"Ensure that JobButton names can't be used as a vector for XSS.\"\"\"",
            "        self.job_button_1.text = \"JobButton {{ obj\"",
            "        self.job_button_1.name = '<script>alert(\"Yo\")</script>'",
            "        self.job_button_1.validated_save()",
            "        response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "        self.assertEqual(response.status_code, 200)",
            "        content = extract_page_body(response.content.decode(response.charset))",
            "        self.assertNotIn(\"<script>alert\", content, content)",
            "        self.assertIn(\"&lt;script&gt;alert\", content, content)",
            "",
            "    def test_render_constrained_run_permissions(self):",
            "        obj_perm = ObjectPermission(",
            "            name=\"Test permission\",",
            "            constraints={\"pk\": self.job_button_1.job.pk},",
            "            actions=[\"run\"],",
            "        )",
            "        obj_perm.save()",
            "        obj_perm.users.add(self.user)",
            "        obj_perm.object_types.add(ContentType.objects.get_for_model(Job))",
            "",
            "        with self.subTest(\"Ungrouped buttons\"):",
            "            response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "            self.assertEqual(response.status_code, 200)",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertInHTML(",
            "                NO_CONFIRM_BUTTON.format(",
            "                    button_id=self.job_button_1.pk,",
            "                    button_text=f\"JobButton {self.location_type.name}\",",
            "                    button_class=self.job_button_1.button_class,",
            "                    disabled=\"\",",
            "                ),",
            "                content,",
            "            )",
            "            self.assertInHTML(",
            "                NO_CONFIRM_BUTTON.format(",
            "                    button_id=self.job_button_2.pk,",
            "                    button_text=\"Click me!\",",
            "                    button_class=self.job_button_2.button_class,",
            "                    disabled=\"disabled\",",
            "                ),",
            "                content,",
            "            )",
            "",
            "        with self.subTest(\"Grouped buttons\"):",
            "            self.job_button_1.group_name = \"Grouping\"",
            "            self.job_button_1.validated_save()",
            "            self.job_button_2.group_name = \"Grouping\"",
            "            self.job_button_2.validated_save()",
            "",
            "            response = self.client.get(self.location_type.get_absolute_url(), follow=True)",
            "            self.assertEqual(response.status_code, 200)",
            "            content = extract_page_body(response.content.decode(response.charset))",
            "            self.assertInHTML(",
            "                \"<li>\"",
            "                + NO_CONFIRM_BUTTON.format(",
            "                    button_id=self.job_button_1.pk,",
            "                    button_text=f\"JobButton {self.location_type.name}\",",
            "                    button_class=\"link\",",
            "                    disabled=\"\",",
            "                )",
            "                + \"</li>\",",
            "                content,",
            "            )",
            "            self.assertInHTML(",
            "                \"<li>\"",
            "                + NO_CONFIRM_BUTTON.format(",
            "                    button_id=self.job_button_2.pk,",
            "                    button_text=\"Click me!\",",
            "                    button_class=\"link\",",
            "                    disabled=\"disabled\",",
            "                )",
            "                + \"</li>\",",
            "                content,",
            "            )",
            "",
            "",
            "# TODO: Convert to StandardTestCases.Views",
            "class ObjectChangeTestCase(TestCase):",
            "    user_permissions = (\"extras.view_objectchange\",)",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        site = Site(name=\"Site 1\", slug=\"site-1\")",
            "        site.save()",
            "",
            "        # Create three ObjectChanges",
            "        user = User.objects.create_user(username=\"testuser2\")",
            "        for _ in range(1, 4):",
            "            oc = site.to_objectchange(action=ObjectChangeActionChoices.ACTION_UPDATE)",
            "            oc.user = user",
            "            oc.request_id = uuid.uuid4()",
            "            oc.save()",
            "",
            "    def test_objectchange_list(self):",
            "        url = reverse(\"extras:objectchange_list\")",
            "        params = {",
            "            \"user\": User.objects.first().pk,",
            "        }",
            "",
            "        response = self.client.get(f\"{url}?{urllib.parse.urlencode(params)}\")",
            "        self.assertHttpStatus(response, 200)",
            "",
            "    def test_objectchange(self):",
            "        objectchange = ObjectChange.objects.first()",
            "        response = self.client.get(objectchange.get_absolute_url())",
            "        self.assertHttpStatus(response, 200)",
            "",
            "",
            "class RelationshipTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "    RequiredRelationshipTestMixin,",
            "):",
            "    model = Relationship",
            "    slug_source = \"name\"",
            "    slugify_function = staticmethod(slugify_dashes_to_underscores)",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        interface_type = ContentType.objects.get_for_model(Interface)",
            "        device_type = ContentType.objects.get_for_model(Device)",
            "        vlan_type = ContentType.objects.get_for_model(VLAN)",
            "",
            "        Relationship(",
            "            name=\"Device VLANs\",",
            "            slug=\"device-vlans\",",
            "            type=\"many-to-many\",",
            "            source_type=device_type,",
            "            destination_type=vlan_type,",
            "        ).validated_save()",
            "        Relationship(",
            "            name=\"Primary VLAN\",",
            "            slug=\"primary-vlan\",",
            "            type=\"one-to-many\",",
            "            source_type=vlan_type,",
            "            destination_type=device_type,",
            "        ).validated_save()",
            "        Relationship(",
            "            name=\"Primary Interface\",",
            "            type=\"one-to-one\",",
            "            source_type=device_type,",
            "            destination_type=interface_type,",
            "        ).validated_save()",
            "",
            "        cls.form_data = {",
            "            \"name\": \"VLAN-to-Interface\",",
            "            \"slug\": \"vlan-to-interface\",",
            "            \"type\": \"many-to-many\",",
            "            \"source_type\": vlan_type.pk,",
            "            \"source_label\": \"Interfaces\",",
            "            \"source_hidden\": False,",
            "            \"source_filter\": '{\"status\": [\"active\"]}',",
            "            \"destination_type\": interface_type.pk,",
            "            \"destination_label\": \"VLANs\",",
            "            \"destination_hidden\": True,",
            "            \"destination_filter\": None,",
            "        }",
            "",
            "        cls.slug_test_object = \"Primary Interface\"",
            "",
            "    def test_required_relationships(self):",
            "        \"\"\"",
            "        1. Try creating an object when no required target object exists",
            "        2. Try creating an object without specifying required target object(s)",
            "        3. Try creating an object when all required data is present",
            "        4. Test bulk edit",
            "        \"\"\"",
            "",
            "        # Parameterized tests (for creating and updating single objects):",
            "        self.required_relationships_test(interact_with=\"ui\")",
            "",
            "        # 4. Bulk create/edit tests:",
            "",
            "        vlans = VLANFactory.create_batch(6)",
            "",
            "        # Try deleting all devices and then editing the 6 VLANs (fails):",
            "        Device.objects.all().delete()",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"), data={\"pk\": [str(vlan.id) for vlan in vlans], \"_apply\": [\"\"]}",
            "        )",
            "        self.assertContains(response, \"VLANs require at least one device, but no devices exist yet.\")",
            "",
            "        # Create test device for association",
            "        device_for_association = test_views.create_test_device(\"VLAN Required Device\")",
            "",
            "        # Try editing all 6 VLANs without adding the required device(fails):",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"), data={\"pk\": [str(vlan.id) for vlan in vlans], \"_apply\": [\"\"]}",
            "        )",
            "        self.assertContains(",
            "            response,",
            "            \"6 VLANs require a device for the required relationship &quot;VLANs require at least one Device&quot;\",",
            "        )",
            "",
            "        # Try editing 3 VLANs without adding the required device(fails):",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"), data={\"pk\": [str(vlan.id) for vlan in vlans[:3]], \"_apply\": [\"\"]}",
            "        )",
            "        self.assertContains(",
            "            response,",
            "            \"These VLANs require a device for the required \"",
            "            \"relationship &quot;VLANs require at least one Device&quot;\",",
            "        )",
            "        for vlan in vlans[:3]:",
            "            self.assertContains(response, f\"{str(vlan)}\")",
            "",
            "        # Try editing 6 VLANs and adding the required device (succeeds):",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"),",
            "            data={",
            "                \"pk\": [str(vlan.id) for vlan in vlans],",
            "                \"add_cr_vlans-devices-m2m__source\": [str(device_for_association.id)],",
            "                \"_apply\": [\"\"],",
            "            },",
            "            follow=True,",
            "        )",
            "        self.assertContains(response, \"Updated 6 VLANs\")",
            "",
            "        # Try editing 6 VLANs and removing the required device (fails):",
            "        response = self.client.post(",
            "            reverse(\"ipam:vlan_bulk_edit\"),",
            "            data={",
            "                \"pk\": [str(vlan.id) for vlan in vlans],",
            "                \"remove_cr_vlans-devices-m2m__source\": [str(device_for_association.id)],",
            "                \"_apply\": [\"\"],",
            "            },",
            "        )",
            "        self.assertContains(",
            "            response,",
            "            \"6 VLANs require a device for the required relationship &quot;VLANs require at least one Device&quot;\",",
            "        )",
            "",
            "",
            "class RelationshipAssociationTestCase(",
            "    # TODO? ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    # TODO? ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.BulkDeleteObjectsViewTestCase,",
            "    # TODO? ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = RelationshipAssociation",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        device_type = ContentType.objects.get_for_model(Device)",
            "        vlan_type = ContentType.objects.get_for_model(VLAN)",
            "",
            "        relationship = Relationship(",
            "            name=\"Device VLANs\",",
            "            slug=\"device-vlans\",",
            "            type=\"many-to-many\",",
            "            source_type=device_type,",
            "            destination_type=vlan_type,",
            "        )",
            "        relationship.validated_save()",
            "        manufacturer = Manufacturer.objects.create(name=\"Manufacturer 1\", slug=\"manufacturer-1\")",
            "        devicetype = DeviceType.objects.create(manufacturer=manufacturer, model=\"Device Type 1\", slug=\"device-type-1\")",
            "        devicerole = DeviceRole.objects.create(name=\"Device Role 1\", slug=\"device-role-1\")",
            "        site = Site.objects.first()",
            "        devices = (",
            "            Device.objects.create(name=\"Device 1\", device_type=devicetype, device_role=devicerole, site=site),",
            "            Device.objects.create(name=\"Device 2\", device_type=devicetype, device_role=devicerole, site=site),",
            "            Device.objects.create(name=\"Device 3\", device_type=devicetype, device_role=devicerole, site=site),",
            "        )",
            "        vlans = (",
            "            VLAN.objects.create(vid=1, name=\"VLAN 1\"),",
            "            VLAN.objects.create(vid=2, name=\"VLAN 2\"),",
            "            VLAN.objects.create(vid=3, name=\"VLAN 3\"),",
            "        )",
            "",
            "        RelationshipAssociation(",
            "            relationship=relationship,",
            "            source_type=device_type,",
            "            source_id=devices[0].pk,",
            "            destination_type=vlan_type,",
            "            destination_id=vlans[0].pk,",
            "        ).validated_save()",
            "        RelationshipAssociation(",
            "            relationship=relationship,",
            "            source_type=device_type,",
            "            source_id=devices[1].pk,",
            "            destination_type=vlan_type,",
            "            destination_id=vlans[1].pk,",
            "        ).validated_save()",
            "        RelationshipAssociation(",
            "            relationship=relationship,",
            "            source_type=device_type,",
            "            source_id=devices[2].pk,",
            "            destination_type=vlan_type,",
            "            destination_id=vlans[2].pk,",
            "        ).validated_save()",
            "",
            "",
            "class StatusTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = Status",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        # Status objects to test.",
            "        content_type = ContentType.objects.get_for_model(Device)",
            "",
            "        cls.form_data = {",
            "            \"name\": \"new_status\",",
            "            \"slug\": \"new-status\",",
            "            \"description\": \"I am a new status object.\",",
            "            \"color\": \"ffcc00\",",
            "            \"content_types\": [content_type.pk],",
            "        }",
            "",
            "        cls.csv_data = (",
            "            \"name,slug,color,content_types\"",
            "            'test_status1,test-status1,ffffff,\"dcim.device\"'",
            "            'test_status2,test-status2,ffffff,\"dcim.device,dcim.rack\"'",
            "            'test_status3,test-status3,ffffff,\"dcim.device,dcim.site\"'",
            "            'test_status4,,ffffff,\"dcim.device,dcim.site\"'",
            "        )",
            "",
            "        cls.bulk_edit_data = {",
            "            \"color\": \"000000\",",
            "        }",
            "",
            "        cls.slug_source = \"name\"",
            "        cls.slug_test_object = Status.objects.first().name",
            "",
            "",
            "class TagTestCase(ViewTestCases.OrganizationalObjectViewTestCase):",
            "    model = Tag",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        cls.form_data = {",
            "            \"name\": \"Tag X\",",
            "            \"slug\": \"tag-x\",",
            "            \"color\": \"c0c0c0\",",
            "            \"comments\": \"Some comments\",",
            "            \"content_types\": [ct.id for ct in TaggableClassesQuery().as_queryset()],",
            "        }",
            "",
            "        cls.csv_data = (",
            "            \"name,slug,color,description\",",
            "            \"Tag 4,tag-4,ff0000,Fourth tag\",",
            "            \"Tag 5,tag-5,00ff00,Fifth tag\",",
            "            \"Tag 6,tag-6,0000ff,Sixth tag\",",
            "        )",
            "",
            "        cls.bulk_edit_data = {",
            "            \"color\": \"00ff00\",",
            "        }",
            "",
            "    def test_create_tags_with_content_types(self):",
            "        self.add_permissions(\"extras.add_tag\")",
            "        site_content_type = ContentType.objects.get_for_model(Site)",
            "",
            "        form_data = {",
            "            **self.form_data,",
            "            \"content_types\": [site_content_type.id],",
            "        }",
            "",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(form_data),",
            "        }",
            "        self.assertHttpStatus(self.client.post(**request), 302)",
            "",
            "        tag = Tag.objects.filter(slug=self.form_data[\"slug\"])",
            "        self.assertTrue(tag.exists())",
            "        self.assertEqual(tag[0].content_types.first(), site_content_type)",
            "",
            "    def test_create_tags_with_invalid_content_types(self):",
            "        self.add_permissions(\"extras.add_tag\")",
            "        vlangroup_content_type = ContentType.objects.get_for_model(VLANGroup)",
            "",
            "        form_data = {",
            "            **self.form_data,",
            "            \"content_types\": [vlangroup_content_type.id],",
            "        }",
            "",
            "        request = {",
            "            \"path\": self._get_url(\"add\"),",
            "            \"data\": post_data(form_data),",
            "        }",
            "",
            "        response = self.client.post(**request)",
            "        tag = Tag.objects.filter(slug=self.form_data[\"slug\"])",
            "        self.assertFalse(tag.exists())",
            "        self.assertIn(\"content_types: Select a valid choice\", str(response.content))",
            "",
            "    def test_update_tags_remove_content_type(self):",
            "        \"\"\"Test removing a tag content_type that is been tagged to a model\"\"\"",
            "        self.add_permissions(\"extras.change_tag\")",
            "",
            "        tag_1 = Tag.objects.get_for_model(Site).first()",
            "        site = Site.objects.first()",
            "        site.tags.add(tag_1)",
            "",
            "        form_data = {",
            "            \"name\": tag_1.name,",
            "            \"slug\": tag_1.slug,",
            "            \"color\": \"c0c0c0\",",
            "            \"content_types\": [ContentType.objects.get_for_model(Device).id],",
            "        }",
            "",
            "        request = {",
            "            \"path\": self._get_url(\"edit\", tag_1),",
            "            \"data\": post_data(form_data),",
            "        }",
            "",
            "        response = self.client.post(**request)",
            "        self.assertHttpStatus(",
            "            response, 200, [\"content_types: Unable to remove dcim.site. Dependent objects were found.\"]",
            "        )",
            "",
            "",
            "class WebhookTestCase(",
            "    ViewTestCases.CreateObjectViewTestCase,",
            "    ViewTestCases.DeleteObjectViewTestCase,",
            "    ViewTestCases.EditObjectViewTestCase,",
            "    ViewTestCases.GetObjectViewTestCase,",
            "    ViewTestCases.GetObjectChangelogViewTestCase,",
            "    ViewTestCases.ListObjectsViewTestCase,",
            "):",
            "    model = Webhook",
            "",
            "    @classmethod",
            "    def setUpTestData(cls):",
            "        webhooks = (",
            "            Webhook(",
            "                name=\"webhook-1\",",
            "                enabled=True,",
            "                type_create=True,",
            "                payload_url=\"http://test-url.com/test-1\",",
            "                http_content_type=HTTP_CONTENT_TYPE_JSON,",
            "            ),",
            "            Webhook(",
            "                name=\"webhook-2\",",
            "                enabled=True,",
            "                type_update=True,",
            "                payload_url=\"http://test-url.com/test-2\",",
            "                http_content_type=HTTP_CONTENT_TYPE_JSON,",
            "            ),",
            "            Webhook(",
            "                name=\"webhook-3\",",
            "                enabled=True,",
            "                type_delete=True,",
            "                payload_url=\"http://test-url.com/test-3\",",
            "                http_content_type=HTTP_CONTENT_TYPE_JSON,",
            "            ),",
            "        )",
            "",
            "        obj_type = ContentType.objects.get_for_model(ConsolePort)",
            "",
            "        for webhook in webhooks:",
            "            webhook.save()",
            "            webhook.content_types.set([obj_type])",
            "",
            "        cls.form_data = {",
            "            \"name\": \"webhook-4\",",
            "            \"content_types\": [obj_type.pk],",
            "            \"enabled\": True,",
            "            \"type_create\": True,",
            "            \"payload_url\": \"http://test-url.com/test-4\",",
            "            \"http_method\": \"POST\",",
            "            \"http_content_type\": \"application/json\",",
            "        }"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "2015": [
                "JobButtonRenderingTestCase",
                "setUp"
            ],
            "2016": [
                "JobButtonRenderingTestCase",
                "setUp"
            ],
            "2021": [
                "JobButtonRenderingTestCase",
                "setUp"
            ],
            "2022": [
                "JobButtonRenderingTestCase",
                "setUp"
            ],
            "2034": [
                "JobButtonRenderingTestCase",
                "test_view_object_with_unsafe_text"
            ],
            "2035": [
                "JobButtonRenderingTestCase",
                "test_view_object_with_unsafe_text"
            ],
            "2043": [
                "JobButtonRenderingTestCase",
                "test_view_object_with_unsafe_text"
            ],
            "2044": [
                "JobButtonRenderingTestCase",
                "test_view_object_with_unsafe_text"
            ],
            "2053": [
                "JobButtonRenderingTestCase",
                "test_view_object_with_unsafe_name"
            ],
            "2054": [
                "JobButtonRenderingTestCase",
                "test_view_object_with_unsafe_name"
            ],
            "2055": [
                "JobButtonRenderingTestCase",
                "test_view_object_with_unsafe_name"
            ]
        },
        "addLocation": []
    },
    "nautobot/extras/urls.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 485,
                "afterPatchRowNumber": 485,
                "PatchRowcode": "         views.JobResultDeleteView.as_view(),"
            },
            "1": {
                "beforePatchRowNumber": 486,
                "afterPatchRowNumber": 486,
                "PatchRowcode": "         name=\"jobresult_delete\","
            },
            "2": {
                "beforePatchRowNumber": 487,
                "afterPatchRowNumber": 487,
                "PatchRowcode": "     ),"
            },
            "3": {
                "beforePatchRowNumber": 488,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    # Job Button Run"
            },
            "4": {
                "beforePatchRowNumber": 489,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    path(\"job-button/<uuid:pk>/run/\", views.JobButtonRunView.as_view(), name=\"jobbutton_run\"),"
            },
            "5": {
                "beforePatchRowNumber": 490,
                "afterPatchRowNumber": 488,
                "PatchRowcode": "     # Notes"
            },
            "6": {
                "beforePatchRowNumber": 491,
                "afterPatchRowNumber": 489,
                "PatchRowcode": "     path(\"notes/add/\", views.NoteEditView.as_view(), name=\"note_add\"),"
            },
            "7": {
                "beforePatchRowNumber": 492,
                "afterPatchRowNumber": 490,
                "PatchRowcode": "     path(\"notes/<slug:slug>/\", views.NoteView.as_view(), name=\"note\"),"
            }
        },
        "frontPatchFile": [
            "from django.urls import path",
            "from django.views.generic import RedirectView",
            "",
            "from nautobot.core.views.routers import NautobotUIViewSetRouter",
            "from nautobot.extras import views",
            "from nautobot.extras.models import (",
            "    ComputedField,",
            "    ConfigContext,",
            "    ConfigContextSchema,",
            "    CustomField,",
            "    CustomLink,",
            "    DynamicGroup,",
            "    ExportTemplate,",
            "    GitRepository,",
            "    GraphQLQuery,",
            "    Job,",
            "    JobHook,",
            "    Note,",
            "    Relationship,",
            "    Secret,",
            "    SecretsGroup,",
            "    Status,",
            "    Tag,",
            "    Webhook,",
            ")",
            "",
            "router = NautobotUIViewSetRouter()",
            "router.register(\"job-buttons\", views.JobButtonUIViewSet)",
            "",
            "app_name = \"extras\"",
            "urlpatterns = [",
            "    # Change logging",
            "    path(\"changelog/\", views.ObjectChangeListView.as_view(), name=\"objectchange_list\"),",
            "    path(\"changelog/<uuid:pk>/\", views.ObjectChangeView.as_view(), name=\"objectchange\"),",
            "    # Computed Fields",
            "    path(\"computed-fields/\", views.ComputedFieldListView.as_view(), name=\"computedfield_list\"),",
            "    path(\"computed-fields/add/\", views.ComputedFieldEditView.as_view(), name=\"computedfield_add\"),",
            "    path(",
            "        \"computed-fields/delete/\",",
            "        views.ComputedFieldBulkDeleteView.as_view(),",
            "        name=\"computedfield_bulk_delete\",",
            "    ),",
            "    path(\"computed-fields/<slug:slug>/\", views.ComputedFieldView.as_view(), name=\"computedfield\"),",
            "    path(",
            "        \"computed-fields/<slug:slug>/edit/\",",
            "        views.ComputedFieldEditView.as_view(),",
            "        name=\"computedfield_edit\",",
            "    ),",
            "    path(",
            "        \"computed-fields/<slug:slug>/delete/\",",
            "        views.ComputedFieldDeleteView.as_view(),",
            "        name=\"computedfield_delete\",",
            "    ),",
            "    path(",
            "        \"computed-fields/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"computedfield_changelog\",",
            "        kwargs={\"model\": ComputedField},",
            "    ),",
            "    path(",
            "        \"computed-fields/<slug:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"computedfield_notes\",",
            "        kwargs={\"model\": ComputedField},",
            "    ),",
            "    # Config contexts",
            "    path(",
            "        \"config-contexts/\",",
            "        views.ConfigContextListView.as_view(),",
            "        name=\"configcontext_list\",",
            "    ),",
            "    path(",
            "        \"config-contexts/add/\",",
            "        views.ConfigContextEditView.as_view(),",
            "        name=\"configcontext_add\",",
            "    ),",
            "    path(",
            "        \"config-contexts/edit/\",",
            "        views.ConfigContextBulkEditView.as_view(),",
            "        name=\"configcontext_bulk_edit\",",
            "    ),",
            "    path(",
            "        \"config-contexts/delete/\",",
            "        views.ConfigContextBulkDeleteView.as_view(),",
            "        name=\"configcontext_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/\",",
            "        views.ConfigContextView.as_view(),",
            "        name=\"configcontext\",",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/edit/\",",
            "        views.ConfigContextEditView.as_view(),",
            "        name=\"configcontext_edit\",",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/delete/\",",
            "        views.ConfigContextDeleteView.as_view(),",
            "        name=\"configcontext_delete\",",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"configcontext_changelog\",",
            "        kwargs={\"model\": ConfigContext},",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"configcontext_notes\",",
            "        kwargs={\"model\": ConfigContext},",
            "    ),",
            "    # Config context schema",
            "    path(",
            "        \"config-context-schemas/\",",
            "        views.ConfigContextSchemaListView.as_view(),",
            "        name=\"configcontextschema_list\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/add/\",",
            "        views.ConfigContextSchemaEditView.as_view(),",
            "        name=\"configcontextschema_add\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/edit/\",",
            "        views.ConfigContextSchemaBulkEditView.as_view(),",
            "        name=\"configcontextschema_bulk_edit\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/delete/\",",
            "        views.ConfigContextSchemaBulkDeleteView.as_view(),",
            "        name=\"configcontextschema_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/\",",
            "        views.ConfigContextSchemaView.as_view(),",
            "        name=\"configcontextschema\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/validation/\",",
            "        views.ConfigContextSchemaObjectValidationView.as_view(),",
            "        name=\"configcontextschema_object_validation\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/edit/\",",
            "        views.ConfigContextSchemaEditView.as_view(),",
            "        name=\"configcontextschema_edit\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/delete/\",",
            "        views.ConfigContextSchemaDeleteView.as_view(),",
            "        name=\"configcontextschema_delete\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"configcontextschema_changelog\",",
            "        kwargs={\"model\": ConfigContextSchema},",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"configcontextschema_notes\",",
            "        kwargs={\"model\": ConfigContextSchema},",
            "    ),",
            "    # Custom fields",
            "    path(\"custom-fields/\", views.CustomFieldListView.as_view(), name=\"customfield_list\"),",
            "    path(\"custom-fields/add/\", views.CustomFieldEditView.as_view(), name=\"customfield_add\"),",
            "    path(",
            "        \"custom-fields/delete/\",",
            "        views.CustomFieldBulkDeleteView.as_view(),",
            "        name=\"customfield_bulk_delete\",",
            "    ),",
            "    path(\"custom-fields/<slug:slug>/\", views.CustomFieldView.as_view(), name=\"customfield\"),",
            "    path(",
            "        \"custom-fields/<slug:slug>/edit/\",",
            "        views.CustomFieldEditView.as_view(),",
            "        name=\"customfield_edit\",",
            "    ),",
            "    path(",
            "        \"custom-fields/<slug:slug>/delete/\",",
            "        views.CustomFieldDeleteView.as_view(),",
            "        name=\"customfield_delete\",",
            "    ),",
            "    path(",
            "        \"custom-fields/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"customfield_changelog\",",
            "        kwargs={\"model\": CustomField},",
            "    ),",
            "    path(",
            "        \"custom-fields/<str:name>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"customfield_notes\",",
            "        kwargs={\"model\": CustomField},",
            "    ),",
            "    # Custom links",
            "    path(\"custom-links/\", views.CustomLinkListView.as_view(), name=\"customlink_list\"),",
            "    path(\"custom-links/add/\", views.CustomLinkEditView.as_view(), name=\"customlink_add\"),",
            "    path(",
            "        \"custom-links/delete/\",",
            "        views.CustomLinkBulkDeleteView.as_view(),",
            "        name=\"customlink_bulk_delete\",",
            "    ),",
            "    path(\"custom-links/<uuid:pk>/\", views.CustomLinkView.as_view(), name=\"customlink\"),",
            "    path(",
            "        \"custom-links/<uuid:pk>/edit/\",",
            "        views.CustomLinkEditView.as_view(),",
            "        name=\"customlink_edit\",",
            "    ),",
            "    path(",
            "        \"custom-links/<uuid:pk>/delete/\",",
            "        views.CustomLinkDeleteView.as_view(),",
            "        name=\"customlink_delete\",",
            "    ),",
            "    path(",
            "        \"custom-links/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"customlink_changelog\",",
            "        kwargs={\"model\": CustomLink},",
            "    ),",
            "    path(",
            "        \"custom-links/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"customlink_notes\",",
            "        kwargs={\"model\": CustomLink},",
            "    ),",
            "    # Dynamic Groups",
            "    path(\"dynamic-groups/\", views.DynamicGroupListView.as_view(), name=\"dynamicgroup_list\"),",
            "    path(\"dynamic-groups/add/\", views.DynamicGroupEditView.as_view(), name=\"dynamicgroup_add\"),",
            "    path(",
            "        \"dynamic-groups/delete/\",",
            "        views.DynamicGroupBulkDeleteView.as_view(),",
            "        name=\"dynamicgroup_bulk_delete\",",
            "    ),",
            "    path(\"dynamic-groups/<str:slug>/\", views.DynamicGroupView.as_view(), name=\"dynamicgroup\"),",
            "    path(\"dynamic-groups/<str:slug>/edit/\", views.DynamicGroupEditView.as_view(), name=\"dynamicgroup_edit\"),",
            "    path(\"dynamic-groups/<str:slug>/delete/\", views.DynamicGroupDeleteView.as_view(), name=\"dynamicgroup_delete\"),",
            "    path(",
            "        \"dynamic-groups/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"dynamicgroup_changelog\",",
            "        kwargs={\"model\": DynamicGroup},",
            "    ),",
            "    path(",
            "        \"dynamic-groups/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"dynamicgroup_notes\",",
            "        kwargs={\"model\": DynamicGroup},",
            "    ),",
            "    # Export Templates",
            "    path(",
            "        \"export-templates/\",",
            "        views.ExportTemplateListView.as_view(),",
            "        name=\"exporttemplate_list\",",
            "    ),",
            "    path(",
            "        \"export-templates/add/\",",
            "        views.ExportTemplateEditView.as_view(),",
            "        name=\"exporttemplate_add\",",
            "    ),",
            "    path(",
            "        \"export-templates/delete/\",",
            "        views.ExportTemplateBulkDeleteView.as_view(),",
            "        name=\"exporttemplate_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/\",",
            "        views.ExportTemplateView.as_view(),",
            "        name=\"exporttemplate\",",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/edit/\",",
            "        views.ExportTemplateEditView.as_view(),",
            "        name=\"exporttemplate_edit\",",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/delete/\",",
            "        views.ExportTemplateDeleteView.as_view(),",
            "        name=\"exporttemplate_delete\",",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"exporttemplate_changelog\",",
            "        kwargs={\"model\": ExportTemplate},",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"exporttemplate_notes\",",
            "        kwargs={\"model\": ExportTemplate},",
            "    ),",
            "    # Git repositories",
            "    path(",
            "        \"git-repositories/\",",
            "        views.GitRepositoryListView.as_view(),",
            "        name=\"gitrepository_list\",",
            "    ),",
            "    path(",
            "        \"git-repositories/add/\",",
            "        views.GitRepositoryEditView.as_view(),",
            "        name=\"gitrepository_add\",",
            "    ),",
            "    path(",
            "        \"git-repositories/delete/\",",
            "        views.GitRepositoryBulkDeleteView.as_view(),",
            "        name=\"gitrepository_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"git-repositories/edit/\",",
            "        views.GitRepositoryBulkEditView.as_view(),",
            "        name=\"gitrepository_bulk_edit\",",
            "    ),",
            "    path(",
            "        \"git-repositories/import/\",",
            "        views.GitRepositoryBulkImportView.as_view(),",
            "        name=\"gitrepository_import\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/\",",
            "        views.GitRepositoryView.as_view(),",
            "        name=\"gitrepository\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/edit/\",",
            "        views.GitRepositoryEditView.as_view(),",
            "        name=\"gitrepository_edit\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/delete/\",",
            "        views.GitRepositoryDeleteView.as_view(),",
            "        name=\"gitrepository_delete\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"gitrepository_changelog\",",
            "        kwargs={\"model\": GitRepository},",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"gitrepository_notes\",",
            "        kwargs={\"model\": GitRepository},",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/result/\",",
            "        views.GitRepositoryResultView.as_view(),",
            "        name=\"gitrepository_result\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/sync/\",",
            "        views.GitRepositorySyncView.as_view(),",
            "        name=\"gitrepository_sync\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/dry-run/\",",
            "        views.GitRepositoryDryRunView.as_view(),",
            "        name=\"gitrepository_dryrun\",",
            "    ),",
            "    # GraphQL Queries",
            "    path(\"graphql-queries/\", views.GraphQLQueryListView.as_view(), name=\"graphqlquery_list\"),",
            "    path(\"graphql-queries/add/\", views.GraphQLQueryEditView.as_view(), name=\"graphqlquery_add\"),",
            "    path(",
            "        \"graphql-queries/delete/\",",
            "        views.GraphQLQueryBulkDeleteView.as_view(),",
            "        name=\"GraphQLQuery_bulk_delete\",",
            "    ),",
            "    path(\"graphql-queries/<str:slug>/\", views.GraphQLQueryView.as_view(), name=\"graphqlquery\"),",
            "    path(",
            "        \"graphql-queries/<str:slug>/edit/\",",
            "        views.GraphQLQueryEditView.as_view(),",
            "        name=\"graphqlquery_edit\",",
            "    ),",
            "    path(",
            "        \"graphql-queries/<str:slug>/delete/\",",
            "        views.GraphQLQueryDeleteView.as_view(),",
            "        name=\"graphqlquery_delete\",",
            "    ),",
            "    path(",
            "        \"graphql-queries/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"graphqlquery_changelog\",",
            "        kwargs={\"model\": GraphQLQuery},",
            "    ),",
            "    path(",
            "        \"graphql-queries/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"graphqlquery_notes\",",
            "        kwargs={\"model\": GraphQLQuery},",
            "    ),",
            "    # Image attachments",
            "    path(",
            "        \"image-attachments/<uuid:pk>/edit/\",",
            "        views.ImageAttachmentEditView.as_view(),",
            "        name=\"imageattachment_edit\",",
            "    ),",
            "    path(",
            "        \"image-attachments/<uuid:pk>/delete/\",",
            "        views.ImageAttachmentDeleteView.as_view(),",
            "        name=\"imageattachment_delete\",",
            "    ),",
            "    # Jobs",
            "    path(\"jobs/\", views.JobListView.as_view(), name=\"job_list\"),",
            "    path(",
            "        \"jobs/results/<uuid:pk>/\",",
            "        RedirectView.as_view(pattern_name=\"extras:jobresult\"),",
            "        name=\"job_jobresult\",",
            "    ),  # 2.0 TODO(jathan): Remove this, no existing code references `job_jobresult` but plugins and others may.",
            "    path(\"jobs/scheduled-jobs/\", views.ScheduledJobListView.as_view(), name=\"scheduledjob_list\"),",
            "    path(\"jobs/scheduled-jobs/<uuid:pk>/\", views.ScheduledJobView.as_view(), name=\"scheduledjob\"),",
            "    path(\"jobs/scheduled-jobs/<uuid:pk>/delete/\", views.ScheduledJobDeleteView.as_view(), name=\"scheduledjob_delete\"),",
            "    path(",
            "        \"jobs/scheduled-jobs/delete/\",",
            "        views.ScheduledJobBulkDeleteView.as_view(),",
            "        name=\"scheduledjob_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"jobs/scheduled-jobs/approval-queue/\",",
            "        views.ScheduledJobApprovalQueueListView.as_view(),",
            "        name=\"scheduledjob_approval_queue_list\",",
            "    ),",
            "    path(",
            "        \"jobs/scheduled-jobs/approval-queue/<uuid:pk>/\",",
            "        views.JobApprovalRequestView.as_view(),",
            "        name=\"scheduledjob_approval_request_view\",",
            "    ),",
            "    # 2.0 TODO: JobDetailView should be just JobView, but see below",
            "    path(",
            "        \"jobs/<slug:slug>/\",",
            "        views.JobDetailView.as_view(),",
            "        name=\"job_detail\",  # 2.0 TODO: name=\"job\",",
            "    ),",
            "    path(\"jobs/<slug:slug>/edit/\", views.JobEditView.as_view(), name=\"job_edit\"),",
            "    path(\"jobs/<slug:slug>/delete/\", views.JobDeleteView.as_view(), name=\"job_delete\"),",
            "    path(",
            "        \"jobs/<slug:slug>/changelog/\",",
            "        views.JobObjectChangeLogView.as_view(),",
            "        name=\"job_changelog\",",
            "        kwargs={\"model\": Job},",
            "    ),",
            "    path(",
            "        \"jobs/<slug:slug>/notes/\",",
            "        views.JobObjectNotesView.as_view(),",
            "        name=\"job_notes\",",
            "        kwargs={\"model\": Job},",
            "    ),",
            "    # 2.0 TODO: JobView should actually be JobRunView, but keeping it as-is for backwards compatibility",
            "    path(\"jobs/<slug:slug>/run/\", views.JobView.as_view(), name=\"job_run\"),",
            "    path(\"jobs/<path:class_path>/\", views.JobView.as_view(), name=\"job\"),",
            "    # Job hooks",
            "    path(\"job-hooks/\", views.JobHookListView.as_view(), name=\"jobhook_list\"),",
            "    path(\"job-hooks/add/\", views.JobHookEditView.as_view(), name=\"jobhook_add\"),",
            "    path(",
            "        \"job-hooks/delete/\",",
            "        views.JobHookBulkDeleteView.as_view(),",
            "        name=\"jobhook_bulk_delete\",",
            "    ),",
            "    path(\"job-hooks/<str:slug>/\", views.JobHookView.as_view(), name=\"jobhook\"),",
            "    path(\"job-hooks/<str:slug>/edit/\", views.JobHookEditView.as_view(), name=\"jobhook_edit\"),",
            "    path(",
            "        \"job-hooks/<str:slug>/delete/\",",
            "        views.JobHookDeleteView.as_view(),",
            "        name=\"jobhook_delete\",",
            "    ),",
            "    path(",
            "        \"job-hooks/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"jobhook_changelog\",",
            "        kwargs={\"model\": JobHook},",
            "    ),",
            "    # Generic job results",
            "    path(\"job-results/\", views.JobResultListView.as_view(), name=\"jobresult_list\"),",
            "    path(\"job-results/<uuid:pk>/\", views.JobResultView.as_view(), name=\"jobresult\"),",
            "    path(\"job-results/<uuid:pk>/log-table/\", views.JobLogEntryTableView.as_view(), name=\"jobresult_log-table\"),",
            "    path(",
            "        \"job-results/delete/\",",
            "        views.JobResultBulkDeleteView.as_view(),",
            "        name=\"jobresult_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"job-results/<uuid:pk>/delete/\",",
            "        views.JobResultDeleteView.as_view(),",
            "        name=\"jobresult_delete\",",
            "    ),",
            "    # Job Button Run",
            "    path(\"job-button/<uuid:pk>/run/\", views.JobButtonRunView.as_view(), name=\"jobbutton_run\"),",
            "    # Notes",
            "    path(\"notes/add/\", views.NoteEditView.as_view(), name=\"note_add\"),",
            "    path(\"notes/<slug:slug>/\", views.NoteView.as_view(), name=\"note\"),",
            "    path(",
            "        \"notes/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"note_changelog\",",
            "        kwargs={\"model\": Note},",
            "    ),",
            "    path(\"notes/<slug:slug>/edit/\", views.NoteEditView.as_view(), name=\"note_edit\"),",
            "    path(\"notes/<slug:slug>/delete/\", views.NoteDeleteView.as_view(), name=\"note_delete\"),",
            "    # Custom relationships",
            "    path(\"relationships/\", views.RelationshipListView.as_view(), name=\"relationship_list\"),",
            "    path(",
            "        \"relationships/add/\",",
            "        views.RelationshipEditView.as_view(),",
            "        name=\"relationship_add\",",
            "    ),",
            "    path(",
            "        \"relationships/delete/\",",
            "        views.RelationshipBulkDeleteView.as_view(),",
            "        name=\"relationship_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/\",",
            "        views.RelationshipView.as_view(),",
            "        name=\"relationship\",",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/edit/\",",
            "        views.RelationshipEditView.as_view(),",
            "        name=\"relationship_edit\",",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/delete/\",",
            "        views.RelationshipDeleteView.as_view(),",
            "        name=\"relationship_delete\",",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"relationship_changelog\",",
            "        kwargs={\"model\": Relationship},",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"relationship_notes\",",
            "        kwargs={\"model\": Relationship},",
            "    ),",
            "    path(",
            "        \"relationship-associations/\",",
            "        views.RelationshipAssociationListView.as_view(),",
            "        name=\"relationshipassociation_list\",",
            "    ),",
            "    path(",
            "        \"relationship-associations/delete/\",",
            "        views.RelationshipAssociationBulkDeleteView.as_view(),",
            "        name=\"relationshipassociation_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"relationship-associations/<uuid:pk>/delete/\",",
            "        views.RelationshipAssociationDeleteView.as_view(),",
            "        name=\"relationshipassociation_delete\",",
            "    ),",
            "    # Secrets",
            "    path(\"secrets/\", views.SecretListView.as_view(), name=\"secret_list\"),",
            "    path(\"secrets/add/\", views.SecretEditView.as_view(), name=\"secret_add\"),",
            "    path(\"secrets/delete/\", views.SecretBulkDeleteView.as_view(), name=\"secret_bulk_delete\"),",
            "    path(\"secrets/import/\", views.SecretBulkImportView.as_view(), name=\"secret_import\"),",
            "    path(",
            "        \"secrets/provider/<str:provider_slug>/form/\",",
            "        views.SecretProviderParametersFormView.as_view(),",
            "        name=\"secret_provider_parameters_form\",",
            "    ),",
            "    path(\"secrets/<str:slug>/\", views.SecretView.as_view(), name=\"secret\"),",
            "    path(\"secrets/<str:slug>/edit/\", views.SecretEditView.as_view(), name=\"secret_edit\"),",
            "    path(\"secrets/<str:slug>/delete/\", views.SecretDeleteView.as_view(), name=\"secret_delete\"),",
            "    path(",
            "        \"secrets/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"secret_changelog\",",
            "        kwargs={\"model\": Secret},",
            "    ),",
            "    path(",
            "        \"secrets/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"secret_notes\",",
            "        kwargs={\"model\": Secret},",
            "    ),",
            "    path(\"secrets-groups/\", views.SecretsGroupListView.as_view(), name=\"secretsgroup_list\"),",
            "    path(\"secrets-groups/add/\", views.SecretsGroupEditView.as_view(), name=\"secretsgroup_add\"),",
            "    path(\"secrets-groups/delete/\", views.SecretsGroupBulkDeleteView.as_view(), name=\"secretsgroup_bulk_delete\"),",
            "    path(\"secrets-groups/<str:slug>/\", views.SecretsGroupView.as_view(), name=\"secretsgroup\"),",
            "    path(\"secrets-groups/<str:slug>/edit/\", views.SecretsGroupEditView.as_view(), name=\"secretsgroup_edit\"),",
            "    path(\"secrets-groups/<str:slug>/delete/\", views.SecretsGroupDeleteView.as_view(), name=\"secretsgroup_delete\"),",
            "    path(",
            "        \"secrets-groups/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"secretsgroup_changelog\",",
            "        kwargs={\"model\": SecretsGroup},",
            "    ),",
            "    path(",
            "        \"secrets-groups/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"secretsgroup_notes\",",
            "        kwargs={\"model\": SecretsGroup},",
            "    ),",
            "    # Custom statuses",
            "    path(\"statuses/\", views.StatusListView.as_view(), name=\"status_list\"),",
            "    path(\"statuses/add/\", views.StatusEditView.as_view(), name=\"status_add\"),",
            "    path(\"statuses/edit/\", views.StatusBulkEditView.as_view(), name=\"status_bulk_edit\"),",
            "    path(",
            "        \"statuses/delete/\",",
            "        views.StatusBulkDeleteView.as_view(),",
            "        name=\"status_bulk_delete\",",
            "    ),",
            "    path(\"statuses/import/\", views.StatusBulkImportView.as_view(), name=\"status_import\"),",
            "    path(\"statuses/<str:slug>/\", views.StatusView.as_view(), name=\"status\"),",
            "    path(\"statuses/<str:slug>/edit/\", views.StatusEditView.as_view(), name=\"status_edit\"),",
            "    path(",
            "        \"statuses/<str:slug>/delete/\",",
            "        views.StatusDeleteView.as_view(),",
            "        name=\"status_delete\",",
            "    ),",
            "    path(",
            "        \"statuses/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"status_changelog\",",
            "        kwargs={\"model\": Status},",
            "    ),",
            "    path(",
            "        \"statuses/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"status_notes\",",
            "        kwargs={\"model\": Status},",
            "    ),",
            "    # Tags",
            "    path(\"tags/\", views.TagListView.as_view(), name=\"tag_list\"),",
            "    path(\"tags/add/\", views.TagEditView.as_view(), name=\"tag_add\"),",
            "    path(\"tags/import/\", views.TagBulkImportView.as_view(), name=\"tag_import\"),",
            "    path(\"tags/edit/\", views.TagBulkEditView.as_view(), name=\"tag_bulk_edit\"),",
            "    path(\"tags/delete/\", views.TagBulkDeleteView.as_view(), name=\"tag_bulk_delete\"),",
            "    path(\"tags/<str:slug>/\", views.TagView.as_view(), name=\"tag\"),",
            "    path(\"tags/<str:slug>/edit/\", views.TagEditView.as_view(), name=\"tag_edit\"),",
            "    path(\"tags/<str:slug>/delete/\", views.TagDeleteView.as_view(), name=\"tag_delete\"),",
            "    path(",
            "        \"tags/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"tag_changelog\",",
            "        kwargs={\"model\": Tag},",
            "    ),",
            "    path(",
            "        \"tags/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"tag_notes\",",
            "        kwargs={\"model\": Tag},",
            "    ),",
            "    # Webhook",
            "    path(\"webhooks/\", views.WebhookListView.as_view(), name=\"webhook_list\"),",
            "    path(\"webhooks/add/\", views.WebhookEditView.as_view(), name=\"webhook_add\"),",
            "    path(",
            "        \"webhooks/delete/\",",
            "        views.WebhookBulkDeleteView.as_view(),",
            "        name=\"webhook_bulk_delete\",",
            "    ),",
            "    path(\"webhooks/<uuid:pk>/\", views.WebhookView.as_view(), name=\"webhook\"),",
            "    path(\"webhooks/<uuid:pk>/edit/\", views.WebhookEditView.as_view(), name=\"webhook_edit\"),",
            "    path(",
            "        \"webhooks/<uuid:pk>/delete/\",",
            "        views.WebhookDeleteView.as_view(),",
            "        name=\"webhook_delete\",",
            "    ),",
            "    path(",
            "        \"webhooks/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"webhook_changelog\",",
            "        kwargs={\"model\": Webhook},",
            "    ),",
            "    path(",
            "        \"webhooks/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"webhook_notes\",",
            "        kwargs={\"model\": Webhook},",
            "    ),",
            "]",
            "urlpatterns += router.urls"
        ],
        "afterPatchFile": [
            "from django.urls import path",
            "from django.views.generic import RedirectView",
            "",
            "from nautobot.core.views.routers import NautobotUIViewSetRouter",
            "from nautobot.extras import views",
            "from nautobot.extras.models import (",
            "    ComputedField,",
            "    ConfigContext,",
            "    ConfigContextSchema,",
            "    CustomField,",
            "    CustomLink,",
            "    DynamicGroup,",
            "    ExportTemplate,",
            "    GitRepository,",
            "    GraphQLQuery,",
            "    Job,",
            "    JobHook,",
            "    Note,",
            "    Relationship,",
            "    Secret,",
            "    SecretsGroup,",
            "    Status,",
            "    Tag,",
            "    Webhook,",
            ")",
            "",
            "router = NautobotUIViewSetRouter()",
            "router.register(\"job-buttons\", views.JobButtonUIViewSet)",
            "",
            "app_name = \"extras\"",
            "urlpatterns = [",
            "    # Change logging",
            "    path(\"changelog/\", views.ObjectChangeListView.as_view(), name=\"objectchange_list\"),",
            "    path(\"changelog/<uuid:pk>/\", views.ObjectChangeView.as_view(), name=\"objectchange\"),",
            "    # Computed Fields",
            "    path(\"computed-fields/\", views.ComputedFieldListView.as_view(), name=\"computedfield_list\"),",
            "    path(\"computed-fields/add/\", views.ComputedFieldEditView.as_view(), name=\"computedfield_add\"),",
            "    path(",
            "        \"computed-fields/delete/\",",
            "        views.ComputedFieldBulkDeleteView.as_view(),",
            "        name=\"computedfield_bulk_delete\",",
            "    ),",
            "    path(\"computed-fields/<slug:slug>/\", views.ComputedFieldView.as_view(), name=\"computedfield\"),",
            "    path(",
            "        \"computed-fields/<slug:slug>/edit/\",",
            "        views.ComputedFieldEditView.as_view(),",
            "        name=\"computedfield_edit\",",
            "    ),",
            "    path(",
            "        \"computed-fields/<slug:slug>/delete/\",",
            "        views.ComputedFieldDeleteView.as_view(),",
            "        name=\"computedfield_delete\",",
            "    ),",
            "    path(",
            "        \"computed-fields/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"computedfield_changelog\",",
            "        kwargs={\"model\": ComputedField},",
            "    ),",
            "    path(",
            "        \"computed-fields/<slug:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"computedfield_notes\",",
            "        kwargs={\"model\": ComputedField},",
            "    ),",
            "    # Config contexts",
            "    path(",
            "        \"config-contexts/\",",
            "        views.ConfigContextListView.as_view(),",
            "        name=\"configcontext_list\",",
            "    ),",
            "    path(",
            "        \"config-contexts/add/\",",
            "        views.ConfigContextEditView.as_view(),",
            "        name=\"configcontext_add\",",
            "    ),",
            "    path(",
            "        \"config-contexts/edit/\",",
            "        views.ConfigContextBulkEditView.as_view(),",
            "        name=\"configcontext_bulk_edit\",",
            "    ),",
            "    path(",
            "        \"config-contexts/delete/\",",
            "        views.ConfigContextBulkDeleteView.as_view(),",
            "        name=\"configcontext_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/\",",
            "        views.ConfigContextView.as_view(),",
            "        name=\"configcontext\",",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/edit/\",",
            "        views.ConfigContextEditView.as_view(),",
            "        name=\"configcontext_edit\",",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/delete/\",",
            "        views.ConfigContextDeleteView.as_view(),",
            "        name=\"configcontext_delete\",",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"configcontext_changelog\",",
            "        kwargs={\"model\": ConfigContext},",
            "    ),",
            "    path(",
            "        \"config-contexts/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"configcontext_notes\",",
            "        kwargs={\"model\": ConfigContext},",
            "    ),",
            "    # Config context schema",
            "    path(",
            "        \"config-context-schemas/\",",
            "        views.ConfigContextSchemaListView.as_view(),",
            "        name=\"configcontextschema_list\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/add/\",",
            "        views.ConfigContextSchemaEditView.as_view(),",
            "        name=\"configcontextschema_add\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/edit/\",",
            "        views.ConfigContextSchemaBulkEditView.as_view(),",
            "        name=\"configcontextschema_bulk_edit\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/delete/\",",
            "        views.ConfigContextSchemaBulkDeleteView.as_view(),",
            "        name=\"configcontextschema_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/\",",
            "        views.ConfigContextSchemaView.as_view(),",
            "        name=\"configcontextschema\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/validation/\",",
            "        views.ConfigContextSchemaObjectValidationView.as_view(),",
            "        name=\"configcontextschema_object_validation\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/edit/\",",
            "        views.ConfigContextSchemaEditView.as_view(),",
            "        name=\"configcontextschema_edit\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/delete/\",",
            "        views.ConfigContextSchemaDeleteView.as_view(),",
            "        name=\"configcontextschema_delete\",",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"configcontextschema_changelog\",",
            "        kwargs={\"model\": ConfigContextSchema},",
            "    ),",
            "    path(",
            "        \"config-context-schemas/<slug:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"configcontextschema_notes\",",
            "        kwargs={\"model\": ConfigContextSchema},",
            "    ),",
            "    # Custom fields",
            "    path(\"custom-fields/\", views.CustomFieldListView.as_view(), name=\"customfield_list\"),",
            "    path(\"custom-fields/add/\", views.CustomFieldEditView.as_view(), name=\"customfield_add\"),",
            "    path(",
            "        \"custom-fields/delete/\",",
            "        views.CustomFieldBulkDeleteView.as_view(),",
            "        name=\"customfield_bulk_delete\",",
            "    ),",
            "    path(\"custom-fields/<slug:slug>/\", views.CustomFieldView.as_view(), name=\"customfield\"),",
            "    path(",
            "        \"custom-fields/<slug:slug>/edit/\",",
            "        views.CustomFieldEditView.as_view(),",
            "        name=\"customfield_edit\",",
            "    ),",
            "    path(",
            "        \"custom-fields/<slug:slug>/delete/\",",
            "        views.CustomFieldDeleteView.as_view(),",
            "        name=\"customfield_delete\",",
            "    ),",
            "    path(",
            "        \"custom-fields/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"customfield_changelog\",",
            "        kwargs={\"model\": CustomField},",
            "    ),",
            "    path(",
            "        \"custom-fields/<str:name>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"customfield_notes\",",
            "        kwargs={\"model\": CustomField},",
            "    ),",
            "    # Custom links",
            "    path(\"custom-links/\", views.CustomLinkListView.as_view(), name=\"customlink_list\"),",
            "    path(\"custom-links/add/\", views.CustomLinkEditView.as_view(), name=\"customlink_add\"),",
            "    path(",
            "        \"custom-links/delete/\",",
            "        views.CustomLinkBulkDeleteView.as_view(),",
            "        name=\"customlink_bulk_delete\",",
            "    ),",
            "    path(\"custom-links/<uuid:pk>/\", views.CustomLinkView.as_view(), name=\"customlink\"),",
            "    path(",
            "        \"custom-links/<uuid:pk>/edit/\",",
            "        views.CustomLinkEditView.as_view(),",
            "        name=\"customlink_edit\",",
            "    ),",
            "    path(",
            "        \"custom-links/<uuid:pk>/delete/\",",
            "        views.CustomLinkDeleteView.as_view(),",
            "        name=\"customlink_delete\",",
            "    ),",
            "    path(",
            "        \"custom-links/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"customlink_changelog\",",
            "        kwargs={\"model\": CustomLink},",
            "    ),",
            "    path(",
            "        \"custom-links/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"customlink_notes\",",
            "        kwargs={\"model\": CustomLink},",
            "    ),",
            "    # Dynamic Groups",
            "    path(\"dynamic-groups/\", views.DynamicGroupListView.as_view(), name=\"dynamicgroup_list\"),",
            "    path(\"dynamic-groups/add/\", views.DynamicGroupEditView.as_view(), name=\"dynamicgroup_add\"),",
            "    path(",
            "        \"dynamic-groups/delete/\",",
            "        views.DynamicGroupBulkDeleteView.as_view(),",
            "        name=\"dynamicgroup_bulk_delete\",",
            "    ),",
            "    path(\"dynamic-groups/<str:slug>/\", views.DynamicGroupView.as_view(), name=\"dynamicgroup\"),",
            "    path(\"dynamic-groups/<str:slug>/edit/\", views.DynamicGroupEditView.as_view(), name=\"dynamicgroup_edit\"),",
            "    path(\"dynamic-groups/<str:slug>/delete/\", views.DynamicGroupDeleteView.as_view(), name=\"dynamicgroup_delete\"),",
            "    path(",
            "        \"dynamic-groups/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"dynamicgroup_changelog\",",
            "        kwargs={\"model\": DynamicGroup},",
            "    ),",
            "    path(",
            "        \"dynamic-groups/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"dynamicgroup_notes\",",
            "        kwargs={\"model\": DynamicGroup},",
            "    ),",
            "    # Export Templates",
            "    path(",
            "        \"export-templates/\",",
            "        views.ExportTemplateListView.as_view(),",
            "        name=\"exporttemplate_list\",",
            "    ),",
            "    path(",
            "        \"export-templates/add/\",",
            "        views.ExportTemplateEditView.as_view(),",
            "        name=\"exporttemplate_add\",",
            "    ),",
            "    path(",
            "        \"export-templates/delete/\",",
            "        views.ExportTemplateBulkDeleteView.as_view(),",
            "        name=\"exporttemplate_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/\",",
            "        views.ExportTemplateView.as_view(),",
            "        name=\"exporttemplate\",",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/edit/\",",
            "        views.ExportTemplateEditView.as_view(),",
            "        name=\"exporttemplate_edit\",",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/delete/\",",
            "        views.ExportTemplateDeleteView.as_view(),",
            "        name=\"exporttemplate_delete\",",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"exporttemplate_changelog\",",
            "        kwargs={\"model\": ExportTemplate},",
            "    ),",
            "    path(",
            "        \"export-templates/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"exporttemplate_notes\",",
            "        kwargs={\"model\": ExportTemplate},",
            "    ),",
            "    # Git repositories",
            "    path(",
            "        \"git-repositories/\",",
            "        views.GitRepositoryListView.as_view(),",
            "        name=\"gitrepository_list\",",
            "    ),",
            "    path(",
            "        \"git-repositories/add/\",",
            "        views.GitRepositoryEditView.as_view(),",
            "        name=\"gitrepository_add\",",
            "    ),",
            "    path(",
            "        \"git-repositories/delete/\",",
            "        views.GitRepositoryBulkDeleteView.as_view(),",
            "        name=\"gitrepository_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"git-repositories/edit/\",",
            "        views.GitRepositoryBulkEditView.as_view(),",
            "        name=\"gitrepository_bulk_edit\",",
            "    ),",
            "    path(",
            "        \"git-repositories/import/\",",
            "        views.GitRepositoryBulkImportView.as_view(),",
            "        name=\"gitrepository_import\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/\",",
            "        views.GitRepositoryView.as_view(),",
            "        name=\"gitrepository\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/edit/\",",
            "        views.GitRepositoryEditView.as_view(),",
            "        name=\"gitrepository_edit\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/delete/\",",
            "        views.GitRepositoryDeleteView.as_view(),",
            "        name=\"gitrepository_delete\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"gitrepository_changelog\",",
            "        kwargs={\"model\": GitRepository},",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"gitrepository_notes\",",
            "        kwargs={\"model\": GitRepository},",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/result/\",",
            "        views.GitRepositoryResultView.as_view(),",
            "        name=\"gitrepository_result\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/sync/\",",
            "        views.GitRepositorySyncView.as_view(),",
            "        name=\"gitrepository_sync\",",
            "    ),",
            "    path(",
            "        \"git-repositories/<str:slug>/dry-run/\",",
            "        views.GitRepositoryDryRunView.as_view(),",
            "        name=\"gitrepository_dryrun\",",
            "    ),",
            "    # GraphQL Queries",
            "    path(\"graphql-queries/\", views.GraphQLQueryListView.as_view(), name=\"graphqlquery_list\"),",
            "    path(\"graphql-queries/add/\", views.GraphQLQueryEditView.as_view(), name=\"graphqlquery_add\"),",
            "    path(",
            "        \"graphql-queries/delete/\",",
            "        views.GraphQLQueryBulkDeleteView.as_view(),",
            "        name=\"GraphQLQuery_bulk_delete\",",
            "    ),",
            "    path(\"graphql-queries/<str:slug>/\", views.GraphQLQueryView.as_view(), name=\"graphqlquery\"),",
            "    path(",
            "        \"graphql-queries/<str:slug>/edit/\",",
            "        views.GraphQLQueryEditView.as_view(),",
            "        name=\"graphqlquery_edit\",",
            "    ),",
            "    path(",
            "        \"graphql-queries/<str:slug>/delete/\",",
            "        views.GraphQLQueryDeleteView.as_view(),",
            "        name=\"graphqlquery_delete\",",
            "    ),",
            "    path(",
            "        \"graphql-queries/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"graphqlquery_changelog\",",
            "        kwargs={\"model\": GraphQLQuery},",
            "    ),",
            "    path(",
            "        \"graphql-queries/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"graphqlquery_notes\",",
            "        kwargs={\"model\": GraphQLQuery},",
            "    ),",
            "    # Image attachments",
            "    path(",
            "        \"image-attachments/<uuid:pk>/edit/\",",
            "        views.ImageAttachmentEditView.as_view(),",
            "        name=\"imageattachment_edit\",",
            "    ),",
            "    path(",
            "        \"image-attachments/<uuid:pk>/delete/\",",
            "        views.ImageAttachmentDeleteView.as_view(),",
            "        name=\"imageattachment_delete\",",
            "    ),",
            "    # Jobs",
            "    path(\"jobs/\", views.JobListView.as_view(), name=\"job_list\"),",
            "    path(",
            "        \"jobs/results/<uuid:pk>/\",",
            "        RedirectView.as_view(pattern_name=\"extras:jobresult\"),",
            "        name=\"job_jobresult\",",
            "    ),  # 2.0 TODO(jathan): Remove this, no existing code references `job_jobresult` but plugins and others may.",
            "    path(\"jobs/scheduled-jobs/\", views.ScheduledJobListView.as_view(), name=\"scheduledjob_list\"),",
            "    path(\"jobs/scheduled-jobs/<uuid:pk>/\", views.ScheduledJobView.as_view(), name=\"scheduledjob\"),",
            "    path(\"jobs/scheduled-jobs/<uuid:pk>/delete/\", views.ScheduledJobDeleteView.as_view(), name=\"scheduledjob_delete\"),",
            "    path(",
            "        \"jobs/scheduled-jobs/delete/\",",
            "        views.ScheduledJobBulkDeleteView.as_view(),",
            "        name=\"scheduledjob_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"jobs/scheduled-jobs/approval-queue/\",",
            "        views.ScheduledJobApprovalQueueListView.as_view(),",
            "        name=\"scheduledjob_approval_queue_list\",",
            "    ),",
            "    path(",
            "        \"jobs/scheduled-jobs/approval-queue/<uuid:pk>/\",",
            "        views.JobApprovalRequestView.as_view(),",
            "        name=\"scheduledjob_approval_request_view\",",
            "    ),",
            "    # 2.0 TODO: JobDetailView should be just JobView, but see below",
            "    path(",
            "        \"jobs/<slug:slug>/\",",
            "        views.JobDetailView.as_view(),",
            "        name=\"job_detail\",  # 2.0 TODO: name=\"job\",",
            "    ),",
            "    path(\"jobs/<slug:slug>/edit/\", views.JobEditView.as_view(), name=\"job_edit\"),",
            "    path(\"jobs/<slug:slug>/delete/\", views.JobDeleteView.as_view(), name=\"job_delete\"),",
            "    path(",
            "        \"jobs/<slug:slug>/changelog/\",",
            "        views.JobObjectChangeLogView.as_view(),",
            "        name=\"job_changelog\",",
            "        kwargs={\"model\": Job},",
            "    ),",
            "    path(",
            "        \"jobs/<slug:slug>/notes/\",",
            "        views.JobObjectNotesView.as_view(),",
            "        name=\"job_notes\",",
            "        kwargs={\"model\": Job},",
            "    ),",
            "    # 2.0 TODO: JobView should actually be JobRunView, but keeping it as-is for backwards compatibility",
            "    path(\"jobs/<slug:slug>/run/\", views.JobView.as_view(), name=\"job_run\"),",
            "    path(\"jobs/<path:class_path>/\", views.JobView.as_view(), name=\"job\"),",
            "    # Job hooks",
            "    path(\"job-hooks/\", views.JobHookListView.as_view(), name=\"jobhook_list\"),",
            "    path(\"job-hooks/add/\", views.JobHookEditView.as_view(), name=\"jobhook_add\"),",
            "    path(",
            "        \"job-hooks/delete/\",",
            "        views.JobHookBulkDeleteView.as_view(),",
            "        name=\"jobhook_bulk_delete\",",
            "    ),",
            "    path(\"job-hooks/<str:slug>/\", views.JobHookView.as_view(), name=\"jobhook\"),",
            "    path(\"job-hooks/<str:slug>/edit/\", views.JobHookEditView.as_view(), name=\"jobhook_edit\"),",
            "    path(",
            "        \"job-hooks/<str:slug>/delete/\",",
            "        views.JobHookDeleteView.as_view(),",
            "        name=\"jobhook_delete\",",
            "    ),",
            "    path(",
            "        \"job-hooks/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"jobhook_changelog\",",
            "        kwargs={\"model\": JobHook},",
            "    ),",
            "    # Generic job results",
            "    path(\"job-results/\", views.JobResultListView.as_view(), name=\"jobresult_list\"),",
            "    path(\"job-results/<uuid:pk>/\", views.JobResultView.as_view(), name=\"jobresult\"),",
            "    path(\"job-results/<uuid:pk>/log-table/\", views.JobLogEntryTableView.as_view(), name=\"jobresult_log-table\"),",
            "    path(",
            "        \"job-results/delete/\",",
            "        views.JobResultBulkDeleteView.as_view(),",
            "        name=\"jobresult_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"job-results/<uuid:pk>/delete/\",",
            "        views.JobResultDeleteView.as_view(),",
            "        name=\"jobresult_delete\",",
            "    ),",
            "    # Notes",
            "    path(\"notes/add/\", views.NoteEditView.as_view(), name=\"note_add\"),",
            "    path(\"notes/<slug:slug>/\", views.NoteView.as_view(), name=\"note\"),",
            "    path(",
            "        \"notes/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"note_changelog\",",
            "        kwargs={\"model\": Note},",
            "    ),",
            "    path(\"notes/<slug:slug>/edit/\", views.NoteEditView.as_view(), name=\"note_edit\"),",
            "    path(\"notes/<slug:slug>/delete/\", views.NoteDeleteView.as_view(), name=\"note_delete\"),",
            "    # Custom relationships",
            "    path(\"relationships/\", views.RelationshipListView.as_view(), name=\"relationship_list\"),",
            "    path(",
            "        \"relationships/add/\",",
            "        views.RelationshipEditView.as_view(),",
            "        name=\"relationship_add\",",
            "    ),",
            "    path(",
            "        \"relationships/delete/\",",
            "        views.RelationshipBulkDeleteView.as_view(),",
            "        name=\"relationship_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/\",",
            "        views.RelationshipView.as_view(),",
            "        name=\"relationship\",",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/edit/\",",
            "        views.RelationshipEditView.as_view(),",
            "        name=\"relationship_edit\",",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/delete/\",",
            "        views.RelationshipDeleteView.as_view(),",
            "        name=\"relationship_delete\",",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"relationship_changelog\",",
            "        kwargs={\"model\": Relationship},",
            "    ),",
            "    path(",
            "        \"relationships/<slug:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"relationship_notes\",",
            "        kwargs={\"model\": Relationship},",
            "    ),",
            "    path(",
            "        \"relationship-associations/\",",
            "        views.RelationshipAssociationListView.as_view(),",
            "        name=\"relationshipassociation_list\",",
            "    ),",
            "    path(",
            "        \"relationship-associations/delete/\",",
            "        views.RelationshipAssociationBulkDeleteView.as_view(),",
            "        name=\"relationshipassociation_bulk_delete\",",
            "    ),",
            "    path(",
            "        \"relationship-associations/<uuid:pk>/delete/\",",
            "        views.RelationshipAssociationDeleteView.as_view(),",
            "        name=\"relationshipassociation_delete\",",
            "    ),",
            "    # Secrets",
            "    path(\"secrets/\", views.SecretListView.as_view(), name=\"secret_list\"),",
            "    path(\"secrets/add/\", views.SecretEditView.as_view(), name=\"secret_add\"),",
            "    path(\"secrets/delete/\", views.SecretBulkDeleteView.as_view(), name=\"secret_bulk_delete\"),",
            "    path(\"secrets/import/\", views.SecretBulkImportView.as_view(), name=\"secret_import\"),",
            "    path(",
            "        \"secrets/provider/<str:provider_slug>/form/\",",
            "        views.SecretProviderParametersFormView.as_view(),",
            "        name=\"secret_provider_parameters_form\",",
            "    ),",
            "    path(\"secrets/<str:slug>/\", views.SecretView.as_view(), name=\"secret\"),",
            "    path(\"secrets/<str:slug>/edit/\", views.SecretEditView.as_view(), name=\"secret_edit\"),",
            "    path(\"secrets/<str:slug>/delete/\", views.SecretDeleteView.as_view(), name=\"secret_delete\"),",
            "    path(",
            "        \"secrets/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"secret_changelog\",",
            "        kwargs={\"model\": Secret},",
            "    ),",
            "    path(",
            "        \"secrets/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"secret_notes\",",
            "        kwargs={\"model\": Secret},",
            "    ),",
            "    path(\"secrets-groups/\", views.SecretsGroupListView.as_view(), name=\"secretsgroup_list\"),",
            "    path(\"secrets-groups/add/\", views.SecretsGroupEditView.as_view(), name=\"secretsgroup_add\"),",
            "    path(\"secrets-groups/delete/\", views.SecretsGroupBulkDeleteView.as_view(), name=\"secretsgroup_bulk_delete\"),",
            "    path(\"secrets-groups/<str:slug>/\", views.SecretsGroupView.as_view(), name=\"secretsgroup\"),",
            "    path(\"secrets-groups/<str:slug>/edit/\", views.SecretsGroupEditView.as_view(), name=\"secretsgroup_edit\"),",
            "    path(\"secrets-groups/<str:slug>/delete/\", views.SecretsGroupDeleteView.as_view(), name=\"secretsgroup_delete\"),",
            "    path(",
            "        \"secrets-groups/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"secretsgroup_changelog\",",
            "        kwargs={\"model\": SecretsGroup},",
            "    ),",
            "    path(",
            "        \"secrets-groups/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"secretsgroup_notes\",",
            "        kwargs={\"model\": SecretsGroup},",
            "    ),",
            "    # Custom statuses",
            "    path(\"statuses/\", views.StatusListView.as_view(), name=\"status_list\"),",
            "    path(\"statuses/add/\", views.StatusEditView.as_view(), name=\"status_add\"),",
            "    path(\"statuses/edit/\", views.StatusBulkEditView.as_view(), name=\"status_bulk_edit\"),",
            "    path(",
            "        \"statuses/delete/\",",
            "        views.StatusBulkDeleteView.as_view(),",
            "        name=\"status_bulk_delete\",",
            "    ),",
            "    path(\"statuses/import/\", views.StatusBulkImportView.as_view(), name=\"status_import\"),",
            "    path(\"statuses/<str:slug>/\", views.StatusView.as_view(), name=\"status\"),",
            "    path(\"statuses/<str:slug>/edit/\", views.StatusEditView.as_view(), name=\"status_edit\"),",
            "    path(",
            "        \"statuses/<str:slug>/delete/\",",
            "        views.StatusDeleteView.as_view(),",
            "        name=\"status_delete\",",
            "    ),",
            "    path(",
            "        \"statuses/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"status_changelog\",",
            "        kwargs={\"model\": Status},",
            "    ),",
            "    path(",
            "        \"statuses/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"status_notes\",",
            "        kwargs={\"model\": Status},",
            "    ),",
            "    # Tags",
            "    path(\"tags/\", views.TagListView.as_view(), name=\"tag_list\"),",
            "    path(\"tags/add/\", views.TagEditView.as_view(), name=\"tag_add\"),",
            "    path(\"tags/import/\", views.TagBulkImportView.as_view(), name=\"tag_import\"),",
            "    path(\"tags/edit/\", views.TagBulkEditView.as_view(), name=\"tag_bulk_edit\"),",
            "    path(\"tags/delete/\", views.TagBulkDeleteView.as_view(), name=\"tag_bulk_delete\"),",
            "    path(\"tags/<str:slug>/\", views.TagView.as_view(), name=\"tag\"),",
            "    path(\"tags/<str:slug>/edit/\", views.TagEditView.as_view(), name=\"tag_edit\"),",
            "    path(\"tags/<str:slug>/delete/\", views.TagDeleteView.as_view(), name=\"tag_delete\"),",
            "    path(",
            "        \"tags/<str:slug>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"tag_changelog\",",
            "        kwargs={\"model\": Tag},",
            "    ),",
            "    path(",
            "        \"tags/<str:slug>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"tag_notes\",",
            "        kwargs={\"model\": Tag},",
            "    ),",
            "    # Webhook",
            "    path(\"webhooks/\", views.WebhookListView.as_view(), name=\"webhook_list\"),",
            "    path(\"webhooks/add/\", views.WebhookEditView.as_view(), name=\"webhook_add\"),",
            "    path(",
            "        \"webhooks/delete/\",",
            "        views.WebhookBulkDeleteView.as_view(),",
            "        name=\"webhook_bulk_delete\",",
            "    ),",
            "    path(\"webhooks/<uuid:pk>/\", views.WebhookView.as_view(), name=\"webhook\"),",
            "    path(\"webhooks/<uuid:pk>/edit/\", views.WebhookEditView.as_view(), name=\"webhook_edit\"),",
            "    path(",
            "        \"webhooks/<uuid:pk>/delete/\",",
            "        views.WebhookDeleteView.as_view(),",
            "        name=\"webhook_delete\",",
            "    ),",
            "    path(",
            "        \"webhooks/<uuid:pk>/changelog/\",",
            "        views.ObjectChangeLogView.as_view(),",
            "        name=\"webhook_changelog\",",
            "        kwargs={\"model\": Webhook},",
            "    ),",
            "    path(",
            "        \"webhooks/<uuid:pk>/notes/\",",
            "        views.ObjectNotesView.as_view(),",
            "        name=\"webhook_notes\",",
            "        kwargs={\"model\": Webhook},",
            "    ),",
            "]",
            "urlpatterns += router.urls"
        ],
        "action": [
            "0",
            "0",
            "0",
            "1",
            "1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "488": [],
            "489": []
        },
        "addLocation": []
    }
}