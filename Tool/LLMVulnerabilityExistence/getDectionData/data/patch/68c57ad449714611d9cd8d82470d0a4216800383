{
    "libs/langchain/tests/unit_tests/prompts/test_loading.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 4,
                "afterPatchRowNumber": 4,
                "PatchRowcode": " from pathlib import Path"
            },
            "1": {
                "beforePatchRowNumber": 5,
                "afterPatchRowNumber": 5,
                "PatchRowcode": " from typing import Iterator"
            },
            "2": {
                "beforePatchRowNumber": 6,
                "afterPatchRowNumber": 6,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 7,
                "PatchRowcode": "+import pytest"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 8,
                "PatchRowcode": "+"
            },
            "5": {
                "beforePatchRowNumber": 7,
                "afterPatchRowNumber": 9,
                "PatchRowcode": " from langchain.output_parsers import RegexParser"
            },
            "6": {
                "beforePatchRowNumber": 8,
                "afterPatchRowNumber": 10,
                "PatchRowcode": " from langchain.prompts.few_shot import FewShotPromptTemplate"
            },
            "7": {
                "beforePatchRowNumber": 9,
                "afterPatchRowNumber": 11,
                "PatchRowcode": " from langchain.prompts.loading import load_prompt"
            },
            "8": {
                "beforePatchRowNumber": 10,
                "afterPatchRowNumber": 12,
                "PatchRowcode": " from langchain.prompts.prompt import PromptTemplate"
            },
            "9": {
                "beforePatchRowNumber": 11,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-import pytest"
            },
            "10": {
                "beforePatchRowNumber": 12,
                "afterPatchRowNumber": 13,
                "PatchRowcode": " "
            },
            "11": {
                "beforePatchRowNumber": 13,
                "afterPatchRowNumber": 14,
                "PatchRowcode": " EXAMPLE_DIR = Path(\"tests/unit_tests/examples\").absolute()"
            },
            "12": {
                "beforePatchRowNumber": 14,
                "afterPatchRowNumber": 15,
                "PatchRowcode": " "
            },
            "13": {
                "beforePatchRowNumber": 51,
                "afterPatchRowNumber": 52,
                "PatchRowcode": "         load_prompt(prompt_path)"
            },
            "14": {
                "beforePatchRowNumber": 52,
                "afterPatchRowNumber": 53,
                "PatchRowcode": " "
            },
            "15": {
                "beforePatchRowNumber": 53,
                "afterPatchRowNumber": 54,
                "PatchRowcode": " "
            },
            "16": {
                "beforePatchRowNumber": 54,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "17": {
                "beforePatchRowNumber": 55,
                "afterPatchRowNumber": 55,
                "PatchRowcode": " def test_loading_jinja_from_YAML() -> None:"
            },
            "18": {
                "beforePatchRowNumber": 56,
                "afterPatchRowNumber": 56,
                "PatchRowcode": "     \"\"\"Test that loading jinja2 format prompts from YAML raises ValueError.\"\"\""
            },
            "19": {
                "beforePatchRowNumber": 57,
                "afterPatchRowNumber": 57,
                "PatchRowcode": "     prompt_path = EXAMPLE_DIR / \"jinja_injection_prompt.yaml\""
            }
        },
        "frontPatchFile": [
            "\"\"\"Test loading functionality.\"\"\"",
            "import os",
            "from contextlib import contextmanager",
            "from pathlib import Path",
            "from typing import Iterator",
            "",
            "from langchain.output_parsers import RegexParser",
            "from langchain.prompts.few_shot import FewShotPromptTemplate",
            "from langchain.prompts.loading import load_prompt",
            "from langchain.prompts.prompt import PromptTemplate",
            "import pytest",
            "",
            "EXAMPLE_DIR = Path(\"tests/unit_tests/examples\").absolute()",
            "",
            "",
            "@contextmanager",
            "def change_directory(dir: Path) -> Iterator:",
            "    \"\"\"Change the working directory to the right folder.\"\"\"",
            "    origin = Path().absolute()",
            "    try:",
            "        os.chdir(dir)",
            "        yield",
            "    finally:",
            "        os.chdir(origin)",
            "",
            "",
            "def test_loading_from_YAML() -> None:",
            "    \"\"\"Test loading from yaml file.\"\"\"",
            "    prompt = load_prompt(EXAMPLE_DIR / \"simple_prompt.yaml\")",
            "    expected_prompt = PromptTemplate(",
            "        input_variables=[\"adjective\", \"content\"],",
            "        template=\"Tell me a {adjective} joke about {content}.\",",
            "    )",
            "    assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_from_JSON() -> None:",
            "    \"\"\"Test loading from json file.\"\"\"",
            "    prompt = load_prompt(EXAMPLE_DIR / \"simple_prompt.json\")",
            "    expected_prompt = PromptTemplate(",
            "        input_variables=[\"adjective\", \"content\"],",
            "        template=\"Tell me a {adjective} joke about {content}.\",",
            "    )",
            "    assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_jinja_from_JSON() -> None:",
            "    \"\"\"Test that loading jinja2 format prompts from JSON raises ValueError.\"\"\"",
            "    prompt_path = EXAMPLE_DIR / \"jinja_injection_prompt.json\"",
            "    with pytest.raises(ValueError, match=\".*can lead to arbitrary code execution.*\"):",
            "        load_prompt(prompt_path)",
            "",
            "",
            "",
            "def test_loading_jinja_from_YAML() -> None:",
            "    \"\"\"Test that loading jinja2 format prompts from YAML raises ValueError.\"\"\"",
            "    prompt_path = EXAMPLE_DIR / \"jinja_injection_prompt.yaml\"",
            "    with pytest.raises(ValueError, match=\".*can lead to arbitrary code execution.*\"):",
            "        load_prompt(prompt_path)",
            "",
            "",
            "def test_saving_loading_round_trip(tmp_path: Path) -> None:",
            "    \"\"\"Test equality when saving and loading a prompt.\"\"\"",
            "    simple_prompt = PromptTemplate(",
            "        input_variables=[\"adjective\", \"content\"],",
            "        template=\"Tell me a {adjective} joke about {content}.\",",
            "    )",
            "    simple_prompt.save(file_path=tmp_path / \"prompt.yaml\")",
            "    loaded_prompt = load_prompt(tmp_path / \"prompt.yaml\")",
            "    assert loaded_prompt == simple_prompt",
            "",
            "    few_shot_prompt = FewShotPromptTemplate(",
            "        input_variables=[\"adjective\"],",
            "        prefix=\"Write antonyms for the following words.\",",
            "        example_prompt=PromptTemplate(",
            "            input_variables=[\"input\", \"output\"],",
            "            template=\"Input: {input}\\nOutput: {output}\",",
            "        ),",
            "        examples=[",
            "            {\"input\": \"happy\", \"output\": \"sad\"},",
            "            {\"input\": \"tall\", \"output\": \"short\"},",
            "        ],",
            "        suffix=\"Input: {adjective}\\nOutput:\",",
            "    )",
            "    few_shot_prompt.save(file_path=tmp_path / \"few_shot.yaml\")",
            "    loaded_prompt = load_prompt(tmp_path / \"few_shot.yaml\")",
            "    assert loaded_prompt == few_shot_prompt",
            "",
            "",
            "def test_loading_with_template_as_file() -> None:",
            "    \"\"\"Test loading when the template is a file.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"simple_prompt_with_template_file.json\")",
            "        expected_prompt = PromptTemplate(",
            "            input_variables=[\"adjective\", \"content\"],",
            "            template=\"Tell me a {adjective} joke about {content}.\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_few_shot_prompt_from_yaml() -> None:",
            "    \"\"\"Test loading few shot prompt from yaml.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"few_shot_prompt.yaml\")",
            "        expected_prompt = FewShotPromptTemplate(",
            "            input_variables=[\"adjective\"],",
            "            prefix=\"Write antonyms for the following words.\",",
            "            example_prompt=PromptTemplate(",
            "                input_variables=[\"input\", \"output\"],",
            "                template=\"Input: {input}\\nOutput: {output}\",",
            "            ),",
            "            examples=[",
            "                {\"input\": \"happy\", \"output\": \"sad\"},",
            "                {\"input\": \"tall\", \"output\": \"short\"},",
            "            ],",
            "            suffix=\"Input: {adjective}\\nOutput:\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_few_shot_prompt_from_json() -> None:",
            "    \"\"\"Test loading few shot prompt from json.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"few_shot_prompt.json\")",
            "        expected_prompt = FewShotPromptTemplate(",
            "            input_variables=[\"adjective\"],",
            "            prefix=\"Write antonyms for the following words.\",",
            "            example_prompt=PromptTemplate(",
            "                input_variables=[\"input\", \"output\"],",
            "                template=\"Input: {input}\\nOutput: {output}\",",
            "            ),",
            "            examples=[",
            "                {\"input\": \"happy\", \"output\": \"sad\"},",
            "                {\"input\": \"tall\", \"output\": \"short\"},",
            "            ],",
            "            suffix=\"Input: {adjective}\\nOutput:\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_few_shot_prompt_when_examples_in_config() -> None:",
            "    \"\"\"Test loading few shot prompt when the examples are in the config.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"few_shot_prompt_examples_in.json\")",
            "        expected_prompt = FewShotPromptTemplate(",
            "            input_variables=[\"adjective\"],",
            "            prefix=\"Write antonyms for the following words.\",",
            "            example_prompt=PromptTemplate(",
            "                input_variables=[\"input\", \"output\"],",
            "                template=\"Input: {input}\\nOutput: {output}\",",
            "            ),",
            "            examples=[",
            "                {\"input\": \"happy\", \"output\": \"sad\"},",
            "                {\"input\": \"tall\", \"output\": \"short\"},",
            "            ],",
            "            suffix=\"Input: {adjective}\\nOutput:\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_few_shot_prompt_example_prompt() -> None:",
            "    \"\"\"Test loading few shot when the example prompt is in its own file.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"few_shot_prompt_example_prompt.json\")",
            "        expected_prompt = FewShotPromptTemplate(",
            "            input_variables=[\"adjective\"],",
            "            prefix=\"Write antonyms for the following words.\",",
            "            example_prompt=PromptTemplate(",
            "                input_variables=[\"input\", \"output\"],",
            "                template=\"Input: {input}\\nOutput: {output}\",",
            "            ),",
            "            examples=[",
            "                {\"input\": \"happy\", \"output\": \"sad\"},",
            "                {\"input\": \"tall\", \"output\": \"short\"},",
            "            ],",
            "            suffix=\"Input: {adjective}\\nOutput:\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_with_output_parser() -> None:",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"prompt_with_output_parser.json\")",
            "        expected_template = \"Given the following question and student answer, provide a correct answer and score the student answer.\\nQuestion: {question}\\nStudent Answer: {student_answer}\\nCorrect Answer:\"  # noqa: E501",
            "        expected_prompt = PromptTemplate(",
            "            input_variables=[\"question\", \"student_answer\"],",
            "            output_parser=RegexParser(",
            "                regex=\"(.*?)\\nScore: (.*)\",",
            "                output_keys=[\"answer\", \"score\"],",
            "            ),",
            "            template=expected_template,",
            "        )",
            "        assert prompt == expected_prompt"
        ],
        "afterPatchFile": [
            "\"\"\"Test loading functionality.\"\"\"",
            "import os",
            "from contextlib import contextmanager",
            "from pathlib import Path",
            "from typing import Iterator",
            "",
            "import pytest",
            "",
            "from langchain.output_parsers import RegexParser",
            "from langchain.prompts.few_shot import FewShotPromptTemplate",
            "from langchain.prompts.loading import load_prompt",
            "from langchain.prompts.prompt import PromptTemplate",
            "",
            "EXAMPLE_DIR = Path(\"tests/unit_tests/examples\").absolute()",
            "",
            "",
            "@contextmanager",
            "def change_directory(dir: Path) -> Iterator:",
            "    \"\"\"Change the working directory to the right folder.\"\"\"",
            "    origin = Path().absolute()",
            "    try:",
            "        os.chdir(dir)",
            "        yield",
            "    finally:",
            "        os.chdir(origin)",
            "",
            "",
            "def test_loading_from_YAML() -> None:",
            "    \"\"\"Test loading from yaml file.\"\"\"",
            "    prompt = load_prompt(EXAMPLE_DIR / \"simple_prompt.yaml\")",
            "    expected_prompt = PromptTemplate(",
            "        input_variables=[\"adjective\", \"content\"],",
            "        template=\"Tell me a {adjective} joke about {content}.\",",
            "    )",
            "    assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_from_JSON() -> None:",
            "    \"\"\"Test loading from json file.\"\"\"",
            "    prompt = load_prompt(EXAMPLE_DIR / \"simple_prompt.json\")",
            "    expected_prompt = PromptTemplate(",
            "        input_variables=[\"adjective\", \"content\"],",
            "        template=\"Tell me a {adjective} joke about {content}.\",",
            "    )",
            "    assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_jinja_from_JSON() -> None:",
            "    \"\"\"Test that loading jinja2 format prompts from JSON raises ValueError.\"\"\"",
            "    prompt_path = EXAMPLE_DIR / \"jinja_injection_prompt.json\"",
            "    with pytest.raises(ValueError, match=\".*can lead to arbitrary code execution.*\"):",
            "        load_prompt(prompt_path)",
            "",
            "",
            "def test_loading_jinja_from_YAML() -> None:",
            "    \"\"\"Test that loading jinja2 format prompts from YAML raises ValueError.\"\"\"",
            "    prompt_path = EXAMPLE_DIR / \"jinja_injection_prompt.yaml\"",
            "    with pytest.raises(ValueError, match=\".*can lead to arbitrary code execution.*\"):",
            "        load_prompt(prompt_path)",
            "",
            "",
            "def test_saving_loading_round_trip(tmp_path: Path) -> None:",
            "    \"\"\"Test equality when saving and loading a prompt.\"\"\"",
            "    simple_prompt = PromptTemplate(",
            "        input_variables=[\"adjective\", \"content\"],",
            "        template=\"Tell me a {adjective} joke about {content}.\",",
            "    )",
            "    simple_prompt.save(file_path=tmp_path / \"prompt.yaml\")",
            "    loaded_prompt = load_prompt(tmp_path / \"prompt.yaml\")",
            "    assert loaded_prompt == simple_prompt",
            "",
            "    few_shot_prompt = FewShotPromptTemplate(",
            "        input_variables=[\"adjective\"],",
            "        prefix=\"Write antonyms for the following words.\",",
            "        example_prompt=PromptTemplate(",
            "            input_variables=[\"input\", \"output\"],",
            "            template=\"Input: {input}\\nOutput: {output}\",",
            "        ),",
            "        examples=[",
            "            {\"input\": \"happy\", \"output\": \"sad\"},",
            "            {\"input\": \"tall\", \"output\": \"short\"},",
            "        ],",
            "        suffix=\"Input: {adjective}\\nOutput:\",",
            "    )",
            "    few_shot_prompt.save(file_path=tmp_path / \"few_shot.yaml\")",
            "    loaded_prompt = load_prompt(tmp_path / \"few_shot.yaml\")",
            "    assert loaded_prompt == few_shot_prompt",
            "",
            "",
            "def test_loading_with_template_as_file() -> None:",
            "    \"\"\"Test loading when the template is a file.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"simple_prompt_with_template_file.json\")",
            "        expected_prompt = PromptTemplate(",
            "            input_variables=[\"adjective\", \"content\"],",
            "            template=\"Tell me a {adjective} joke about {content}.\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_few_shot_prompt_from_yaml() -> None:",
            "    \"\"\"Test loading few shot prompt from yaml.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"few_shot_prompt.yaml\")",
            "        expected_prompt = FewShotPromptTemplate(",
            "            input_variables=[\"adjective\"],",
            "            prefix=\"Write antonyms for the following words.\",",
            "            example_prompt=PromptTemplate(",
            "                input_variables=[\"input\", \"output\"],",
            "                template=\"Input: {input}\\nOutput: {output}\",",
            "            ),",
            "            examples=[",
            "                {\"input\": \"happy\", \"output\": \"sad\"},",
            "                {\"input\": \"tall\", \"output\": \"short\"},",
            "            ],",
            "            suffix=\"Input: {adjective}\\nOutput:\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_few_shot_prompt_from_json() -> None:",
            "    \"\"\"Test loading few shot prompt from json.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"few_shot_prompt.json\")",
            "        expected_prompt = FewShotPromptTemplate(",
            "            input_variables=[\"adjective\"],",
            "            prefix=\"Write antonyms for the following words.\",",
            "            example_prompt=PromptTemplate(",
            "                input_variables=[\"input\", \"output\"],",
            "                template=\"Input: {input}\\nOutput: {output}\",",
            "            ),",
            "            examples=[",
            "                {\"input\": \"happy\", \"output\": \"sad\"},",
            "                {\"input\": \"tall\", \"output\": \"short\"},",
            "            ],",
            "            suffix=\"Input: {adjective}\\nOutput:\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_few_shot_prompt_when_examples_in_config() -> None:",
            "    \"\"\"Test loading few shot prompt when the examples are in the config.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"few_shot_prompt_examples_in.json\")",
            "        expected_prompt = FewShotPromptTemplate(",
            "            input_variables=[\"adjective\"],",
            "            prefix=\"Write antonyms for the following words.\",",
            "            example_prompt=PromptTemplate(",
            "                input_variables=[\"input\", \"output\"],",
            "                template=\"Input: {input}\\nOutput: {output}\",",
            "            ),",
            "            examples=[",
            "                {\"input\": \"happy\", \"output\": \"sad\"},",
            "                {\"input\": \"tall\", \"output\": \"short\"},",
            "            ],",
            "            suffix=\"Input: {adjective}\\nOutput:\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_few_shot_prompt_example_prompt() -> None:",
            "    \"\"\"Test loading few shot when the example prompt is in its own file.\"\"\"",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"few_shot_prompt_example_prompt.json\")",
            "        expected_prompt = FewShotPromptTemplate(",
            "            input_variables=[\"adjective\"],",
            "            prefix=\"Write antonyms for the following words.\",",
            "            example_prompt=PromptTemplate(",
            "                input_variables=[\"input\", \"output\"],",
            "                template=\"Input: {input}\\nOutput: {output}\",",
            "            ),",
            "            examples=[",
            "                {\"input\": \"happy\", \"output\": \"sad\"},",
            "                {\"input\": \"tall\", \"output\": \"short\"},",
            "            ],",
            "            suffix=\"Input: {adjective}\\nOutput:\",",
            "        )",
            "        assert prompt == expected_prompt",
            "",
            "",
            "def test_loading_with_output_parser() -> None:",
            "    with change_directory(EXAMPLE_DIR):",
            "        prompt = load_prompt(\"prompt_with_output_parser.json\")",
            "        expected_template = \"Given the following question and student answer, provide a correct answer and score the student answer.\\nQuestion: {question}\\nStudent Answer: {student_answer}\\nCorrect Answer:\"  # noqa: E501",
            "        expected_prompt = PromptTemplate(",
            "            input_variables=[\"question\", \"student_answer\"],",
            "            output_parser=RegexParser(",
            "                regex=\"(.*?)\\nScore: (.*)\",",
            "                output_keys=[\"answer\", \"score\"],",
            "            ),",
            "            template=expected_template,",
            "        )",
            "        assert prompt == expected_prompt"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "11": [],
            "54": []
        },
        "addLocation": []
    }
}