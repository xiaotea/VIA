{
    "lib/python/ZServer/PubCore/ZServerPublisher.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 11,
                "afterPatchRowNumber": 11,
                "PatchRowcode": " #"
            },
            "1": {
                "beforePatchRowNumber": 12,
                "afterPatchRowNumber": 12,
                "PatchRowcode": " ##############################################################################"
            },
            "2": {
                "beforePatchRowNumber": 13,
                "afterPatchRowNumber": 13,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 14,
                "PatchRowcode": "+import logging"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 15,
                "PatchRowcode": "+"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 16,
                "PatchRowcode": "+LOG = logging.getLogger('ZServerPublisher')"
            },
            "6": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 17,
                "PatchRowcode": "+"
            },
            "7": {
                "beforePatchRowNumber": 14,
                "afterPatchRowNumber": 18,
                "PatchRowcode": " class ZServerPublisher:"
            },
            "8": {
                "beforePatchRowNumber": 15,
                "afterPatchRowNumber": 19,
                "PatchRowcode": "     def __init__(self, accept):"
            },
            "9": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 20,
                "PatchRowcode": "+        from sys import exc_info"
            },
            "10": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 21,
                "PatchRowcode": "         from ZPublisher import publish_module"
            },
            "11": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 22,
                "PatchRowcode": "         from ZPublisher.WSGIPublisher import publish_module as publish_wsgi"
            },
            "12": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 23,
                "PatchRowcode": "         while 1:"
            },
            "13": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            name, a, b=accept()"
            },
            "14": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            if name == \"Zope2\":"
            },
            "15": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                try:"
            },
            "16": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    publish_module("
            },
            "17": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        name,"
            },
            "18": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        request=a,"
            },
            "19": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        response=b)"
            },
            "20": {
                "beforePatchRowNumber": 26,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                finally:"
            },
            "21": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    b._finish()"
            },
            "22": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    a=b=None"
            },
            "23": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 24,
                "PatchRowcode": "+            try:"
            },
            "24": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 25,
                "PatchRowcode": "+                name, a, b=accept()"
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 26,
                "PatchRowcode": "+                if name == \"Zope2\":"
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 27,
                "PatchRowcode": "+                    try:"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 28,
                "PatchRowcode": "+                        publish_module("
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 29,
                "PatchRowcode": "+                            name,"
            },
            "29": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 30,
                "PatchRowcode": "+                            request=a,"
            },
            "30": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 31,
                "PatchRowcode": "+                            response=b)"
            },
            "31": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 32,
                "PatchRowcode": "+                    finally:"
            },
            "32": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 33,
                "PatchRowcode": "+                        b._finish()"
            },
            "33": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 34,
                "PatchRowcode": "+                        a=b=None"
            },
            "34": {
                "beforePatchRowNumber": 29,
                "afterPatchRowNumber": 35,
                "PatchRowcode": " "
            },
            "35": {
                "beforePatchRowNumber": 30,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            elif name == \"Zope2WSGI\":"
            },
            "36": {
                "beforePatchRowNumber": 31,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                try:"
            },
            "37": {
                "beforePatchRowNumber": 32,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    res = publish_wsgi(a, b)"
            },
            "38": {
                "beforePatchRowNumber": 33,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    for r in res:"
            },
            "39": {
                "beforePatchRowNumber": 34,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                        a['wsgi.output'].write(r)"
            },
            "40": {
                "beforePatchRowNumber": 35,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                finally:"
            },
            "41": {
                "beforePatchRowNumber": 36,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    # TODO: Support keeping connections open."
            },
            "42": {
                "beforePatchRowNumber": 37,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    a['wsgi.output']._close = 1"
            },
            "43": {
                "beforePatchRowNumber": 38,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                    a['wsgi.output'].close()"
            },
            "44": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 36,
                "PatchRowcode": "+                elif name == \"Zope2WSGI\":"
            },
            "45": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 37,
                "PatchRowcode": "+                    try:"
            },
            "46": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 38,
                "PatchRowcode": "+                        res = publish_wsgi(a, b)"
            },
            "47": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 39,
                "PatchRowcode": "+                        for r in res:"
            },
            "48": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 40,
                "PatchRowcode": "+                            a['wsgi.output'].write(r)"
            },
            "49": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 41,
                "PatchRowcode": "+                    finally:"
            },
            "50": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 42,
                "PatchRowcode": "+                        # TODO: Support keeping connections open."
            },
            "51": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 43,
                "PatchRowcode": "+                        a['wsgi.output']._close = 1"
            },
            "52": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 44,
                "PatchRowcode": "+                        a['wsgi.output'].close()"
            },
            "53": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 45,
                "PatchRowcode": "+            except:"
            },
            "54": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 46,
                "PatchRowcode": "+                LOG.error('exception caught', exc_info=True)"
            }
        },
        "frontPatchFile": [
            "##############################################################################",
            "#",
            "# Copyright (c) 2002 Zope Corporation and Contributors. All Rights Reserved.",
            "#",
            "# This software is subject to the provisions of the Zope Public License,",
            "# Version 2.1 (ZPL).  A copy of the ZPL should accompany this distribution.",
            "# THIS SOFTWARE IS PROVIDED \"AS IS\" AND ANY AND ALL EXPRESS OR IMPLIED",
            "# WARRANTIES ARE DISCLAIMED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",
            "# WARRANTIES OF TITLE, MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS",
            "# FOR A PARTICULAR PURPOSE",
            "#",
            "##############################################################################",
            "",
            "class ZServerPublisher:",
            "    def __init__(self, accept):",
            "        from ZPublisher import publish_module",
            "        from ZPublisher.WSGIPublisher import publish_module as publish_wsgi",
            "        while 1:",
            "            name, a, b=accept()",
            "            if name == \"Zope2\":",
            "                try:",
            "                    publish_module(",
            "                        name,",
            "                        request=a,",
            "                        response=b)",
            "                finally:",
            "                    b._finish()",
            "                    a=b=None",
            "",
            "            elif name == \"Zope2WSGI\":",
            "                try:",
            "                    res = publish_wsgi(a, b)",
            "                    for r in res:",
            "                        a['wsgi.output'].write(r)",
            "                finally:",
            "                    # TODO: Support keeping connections open.",
            "                    a['wsgi.output']._close = 1",
            "                    a['wsgi.output'].close()"
        ],
        "afterPatchFile": [
            "##############################################################################",
            "#",
            "# Copyright (c) 2002 Zope Corporation and Contributors. All Rights Reserved.",
            "#",
            "# This software is subject to the provisions of the Zope Public License,",
            "# Version 2.1 (ZPL).  A copy of the ZPL should accompany this distribution.",
            "# THIS SOFTWARE IS PROVIDED \"AS IS\" AND ANY AND ALL EXPRESS OR IMPLIED",
            "# WARRANTIES ARE DISCLAIMED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED",
            "# WARRANTIES OF TITLE, MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS",
            "# FOR A PARTICULAR PURPOSE",
            "#",
            "##############################################################################",
            "",
            "import logging",
            "",
            "LOG = logging.getLogger('ZServerPublisher')",
            "",
            "class ZServerPublisher:",
            "    def __init__(self, accept):",
            "        from sys import exc_info",
            "        from ZPublisher import publish_module",
            "        from ZPublisher.WSGIPublisher import publish_module as publish_wsgi",
            "        while 1:",
            "            try:",
            "                name, a, b=accept()",
            "                if name == \"Zope2\":",
            "                    try:",
            "                        publish_module(",
            "                            name,",
            "                            request=a,",
            "                            response=b)",
            "                    finally:",
            "                        b._finish()",
            "                        a=b=None",
            "",
            "                elif name == \"Zope2WSGI\":",
            "                    try:",
            "                        res = publish_wsgi(a, b)",
            "                        for r in res:",
            "                            a['wsgi.output'].write(r)",
            "                    finally:",
            "                        # TODO: Support keeping connections open.",
            "                        a['wsgi.output']._close = 1",
            "                        a['wsgi.output'].close()",
            "            except:",
            "                LOG.error('exception caught', exc_info=True)"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2"
        ],
        "dele_reviseLocation": {
            "19": [
                "ZServerPublisher",
                "__init__"
            ],
            "20": [
                "ZServerPublisher",
                "__init__"
            ],
            "21": [
                "ZServerPublisher",
                "__init__"
            ],
            "22": [
                "ZServerPublisher",
                "__init__"
            ],
            "23": [
                "ZServerPublisher",
                "__init__"
            ],
            "24": [
                "ZServerPublisher",
                "__init__"
            ],
            "25": [
                "ZServerPublisher",
                "__init__"
            ],
            "26": [
                "ZServerPublisher",
                "__init__"
            ],
            "27": [
                "ZServerPublisher",
                "__init__"
            ],
            "28": [
                "ZServerPublisher",
                "__init__"
            ],
            "30": [
                "ZServerPublisher",
                "__init__"
            ],
            "31": [
                "ZServerPublisher",
                "__init__"
            ],
            "32": [
                "ZServerPublisher",
                "__init__"
            ],
            "33": [
                "ZServerPublisher",
                "__init__"
            ],
            "34": [
                "ZServerPublisher",
                "__init__"
            ],
            "35": [
                "ZServerPublisher",
                "__init__"
            ],
            "36": [
                "ZServerPublisher",
                "__init__"
            ],
            "37": [
                "ZServerPublisher",
                "__init__"
            ],
            "38": [
                "ZServerPublisher",
                "__init__"
            ]
        },
        "addLocation": [
            "lib.python.ZServer.PubCore.ZServerPublisher.ZServerPublisher",
            "flower.command"
        ]
    }
}