{
    "airflow/api_connexion/endpoints/dag_warning_endpoint.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " # under the License."
            },
            "1": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 17,
                "PatchRowcode": " from __future__ import annotations"
            },
            "2": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 18,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 19,
                "PatchRowcode": "+from flask import g"
            },
            "4": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " from sqlalchemy import select"
            },
            "5": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 21,
                "PatchRowcode": " from sqlalchemy.orm import Session"
            },
            "6": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 22,
                "PatchRowcode": " "
            },
            "7": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": 23,
                "PatchRowcode": " from airflow.api_connexion import security"
            },
            "8": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 24,
                "PatchRowcode": "+from airflow.api_connexion.exceptions import PermissionDenied"
            },
            "9": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": 25,
                "PatchRowcode": " from airflow.api_connexion.parameters import apply_sorting, check_limit, format_parameters"
            },
            "10": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": 26,
                "PatchRowcode": " from airflow.api_connexion.schemas.dag_warning_schema import ("
            },
            "11": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 27,
                "PatchRowcode": "     DagWarningCollection,"
            },
            "12": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": 30,
                "PatchRowcode": " from airflow.api_connexion.types import APIResponse"
            },
            "13": {
                "beforePatchRowNumber": 29,
                "afterPatchRowNumber": 31,
                "PatchRowcode": " from airflow.models.dagwarning import DagWarning as DagWarningModel"
            },
            "14": {
                "beforePatchRowNumber": 30,
                "afterPatchRowNumber": 32,
                "PatchRowcode": " from airflow.security import permissions"
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 33,
                "PatchRowcode": "+from airflow.utils.airflow_flask_app import get_airflow_app"
            },
            "16": {
                "beforePatchRowNumber": 31,
                "afterPatchRowNumber": 34,
                "PatchRowcode": " from airflow.utils.db import get_query_count"
            },
            "17": {
                "beforePatchRowNumber": 32,
                "afterPatchRowNumber": 35,
                "PatchRowcode": " from airflow.utils.session import NEW_SESSION, provide_session"
            },
            "18": {
                "beforePatchRowNumber": 33,
                "afterPatchRowNumber": 36,
                "PatchRowcode": " "
            },
            "19": {
                "beforePatchRowNumber": 52,
                "afterPatchRowNumber": 55,
                "PatchRowcode": "     allowed_filter_attrs = [\"dag_id\", \"warning_type\", \"message\", \"timestamp\"]"
            },
            "20": {
                "beforePatchRowNumber": 53,
                "afterPatchRowNumber": 56,
                "PatchRowcode": "     query = select(DagWarningModel)"
            },
            "21": {
                "beforePatchRowNumber": 54,
                "afterPatchRowNumber": 57,
                "PatchRowcode": "     if dag_id:"
            },
            "22": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 58,
                "PatchRowcode": "+        if not get_airflow_app().appbuilder.sm.can_read_dag(dag_id, g.user):"
            },
            "23": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 59,
                "PatchRowcode": "+            raise PermissionDenied(detail=f\"User not allowed to access this DAG: {dag_id}\")"
            },
            "24": {
                "beforePatchRowNumber": 55,
                "afterPatchRowNumber": 60,
                "PatchRowcode": "         query = query.where(DagWarningModel.dag_id == dag_id)"
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 61,
                "PatchRowcode": "+    else:"
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 62,
                "PatchRowcode": "+        readable_dags = get_airflow_app().appbuilder.sm.get_accessible_dag_ids(g.user)"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 63,
                "PatchRowcode": "+        query = query.where(DagWarningModel.dag_id.in_(readable_dags))"
            },
            "28": {
                "beforePatchRowNumber": 56,
                "afterPatchRowNumber": 64,
                "PatchRowcode": "     if warning_type:"
            },
            "29": {
                "beforePatchRowNumber": 57,
                "afterPatchRowNumber": 65,
                "PatchRowcode": "         query = query.where(DagWarningModel.warning_type == warning_type)"
            },
            "30": {
                "beforePatchRowNumber": 58,
                "afterPatchRowNumber": 66,
                "PatchRowcode": "     total_entries = get_query_count(query, session=session)"
            }
        },
        "frontPatchFile": [
            "# Licensed to the Apache Software Foundation (ASF) under one",
            "# or more contributor license agreements.  See the NOTICE file",
            "# distributed with this work for additional information",
            "# regarding copyright ownership.  The ASF licenses this file",
            "# to you under the Apache License, Version 2.0 (the",
            "# \"License\"); you may not use this file except in compliance",
            "# with the License.  You may obtain a copy of the License at",
            "#",
            "#   http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "# Unless required by applicable law or agreed to in writing,",
            "# software distributed under the License is distributed on an",
            "# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY",
            "# KIND, either express or implied.  See the License for the",
            "# specific language governing permissions and limitations",
            "# under the License.",
            "from __future__ import annotations",
            "",
            "from sqlalchemy import select",
            "from sqlalchemy.orm import Session",
            "",
            "from airflow.api_connexion import security",
            "from airflow.api_connexion.parameters import apply_sorting, check_limit, format_parameters",
            "from airflow.api_connexion.schemas.dag_warning_schema import (",
            "    DagWarningCollection,",
            "    dag_warning_collection_schema,",
            ")",
            "from airflow.api_connexion.types import APIResponse",
            "from airflow.models.dagwarning import DagWarning as DagWarningModel",
            "from airflow.security import permissions",
            "from airflow.utils.db import get_query_count",
            "from airflow.utils.session import NEW_SESSION, provide_session",
            "",
            "",
            "@security.requires_access([(permissions.ACTION_CAN_READ, permissions.RESOURCE_DAG_WARNING)])",
            "@format_parameters({\"limit\": check_limit})",
            "@provide_session",
            "def get_dag_warnings(",
            "    *,",
            "    limit: int,",
            "    dag_id: str | None = None,",
            "    warning_type: str | None = None,",
            "    offset: int | None = None,",
            "    order_by: str = \"timestamp\",",
            "    session: Session = NEW_SESSION,",
            ") -> APIResponse:",
            "    \"\"\"Get DAG warnings.",
            "",
            "    :param dag_id: the dag_id to optionally filter by",
            "    :param warning_type: the warning type to optionally filter by",
            "    \"\"\"",
            "    allowed_filter_attrs = [\"dag_id\", \"warning_type\", \"message\", \"timestamp\"]",
            "    query = select(DagWarningModel)",
            "    if dag_id:",
            "        query = query.where(DagWarningModel.dag_id == dag_id)",
            "    if warning_type:",
            "        query = query.where(DagWarningModel.warning_type == warning_type)",
            "    total_entries = get_query_count(query, session=session)",
            "    query = apply_sorting(query=query, order_by=order_by, allowed_attrs=allowed_filter_attrs)",
            "    dag_warnings = session.scalars(query.offset(offset).limit(limit)).all()",
            "    return dag_warning_collection_schema.dump(",
            "        DagWarningCollection(dag_warnings=dag_warnings, total_entries=total_entries)",
            "    )"
        ],
        "afterPatchFile": [
            "# Licensed to the Apache Software Foundation (ASF) under one",
            "# or more contributor license agreements.  See the NOTICE file",
            "# distributed with this work for additional information",
            "# regarding copyright ownership.  The ASF licenses this file",
            "# to you under the Apache License, Version 2.0 (the",
            "# \"License\"); you may not use this file except in compliance",
            "# with the License.  You may obtain a copy of the License at",
            "#",
            "#   http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "# Unless required by applicable law or agreed to in writing,",
            "# software distributed under the License is distributed on an",
            "# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY",
            "# KIND, either express or implied.  See the License for the",
            "# specific language governing permissions and limitations",
            "# under the License.",
            "from __future__ import annotations",
            "",
            "from flask import g",
            "from sqlalchemy import select",
            "from sqlalchemy.orm import Session",
            "",
            "from airflow.api_connexion import security",
            "from airflow.api_connexion.exceptions import PermissionDenied",
            "from airflow.api_connexion.parameters import apply_sorting, check_limit, format_parameters",
            "from airflow.api_connexion.schemas.dag_warning_schema import (",
            "    DagWarningCollection,",
            "    dag_warning_collection_schema,",
            ")",
            "from airflow.api_connexion.types import APIResponse",
            "from airflow.models.dagwarning import DagWarning as DagWarningModel",
            "from airflow.security import permissions",
            "from airflow.utils.airflow_flask_app import get_airflow_app",
            "from airflow.utils.db import get_query_count",
            "from airflow.utils.session import NEW_SESSION, provide_session",
            "",
            "",
            "@security.requires_access([(permissions.ACTION_CAN_READ, permissions.RESOURCE_DAG_WARNING)])",
            "@format_parameters({\"limit\": check_limit})",
            "@provide_session",
            "def get_dag_warnings(",
            "    *,",
            "    limit: int,",
            "    dag_id: str | None = None,",
            "    warning_type: str | None = None,",
            "    offset: int | None = None,",
            "    order_by: str = \"timestamp\",",
            "    session: Session = NEW_SESSION,",
            ") -> APIResponse:",
            "    \"\"\"Get DAG warnings.",
            "",
            "    :param dag_id: the dag_id to optionally filter by",
            "    :param warning_type: the warning type to optionally filter by",
            "    \"\"\"",
            "    allowed_filter_attrs = [\"dag_id\", \"warning_type\", \"message\", \"timestamp\"]",
            "    query = select(DagWarningModel)",
            "    if dag_id:",
            "        if not get_airflow_app().appbuilder.sm.can_read_dag(dag_id, g.user):",
            "            raise PermissionDenied(detail=f\"User not allowed to access this DAG: {dag_id}\")",
            "        query = query.where(DagWarningModel.dag_id == dag_id)",
            "    else:",
            "        readable_dags = get_airflow_app().appbuilder.sm.get_accessible_dag_ids(g.user)",
            "        query = query.where(DagWarningModel.dag_id.in_(readable_dags))",
            "    if warning_type:",
            "        query = query.where(DagWarningModel.warning_type == warning_type)",
            "    total_entries = get_query_count(query, session=session)",
            "    query = apply_sorting(query=query, order_by=order_by, allowed_attrs=allowed_filter_attrs)",
            "    dag_warnings = session.scalars(query.offset(offset).limit(limit)).all()",
            "    return dag_warning_collection_schema.dump(",
            "        DagWarningCollection(dag_warnings=dag_warnings, total_entries=total_entries)",
            "    )"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "0",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": [
            "applications.admin.controllers.default.git_pull",
            "airflow.api_connexion.endpoints.dag_warning_endpoint.get_dag_warnings.allowed_filter_attrs"
        ]
    }
}