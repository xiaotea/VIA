{
    "airflow/www/auth.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " # under the License."
            },
            "1": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 17,
                "PatchRowcode": " from __future__ import annotations"
            },
            "2": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 18,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 19,
                "PatchRowcode": "+import logging"
            },
            "4": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " from functools import wraps"
            },
            "5": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 21,
                "PatchRowcode": " from typing import Callable, Sequence, TypeVar, cast"
            },
            "6": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 22,
                "PatchRowcode": " "
            },
            "7": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": 28,
                "PatchRowcode": " "
            },
            "8": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": 29,
                "PatchRowcode": " T = TypeVar(\"T\", bound=Callable)"
            },
            "9": {
                "beforePatchRowNumber": 29,
                "afterPatchRowNumber": 30,
                "PatchRowcode": " "
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 31,
                "PatchRowcode": "+log = logging.getLogger(__name__)"
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 32,
                "PatchRowcode": "+"
            },
            "12": {
                "beforePatchRowNumber": 30,
                "afterPatchRowNumber": 33,
                "PatchRowcode": " "
            },
            "13": {
                "beforePatchRowNumber": 31,
                "afterPatchRowNumber": 34,
                "PatchRowcode": " def get_access_denied_message():"
            },
            "14": {
                "beforePatchRowNumber": 32,
                "afterPatchRowNumber": 35,
                "PatchRowcode": "     return conf.get(\"webserver\", \"access_denied_message\")"
            },
            "15": {
                "beforePatchRowNumber": 42,
                "afterPatchRowNumber": 45,
                "PatchRowcode": " "
            },
            "16": {
                "beforePatchRowNumber": 43,
                "afterPatchRowNumber": 46,
                "PatchRowcode": "             appbuilder = current_app.appbuilder"
            },
            "17": {
                "beforePatchRowNumber": 44,
                "afterPatchRowNumber": 47,
                "PatchRowcode": " "
            },
            "18": {
                "beforePatchRowNumber": 45,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            dag_id = ("
            },
            "19": {
                "beforePatchRowNumber": 46,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                kwargs.get(\"dag_id\")"
            },
            "20": {
                "beforePatchRowNumber": 47,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                or request.args.get(\"dag_id\")"
            },
            "21": {
                "beforePatchRowNumber": 48,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                or request.form.get(\"dag_id\")"
            },
            "22": {
                "beforePatchRowNumber": 49,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                or (request.is_json and request.json.get(\"dag_id\"))"
            },
            "23": {
                "beforePatchRowNumber": 50,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-                or None"
            },
            "24": {
                "beforePatchRowNumber": 51,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            )"
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 48,
                "PatchRowcode": "+            dag_id_kwargs = kwargs.get(\"dag_id\")"
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 49,
                "PatchRowcode": "+            dag_id_args = request.args.get(\"dag_id\")"
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 50,
                "PatchRowcode": "+            dag_id_form = request.form.get(\"dag_id\")"
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 51,
                "PatchRowcode": "+            dag_id_json = request.json.get(\"dag_id\") if request.is_json else None"
            },
            "29": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 52,
                "PatchRowcode": "+            all_dag_ids = [dag_id_kwargs, dag_id_args, dag_id_form, dag_id_json]"
            },
            "30": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 53,
                "PatchRowcode": "+            unique_dag_ids = set(dag_id for dag_id in all_dag_ids if dag_id is not None)"
            },
            "31": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 54,
                "PatchRowcode": "+"
            },
            "32": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 55,
                "PatchRowcode": "+            if len(unique_dag_ids) > 1:"
            },
            "33": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 56,
                "PatchRowcode": "+                log.warning("
            },
            "34": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 57,
                "PatchRowcode": "+                    f\"There are different dag_ids passed in the request: {unique_dag_ids}. Returning 403.\""
            },
            "35": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 58,
                "PatchRowcode": "+                )"
            },
            "36": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 59,
                "PatchRowcode": "+                log.warning("
            },
            "37": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 60,
                "PatchRowcode": "+                    f\"kwargs: {dag_id_kwargs}, args: {dag_id_args}, \""
            },
            "38": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 61,
                "PatchRowcode": "+                    f\"form: {dag_id_form}, json: {dag_id_json}\""
            },
            "39": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 62,
                "PatchRowcode": "+                )"
            },
            "40": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 63,
                "PatchRowcode": "+                return ("
            },
            "41": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 64,
                "PatchRowcode": "+                    render_template("
            },
            "42": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 65,
                "PatchRowcode": "+                        \"airflow/no_roles_permissions.html\","
            },
            "43": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 66,
                "PatchRowcode": "+                        hostname=get_hostname()"
            },
            "44": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 67,
                "PatchRowcode": "+                        if conf.getboolean(\"webserver\", \"EXPOSE_HOSTNAME\")"
            },
            "45": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 68,
                "PatchRowcode": "+                        else \"redact\","
            },
            "46": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 69,
                "PatchRowcode": "+                        logout_url=get_auth_manager().get_url_logout(),"
            },
            "47": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 70,
                "PatchRowcode": "+                    ),"
            },
            "48": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 71,
                "PatchRowcode": "+                    403,"
            },
            "49": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 72,
                "PatchRowcode": "+                )"
            },
            "50": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 73,
                "PatchRowcode": "+            dag_id = unique_dag_ids.pop() if unique_dag_ids else None"
            },
            "51": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 74,
                "PatchRowcode": "+"
            },
            "52": {
                "beforePatchRowNumber": 52,
                "afterPatchRowNumber": 75,
                "PatchRowcode": "             if appbuilder.sm.check_authorization(permissions, dag_id):"
            },
            "53": {
                "beforePatchRowNumber": 53,
                "afterPatchRowNumber": 76,
                "PatchRowcode": "                 return func(*args, **kwargs)"
            },
            "54": {
                "beforePatchRowNumber": 54,
                "afterPatchRowNumber": 77,
                "PatchRowcode": "             elif get_auth_manager().is_logged_in() and not g.user.perms:"
            }
        },
        "frontPatchFile": [
            "# Licensed to the Apache Software Foundation (ASF) under one",
            "# or more contributor license agreements.  See the NOTICE file",
            "# distributed with this work for additional information",
            "# regarding copyright ownership.  The ASF licenses this file",
            "# to you under the Apache License, Version 2.0 (the",
            "# \"License\"); you may not use this file except in compliance",
            "# with the License.  You may obtain a copy of the License at",
            "#",
            "#   http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "# Unless required by applicable law or agreed to in writing,",
            "# software distributed under the License is distributed on an",
            "# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY",
            "# KIND, either express or implied.  See the License for the",
            "# specific language governing permissions and limitations",
            "# under the License.",
            "from __future__ import annotations",
            "",
            "from functools import wraps",
            "from typing import Callable, Sequence, TypeVar, cast",
            "",
            "from flask import current_app, flash, g, redirect, render_template, request",
            "",
            "from airflow.configuration import conf",
            "from airflow.utils.net import get_hostname",
            "from airflow.www.extensions.init_auth_manager import get_auth_manager",
            "",
            "T = TypeVar(\"T\", bound=Callable)",
            "",
            "",
            "def get_access_denied_message():",
            "    return conf.get(\"webserver\", \"access_denied_message\")",
            "",
            "",
            "def has_access(permissions: Sequence[tuple[str, str]] | None = None) -> Callable[[T], T]:",
            "    \"\"\"Factory for decorator that checks current user's permissions against required permissions.\"\"\"",
            "",
            "    def requires_access_decorator(func: T):",
            "        @wraps(func)",
            "        def decorated(*args, **kwargs):",
            "            __tracebackhide__ = True  # Hide from pytest traceback.",
            "",
            "            appbuilder = current_app.appbuilder",
            "",
            "            dag_id = (",
            "                kwargs.get(\"dag_id\")",
            "                or request.args.get(\"dag_id\")",
            "                or request.form.get(\"dag_id\")",
            "                or (request.is_json and request.json.get(\"dag_id\"))",
            "                or None",
            "            )",
            "            if appbuilder.sm.check_authorization(permissions, dag_id):",
            "                return func(*args, **kwargs)",
            "            elif get_auth_manager().is_logged_in() and not g.user.perms:",
            "                return (",
            "                    render_template(",
            "                        \"airflow/no_roles_permissions.html\",",
            "                        hostname=get_hostname()",
            "                        if conf.getboolean(\"webserver\", \"EXPOSE_HOSTNAME\")",
            "                        else \"redact\",",
            "                        logout_url=get_auth_manager().get_url_logout(),",
            "                    ),",
            "                    403,",
            "                )",
            "            else:",
            "                access_denied = get_access_denied_message()",
            "                flash(access_denied, \"danger\")",
            "            return redirect(get_auth_manager().get_url_login(next=request.url))",
            "",
            "        return cast(T, decorated)",
            "",
            "    return requires_access_decorator"
        ],
        "afterPatchFile": [
            "# Licensed to the Apache Software Foundation (ASF) under one",
            "# or more contributor license agreements.  See the NOTICE file",
            "# distributed with this work for additional information",
            "# regarding copyright ownership.  The ASF licenses this file",
            "# to you under the Apache License, Version 2.0 (the",
            "# \"License\"); you may not use this file except in compliance",
            "# with the License.  You may obtain a copy of the License at",
            "#",
            "#   http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "# Unless required by applicable law or agreed to in writing,",
            "# software distributed under the License is distributed on an",
            "# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY",
            "# KIND, either express or implied.  See the License for the",
            "# specific language governing permissions and limitations",
            "# under the License.",
            "from __future__ import annotations",
            "",
            "import logging",
            "from functools import wraps",
            "from typing import Callable, Sequence, TypeVar, cast",
            "",
            "from flask import current_app, flash, g, redirect, render_template, request",
            "",
            "from airflow.configuration import conf",
            "from airflow.utils.net import get_hostname",
            "from airflow.www.extensions.init_auth_manager import get_auth_manager",
            "",
            "T = TypeVar(\"T\", bound=Callable)",
            "",
            "log = logging.getLogger(__name__)",
            "",
            "",
            "def get_access_denied_message():",
            "    return conf.get(\"webserver\", \"access_denied_message\")",
            "",
            "",
            "def has_access(permissions: Sequence[tuple[str, str]] | None = None) -> Callable[[T], T]:",
            "    \"\"\"Factory for decorator that checks current user's permissions against required permissions.\"\"\"",
            "",
            "    def requires_access_decorator(func: T):",
            "        @wraps(func)",
            "        def decorated(*args, **kwargs):",
            "            __tracebackhide__ = True  # Hide from pytest traceback.",
            "",
            "            appbuilder = current_app.appbuilder",
            "",
            "            dag_id_kwargs = kwargs.get(\"dag_id\")",
            "            dag_id_args = request.args.get(\"dag_id\")",
            "            dag_id_form = request.form.get(\"dag_id\")",
            "            dag_id_json = request.json.get(\"dag_id\") if request.is_json else None",
            "            all_dag_ids = [dag_id_kwargs, dag_id_args, dag_id_form, dag_id_json]",
            "            unique_dag_ids = set(dag_id for dag_id in all_dag_ids if dag_id is not None)",
            "",
            "            if len(unique_dag_ids) > 1:",
            "                log.warning(",
            "                    f\"There are different dag_ids passed in the request: {unique_dag_ids}. Returning 403.\"",
            "                )",
            "                log.warning(",
            "                    f\"kwargs: {dag_id_kwargs}, args: {dag_id_args}, \"",
            "                    f\"form: {dag_id_form}, json: {dag_id_json}\"",
            "                )",
            "                return (",
            "                    render_template(",
            "                        \"airflow/no_roles_permissions.html\",",
            "                        hostname=get_hostname()",
            "                        if conf.getboolean(\"webserver\", \"EXPOSE_HOSTNAME\")",
            "                        else \"redact\",",
            "                        logout_url=get_auth_manager().get_url_logout(),",
            "                    ),",
            "                    403,",
            "                )",
            "            dag_id = unique_dag_ids.pop() if unique_dag_ids else None",
            "",
            "            if appbuilder.sm.check_authorization(permissions, dag_id):",
            "                return func(*args, **kwargs)",
            "            elif get_auth_manager().is_logged_in() and not g.user.perms:",
            "                return (",
            "                    render_template(",
            "                        \"airflow/no_roles_permissions.html\",",
            "                        hostname=get_hostname()",
            "                        if conf.getboolean(\"webserver\", \"EXPOSE_HOSTNAME\")",
            "                        else \"redact\",",
            "                        logout_url=get_auth_manager().get_url_logout(),",
            "                    ),",
            "                    403,",
            "                )",
            "            else:",
            "                access_denied = get_access_denied_message()",
            "                flash(access_denied, \"danger\")",
            "            return redirect(get_auth_manager().get_url_login(next=request.url))",
            "",
            "        return cast(T, decorated)",
            "",
            "    return requires_access_decorator"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "45": [
                "has_access",
                "requires_access_decorator",
                "decorated"
            ],
            "46": [
                "has_access",
                "requires_access_decorator",
                "decorated"
            ],
            "47": [
                "has_access",
                "requires_access_decorator",
                "decorated"
            ],
            "48": [
                "has_access",
                "requires_access_decorator",
                "decorated"
            ],
            "49": [
                "has_access",
                "requires_access_decorator",
                "decorated"
            ],
            "50": [
                "has_access",
                "requires_access_decorator",
                "decorated"
            ],
            "51": [
                "has_access",
                "requires_access_decorator",
                "decorated"
            ]
        },
        "addLocation": []
    }
}