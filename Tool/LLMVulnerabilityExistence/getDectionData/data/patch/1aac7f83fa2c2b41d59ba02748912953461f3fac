{
    "setup.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 47,
                "afterPatchRowNumber": 47,
                "PatchRowcode": "         'plone.directives.form',"
            },
            "1": {
                "beforePatchRowNumber": 48,
                "afterPatchRowNumber": 48,
                "PatchRowcode": "         'plone.formwidget.masterselect',"
            },
            "2": {
                "beforePatchRowNumber": 49,
                "afterPatchRowNumber": 49,
                "PatchRowcode": "         'plone.principalsource',"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 50,
                "PatchRowcode": "+        'future',"
            },
            "4": {
                "beforePatchRowNumber": 50,
                "afterPatchRowNumber": 51,
                "PatchRowcode": "         'imio.helpers',"
            },
            "5": {
                "beforePatchRowNumber": 51,
                "afterPatchRowNumber": 52,
                "PatchRowcode": "         'imio.migrator',"
            },
            "6": {
                "beforePatchRowNumber": 52,
                "afterPatchRowNumber": 53,
                "PatchRowcode": "         'setuptools',"
            },
            "7": {
                "beforePatchRowNumber": 53,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        'z3c.table',"
            },
            "8": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 54,
                "PatchRowcode": "+        'z3c.table>=2.2',"
            },
            "9": {
                "beforePatchRowNumber": 54,
                "afterPatchRowNumber": 55,
                "PatchRowcode": "     ],"
            },
            "10": {
                "beforePatchRowNumber": 55,
                "afterPatchRowNumber": 56,
                "PatchRowcode": "     extras_require={"
            },
            "11": {
                "beforePatchRowNumber": 56,
                "afterPatchRowNumber": 57,
                "PatchRowcode": "         'test': ["
            }
        },
        "frontPatchFile": [
            "# -*- coding: utf-8 -*-",
            "\"\"\"Installer for the collective.task package.\"\"\"",
            "",
            "from setuptools import find_packages",
            "from setuptools import setup",
            "",
            "",
            "long_description = (",
            "    open('README.rst').read()",
            "    + '\\n' +",
            "    'Contributors\\n'",
            "    '============\\n'",
            "    + '\\n' +",
            "    open('CONTRIBUTORS.rst').read()",
            "    + '\\n' +",
            "    open('CHANGES.rst').read()",
            "    + '\\n')",
            "",
            "",
            "setup(",
            "    name='collective.task',",
            "    version='3.0.9.dev0',",
            "    description=\"Tasks management for Plone.\",",
            "    long_description=long_description,",
            "    # Get more from http://pypi.python.org/pypi?%3Aaction=list_classifiers",
            "    classifiers=[",
            "        \"Environment :: Web Environment\",",
            "        \"Framework :: Plone\",",
            "        \"Framework :: Plone :: 4.3\",",
            "        \"Programming Language :: Python\",",
            "        \"Programming Language :: Python :: 2.7\",",
            "    ],",
            "    keywords='Plone Python',",
            "    author='C\u00e9dric Messiant',",
            "    author_email='cedricmessiant@ecreall.com',",
            "    url='http://pypi.python.org/pypi/collective.task',",
            "    license='GPL',",
            "    packages=find_packages('src', exclude=['ez_setup']),",
            "    namespace_packages=['collective'],",
            "    package_dir={'': 'src'},",
            "    include_package_data=True,",
            "    zip_safe=False,",
            "    install_requires=[",
            "        'dexterity.localrolesfield',",
            "        'plone.api',",
            "        'plone.app.lockingbehavior',",
            "        'plone.directives.form',",
            "        'plone.formwidget.masterselect',",
            "        'plone.principalsource',",
            "        'imio.helpers',",
            "        'imio.migrator',",
            "        'setuptools',",
            "        'z3c.table',",
            "    ],",
            "    extras_require={",
            "        'test': [",
            "            'collective.eeafaceted.batchactions',",
            "            'imio.prettylink',",
            "            'plone.app.testing',",
            "            'plone.app.contenttypes',",
            "            'plone.app.robotframework[debug]',",
            "        ],",
            "    },",
            "    entry_points=\"\"\"",
            "    [z3c.autoinclude.plugin]",
            "    target = plone",
            "    \"\"\",",
            ")"
        ],
        "afterPatchFile": [
            "# -*- coding: utf-8 -*-",
            "\"\"\"Installer for the collective.task package.\"\"\"",
            "",
            "from setuptools import find_packages",
            "from setuptools import setup",
            "",
            "",
            "long_description = (",
            "    open('README.rst').read()",
            "    + '\\n' +",
            "    'Contributors\\n'",
            "    '============\\n'",
            "    + '\\n' +",
            "    open('CONTRIBUTORS.rst').read()",
            "    + '\\n' +",
            "    open('CHANGES.rst').read()",
            "    + '\\n')",
            "",
            "",
            "setup(",
            "    name='collective.task',",
            "    version='3.0.9.dev0',",
            "    description=\"Tasks management for Plone.\",",
            "    long_description=long_description,",
            "    # Get more from http://pypi.python.org/pypi?%3Aaction=list_classifiers",
            "    classifiers=[",
            "        \"Environment :: Web Environment\",",
            "        \"Framework :: Plone\",",
            "        \"Framework :: Plone :: 4.3\",",
            "        \"Programming Language :: Python\",",
            "        \"Programming Language :: Python :: 2.7\",",
            "    ],",
            "    keywords='Plone Python',",
            "    author='C\u00e9dric Messiant',",
            "    author_email='cedricmessiant@ecreall.com',",
            "    url='http://pypi.python.org/pypi/collective.task',",
            "    license='GPL',",
            "    packages=find_packages('src', exclude=['ez_setup']),",
            "    namespace_packages=['collective'],",
            "    package_dir={'': 'src'},",
            "    include_package_data=True,",
            "    zip_safe=False,",
            "    install_requires=[",
            "        'dexterity.localrolesfield',",
            "        'plone.api',",
            "        'plone.app.lockingbehavior',",
            "        'plone.directives.form',",
            "        'plone.formwidget.masterselect',",
            "        'plone.principalsource',",
            "        'future',",
            "        'imio.helpers',",
            "        'imio.migrator',",
            "        'setuptools',",
            "        'z3c.table>=2.2',",
            "    ],",
            "    extras_require={",
            "        'test': [",
            "            'collective.eeafaceted.batchactions',",
            "            'imio.prettylink',",
            "            'plone.app.testing',",
            "            'plone.app.contenttypes',",
            "            'plone.app.robotframework[debug]',",
            "        ],",
            "    },",
            "    entry_points=\"\"\"",
            "    [z3c.autoinclude.plugin]",
            "    target = plone",
            "    \"\"\",",
            ")"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "53": []
        },
        "addLocation": []
    },
    "src/collective/task/browser/table.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 4,
                "afterPatchRowNumber": 4,
                "PatchRowcode": " from collective.task import _"
            },
            "1": {
                "beforePatchRowNumber": 5,
                "afterPatchRowNumber": 5,
                "PatchRowcode": " from collective.task import PMF"
            },
            "2": {
                "beforePatchRowNumber": 6,
                "afterPatchRowNumber": 6,
                "PatchRowcode": " from collective.task.adapters import EMPTY_STRING"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 7,
                "PatchRowcode": "+from html import escape"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 8,
                "PatchRowcode": "+from imio.helpers.adapters import NoEscapeLinkColumn"
            },
            "5": {
                "beforePatchRowNumber": 7,
                "afterPatchRowNumber": 9,
                "PatchRowcode": " from plone import api"
            },
            "6": {
                "beforePatchRowNumber": 8,
                "afterPatchRowNumber": 10,
                "PatchRowcode": " from Products.CMFPlone.utils import normalizeString"
            },
            "7": {
                "beforePatchRowNumber": 9,
                "afterPatchRowNumber": 11,
                "PatchRowcode": " from Products.CMFPlone.utils import safe_unicode"
            },
            "8": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 22,
                "PatchRowcode": " "
            },
            "9": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 23,
                "PatchRowcode": " "
            },
            "10": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": 24,
                "PatchRowcode": " class TasksTable(Table):"
            },
            "11": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "12": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": 25,
                "PatchRowcode": "     \"\"\"Table that displays tasks info.\"\"\""
            },
            "13": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 26,
                "PatchRowcode": " "
            },
            "14": {
                "beforePatchRowNumber": 26,
                "afterPatchRowNumber": 27,
                "PatchRowcode": "     cssClassEven = u'even'"
            },
            "15": {
                "beforePatchRowNumber": 49,
                "afterPatchRowNumber": 50,
                "PatchRowcode": " "
            },
            "16": {
                "beforePatchRowNumber": 50,
                "afterPatchRowNumber": 51,
                "PatchRowcode": " "
            },
            "17": {
                "beforePatchRowNumber": 51,
                "afterPatchRowNumber": 52,
                "PatchRowcode": " class UserColumn(Column):"
            },
            "18": {
                "beforePatchRowNumber": 52,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "19": {
                "beforePatchRowNumber": 53,
                "afterPatchRowNumber": 53,
                "PatchRowcode": "     \"\"\"Base user column.\"\"\""
            },
            "20": {
                "beforePatchRowNumber": 54,
                "afterPatchRowNumber": 54,
                "PatchRowcode": " "
            },
            "21": {
                "beforePatchRowNumber": 55,
                "afterPatchRowNumber": 55,
                "PatchRowcode": "     field = NotImplemented"
            },
            "22": {
                "beforePatchRowNumber": 58,
                "afterPatchRowNumber": 58,
                "PatchRowcode": "         username = getattr(value, self.field, '')"
            },
            "23": {
                "beforePatchRowNumber": 59,
                "afterPatchRowNumber": 59,
                "PatchRowcode": "         if username and username != EMPTY_STRING:"
            },
            "24": {
                "beforePatchRowNumber": 60,
                "afterPatchRowNumber": 60,
                "PatchRowcode": "             member = api.user.get(username)"
            },
            "25": {
                "beforePatchRowNumber": 61,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            return member.getUser().getProperty('fullname').decode('utf-8')"
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 61,
                "PatchRowcode": "+            return escape(member.getUser().getProperty('fullname').decode('utf-8'))"
            },
            "27": {
                "beforePatchRowNumber": 62,
                "afterPatchRowNumber": 62,
                "PatchRowcode": " "
            },
            "28": {
                "beforePatchRowNumber": 63,
                "afterPatchRowNumber": 63,
                "PatchRowcode": "         return \"\""
            },
            "29": {
                "beforePatchRowNumber": 64,
                "afterPatchRowNumber": 64,
                "PatchRowcode": " "
            },
            "30": {
                "beforePatchRowNumber": 65,
                "afterPatchRowNumber": 65,
                "PatchRowcode": " "
            },
            "31": {
                "beforePatchRowNumber": 66,
                "afterPatchRowNumber": 66,
                "PatchRowcode": " class TitleColumn(LinkColumn):"
            },
            "32": {
                "beforePatchRowNumber": 67,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "33": {
                "beforePatchRowNumber": 68,
                "afterPatchRowNumber": 67,
                "PatchRowcode": "     \"\"\"Column that displays title.\"\"\""
            },
            "34": {
                "beforePatchRowNumber": 69,
                "afterPatchRowNumber": 68,
                "PatchRowcode": " "
            },
            "35": {
                "beforePatchRowNumber": 70,
                "afterPatchRowNumber": 69,
                "PatchRowcode": "     header = PMF(\"Title\")"
            },
            "36": {
                "beforePatchRowNumber": 79,
                "afterPatchRowNumber": 78,
                "PatchRowcode": " "
            },
            "37": {
                "beforePatchRowNumber": 80,
                "afterPatchRowNumber": 79,
                "PatchRowcode": " "
            },
            "38": {
                "beforePatchRowNumber": 81,
                "afterPatchRowNumber": 80,
                "PatchRowcode": " class PrettyLinkTitleColumn(TitleColumn):"
            },
            "39": {
                "beforePatchRowNumber": 82,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "40": {
                "beforePatchRowNumber": 83,
                "afterPatchRowNumber": 81,
                "PatchRowcode": "     \"\"\"Column that displays prettylink title.\"\"\""
            },
            "41": {
                "beforePatchRowNumber": 84,
                "afterPatchRowNumber": 82,
                "PatchRowcode": " "
            },
            "42": {
                "beforePatchRowNumber": 85,
                "afterPatchRowNumber": 83,
                "PatchRowcode": "     header = PMF(\"Title\")"
            },
            "43": {
                "beforePatchRowNumber": 99,
                "afterPatchRowNumber": 97,
                "PatchRowcode": " "
            },
            "44": {
                "beforePatchRowNumber": 100,
                "afterPatchRowNumber": 98,
                "PatchRowcode": " "
            },
            "45": {
                "beforePatchRowNumber": 101,
                "afterPatchRowNumber": 99,
                "PatchRowcode": " class EnquirerColumn(UserColumn):"
            },
            "46": {
                "beforePatchRowNumber": 102,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "47": {
                "beforePatchRowNumber": 103,
                "afterPatchRowNumber": 100,
                "PatchRowcode": "     \"\"\"Column that displays enquirer.\"\"\""
            },
            "48": {
                "beforePatchRowNumber": 104,
                "afterPatchRowNumber": 101,
                "PatchRowcode": " "
            },
            "49": {
                "beforePatchRowNumber": 105,
                "afterPatchRowNumber": 102,
                "PatchRowcode": "     header = _(\"Enquirer\")"
            },
            "50": {
                "beforePatchRowNumber": 108,
                "afterPatchRowNumber": 105,
                "PatchRowcode": " "
            },
            "51": {
                "beforePatchRowNumber": 109,
                "afterPatchRowNumber": 106,
                "PatchRowcode": " "
            },
            "52": {
                "beforePatchRowNumber": 110,
                "afterPatchRowNumber": 107,
                "PatchRowcode": " class AssignedGroupColumn(Column):"
            },
            "53": {
                "beforePatchRowNumber": 111,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "54": {
                "beforePatchRowNumber": 112,
                "afterPatchRowNumber": 108,
                "PatchRowcode": "     \"\"\"Column that displays assigned group.\"\"\""
            },
            "55": {
                "beforePatchRowNumber": 113,
                "afterPatchRowNumber": 109,
                "PatchRowcode": " "
            },
            "56": {
                "beforePatchRowNumber": 114,
                "afterPatchRowNumber": 110,
                "PatchRowcode": "     header = _(\"Assigned group\")"
            },
            "57": {
                "beforePatchRowNumber": 117,
                "afterPatchRowNumber": 113,
                "PatchRowcode": "     def renderCell(self, value):"
            },
            "58": {
                "beforePatchRowNumber": 118,
                "afterPatchRowNumber": 114,
                "PatchRowcode": "         if value.assigned_group:"
            },
            "59": {
                "beforePatchRowNumber": 119,
                "afterPatchRowNumber": 115,
                "PatchRowcode": "             group = api.group.get(value.assigned_group).getGroup()"
            },
            "60": {
                "beforePatchRowNumber": 120,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            return group.getProperty('title').decode('utf-8')"
            },
            "61": {
                "beforePatchRowNumber": 121,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "62": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 116,
                "PatchRowcode": "+            return escape(group.getProperty('title').decode('utf-8'))"
            },
            "63": {
                "beforePatchRowNumber": 122,
                "afterPatchRowNumber": 117,
                "PatchRowcode": "         return \"\""
            },
            "64": {
                "beforePatchRowNumber": 123,
                "afterPatchRowNumber": 118,
                "PatchRowcode": " "
            },
            "65": {
                "beforePatchRowNumber": 124,
                "afterPatchRowNumber": 119,
                "PatchRowcode": " "
            },
            "66": {
                "beforePatchRowNumber": 125,
                "afterPatchRowNumber": 120,
                "PatchRowcode": " class AssignedUserColumn(UserColumn):"
            },
            "67": {
                "beforePatchRowNumber": 126,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "68": {
                "beforePatchRowNumber": 127,
                "afterPatchRowNumber": 121,
                "PatchRowcode": "     \"\"\"Column that displays assigned user.\"\"\""
            },
            "69": {
                "beforePatchRowNumber": 128,
                "afterPatchRowNumber": 122,
                "PatchRowcode": " "
            },
            "70": {
                "beforePatchRowNumber": 129,
                "afterPatchRowNumber": 123,
                "PatchRowcode": "     header = _(\"Assigned user\")"
            },
            "71": {
                "beforePatchRowNumber": 132,
                "afterPatchRowNumber": 126,
                "PatchRowcode": " "
            },
            "72": {
                "beforePatchRowNumber": 133,
                "afterPatchRowNumber": 127,
                "PatchRowcode": " "
            },
            "73": {
                "beforePatchRowNumber": 134,
                "afterPatchRowNumber": 128,
                "PatchRowcode": " class DueDateColumn(Column):"
            },
            "74": {
                "beforePatchRowNumber": 135,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "75": {
                "beforePatchRowNumber": 136,
                "afterPatchRowNumber": 129,
                "PatchRowcode": "     \"\"\"Column that displays due date.\"\"\""
            },
            "76": {
                "beforePatchRowNumber": 137,
                "afterPatchRowNumber": 130,
                "PatchRowcode": " "
            },
            "77": {
                "beforePatchRowNumber": 138,
                "afterPatchRowNumber": 131,
                "PatchRowcode": "     header = _(\"Due date\")"
            },
            "78": {
                "beforePatchRowNumber": 144,
                "afterPatchRowNumber": 137,
                "PatchRowcode": "         if value.due_date:"
            },
            "79": {
                "beforePatchRowNumber": 145,
                "afterPatchRowNumber": 138,
                "PatchRowcode": "             return api.portal.get_localized_time(datetime=value.due_date, long_format=self.long_format,"
            },
            "80": {
                "beforePatchRowNumber": 146,
                "afterPatchRowNumber": 139,
                "PatchRowcode": "                                                  time_only=self.time_only)"
            },
            "81": {
                "beforePatchRowNumber": 147,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "82": {
                "beforePatchRowNumber": 148,
                "afterPatchRowNumber": 140,
                "PatchRowcode": "         return \"\""
            },
            "83": {
                "beforePatchRowNumber": 149,
                "afterPatchRowNumber": 141,
                "PatchRowcode": " "
            },
            "84": {
                "beforePatchRowNumber": 150,
                "afterPatchRowNumber": 142,
                "PatchRowcode": " "
            },
            "85": {
                "beforePatchRowNumber": 151,
                "afterPatchRowNumber": 143,
                "PatchRowcode": " class ReviewStateColumn(Column):"
            },
            "86": {
                "beforePatchRowNumber": 152,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "87": {
                "beforePatchRowNumber": 153,
                "afterPatchRowNumber": 144,
                "PatchRowcode": "     \"\"\"Column that displays value's review state.\"\"\""
            },
            "88": {
                "beforePatchRowNumber": 154,
                "afterPatchRowNumber": 145,
                "PatchRowcode": " "
            },
            "89": {
                "beforePatchRowNumber": 155,
                "afterPatchRowNumber": 146,
                "PatchRowcode": "     header = PMF(\"Review state\")"
            },
            "90": {
                "beforePatchRowNumber": 160,
                "afterPatchRowNumber": 151,
                "PatchRowcode": "         if state:"
            },
            "91": {
                "beforePatchRowNumber": 161,
                "afterPatchRowNumber": 152,
                "PatchRowcode": "             wtool = api.portal.get_tool('portal_workflow')"
            },
            "92": {
                "beforePatchRowNumber": 162,
                "afterPatchRowNumber": 153,
                "PatchRowcode": "             state_title = wtool.getTitleForStateOnType(state, value.portal_type)"
            },
            "93": {
                "beforePatchRowNumber": 163,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            return translate(PMF(state_title), context=self.request)"
            },
            "94": {
                "beforePatchRowNumber": 164,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "95": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 154,
                "PatchRowcode": "+            return escape(translate(PMF(state_title), context=self.request))"
            },
            "96": {
                "beforePatchRowNumber": 165,
                "afterPatchRowNumber": 155,
                "PatchRowcode": "         return ''"
            }
        },
        "frontPatchFile": [
            "# -*- coding: utf-8 -*-",
            "\"\"\"Define tables and columns.\"\"\"",
            "",
            "from collective.task import _",
            "from collective.task import PMF",
            "from collective.task.adapters import EMPTY_STRING",
            "from plone import api",
            "from Products.CMFPlone.utils import normalizeString",
            "from Products.CMFPlone.utils import safe_unicode",
            "from z3c.table.column import Column",
            "from z3c.table.column import LinkColumn",
            "from z3c.table.table import Table",
            "from zope.cachedescriptors.property import CachedProperty",
            "from zope.i18n import translate",
            "",
            "try:",
            "    from imio.prettylink.interfaces import IPrettyLink",
            "except ImportError:",
            "    pass",
            "",
            "",
            "class TasksTable(Table):",
            "",
            "    \"\"\"Table that displays tasks info.\"\"\"",
            "",
            "    cssClassEven = u'even'",
            "    cssClassOdd = u'odd'",
            "    cssClasses = {'table': 'listing taskContainerListing icons-on'}",
            "",
            "    batchSize = 20",
            "    startBatchingAt = 30",
            "    results = []",
            "",
            "    @CachedProperty",
            "    def translation_service(self):",
            "        return api.portal.get_tool('translation_service')",
            "",
            "    @CachedProperty",
            "    def wtool(self):",
            "        return api.portal.get_tool('portal_workflow')",
            "",
            "    @CachedProperty",
            "    def portal_url(self):",
            "        return api.portal.get().absolute_url()",
            "",
            "    @CachedProperty",
            "    def values(self):",
            "        return self.results",
            "",
            "",
            "class UserColumn(Column):",
            "",
            "    \"\"\"Base user column.\"\"\"",
            "",
            "    field = NotImplemented",
            "",
            "    def renderCell(self, value):",
            "        username = getattr(value, self.field, '')",
            "        if username and username != EMPTY_STRING:",
            "            member = api.user.get(username)",
            "            return member.getUser().getProperty('fullname').decode('utf-8')",
            "",
            "        return \"\"",
            "",
            "",
            "class TitleColumn(LinkColumn):",
            "",
            "    \"\"\"Column that displays title.\"\"\"",
            "",
            "    header = PMF(\"Title\")",
            "    weight = 10",
            "",
            "    def getLinkCSS(self, item):",
            "        return ' class=\"state-%s contenttype-%s\"' % (api.content.get_state(obj=item),",
            "                                                     normalizeString(item.portal_type))",
            "",
            "    def getLinkContent(self, item):",
            "        return safe_unicode(item.title)",
            "",
            "",
            "class PrettyLinkTitleColumn(TitleColumn):",
            "",
            "    \"\"\"Column that displays prettylink title.\"\"\"",
            "",
            "    header = PMF(\"Title\")",
            "    weight = 10",
            "",
            "    params = {}",
            "",
            "    def getPrettyLink(self, obj):",
            "        pl = IPrettyLink(obj)",
            "        for k, v in self.params.items():",
            "            setattr(pl, k, v)",
            "        return pl.getLink()",
            "",
            "    def renderCell(self, item):",
            "        \"\"\" \"\"\"",
            "        return self.getPrettyLink(item)",
            "",
            "",
            "class EnquirerColumn(UserColumn):",
            "",
            "    \"\"\"Column that displays enquirer.\"\"\"",
            "",
            "    header = _(\"Enquirer\")",
            "    weight = 20",
            "    field = 'enquirer'",
            "",
            "",
            "class AssignedGroupColumn(Column):",
            "",
            "    \"\"\"Column that displays assigned group.\"\"\"",
            "",
            "    header = _(\"Assigned group\")",
            "    weight = 30",
            "",
            "    def renderCell(self, value):",
            "        if value.assigned_group:",
            "            group = api.group.get(value.assigned_group).getGroup()",
            "            return group.getProperty('title').decode('utf-8')",
            "",
            "        return \"\"",
            "",
            "",
            "class AssignedUserColumn(UserColumn):",
            "",
            "    \"\"\"Column that displays assigned user.\"\"\"",
            "",
            "    header = _(\"Assigned user\")",
            "    weight = 40",
            "    field = 'assigned_user'",
            "",
            "",
            "class DueDateColumn(Column):",
            "",
            "    \"\"\"Column that displays due date.\"\"\"",
            "",
            "    header = _(\"Due date\")",
            "    weight = 50",
            "    long_format = False",
            "    time_only = False",
            "",
            "    def renderCell(self, value):",
            "        if value.due_date:",
            "            return api.portal.get_localized_time(datetime=value.due_date, long_format=self.long_format,",
            "                                                 time_only=self.time_only)",
            "",
            "        return \"\"",
            "",
            "",
            "class ReviewStateColumn(Column):",
            "",
            "    \"\"\"Column that displays value's review state.\"\"\"",
            "",
            "    header = PMF(\"Review state\")",
            "    weight = 60",
            "",
            "    def renderCell(self, value):",
            "        state = api.content.get_state(value)",
            "        if state:",
            "            wtool = api.portal.get_tool('portal_workflow')",
            "            state_title = wtool.getTitleForStateOnType(state, value.portal_type)",
            "            return translate(PMF(state_title), context=self.request)",
            "",
            "        return ''"
        ],
        "afterPatchFile": [
            "# -*- coding: utf-8 -*-",
            "\"\"\"Define tables and columns.\"\"\"",
            "",
            "from collective.task import _",
            "from collective.task import PMF",
            "from collective.task.adapters import EMPTY_STRING",
            "from html import escape",
            "from imio.helpers.adapters import NoEscapeLinkColumn",
            "from plone import api",
            "from Products.CMFPlone.utils import normalizeString",
            "from Products.CMFPlone.utils import safe_unicode",
            "from z3c.table.column import Column",
            "from z3c.table.column import LinkColumn",
            "from z3c.table.table import Table",
            "from zope.cachedescriptors.property import CachedProperty",
            "from zope.i18n import translate",
            "",
            "try:",
            "    from imio.prettylink.interfaces import IPrettyLink",
            "except ImportError:",
            "    pass",
            "",
            "",
            "class TasksTable(Table):",
            "    \"\"\"Table that displays tasks info.\"\"\"",
            "",
            "    cssClassEven = u'even'",
            "    cssClassOdd = u'odd'",
            "    cssClasses = {'table': 'listing taskContainerListing icons-on'}",
            "",
            "    batchSize = 20",
            "    startBatchingAt = 30",
            "    results = []",
            "",
            "    @CachedProperty",
            "    def translation_service(self):",
            "        return api.portal.get_tool('translation_service')",
            "",
            "    @CachedProperty",
            "    def wtool(self):",
            "        return api.portal.get_tool('portal_workflow')",
            "",
            "    @CachedProperty",
            "    def portal_url(self):",
            "        return api.portal.get().absolute_url()",
            "",
            "    @CachedProperty",
            "    def values(self):",
            "        return self.results",
            "",
            "",
            "class UserColumn(Column):",
            "    \"\"\"Base user column.\"\"\"",
            "",
            "    field = NotImplemented",
            "",
            "    def renderCell(self, value):",
            "        username = getattr(value, self.field, '')",
            "        if username and username != EMPTY_STRING:",
            "            member = api.user.get(username)",
            "            return escape(member.getUser().getProperty('fullname').decode('utf-8'))",
            "",
            "        return \"\"",
            "",
            "",
            "class TitleColumn(LinkColumn):",
            "    \"\"\"Column that displays title.\"\"\"",
            "",
            "    header = PMF(\"Title\")",
            "    weight = 10",
            "",
            "    def getLinkCSS(self, item):",
            "        return ' class=\"state-%s contenttype-%s\"' % (api.content.get_state(obj=item),",
            "                                                     normalizeString(item.portal_type))",
            "",
            "    def getLinkContent(self, item):",
            "        return safe_unicode(item.title)",
            "",
            "",
            "class PrettyLinkTitleColumn(TitleColumn):",
            "    \"\"\"Column that displays prettylink title.\"\"\"",
            "",
            "    header = PMF(\"Title\")",
            "    weight = 10",
            "",
            "    params = {}",
            "",
            "    def getPrettyLink(self, obj):",
            "        pl = IPrettyLink(obj)",
            "        for k, v in self.params.items():",
            "            setattr(pl, k, v)",
            "        return pl.getLink()",
            "",
            "    def renderCell(self, item):",
            "        \"\"\" \"\"\"",
            "        return self.getPrettyLink(item)",
            "",
            "",
            "class EnquirerColumn(UserColumn):",
            "    \"\"\"Column that displays enquirer.\"\"\"",
            "",
            "    header = _(\"Enquirer\")",
            "    weight = 20",
            "    field = 'enquirer'",
            "",
            "",
            "class AssignedGroupColumn(Column):",
            "    \"\"\"Column that displays assigned group.\"\"\"",
            "",
            "    header = _(\"Assigned group\")",
            "    weight = 30",
            "",
            "    def renderCell(self, value):",
            "        if value.assigned_group:",
            "            group = api.group.get(value.assigned_group).getGroup()",
            "            return escape(group.getProperty('title').decode('utf-8'))",
            "        return \"\"",
            "",
            "",
            "class AssignedUserColumn(UserColumn):",
            "    \"\"\"Column that displays assigned user.\"\"\"",
            "",
            "    header = _(\"Assigned user\")",
            "    weight = 40",
            "    field = 'assigned_user'",
            "",
            "",
            "class DueDateColumn(Column):",
            "    \"\"\"Column that displays due date.\"\"\"",
            "",
            "    header = _(\"Due date\")",
            "    weight = 50",
            "    long_format = False",
            "    time_only = False",
            "",
            "    def renderCell(self, value):",
            "        if value.due_date:",
            "            return api.portal.get_localized_time(datetime=value.due_date, long_format=self.long_format,",
            "                                                 time_only=self.time_only)",
            "        return \"\"",
            "",
            "",
            "class ReviewStateColumn(Column):",
            "    \"\"\"Column that displays value's review state.\"\"\"",
            "",
            "    header = PMF(\"Review state\")",
            "    weight = 60",
            "",
            "    def renderCell(self, value):",
            "        state = api.content.get_state(value)",
            "        if state:",
            "            wtool = api.portal.get_tool('portal_workflow')",
            "            state_title = wtool.getTitleForStateOnType(state, value.portal_type)",
            "            return escape(translate(PMF(state_title), context=self.request))",
            "        return ''"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "0"
        ],
        "dele_reviseLocation": {
            "23": [
                "TasksTable"
            ],
            "52": [
                "UserColumn"
            ],
            "61": [
                "UserColumn",
                "renderCell"
            ],
            "67": [
                "TitleColumn"
            ],
            "82": [
                "PrettyLinkTitleColumn"
            ],
            "102": [
                "EnquirerColumn"
            ],
            "111": [
                "AssignedGroupColumn"
            ],
            "120": [
                "AssignedGroupColumn",
                "renderCell"
            ],
            "121": [
                "AssignedGroupColumn",
                "renderCell"
            ],
            "126": [
                "AssignedUserColumn"
            ],
            "135": [
                "DueDateColumn"
            ],
            "147": [
                "DueDateColumn",
                "renderCell"
            ],
            "152": [
                "ReviewStateColumn"
            ],
            "163": [
                "ReviewStateColumn",
                "renderCell"
            ],
            "164": [
                "ReviewStateColumn",
                "renderCell"
            ]
        },
        "addLocation": []
    }
}