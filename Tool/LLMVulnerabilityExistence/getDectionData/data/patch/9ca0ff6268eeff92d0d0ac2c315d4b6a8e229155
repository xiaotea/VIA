{
    "django/core/files/images.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 47,
                "afterPatchRowNumber": 47,
                "PatchRowcode": "         file = open(file_or_path, 'rb')"
            },
            "1": {
                "beforePatchRowNumber": 48,
                "afterPatchRowNumber": 48,
                "PatchRowcode": "         close = True"
            },
            "2": {
                "beforePatchRowNumber": 49,
                "afterPatchRowNumber": 49,
                "PatchRowcode": "     try:"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 50,
                "PatchRowcode": "+        # Most of the time PIL only needs a small chunk to parse the image and"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 51,
                "PatchRowcode": "+        # get the dimensions, but with some TIFF files PIL needs to parse the"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 52,
                "PatchRowcode": "+        # whole file."
            },
            "6": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 53,
                "PatchRowcode": "+        chunk_size = 1024"
            },
            "7": {
                "beforePatchRowNumber": 50,
                "afterPatchRowNumber": 54,
                "PatchRowcode": "         while 1:"
            },
            "8": {
                "beforePatchRowNumber": 51,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-            data = file.read(1024)"
            },
            "9": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 55,
                "PatchRowcode": "+            data = file.read(chunk_size)"
            },
            "10": {
                "beforePatchRowNumber": 52,
                "afterPatchRowNumber": 56,
                "PatchRowcode": "             if not data:"
            },
            "11": {
                "beforePatchRowNumber": 53,
                "afterPatchRowNumber": 57,
                "PatchRowcode": "                 break"
            },
            "12": {
                "beforePatchRowNumber": 54,
                "afterPatchRowNumber": 58,
                "PatchRowcode": "             p.feed(data)"
            },
            "13": {
                "beforePatchRowNumber": 55,
                "afterPatchRowNumber": 59,
                "PatchRowcode": "             if p.image:"
            },
            "14": {
                "beforePatchRowNumber": 56,
                "afterPatchRowNumber": 60,
                "PatchRowcode": "                 return p.image.size"
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 61,
                "PatchRowcode": "+            chunk_size = chunk_size*2"
            },
            "16": {
                "beforePatchRowNumber": 57,
                "afterPatchRowNumber": 62,
                "PatchRowcode": "         return None"
            },
            "17": {
                "beforePatchRowNumber": 58,
                "afterPatchRowNumber": 63,
                "PatchRowcode": "     finally:"
            },
            "18": {
                "beforePatchRowNumber": 59,
                "afterPatchRowNumber": 64,
                "PatchRowcode": "         if close:"
            }
        },
        "frontPatchFile": [
            "\"\"\"",
            "Utility functions for handling images.",
            "",
            "Requires PIL, as you might imagine.",
            "\"\"\"",
            "",
            "from django.core.files import File",
            "",
            "class ImageFile(File):",
            "    \"\"\"",
            "    A mixin for use alongside django.core.files.base.File, which provides",
            "    additional features for dealing with images.",
            "    \"\"\"",
            "    def _get_width(self):",
            "        return self._get_image_dimensions()[0]",
            "    width = property(_get_width)",
            "",
            "    def _get_height(self):",
            "        return self._get_image_dimensions()[1]",
            "    height = property(_get_height)",
            "",
            "    def _get_image_dimensions(self):",
            "        if not hasattr(self, '_dimensions_cache'):",
            "            close = self.closed",
            "            self.open()",
            "            self._dimensions_cache = get_image_dimensions(self, close=close)",
            "        return self._dimensions_cache",
            "",
            "def get_image_dimensions(file_or_path, close=False):",
            "    \"\"\"",
            "    Returns the (width, height) of an image, given an open file or a path.  Set",
            "    'close' to True to close the file at the end if it is initially in an open",
            "    state.",
            "    \"\"\"",
            "    # Try to import PIL in either of the two ways it can end up installed.",
            "    try:",
            "        from PIL import ImageFile as PILImageFile",
            "    except ImportError:",
            "        import ImageFile as PILImageFile",
            "",
            "    p = PILImageFile.Parser()",
            "    if hasattr(file_or_path, 'read'):",
            "        file = file_or_path",
            "        file_pos = file.tell()",
            "        file.seek(0)",
            "    else:",
            "        file = open(file_or_path, 'rb')",
            "        close = True",
            "    try:",
            "        while 1:",
            "            data = file.read(1024)",
            "            if not data:",
            "                break",
            "            p.feed(data)",
            "            if p.image:",
            "                return p.image.size",
            "        return None",
            "    finally:",
            "        if close:",
            "            file.close()",
            "        else:",
            "            file.seek(file_pos)"
        ],
        "afterPatchFile": [
            "\"\"\"",
            "Utility functions for handling images.",
            "",
            "Requires PIL, as you might imagine.",
            "\"\"\"",
            "",
            "from django.core.files import File",
            "",
            "class ImageFile(File):",
            "    \"\"\"",
            "    A mixin for use alongside django.core.files.base.File, which provides",
            "    additional features for dealing with images.",
            "    \"\"\"",
            "    def _get_width(self):",
            "        return self._get_image_dimensions()[0]",
            "    width = property(_get_width)",
            "",
            "    def _get_height(self):",
            "        return self._get_image_dimensions()[1]",
            "    height = property(_get_height)",
            "",
            "    def _get_image_dimensions(self):",
            "        if not hasattr(self, '_dimensions_cache'):",
            "            close = self.closed",
            "            self.open()",
            "            self._dimensions_cache = get_image_dimensions(self, close=close)",
            "        return self._dimensions_cache",
            "",
            "def get_image_dimensions(file_or_path, close=False):",
            "    \"\"\"",
            "    Returns the (width, height) of an image, given an open file or a path.  Set",
            "    'close' to True to close the file at the end if it is initially in an open",
            "    state.",
            "    \"\"\"",
            "    # Try to import PIL in either of the two ways it can end up installed.",
            "    try:",
            "        from PIL import ImageFile as PILImageFile",
            "    except ImportError:",
            "        import ImageFile as PILImageFile",
            "",
            "    p = PILImageFile.Parser()",
            "    if hasattr(file_or_path, 'read'):",
            "        file = file_or_path",
            "        file_pos = file.tell()",
            "        file.seek(0)",
            "    else:",
            "        file = open(file_or_path, 'rb')",
            "        close = True",
            "    try:",
            "        # Most of the time PIL only needs a small chunk to parse the image and",
            "        # get the dimensions, but with some TIFF files PIL needs to parse the",
            "        # whole file.",
            "        chunk_size = 1024",
            "        while 1:",
            "            data = file.read(chunk_size)",
            "            if not data:",
            "                break",
            "            p.feed(data)",
            "            if p.image:",
            "                return p.image.size",
            "            chunk_size = chunk_size*2",
            "        return None",
            "    finally:",
            "        if close:",
            "            file.close()",
            "        else:",
            "            file.seek(file_pos)"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "51": [
                "get_image_dimensions"
            ]
        },
        "addLocation": [
            "redbot.cogs.trivia.trivia",
            "django.core.files.images.ImageFile._get_image_dimensions"
        ]
    }
}