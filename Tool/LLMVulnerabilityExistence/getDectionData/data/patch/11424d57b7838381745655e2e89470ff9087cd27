{
    "trytond/tests/test_user.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 37,
                "afterPatchRowNumber": 37,
                "PatchRowcode": "             User.write([user], {"
            },
            "1": {
                "beforePatchRowNumber": 38,
                "afterPatchRowNumber": 38,
                "PatchRowcode": "                     'password': password,"
            },
            "2": {
                "beforePatchRowNumber": 39,
                "afterPatchRowNumber": 39,
                "PatchRowcode": "                     })"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 40,
                "PatchRowcode": "+        return user"
            },
            "4": {
                "beforePatchRowNumber": 40,
                "afterPatchRowNumber": 41,
                "PatchRowcode": " "
            },
            "5": {
                "beforePatchRowNumber": 41,
                "afterPatchRowNumber": 42,
                "PatchRowcode": "     def check_user(self, login, password):"
            },
            "6": {
                "beforePatchRowNumber": 42,
                "afterPatchRowNumber": 43,
                "PatchRowcode": "         pool = Pool()"
            },
            "7": {
                "beforePatchRowNumber": 72,
                "afterPatchRowNumber": 73,
                "PatchRowcode": "         self.create_user('user', '12345', 'bcrypt')"
            },
            "8": {
                "beforePatchRowNumber": 73,
                "afterPatchRowNumber": 74,
                "PatchRowcode": "         self.check_user('user', '12345')"
            },
            "9": {
                "beforePatchRowNumber": 74,
                "afterPatchRowNumber": 75,
                "PatchRowcode": " "
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 76,
                "PatchRowcode": "+    @with_transaction()"
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 77,
                "PatchRowcode": "+    def test_read_password_hash(self):"
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 78,
                "PatchRowcode": "+        \"Test password_hash can not be read\""
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 79,
                "PatchRowcode": "+        user = self.create_user('user', '12345')"
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 80,
                "PatchRowcode": "+        self.assertIsNone(user.password_hash)"
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 81,
                "PatchRowcode": "+"
            },
            "16": {
                "beforePatchRowNumber": 75,
                "afterPatchRowNumber": 82,
                "PatchRowcode": " "
            },
            "17": {
                "beforePatchRowNumber": 76,
                "afterPatchRowNumber": 83,
                "PatchRowcode": " def suite():"
            },
            "18": {
                "beforePatchRowNumber": 77,
                "afterPatchRowNumber": 84,
                "PatchRowcode": "     return unittest.TestLoader().loadTestsFromTestCase(UserTestCase)"
            }
        },
        "frontPatchFile": [
            "# This file is part of Tryton.  The COPYRIGHT file at the top level of this",
            "# repository contains the full copyright notices and license terms.",
            "",
            "import unittest",
            "from trytond.tests.test_tryton import install_module, with_transaction",
            "from trytond.pool import Pool",
            "from trytond.res.user import bcrypt",
            "from trytond.config import config",
            "",
            "",
            "class UserTestCase(unittest.TestCase):",
            "    'Test User'",
            "",
            "    @classmethod",
            "    def setUpClass(cls):",
            "        install_module('res')",
            "",
            "    def setUp(self):",
            "        methods = config.get('session', 'authentications')",
            "        config.set('session', 'authentications', 'password')",
            "        self.addCleanup(config.set, 'session', 'authentications', methods)",
            "",
            "    def create_user(self, login, password, hash_method=None):",
            "        pool = Pool()",
            "        User = pool.get('res.user')",
            "",
            "        user, = User.create([{",
            "                    'name': login,",
            "                    'login': login,",
            "                    }])",
            "        if hash_method:",
            "            hash = getattr(User, 'hash_' + hash_method)",
            "            User.write([user], {",
            "                    'password_hash': hash(password),",
            "                    })",
            "        else:",
            "            User.write([user], {",
            "                    'password': password,",
            "                    })",
            "",
            "    def check_user(self, login, password):",
            "        pool = Pool()",
            "        User = pool.get('res.user')",
            "",
            "        user, = User.search([('login', '=', login)])",
            "        user_id = User.get_login(login, {",
            "                'password': password,",
            "                })",
            "        self.assertEqual(user_id, user.id)",
            "",
            "        bad_user_id = User.get_login(login, {",
            "                'password': password + 'wrong',",
            "                })",
            "        self.assertFalse(bad_user_id)",
            "",
            "    @with_transaction()",
            "    def test_test_hash(self):",
            "        'Test default hash password'",
            "        self.create_user('user', '12345')",
            "        self.check_user('user', '12345')",
            "",
            "    @with_transaction()",
            "    def test_test_sha1(self):",
            "        'Test sha1 password'",
            "        self.create_user('user', '12345', 'sha1')",
            "        self.check_user('user', '12345')",
            "",
            "    @unittest.skipIf(bcrypt is None, 'requires bcrypt')",
            "    @with_transaction()",
            "    def test_test_bcrypt(self):",
            "        'Test bcrypt password'",
            "        self.create_user('user', '12345', 'bcrypt')",
            "        self.check_user('user', '12345')",
            "",
            "",
            "def suite():",
            "    return unittest.TestLoader().loadTestsFromTestCase(UserTestCase)"
        ],
        "afterPatchFile": [
            "# This file is part of Tryton.  The COPYRIGHT file at the top level of this",
            "# repository contains the full copyright notices and license terms.",
            "",
            "import unittest",
            "from trytond.tests.test_tryton import install_module, with_transaction",
            "from trytond.pool import Pool",
            "from trytond.res.user import bcrypt",
            "from trytond.config import config",
            "",
            "",
            "class UserTestCase(unittest.TestCase):",
            "    'Test User'",
            "",
            "    @classmethod",
            "    def setUpClass(cls):",
            "        install_module('res')",
            "",
            "    def setUp(self):",
            "        methods = config.get('session', 'authentications')",
            "        config.set('session', 'authentications', 'password')",
            "        self.addCleanup(config.set, 'session', 'authentications', methods)",
            "",
            "    def create_user(self, login, password, hash_method=None):",
            "        pool = Pool()",
            "        User = pool.get('res.user')",
            "",
            "        user, = User.create([{",
            "                    'name': login,",
            "                    'login': login,",
            "                    }])",
            "        if hash_method:",
            "            hash = getattr(User, 'hash_' + hash_method)",
            "            User.write([user], {",
            "                    'password_hash': hash(password),",
            "                    })",
            "        else:",
            "            User.write([user], {",
            "                    'password': password,",
            "                    })",
            "        return user",
            "",
            "    def check_user(self, login, password):",
            "        pool = Pool()",
            "        User = pool.get('res.user')",
            "",
            "        user, = User.search([('login', '=', login)])",
            "        user_id = User.get_login(login, {",
            "                'password': password,",
            "                })",
            "        self.assertEqual(user_id, user.id)",
            "",
            "        bad_user_id = User.get_login(login, {",
            "                'password': password + 'wrong',",
            "                })",
            "        self.assertFalse(bad_user_id)",
            "",
            "    @with_transaction()",
            "    def test_test_hash(self):",
            "        'Test default hash password'",
            "        self.create_user('user', '12345')",
            "        self.check_user('user', '12345')",
            "",
            "    @with_transaction()",
            "    def test_test_sha1(self):",
            "        'Test sha1 password'",
            "        self.create_user('user', '12345', 'sha1')",
            "        self.check_user('user', '12345')",
            "",
            "    @unittest.skipIf(bcrypt is None, 'requires bcrypt')",
            "    @with_transaction()",
            "    def test_test_bcrypt(self):",
            "        'Test bcrypt password'",
            "        self.create_user('user', '12345', 'bcrypt')",
            "        self.check_user('user', '12345')",
            "",
            "    @with_transaction()",
            "    def test_read_password_hash(self):",
            "        \"Test password_hash can not be read\"",
            "        user = self.create_user('user', '12345')",
            "        self.assertIsNone(user.password_hash)",
            "",
            "",
            "def suite():",
            "    return unittest.TestLoader().loadTestsFromTestCase(UserTestCase)"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": [
            "trytond.tests.test_user.UserTestCase.test_test_sha1",
            "trytond.tests.test_user.UserTestCase.test_test_hash",
            "trytond.tests.test_user.UserTestCase.test_test_bcrypt",
            "trytond.res.user",
            "trytond.tests.test_user.UserTestCase.self"
        ]
    }
}