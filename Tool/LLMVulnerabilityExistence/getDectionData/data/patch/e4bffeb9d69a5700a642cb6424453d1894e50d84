{
    "app/__metadata__.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": 28,
                "PatchRowcode": " #lxdui.lxd.sslverify = true"
            },
            "1": {
                "beforePatchRowNumber": 29,
                "afterPatchRowNumber": 29,
                "PatchRowcode": " #lxdui.lxd.remote.name = host"
            },
            "2": {
                "beforePatchRowNumber": 30,
                "afterPatchRowNumber": 30,
                "PatchRowcode": " lxdui.jwt.token.expiration = 1200"
            },
            "3": {
                "beforePatchRowNumber": 31,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-lxdui.jwt.secret.key = AC8d83&21Almnis710sds"
            },
            "4": {
                "beforePatchRowNumber": 32,
                "afterPatchRowNumber": 31,
                "PatchRowcode": " lxdui.admin.user = admin"
            },
            "5": {
                "beforePatchRowNumber": 33,
                "afterPatchRowNumber": 32,
                "PatchRowcode": " lxdui.conf.dir = {{app_root}}/conf"
            },
            "6": {
                "beforePatchRowNumber": 34,
                "afterPatchRowNumber": 33,
                "PatchRowcode": " lxdui.conf.file = ${lxdui.conf.dir}/lxdui.conf"
            }
        },
        "frontPatchFile": [
            "APP_NAME = 'LXDUI'",
            "APP_CLI_CMD = 'lxdui'",
            "VERSION = '2.2'",
            "GIT_URL = 'https://github.com/AdaptiveScale/lxdui.git'",
            "LXD_URL = 'http://localhost:8443'",
            "LICENSE = 'Apache 2.0'",
            "AUTHOR = 'AdaptiveScale, Inc.'",
            "AUTHOR_URL = 'http://www.adaptivescale.com'",
            "AUTHOR_EMAIL = 'info@adaptivescale.com'",
            "KEYWORDS = 'lxc lxc-containers lxd'",
            "IMAGE_HUB = 'http://hub.kuti.io'",
            "",
            "'''",
            "",
            "The following section is for the default configuration",
            "that will be written to the lxdui.conf file if the file",
            "does not already exist.",
            "",
            "'''",
            "AUTO_LOAD_CONFIG = True",
            "DEFAULT_CONFIG_FORMAT = 'ini'",
            "__default_config__ = \"\"\"",
            "[LXDUI]",
            "lxdui.host = 0.0.0.0",
            "lxdui.port = 15151",
            "lxdui.images.remote = https://images.linuxcontainers.org",
            "#lxdui.lxd.remote = https://lxd.host.org:8443/",
            "#lxdui.lxd.sslverify = true",
            "#lxdui.lxd.remote.name = host",
            "lxdui.jwt.token.expiration = 1200",
            "lxdui.jwt.secret.key = AC8d83&21Almnis710sds",
            "lxdui.admin.user = admin",
            "lxdui.conf.dir = {{app_root}}/conf",
            "lxdui.conf.file = ${lxdui.conf.dir}/lxdui.conf",
            "lxdui.auth.conf = ${lxdui.conf.dir}/auth.conf",
            "lxdui.ssl.cert = ${lxdui.conf.dir}/client.crt",
            "lxdui.ssl.key = ${lxdui.conf.dir}/client.key",
            "lxdui.log.dir =  {{app_root}}/logs",
            "lxdui.log.file = ${lxdui.log.dir}/lxdui.log",
            "lxdui.log.conf = ${lxdui.conf.dir}/log.conf",
            "#lxdui.log.rotate = true",
            "#lxdui.log.max = 10M",
            "#lxdui.log.keep.generations = 5",
            "lxdui.profiles = ${lxdui.conf.dir}/profiles",
            "lxdui.zfs.pool.name = lxdpool",
            "lxdui.app.alias = LXDUI",
            "lxdui.cli = cli",
            "",
            "[LXDUI_CERT]",
            "lxdui.cert.country = US",
            "lxdui.cert.state = Texas",
            "lxdui.cert.locale = Dallas",
            "lxdui.cert.org = AdaptiveScale, Inc.",
            "lxdui.cert.ou = OU=AdaptiveScale, DN=com",
            "",
            "[LXD]",
            "lxd.bridge.enabled = true",
            "lxd.bridge.name = lxdbr0",
            "lxd.dns.conf.file = ",
            "lxd.dns.domain = lxd",
            "lxd.ipv4.addr = 10.5.5.1",
            "lxd.ipv4.netmask = 255.255.255.0",
            "lxd.ipv4.network = 10.5.5.0/24",
            "lxd.ipv4.dhcp.range = 253",
            "lxd.ipv4.dhcp.max = 10.5.5.2,10.5.5.254",
            "lxd.ipv4.nat = true",
            "lxd.ipv6.addr = 2001:470:b368:4242::1",
            "lxd.ipv6.mask = 255.255.255.0",
            "lxd.ipv6.network = 2001:470:b368:4242::/64",
            "lxd.ipv6.nat = false",
            "lxd.ipv6.proxy = false",
            "\"\"\""
        ],
        "afterPatchFile": [
            "APP_NAME = 'LXDUI'",
            "APP_CLI_CMD = 'lxdui'",
            "VERSION = '2.2'",
            "GIT_URL = 'https://github.com/AdaptiveScale/lxdui.git'",
            "LXD_URL = 'http://localhost:8443'",
            "LICENSE = 'Apache 2.0'",
            "AUTHOR = 'AdaptiveScale, Inc.'",
            "AUTHOR_URL = 'http://www.adaptivescale.com'",
            "AUTHOR_EMAIL = 'info@adaptivescale.com'",
            "KEYWORDS = 'lxc lxc-containers lxd'",
            "IMAGE_HUB = 'http://hub.kuti.io'",
            "",
            "'''",
            "",
            "The following section is for the default configuration",
            "that will be written to the lxdui.conf file if the file",
            "does not already exist.",
            "",
            "'''",
            "AUTO_LOAD_CONFIG = True",
            "DEFAULT_CONFIG_FORMAT = 'ini'",
            "__default_config__ = \"\"\"",
            "[LXDUI]",
            "lxdui.host = 0.0.0.0",
            "lxdui.port = 15151",
            "lxdui.images.remote = https://images.linuxcontainers.org",
            "#lxdui.lxd.remote = https://lxd.host.org:8443/",
            "#lxdui.lxd.sslverify = true",
            "#lxdui.lxd.remote.name = host",
            "lxdui.jwt.token.expiration = 1200",
            "lxdui.admin.user = admin",
            "lxdui.conf.dir = {{app_root}}/conf",
            "lxdui.conf.file = ${lxdui.conf.dir}/lxdui.conf",
            "lxdui.auth.conf = ${lxdui.conf.dir}/auth.conf",
            "lxdui.ssl.cert = ${lxdui.conf.dir}/client.crt",
            "lxdui.ssl.key = ${lxdui.conf.dir}/client.key",
            "lxdui.log.dir =  {{app_root}}/logs",
            "lxdui.log.file = ${lxdui.log.dir}/lxdui.log",
            "lxdui.log.conf = ${lxdui.conf.dir}/log.conf",
            "#lxdui.log.rotate = true",
            "#lxdui.log.max = 10M",
            "#lxdui.log.keep.generations = 5",
            "lxdui.profiles = ${lxdui.conf.dir}/profiles",
            "lxdui.zfs.pool.name = lxdpool",
            "lxdui.app.alias = LXDUI",
            "lxdui.cli = cli",
            "",
            "[LXDUI_CERT]",
            "lxdui.cert.country = US",
            "lxdui.cert.state = Texas",
            "lxdui.cert.locale = Dallas",
            "lxdui.cert.org = AdaptiveScale, Inc.",
            "lxdui.cert.ou = OU=AdaptiveScale, DN=com",
            "",
            "[LXD]",
            "lxd.bridge.enabled = true",
            "lxd.bridge.name = lxdbr0",
            "lxd.dns.conf.file = ",
            "lxd.dns.domain = lxd",
            "lxd.ipv4.addr = 10.5.5.1",
            "lxd.ipv4.netmask = 255.255.255.0",
            "lxd.ipv4.network = 10.5.5.0/24",
            "lxd.ipv4.dhcp.range = 253",
            "lxd.ipv4.dhcp.max = 10.5.5.2,10.5.5.254",
            "lxd.ipv4.nat = true",
            "lxd.ipv6.addr = 2001:470:b368:4242::1",
            "lxd.ipv6.mask = 255.255.255.0",
            "lxd.ipv6.network = 2001:470:b368:4242::/64",
            "lxd.ipv6.nat = false",
            "lxd.ipv6.proxy = false",
            "\"\"\""
        ],
        "action": [
            "0",
            "0",
            "0",
            "1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "31": []
        },
        "addLocation": []
    },
    "app/api/utils/authentication.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 6,
                "afterPatchRowNumber": 6,
                "PatchRowcode": " from app.api.utils import converters"
            },
            "1": {
                "beforePatchRowNumber": 7,
                "afterPatchRowNumber": 7,
                "PatchRowcode": " import app.__metadata__ as meta"
            },
            "2": {
                "beforePatchRowNumber": 8,
                "afterPatchRowNumber": 8,
                "PatchRowcode": " import logging"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 9,
                "PatchRowcode": "+import secrets"
            },
            "4": {
                "beforePatchRowNumber": 9,
                "afterPatchRowNumber": 10,
                "PatchRowcode": " "
            },
            "5": {
                "beforePatchRowNumber": 10,
                "afterPatchRowNumber": 11,
                "PatchRowcode": " logging = logging.getLogger(__name__)"
            },
            "6": {
                "beforePatchRowNumber": 11,
                "afterPatchRowNumber": 12,
                "PatchRowcode": " "
            },
            "7": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 22,
                "PatchRowcode": " def initAuth(app):"
            },
            "8": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": 23,
                "PatchRowcode": "     APP = meta.APP_NAME"
            },
            "9": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": 24,
                "PatchRowcode": "     tokenExpiration = int(Config().get(APP, '{}.jwt.token.expiration'.format(APP.lower())))"
            },
            "10": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    secretKey = Config().get(APP, '{}.jwt.secret.key'.format(APP.lower()))"
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 25,
                "PatchRowcode": "+    # create a new secretKet whenever the system is started"
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 26,
                "PatchRowcode": "+    secretKey = secrets.token_urlsafe(32) "
            },
            "13": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 27,
                "PatchRowcode": "     if (tokenExpiration == None):"
            },
            "14": {
                "beforePatchRowNumber": 26,
                "afterPatchRowNumber": 28,
                "PatchRowcode": "         tokenExpiration = 1200"
            },
            "15": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": 29,
                "PatchRowcode": " "
            }
        },
        "frontPatchFile": [
            "from app.lib.auth import User",
            "from app.lib.conf import Config",
            "from datetime import timedelta",
            "from flask_jwt_extended import JWTManager",
            "",
            "from app.api.utils import converters",
            "import app.__metadata__ as meta",
            "import logging",
            "",
            "logging = logging.getLogger(__name__)",
            "",
            "def authenticate(username, password):",
            "    logging.info(\"Authenticate user {}\".format(username))",
            "    if User().authenticate(username, password)[0] == True:",
            "        logging.info(\"User {} successfully authenticated\".format(username))",
            "        return True",
            "    else:",
            "        logging.warning(\"Authentication failed for user {}\".format(username))",
            "        return False",
            "",
            "def initAuth(app):",
            "    APP = meta.APP_NAME",
            "    tokenExpiration = int(Config().get(APP, '{}.jwt.token.expiration'.format(APP.lower())))",
            "    secretKey = Config().get(APP, '{}.jwt.secret.key'.format(APP.lower()))",
            "    if (tokenExpiration == None):",
            "        tokenExpiration = 1200",
            "",
            "    tokenLocation = [\"headers\",\"cookies\"]",
            "",
            "    app.config['JWT_SECRET_KEY'] = secretKey",
            "    app.config['JWT_TOKEN_LOCATION'] = tokenLocation",
            "    app.config['JWT_EXPIRATION_DELTA'] = timedelta(seconds=tokenExpiration)",
            "    app.config['JWT_COOKIE_CSRF_PROTECT'] = False",
            "    jwt = JWTManager(app)"
        ],
        "afterPatchFile": [
            "from app.lib.auth import User",
            "from app.lib.conf import Config",
            "from datetime import timedelta",
            "from flask_jwt_extended import JWTManager",
            "",
            "from app.api.utils import converters",
            "import app.__metadata__ as meta",
            "import logging",
            "import secrets",
            "",
            "logging = logging.getLogger(__name__)",
            "",
            "def authenticate(username, password):",
            "    logging.info(\"Authenticate user {}\".format(username))",
            "    if User().authenticate(username, password)[0] == True:",
            "        logging.info(\"User {} successfully authenticated\".format(username))",
            "        return True",
            "    else:",
            "        logging.warning(\"Authentication failed for user {}\".format(username))",
            "        return False",
            "",
            "def initAuth(app):",
            "    APP = meta.APP_NAME",
            "    tokenExpiration = int(Config().get(APP, '{}.jwt.token.expiration'.format(APP.lower())))",
            "    # create a new secretKet whenever the system is started",
            "    secretKey = secrets.token_urlsafe(32) ",
            "    if (tokenExpiration == None):",
            "        tokenExpiration = 1200",
            "",
            "    tokenLocation = [\"headers\",\"cookies\"]",
            "",
            "    app.config['JWT_SECRET_KEY'] = secretKey",
            "    app.config['JWT_TOKEN_LOCATION'] = tokenLocation",
            "    app.config['JWT_EXPIRATION_DELTA'] = timedelta(seconds=tokenExpiration)",
            "    app.config['JWT_COOKIE_CSRF_PROTECT'] = False",
            "    jwt = JWTManager(app)"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "24": [
                "initAuth"
            ]
        },
        "addLocation": []
    }
}