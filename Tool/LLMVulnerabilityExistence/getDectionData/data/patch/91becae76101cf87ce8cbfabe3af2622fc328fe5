{
    "beaker/crypto/pycrypto.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 15,
                "afterPatchRowNumber": 15,
                "PatchRowcode": " "
            },
            "1": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " except ImportError:"
            },
            "2": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 17,
                "PatchRowcode": "     from Crypto.Cipher import AES"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 18,
                "PatchRowcode": "+    from Crypto.Util import Counter"
            },
            "4": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 19,
                "PatchRowcode": " "
            },
            "5": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 20,
                "PatchRowcode": "     def aesEncrypt(data, key):"
            },
            "6": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        cipher = AES.new(key)"
            },
            "7": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 21,
                "PatchRowcode": "+        cipher = AES.new(key, AES.MODE_CTR,"
            },
            "8": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 22,
                "PatchRowcode": "+                         counter=Counter.new(128, initial_value=0))"
            },
            "9": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 23,
                "PatchRowcode": " "
            },
            "10": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        data = data + (\" \" * (16 - (len(data) % 16)))"
            },
            "11": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": 24,
                "PatchRowcode": "         return cipher.encrypt(data)"
            },
            "12": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": 25,
                "PatchRowcode": " "
            },
            "13": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 26,
                "PatchRowcode": "     def aesDecrypt(data, key):"
            },
            "14": {
                "beforePatchRowNumber": 26,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        cipher = AES.new(key)"
            },
            "15": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "16": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        return cipher.decrypt(data).rstrip()"
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 27,
                "PatchRowcode": "+        cipher = AES.new(key, AES.MODE_CTR,"
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 28,
                "PatchRowcode": "+                         counter=Counter.new(128, initial_value=0))"
            },
            "19": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 29,
                "PatchRowcode": "+        return cipher.decrypt(data)"
            },
            "20": {
                "beforePatchRowNumber": 29,
                "afterPatchRowNumber": 30,
                "PatchRowcode": " "
            },
            "21": {
                "beforePatchRowNumber": 30,
                "afterPatchRowNumber": 31,
                "PatchRowcode": " def getKeyLength():"
            },
            "22": {
                "beforePatchRowNumber": 31,
                "afterPatchRowNumber": 32,
                "PatchRowcode": "     return 32"
            }
        },
        "frontPatchFile": [
            "\"\"\"Encryption module that uses pycryptopp or pycrypto\"\"\"",
            "try:",
            "    # Pycryptopp is preferred over Crypto because Crypto has had",
            "    # various periods of not being maintained, and pycryptopp uses",
            "    # the Crypto++ library which is generally considered the 'gold standard'",
            "    # of crypto implementations",
            "    from pycryptopp.cipher import aes",
            "",
            "    def aesEncrypt(data, key):",
            "        cipher = aes.AES(key)",
            "        return cipher.process(data)",
            "",
            "    # magic.",
            "    aesDecrypt = aesEncrypt",
            "",
            "except ImportError:",
            "    from Crypto.Cipher import AES",
            "",
            "    def aesEncrypt(data, key):",
            "        cipher = AES.new(key)",
            "",
            "        data = data + (\" \" * (16 - (len(data) % 16)))",
            "        return cipher.encrypt(data)",
            "",
            "    def aesDecrypt(data, key):",
            "        cipher = AES.new(key)",
            "",
            "        return cipher.decrypt(data).rstrip()",
            "",
            "def getKeyLength():",
            "    return 32"
        ],
        "afterPatchFile": [
            "\"\"\"Encryption module that uses pycryptopp or pycrypto\"\"\"",
            "try:",
            "    # Pycryptopp is preferred over Crypto because Crypto has had",
            "    # various periods of not being maintained, and pycryptopp uses",
            "    # the Crypto++ library which is generally considered the 'gold standard'",
            "    # of crypto implementations",
            "    from pycryptopp.cipher import aes",
            "",
            "    def aesEncrypt(data, key):",
            "        cipher = aes.AES(key)",
            "        return cipher.process(data)",
            "",
            "    # magic.",
            "    aesDecrypt = aesEncrypt",
            "",
            "except ImportError:",
            "    from Crypto.Cipher import AES",
            "    from Crypto.Util import Counter",
            "",
            "    def aesEncrypt(data, key):",
            "        cipher = AES.new(key, AES.MODE_CTR,",
            "                         counter=Counter.new(128, initial_value=0))",
            "",
            "        return cipher.encrypt(data)",
            "",
            "    def aesDecrypt(data, key):",
            "        cipher = AES.new(key, AES.MODE_CTR,",
            "                         counter=Counter.new(128, initial_value=0))",
            "        return cipher.decrypt(data)",
            "",
            "def getKeyLength():",
            "    return 32"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "2",
            "2",
            "2",
            "0",
            "2",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "20": [
                "cipher"
            ],
            "22": [
                "data"
            ],
            "26": [
                "cipher"
            ],
            "27": [],
            "28": []
        },
        "addLocation": []
    }
}