{
    "salt/netapi/__init__.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 4,
                "afterPatchRowNumber": 4,
                "PatchRowcode": " \"\"\""
            },
            "1": {
                "beforePatchRowNumber": 5,
                "afterPatchRowNumber": 5,
                "PatchRowcode": " from __future__ import absolute_import, print_function, unicode_literals"
            },
            "2": {
                "beforePatchRowNumber": 6,
                "afterPatchRowNumber": 6,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 7,
                "PatchRowcode": "+import copy"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 8,
                "PatchRowcode": "+"
            },
            "5": {
                "beforePatchRowNumber": 7,
                "afterPatchRowNumber": 9,
                "PatchRowcode": " # Import Python libs"
            },
            "6": {
                "beforePatchRowNumber": 8,
                "afterPatchRowNumber": 10,
                "PatchRowcode": " import inspect"
            },
            "7": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 11,
                "PatchRowcode": "+import logging"
            },
            "8": {
                "beforePatchRowNumber": 9,
                "afterPatchRowNumber": 12,
                "PatchRowcode": " import os"
            },
            "9": {
                "beforePatchRowNumber": 10,
                "afterPatchRowNumber": 13,
                "PatchRowcode": " "
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 14,
                "PatchRowcode": "+import salt.auth"
            },
            "11": {
                "beforePatchRowNumber": 11,
                "afterPatchRowNumber": 15,
                "PatchRowcode": " import salt.client"
            },
            "12": {
                "beforePatchRowNumber": 12,
                "afterPatchRowNumber": 16,
                "PatchRowcode": " import salt.client.ssh.client"
            },
            "13": {
                "beforePatchRowNumber": 13,
                "afterPatchRowNumber": 17,
                "PatchRowcode": " import salt.config"
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 18,
                "PatchRowcode": "+import salt.daemons.masterapi"
            },
            "15": {
                "beforePatchRowNumber": 14,
                "afterPatchRowNumber": 19,
                "PatchRowcode": " import salt.exceptions"
            },
            "16": {
                "beforePatchRowNumber": 15,
                "afterPatchRowNumber": 20,
                "PatchRowcode": " "
            },
            "17": {
                "beforePatchRowNumber": 16,
                "afterPatchRowNumber": 21,
                "PatchRowcode": " # Import Salt libs"
            },
            "18": {
                "beforePatchRowNumber": 17,
                "afterPatchRowNumber": 22,
                "PatchRowcode": " import salt.log  # pylint: disable=W0611"
            },
            "19": {
                "beforePatchRowNumber": 18,
                "afterPatchRowNumber": 23,
                "PatchRowcode": " import salt.runner"
            },
            "20": {
                "beforePatchRowNumber": 19,
                "afterPatchRowNumber": 24,
                "PatchRowcode": " import salt.syspaths"
            },
            "21": {
                "beforePatchRowNumber": 20,
                "afterPatchRowNumber": 25,
                "PatchRowcode": " import salt.utils.args"
            },
            "22": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 26,
                "PatchRowcode": "+import salt.utils.minions"
            },
            "23": {
                "beforePatchRowNumber": 21,
                "afterPatchRowNumber": 27,
                "PatchRowcode": " import salt.wheel"
            },
            "24": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 28,
                "PatchRowcode": "+from salt.defaults import DEFAULT_TARGET_DELIM"
            },
            "25": {
                "beforePatchRowNumber": 22,
                "afterPatchRowNumber": 29,
                "PatchRowcode": " "
            },
            "26": {
                "beforePatchRowNumber": 23,
                "afterPatchRowNumber": 30,
                "PatchRowcode": " # Import third party libs"
            },
            "27": {
                "beforePatchRowNumber": 24,
                "afterPatchRowNumber": 31,
                "PatchRowcode": " from salt.ext import six"
            },
            "28": {
                "beforePatchRowNumber": 25,
                "afterPatchRowNumber": 32,
                "PatchRowcode": " "
            },
            "29": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 33,
                "PatchRowcode": "+log = logging.getLogger(__name__)"
            },
            "30": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 34,
                "PatchRowcode": "+"
            },
            "31": {
                "beforePatchRowNumber": 26,
                "afterPatchRowNumber": 35,
                "PatchRowcode": " "
            },
            "32": {
                "beforePatchRowNumber": 27,
                "afterPatchRowNumber": 36,
                "PatchRowcode": " class NetapiClient(object):"
            },
            "33": {
                "beforePatchRowNumber": 28,
                "afterPatchRowNumber": 37,
                "PatchRowcode": "     \"\"\""
            },
            "34": {
                "beforePatchRowNumber": 36,
                "afterPatchRowNumber": 45,
                "PatchRowcode": " "
            },
            "35": {
                "beforePatchRowNumber": 37,
                "afterPatchRowNumber": 46,
                "PatchRowcode": "     def __init__(self, opts):"
            },
            "36": {
                "beforePatchRowNumber": 38,
                "afterPatchRowNumber": 47,
                "PatchRowcode": "         self.opts = opts"
            },
            "37": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 48,
                "PatchRowcode": "+        self.loadauth = salt.auth.LoadAuth(opts)"
            },
            "38": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 49,
                "PatchRowcode": "+        self.key = salt.daemons.masterapi.access_keys(self.opts)"
            },
            "39": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 50,
                "PatchRowcode": "+        minopts = copy.deepcopy(self.opts)"
            },
            "40": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 51,
                "PatchRowcode": "+        minopts[\"enable_ssh_minions\"] = True"
            },
            "41": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 52,
                "PatchRowcode": "+        self.ckminions = salt.utils.minions.CkMinions(minopts)"
            },
            "42": {
                "beforePatchRowNumber": 39,
                "afterPatchRowNumber": 53,
                "PatchRowcode": " "
            },
            "43": {
                "beforePatchRowNumber": 40,
                "afterPatchRowNumber": 54,
                "PatchRowcode": "     def _is_master_running(self):"
            },
            "44": {
                "beforePatchRowNumber": 41,
                "afterPatchRowNumber": 55,
                "PatchRowcode": "         \"\"\""
            },
            "45": {
                "beforePatchRowNumber": 55,
                "afterPatchRowNumber": 69,
                "PatchRowcode": "             ipc_file = \"workers.ipc\""
            },
            "46": {
                "beforePatchRowNumber": 56,
                "afterPatchRowNumber": 70,
                "PatchRowcode": "         return os.path.exists(os.path.join(self.opts[\"sock_dir\"], ipc_file))"
            },
            "47": {
                "beforePatchRowNumber": 57,
                "afterPatchRowNumber": 71,
                "PatchRowcode": " "
            },
            "48": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 72,
                "PatchRowcode": "+    def _prep_auth_info(self, clear_load):"
            },
            "49": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 73,
                "PatchRowcode": "+        sensitive_load_keys = []"
            },
            "50": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 74,
                "PatchRowcode": "+        key = None"
            },
            "51": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 75,
                "PatchRowcode": "+        if \"token\" in clear_load:"
            },
            "52": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 76,
                "PatchRowcode": "+            auth_type = \"token\""
            },
            "53": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 77,
                "PatchRowcode": "+            err_name = \"TokenAuthenticationError\""
            },
            "54": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 78,
                "PatchRowcode": "+            sensitive_load_keys = [\"token\"]"
            },
            "55": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 79,
                "PatchRowcode": "+            return auth_type, err_name, key, sensitive_load_keys"
            },
            "56": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 80,
                "PatchRowcode": "+        elif \"eauth\" in clear_load:"
            },
            "57": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 81,
                "PatchRowcode": "+            auth_type = \"eauth\""
            },
            "58": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 82,
                "PatchRowcode": "+            err_name = \"EauthAuthenticationError\""
            },
            "59": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 83,
                "PatchRowcode": "+            sensitive_load_keys = [\"username\", \"password\"]"
            },
            "60": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 84,
                "PatchRowcode": "+            return auth_type, err_name, key, sensitive_load_keys"
            },
            "61": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 85,
                "PatchRowcode": "+        raise salt.exceptions.EauthAuthenticationError("
            },
            "62": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 86,
                "PatchRowcode": "+            \"No authentication credentials given\""
            },
            "63": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 87,
                "PatchRowcode": "+        )"
            },
            "64": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 88,
                "PatchRowcode": "+"
            },
            "65": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 89,
                "PatchRowcode": "+    def _authorize_ssh(self, low):"
            },
            "66": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 90,
                "PatchRowcode": "+        auth_type, err_name, key, sensitive_load_keys = self._prep_auth_info(low)"
            },
            "67": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 91,
                "PatchRowcode": "+        auth_check = self.loadauth.check_authentication(low, auth_type, key=key)"
            },
            "68": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 92,
                "PatchRowcode": "+        auth_list = auth_check.get(\"auth_list\", [])"
            },
            "69": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 93,
                "PatchRowcode": "+        error = auth_check.get(\"error\")"
            },
            "70": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 94,
                "PatchRowcode": "+        if error:"
            },
            "71": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 95,
                "PatchRowcode": "+            raise salt.exceptions.EauthAuthenticationError(error)"
            },
            "72": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 96,
                "PatchRowcode": "+        delimiter = low.get(\"kwargs\", {}).get(\"delimiter\", DEFAULT_TARGET_DELIM)"
            },
            "73": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 97,
                "PatchRowcode": "+        _res = self.ckminions.check_minions("
            },
            "74": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 98,
                "PatchRowcode": "+            low[\"tgt\"], low.get(\"tgt_type\", \"glob\"), delimiter"
            },
            "75": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 99,
                "PatchRowcode": "+        )"
            },
            "76": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 100,
                "PatchRowcode": "+        minions = _res.get(\"minions\", list())"
            },
            "77": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 101,
                "PatchRowcode": "+        missing = _res.get(\"missing\", list())"
            },
            "78": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 102,
                "PatchRowcode": "+        authorized = self.ckminions.auth_check("
            },
            "79": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 103,
                "PatchRowcode": "+            auth_list,"
            },
            "80": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 104,
                "PatchRowcode": "+            low[\"fun\"],"
            },
            "81": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 105,
                "PatchRowcode": "+            low.get(\"arg\", []),"
            },
            "82": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 106,
                "PatchRowcode": "+            low[\"tgt\"],"
            },
            "83": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 107,
                "PatchRowcode": "+            low.get(\"tgt_type\", \"glob\"),"
            },
            "84": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 108,
                "PatchRowcode": "+            minions=minions,"
            },
            "85": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 109,
                "PatchRowcode": "+        )"
            },
            "86": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 110,
                "PatchRowcode": "+        if not authorized:"
            },
            "87": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 111,
                "PatchRowcode": "+            raise salt.exceptions.EauthAuthenticationError("
            },
            "88": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 112,
                "PatchRowcode": "+                \"Authorization error occurred.\""
            },
            "89": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 113,
                "PatchRowcode": "+            )"
            },
            "90": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 114,
                "PatchRowcode": "+"
            },
            "91": {
                "beforePatchRowNumber": 58,
                "afterPatchRowNumber": 115,
                "PatchRowcode": "     def run(self, low):"
            },
            "92": {
                "beforePatchRowNumber": 59,
                "afterPatchRowNumber": 116,
                "PatchRowcode": "         \"\"\""
            },
            "93": {
                "beforePatchRowNumber": 60,
                "afterPatchRowNumber": 117,
                "PatchRowcode": "         Execute the specified function in the specified client by passing the"
            },
            "94": {
                "beforePatchRowNumber": 81,
                "afterPatchRowNumber": 138,
                "PatchRowcode": "                 \"Raw shell option not allowed.\""
            },
            "95": {
                "beforePatchRowNumber": 82,
                "afterPatchRowNumber": 139,
                "PatchRowcode": "             )"
            },
            "96": {
                "beforePatchRowNumber": 83,
                "afterPatchRowNumber": 140,
                "PatchRowcode": " "
            },
            "97": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 141,
                "PatchRowcode": "+        if low[\"client\"] == \"ssh\":"
            },
            "98": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 142,
                "PatchRowcode": "+            self._authorize_ssh(low)"
            },
            "99": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 143,
                "PatchRowcode": "+"
            },
            "100": {
                "beforePatchRowNumber": 84,
                "afterPatchRowNumber": 144,
                "PatchRowcode": "         l_fun = getattr(self, low[\"client\"])"
            },
            "101": {
                "beforePatchRowNumber": 85,
                "afterPatchRowNumber": 145,
                "PatchRowcode": "         f_call = salt.utils.args.format_call(l_fun, low)"
            },
            "102": {
                "beforePatchRowNumber": 86,
                "afterPatchRowNumber": 146,
                "PatchRowcode": "         return l_fun(*f_call.get(\"args\", ()), **f_call.get(\"kwargs\", {}))"
            }
        },
        "frontPatchFile": [
            "# encoding: utf-8",
            "\"\"\"",
            "Make api awesomeness",
            "\"\"\"",
            "from __future__ import absolute_import, print_function, unicode_literals",
            "",
            "# Import Python libs",
            "import inspect",
            "import os",
            "",
            "import salt.client",
            "import salt.client.ssh.client",
            "import salt.config",
            "import salt.exceptions",
            "",
            "# Import Salt libs",
            "import salt.log  # pylint: disable=W0611",
            "import salt.runner",
            "import salt.syspaths",
            "import salt.utils.args",
            "import salt.wheel",
            "",
            "# Import third party libs",
            "from salt.ext import six",
            "",
            "",
            "class NetapiClient(object):",
            "    \"\"\"",
            "    Provide a uniform method of accessing the various client interfaces in Salt",
            "    in the form of low-data data structures. For example:",
            "",
            "    >>> client = NetapiClient(__opts__)",
            "    >>> lowstate = {'client': 'local', 'tgt': '*', 'fun': 'test.ping', 'arg': ''}",
            "    >>> client.run(lowstate)",
            "    \"\"\"",
            "",
            "    def __init__(self, opts):",
            "        self.opts = opts",
            "",
            "    def _is_master_running(self):",
            "        \"\"\"",
            "        Perform a lightweight check to see if the master daemon is running",
            "",
            "        Note, this will return an invalid success if the master crashed or was",
            "        not shut down cleanly.",
            "        \"\"\"",
            "        # Windows doesn't have IPC. Assume the master is running.",
            "        # At worse, it will error 500.",
            "        if salt.utils.platform.is_windows():",
            "            return True",
            "",
            "        if self.opts[\"transport\"] == \"tcp\":",
            "            ipc_file = \"publish_pull.ipc\"",
            "        else:",
            "            ipc_file = \"workers.ipc\"",
            "        return os.path.exists(os.path.join(self.opts[\"sock_dir\"], ipc_file))",
            "",
            "    def run(self, low):",
            "        \"\"\"",
            "        Execute the specified function in the specified client by passing the",
            "        lowstate",
            "        \"\"\"",
            "        # Eauth currently requires a running daemon and commands run through",
            "        # this method require eauth so perform a quick check to raise a",
            "        # more meaningful error.",
            "        if not self._is_master_running():",
            "            raise salt.exceptions.SaltDaemonNotRunning(\"Salt Master is not available.\")",
            "",
            "        if low.get(\"client\") not in CLIENTS:",
            "            raise salt.exceptions.SaltInvocationError(",
            "                \"Invalid client specified: '{0}'\".format(low.get(\"client\"))",
            "            )",
            "",
            "        if not (\"token\" in low or \"eauth\" in low):",
            "            raise salt.exceptions.EauthAuthenticationError(",
            "                \"No authentication credentials given\"",
            "            )",
            "",
            "        if low.get(\"raw_shell\") and not self.opts.get(\"netapi_allow_raw_shell\"):",
            "            raise salt.exceptions.EauthAuthenticationError(",
            "                \"Raw shell option not allowed.\"",
            "            )",
            "",
            "        l_fun = getattr(self, low[\"client\"])",
            "        f_call = salt.utils.args.format_call(l_fun, low)",
            "        return l_fun(*f_call.get(\"args\", ()), **f_call.get(\"kwargs\", {}))",
            "",
            "    def local_async(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`execution modules <all-salt.modules>` asynchronously",
            "",
            "        Wraps :py:meth:`salt.client.LocalClient.run_job`.",
            "",
            "        :return: job ID",
            "        \"\"\"",
            "        local = salt.client.get_local_client(mopts=self.opts)",
            "        return local.run_job(*args, **kwargs)",
            "",
            "    def local(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`execution modules <all-salt.modules>` synchronously",
            "",
            "        See :py:meth:`salt.client.LocalClient.cmd` for all available",
            "        parameters.",
            "",
            "        Sends a command from the master to the targeted minions. This is the",
            "        same interface that Salt's own CLI uses. Note the ``arg`` and ``kwarg``",
            "        parameters are sent down to the minion(s) and the given function,",
            "        ``fun``, is called with those parameters.",
            "",
            "        :return: Returns the result from the execution module",
            "        \"\"\"",
            "        local = salt.client.get_local_client(mopts=self.opts)",
            "        return local.cmd(*args, **kwargs)",
            "",
            "    def local_subset(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`execution modules <all-salt.modules>` against subsets of minions",
            "",
            "        .. versionadded:: 2016.3.0",
            "",
            "        Wraps :py:meth:`salt.client.LocalClient.cmd_subset`",
            "        \"\"\"",
            "        local = salt.client.get_local_client(mopts=self.opts)",
            "        return local.cmd_subset(*args, **kwargs)",
            "",
            "    def local_batch(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`execution modules <all-salt.modules>` against batches of minions",
            "",
            "        .. versionadded:: 0.8.4",
            "",
            "        Wraps :py:meth:`salt.client.LocalClient.cmd_batch`",
            "",
            "        :return: Returns the result from the exeuction module for each batch of",
            "            returns",
            "        \"\"\"",
            "        local = salt.client.get_local_client(mopts=self.opts)",
            "        return local.cmd_batch(*args, **kwargs)",
            "",
            "    def ssh(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run salt-ssh commands synchronously",
            "",
            "        Wraps :py:meth:`salt.client.ssh.client.SSHClient.cmd_sync`.",
            "",
            "        :return: Returns the result from the salt-ssh command",
            "        \"\"\"",
            "        ssh_client = salt.client.ssh.client.SSHClient(",
            "            mopts=self.opts, disable_custom_roster=True",
            "        )",
            "        return ssh_client.cmd_sync(kwargs)",
            "",
            "    def runner(self, fun, timeout=None, full_return=False, **kwargs):",
            "        \"\"\"",
            "        Run `runner modules <all-salt.runners>` synchronously",
            "",
            "        Wraps :py:meth:`salt.runner.RunnerClient.cmd_sync`.",
            "",
            "        Note that runner functions must be called using keyword arguments.",
            "        Positional arguments are not supported.",
            "",
            "        :return: Returns the result from the runner module",
            "        \"\"\"",
            "        kwargs[\"fun\"] = fun",
            "        runner = salt.runner.RunnerClient(self.opts)",
            "        return runner.cmd_sync(kwargs, timeout=timeout, full_return=full_return)",
            "",
            "    def runner_async(self, fun, **kwargs):",
            "        \"\"\"",
            "        Run `runner modules <all-salt.runners>` asynchronously",
            "",
            "        Wraps :py:meth:`salt.runner.RunnerClient.cmd_async`.",
            "",
            "        Note that runner functions must be called using keyword arguments.",
            "        Positional arguments are not supported.",
            "",
            "        :return: event data and a job ID for the executed function.",
            "        \"\"\"",
            "        kwargs[\"fun\"] = fun",
            "        runner = salt.runner.RunnerClient(self.opts)",
            "        return runner.cmd_async(kwargs)",
            "",
            "    def wheel(self, fun, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`wheel modules <all-salt.wheel>` synchronously",
            "",
            "        Wraps :py:meth:`salt.wheel.WheelClient.master_call`.",
            "",
            "        Note that wheel functions must be called using keyword arguments.",
            "        Positional arguments are not supported.",
            "",
            "        :return: Returns the result from the wheel module",
            "        \"\"\"",
            "        kwargs[\"fun\"] = fun",
            "        wheel = salt.wheel.WheelClient(self.opts)",
            "        return wheel.cmd_sync(kwargs)",
            "",
            "    def wheel_async(self, fun, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`wheel modules <all-salt.wheel>` asynchronously",
            "",
            "        Wraps :py:meth:`salt.wheel.WheelClient.master_call`.",
            "",
            "        Note that wheel functions must be called using keyword arguments.",
            "        Positional arguments are not supported.",
            "",
            "        :return: Returns the result from the wheel module",
            "        \"\"\"",
            "        kwargs[\"fun\"] = fun",
            "        wheel = salt.wheel.WheelClient(self.opts)",
            "        return wheel.cmd_async(kwargs)",
            "",
            "",
            "CLIENTS = [",
            "    name",
            "    for name, _ in inspect.getmembers(",
            "        NetapiClient, predicate=inspect.ismethod if six.PY2 else None",
            "    )",
            "    if not (name == \"run\" or name.startswith(\"_\"))",
            "]"
        ],
        "afterPatchFile": [
            "# encoding: utf-8",
            "\"\"\"",
            "Make api awesomeness",
            "\"\"\"",
            "from __future__ import absolute_import, print_function, unicode_literals",
            "",
            "import copy",
            "",
            "# Import Python libs",
            "import inspect",
            "import logging",
            "import os",
            "",
            "import salt.auth",
            "import salt.client",
            "import salt.client.ssh.client",
            "import salt.config",
            "import salt.daemons.masterapi",
            "import salt.exceptions",
            "",
            "# Import Salt libs",
            "import salt.log  # pylint: disable=W0611",
            "import salt.runner",
            "import salt.syspaths",
            "import salt.utils.args",
            "import salt.utils.minions",
            "import salt.wheel",
            "from salt.defaults import DEFAULT_TARGET_DELIM",
            "",
            "# Import third party libs",
            "from salt.ext import six",
            "",
            "log = logging.getLogger(__name__)",
            "",
            "",
            "class NetapiClient(object):",
            "    \"\"\"",
            "    Provide a uniform method of accessing the various client interfaces in Salt",
            "    in the form of low-data data structures. For example:",
            "",
            "    >>> client = NetapiClient(__opts__)",
            "    >>> lowstate = {'client': 'local', 'tgt': '*', 'fun': 'test.ping', 'arg': ''}",
            "    >>> client.run(lowstate)",
            "    \"\"\"",
            "",
            "    def __init__(self, opts):",
            "        self.opts = opts",
            "        self.loadauth = salt.auth.LoadAuth(opts)",
            "        self.key = salt.daemons.masterapi.access_keys(self.opts)",
            "        minopts = copy.deepcopy(self.opts)",
            "        minopts[\"enable_ssh_minions\"] = True",
            "        self.ckminions = salt.utils.minions.CkMinions(minopts)",
            "",
            "    def _is_master_running(self):",
            "        \"\"\"",
            "        Perform a lightweight check to see if the master daemon is running",
            "",
            "        Note, this will return an invalid success if the master crashed or was",
            "        not shut down cleanly.",
            "        \"\"\"",
            "        # Windows doesn't have IPC. Assume the master is running.",
            "        # At worse, it will error 500.",
            "        if salt.utils.platform.is_windows():",
            "            return True",
            "",
            "        if self.opts[\"transport\"] == \"tcp\":",
            "            ipc_file = \"publish_pull.ipc\"",
            "        else:",
            "            ipc_file = \"workers.ipc\"",
            "        return os.path.exists(os.path.join(self.opts[\"sock_dir\"], ipc_file))",
            "",
            "    def _prep_auth_info(self, clear_load):",
            "        sensitive_load_keys = []",
            "        key = None",
            "        if \"token\" in clear_load:",
            "            auth_type = \"token\"",
            "            err_name = \"TokenAuthenticationError\"",
            "            sensitive_load_keys = [\"token\"]",
            "            return auth_type, err_name, key, sensitive_load_keys",
            "        elif \"eauth\" in clear_load:",
            "            auth_type = \"eauth\"",
            "            err_name = \"EauthAuthenticationError\"",
            "            sensitive_load_keys = [\"username\", \"password\"]",
            "            return auth_type, err_name, key, sensitive_load_keys",
            "        raise salt.exceptions.EauthAuthenticationError(",
            "            \"No authentication credentials given\"",
            "        )",
            "",
            "    def _authorize_ssh(self, low):",
            "        auth_type, err_name, key, sensitive_load_keys = self._prep_auth_info(low)",
            "        auth_check = self.loadauth.check_authentication(low, auth_type, key=key)",
            "        auth_list = auth_check.get(\"auth_list\", [])",
            "        error = auth_check.get(\"error\")",
            "        if error:",
            "            raise salt.exceptions.EauthAuthenticationError(error)",
            "        delimiter = low.get(\"kwargs\", {}).get(\"delimiter\", DEFAULT_TARGET_DELIM)",
            "        _res = self.ckminions.check_minions(",
            "            low[\"tgt\"], low.get(\"tgt_type\", \"glob\"), delimiter",
            "        )",
            "        minions = _res.get(\"minions\", list())",
            "        missing = _res.get(\"missing\", list())",
            "        authorized = self.ckminions.auth_check(",
            "            auth_list,",
            "            low[\"fun\"],",
            "            low.get(\"arg\", []),",
            "            low[\"tgt\"],",
            "            low.get(\"tgt_type\", \"glob\"),",
            "            minions=minions,",
            "        )",
            "        if not authorized:",
            "            raise salt.exceptions.EauthAuthenticationError(",
            "                \"Authorization error occurred.\"",
            "            )",
            "",
            "    def run(self, low):",
            "        \"\"\"",
            "        Execute the specified function in the specified client by passing the",
            "        lowstate",
            "        \"\"\"",
            "        # Eauth currently requires a running daemon and commands run through",
            "        # this method require eauth so perform a quick check to raise a",
            "        # more meaningful error.",
            "        if not self._is_master_running():",
            "            raise salt.exceptions.SaltDaemonNotRunning(\"Salt Master is not available.\")",
            "",
            "        if low.get(\"client\") not in CLIENTS:",
            "            raise salt.exceptions.SaltInvocationError(",
            "                \"Invalid client specified: '{0}'\".format(low.get(\"client\"))",
            "            )",
            "",
            "        if not (\"token\" in low or \"eauth\" in low):",
            "            raise salt.exceptions.EauthAuthenticationError(",
            "                \"No authentication credentials given\"",
            "            )",
            "",
            "        if low.get(\"raw_shell\") and not self.opts.get(\"netapi_allow_raw_shell\"):",
            "            raise salt.exceptions.EauthAuthenticationError(",
            "                \"Raw shell option not allowed.\"",
            "            )",
            "",
            "        if low[\"client\"] == \"ssh\":",
            "            self._authorize_ssh(low)",
            "",
            "        l_fun = getattr(self, low[\"client\"])",
            "        f_call = salt.utils.args.format_call(l_fun, low)",
            "        return l_fun(*f_call.get(\"args\", ()), **f_call.get(\"kwargs\", {}))",
            "",
            "    def local_async(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`execution modules <all-salt.modules>` asynchronously",
            "",
            "        Wraps :py:meth:`salt.client.LocalClient.run_job`.",
            "",
            "        :return: job ID",
            "        \"\"\"",
            "        local = salt.client.get_local_client(mopts=self.opts)",
            "        return local.run_job(*args, **kwargs)",
            "",
            "    def local(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`execution modules <all-salt.modules>` synchronously",
            "",
            "        See :py:meth:`salt.client.LocalClient.cmd` for all available",
            "        parameters.",
            "",
            "        Sends a command from the master to the targeted minions. This is the",
            "        same interface that Salt's own CLI uses. Note the ``arg`` and ``kwarg``",
            "        parameters are sent down to the minion(s) and the given function,",
            "        ``fun``, is called with those parameters.",
            "",
            "        :return: Returns the result from the execution module",
            "        \"\"\"",
            "        local = salt.client.get_local_client(mopts=self.opts)",
            "        return local.cmd(*args, **kwargs)",
            "",
            "    def local_subset(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`execution modules <all-salt.modules>` against subsets of minions",
            "",
            "        .. versionadded:: 2016.3.0",
            "",
            "        Wraps :py:meth:`salt.client.LocalClient.cmd_subset`",
            "        \"\"\"",
            "        local = salt.client.get_local_client(mopts=self.opts)",
            "        return local.cmd_subset(*args, **kwargs)",
            "",
            "    def local_batch(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`execution modules <all-salt.modules>` against batches of minions",
            "",
            "        .. versionadded:: 0.8.4",
            "",
            "        Wraps :py:meth:`salt.client.LocalClient.cmd_batch`",
            "",
            "        :return: Returns the result from the exeuction module for each batch of",
            "            returns",
            "        \"\"\"",
            "        local = salt.client.get_local_client(mopts=self.opts)",
            "        return local.cmd_batch(*args, **kwargs)",
            "",
            "    def ssh(self, *args, **kwargs):",
            "        \"\"\"",
            "        Run salt-ssh commands synchronously",
            "",
            "        Wraps :py:meth:`salt.client.ssh.client.SSHClient.cmd_sync`.",
            "",
            "        :return: Returns the result from the salt-ssh command",
            "        \"\"\"",
            "        ssh_client = salt.client.ssh.client.SSHClient(",
            "            mopts=self.opts, disable_custom_roster=True",
            "        )",
            "        return ssh_client.cmd_sync(kwargs)",
            "",
            "    def runner(self, fun, timeout=None, full_return=False, **kwargs):",
            "        \"\"\"",
            "        Run `runner modules <all-salt.runners>` synchronously",
            "",
            "        Wraps :py:meth:`salt.runner.RunnerClient.cmd_sync`.",
            "",
            "        Note that runner functions must be called using keyword arguments.",
            "        Positional arguments are not supported.",
            "",
            "        :return: Returns the result from the runner module",
            "        \"\"\"",
            "        kwargs[\"fun\"] = fun",
            "        runner = salt.runner.RunnerClient(self.opts)",
            "        return runner.cmd_sync(kwargs, timeout=timeout, full_return=full_return)",
            "",
            "    def runner_async(self, fun, **kwargs):",
            "        \"\"\"",
            "        Run `runner modules <all-salt.runners>` asynchronously",
            "",
            "        Wraps :py:meth:`salt.runner.RunnerClient.cmd_async`.",
            "",
            "        Note that runner functions must be called using keyword arguments.",
            "        Positional arguments are not supported.",
            "",
            "        :return: event data and a job ID for the executed function.",
            "        \"\"\"",
            "        kwargs[\"fun\"] = fun",
            "        runner = salt.runner.RunnerClient(self.opts)",
            "        return runner.cmd_async(kwargs)",
            "",
            "    def wheel(self, fun, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`wheel modules <all-salt.wheel>` synchronously",
            "",
            "        Wraps :py:meth:`salt.wheel.WheelClient.master_call`.",
            "",
            "        Note that wheel functions must be called using keyword arguments.",
            "        Positional arguments are not supported.",
            "",
            "        :return: Returns the result from the wheel module",
            "        \"\"\"",
            "        kwargs[\"fun\"] = fun",
            "        wheel = salt.wheel.WheelClient(self.opts)",
            "        return wheel.cmd_sync(kwargs)",
            "",
            "    def wheel_async(self, fun, **kwargs):",
            "        \"\"\"",
            "        Run :ref:`wheel modules <all-salt.wheel>` asynchronously",
            "",
            "        Wraps :py:meth:`salt.wheel.WheelClient.master_call`.",
            "",
            "        Note that wheel functions must be called using keyword arguments.",
            "        Positional arguments are not supported.",
            "",
            "        :return: Returns the result from the wheel module",
            "        \"\"\"",
            "        kwargs[\"fun\"] = fun",
            "        wheel = salt.wheel.WheelClient(self.opts)",
            "        return wheel.cmd_async(kwargs)",
            "",
            "",
            "CLIENTS = [",
            "    name",
            "    for name, _ in inspect.getmembers(",
            "        NetapiClient, predicate=inspect.ismethod if six.PY2 else None",
            "    )",
            "    if not (name == \"run\" or name.startswith(\"_\"))",
            "]"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "0",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": [
            "salt.netapi.NetapiClient",
            "salt.netapi",
            "salt.netapi.NetapiClient.run",
            "salt.netapi.NetapiClient.self",
            "asyncua.server.internal_session"
        ]
    }
}