{
    "barbican/common/policies/base.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 92,
                "afterPatchRowNumber": 92,
                "PatchRowcode": "         name='container_project_creator',"
            },
            "1": {
                "beforePatchRowNumber": 93,
                "afterPatchRowNumber": 93,
                "PatchRowcode": "         check_str=\"rule:creator and rule:container_project_match and \" +"
            },
            "2": {
                "beforePatchRowNumber": 94,
                "afterPatchRowNumber": 94,
                "PatchRowcode": "                   \"rule:container_creator_user\"),"
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 95,
                "PatchRowcode": "+    policy.RuleDefault("
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 96,
                "PatchRowcode": "+        name='container_project_creator_role',"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 97,
                "PatchRowcode": "+        check_str=\"rule:creator and rule:container_project_match\"),"
            },
            "6": {
                "beforePatchRowNumber": 95,
                "afterPatchRowNumber": 98,
                "PatchRowcode": " ]"
            },
            "7": {
                "beforePatchRowNumber": 96,
                "afterPatchRowNumber": 99,
                "PatchRowcode": " "
            },
            "8": {
                "beforePatchRowNumber": 97,
                "afterPatchRowNumber": 100,
                "PatchRowcode": " "
            }
        },
        "frontPatchFile": [
            "#  Licensed under the Apache License, Version 2.0 (the \"License\"); you may",
            "#  not use this file except in compliance with the License. You may obtain",
            "#  a copy of the License at",
            "#",
            "#       http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "#  Unless required by applicable law or agreed to in writing, software",
            "#  distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT",
            "#  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",
            "#  License for the specific language governing permissions and limitations",
            "#  under the License.",
            "",
            "from oslo_policy import policy",
            "",
            "",
            "rules = [",
            "    policy.RuleDefault(",
            "        name='admin',",
            "        check_str='role:admin'),",
            "    policy.RuleDefault(",
            "        name='observer',",
            "        check_str='role:observer'),",
            "    policy.RuleDefault(",
            "        name='creator',",
            "        check_str='role:creator'),",
            "    policy.RuleDefault(",
            "        name='audit',",
            "        check_str='role:audit'),",
            "    policy.RuleDefault(",
            "        name='service_admin',",
            "        check_str='role:key-manager:service-admin'),",
            "    policy.RuleDefault(",
            "        name='admin_or_creator',",
            "        check_str='rule:admin or rule:creator'),",
            "    policy.RuleDefault(",
            "        name='all_but_audit',",
            "        check_str='rule:admin or rule:observer or rule:creator'),",
            "    policy.RuleDefault(",
            "        name='all_users',",
            "        check_str='rule:admin or rule:observer or rule:creator or ' +",
            "                  'rule:audit or rule:service_admin'),",
            "    policy.RuleDefault(",
            "        name='secret_project_match',",
            "        check_str='project_id:%(target.secret.project_id)s'),",
            "    policy.RuleDefault(",
            "        name='secret_acl_read',",
            "        check_str=\"'read':%(target.secret.read)s\"),",
            "    policy.RuleDefault(",
            "        name='secret_private_read',",
            "        check_str=\"'False':%(target.secret.read_project_access)s\"),",
            "    policy.RuleDefault(",
            "        name='secret_creator_user',",
            "        check_str=\"user_id:%(target.secret.creator_id)s\"),",
            "    policy.RuleDefault(",
            "        name='container_project_match',",
            "        check_str=\"project_id:%(target.container.project_id)s\"),",
            "    policy.RuleDefault(",
            "        name='container_acl_read',",
            "        check_str=\"'read':%(target.container.read)s\"),",
            "    policy.RuleDefault(",
            "        name='container_private_read',",
            "        check_str=\"'False':%(target.container.read_project_access)s\"),",
            "    policy.RuleDefault(",
            "        name='container_creator_user',",
            "        check_str=\"user_id:%(target.container.creator_id)s\"),",
            "    policy.RuleDefault(",
            "        name='secret_non_private_read',",
            "        check_str=\"rule:all_users and rule:secret_project_match and not \" +",
            "                  \"rule:secret_private_read\"),",
            "    policy.RuleDefault(",
            "        name='secret_decrypt_non_private_read',",
            "        check_str=\"rule:all_but_audit and rule:secret_project_match and not \" +",
            "                  \"rule:secret_private_read\"),",
            "    policy.RuleDefault(",
            "        name='container_non_private_read',",
            "        check_str=\"rule:all_users and rule:container_project_match and not \" +",
            "                  \"rule:container_private_read\"),",
            "    policy.RuleDefault(",
            "        name='secret_project_admin',",
            "        check_str=\"rule:admin and rule:secret_project_match\"),",
            "    policy.RuleDefault(",
            "        name='secret_project_creator',",
            "        check_str=\"rule:creator and rule:secret_project_match and \" +",
            "                  \"rule:secret_creator_user\"),",
            "    policy.RuleDefault(",
            "        name='secret_project_creator_role',",
            "        check_str=\"rule:creator and rule:secret_project_match\"),",
            "    policy.RuleDefault(",
            "        name='container_project_admin',",
            "        check_str=\"rule:admin and rule:container_project_match\"),",
            "    policy.RuleDefault(",
            "        name='container_project_creator',",
            "        check_str=\"rule:creator and rule:container_project_match and \" +",
            "                  \"rule:container_creator_user\"),",
            "]",
            "",
            "",
            "def list_rules():",
            "    return rules"
        ],
        "afterPatchFile": [
            "#  Licensed under the Apache License, Version 2.0 (the \"License\"); you may",
            "#  not use this file except in compliance with the License. You may obtain",
            "#  a copy of the License at",
            "#",
            "#       http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "#  Unless required by applicable law or agreed to in writing, software",
            "#  distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT",
            "#  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",
            "#  License for the specific language governing permissions and limitations",
            "#  under the License.",
            "",
            "from oslo_policy import policy",
            "",
            "",
            "rules = [",
            "    policy.RuleDefault(",
            "        name='admin',",
            "        check_str='role:admin'),",
            "    policy.RuleDefault(",
            "        name='observer',",
            "        check_str='role:observer'),",
            "    policy.RuleDefault(",
            "        name='creator',",
            "        check_str='role:creator'),",
            "    policy.RuleDefault(",
            "        name='audit',",
            "        check_str='role:audit'),",
            "    policy.RuleDefault(",
            "        name='service_admin',",
            "        check_str='role:key-manager:service-admin'),",
            "    policy.RuleDefault(",
            "        name='admin_or_creator',",
            "        check_str='rule:admin or rule:creator'),",
            "    policy.RuleDefault(",
            "        name='all_but_audit',",
            "        check_str='rule:admin or rule:observer or rule:creator'),",
            "    policy.RuleDefault(",
            "        name='all_users',",
            "        check_str='rule:admin or rule:observer or rule:creator or ' +",
            "                  'rule:audit or rule:service_admin'),",
            "    policy.RuleDefault(",
            "        name='secret_project_match',",
            "        check_str='project_id:%(target.secret.project_id)s'),",
            "    policy.RuleDefault(",
            "        name='secret_acl_read',",
            "        check_str=\"'read':%(target.secret.read)s\"),",
            "    policy.RuleDefault(",
            "        name='secret_private_read',",
            "        check_str=\"'False':%(target.secret.read_project_access)s\"),",
            "    policy.RuleDefault(",
            "        name='secret_creator_user',",
            "        check_str=\"user_id:%(target.secret.creator_id)s\"),",
            "    policy.RuleDefault(",
            "        name='container_project_match',",
            "        check_str=\"project_id:%(target.container.project_id)s\"),",
            "    policy.RuleDefault(",
            "        name='container_acl_read',",
            "        check_str=\"'read':%(target.container.read)s\"),",
            "    policy.RuleDefault(",
            "        name='container_private_read',",
            "        check_str=\"'False':%(target.container.read_project_access)s\"),",
            "    policy.RuleDefault(",
            "        name='container_creator_user',",
            "        check_str=\"user_id:%(target.container.creator_id)s\"),",
            "    policy.RuleDefault(",
            "        name='secret_non_private_read',",
            "        check_str=\"rule:all_users and rule:secret_project_match and not \" +",
            "                  \"rule:secret_private_read\"),",
            "    policy.RuleDefault(",
            "        name='secret_decrypt_non_private_read',",
            "        check_str=\"rule:all_but_audit and rule:secret_project_match and not \" +",
            "                  \"rule:secret_private_read\"),",
            "    policy.RuleDefault(",
            "        name='container_non_private_read',",
            "        check_str=\"rule:all_users and rule:container_project_match and not \" +",
            "                  \"rule:container_private_read\"),",
            "    policy.RuleDefault(",
            "        name='secret_project_admin',",
            "        check_str=\"rule:admin and rule:secret_project_match\"),",
            "    policy.RuleDefault(",
            "        name='secret_project_creator',",
            "        check_str=\"rule:creator and rule:secret_project_match and \" +",
            "                  \"rule:secret_creator_user\"),",
            "    policy.RuleDefault(",
            "        name='secret_project_creator_role',",
            "        check_str=\"rule:creator and rule:secret_project_match\"),",
            "    policy.RuleDefault(",
            "        name='container_project_admin',",
            "        check_str=\"rule:admin and rule:container_project_match\"),",
            "    policy.RuleDefault(",
            "        name='container_project_creator',",
            "        check_str=\"rule:creator and rule:container_project_match and \" +",
            "                  \"rule:container_creator_user\"),",
            "    policy.RuleDefault(",
            "        name='container_project_creator_role',",
            "        check_str=\"rule:creator and rule:container_project_match\"),",
            "]",
            "",
            "",
            "def list_rules():",
            "    return rules"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {},
        "addLocation": []
    },
    "barbican/common/policies/containers.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 80,
                "afterPatchRowNumber": 80,
                "PatchRowcode": "     ),"
            },
            "1": {
                "beforePatchRowNumber": 81,
                "afterPatchRowNumber": 81,
                "PatchRowcode": "     policy.DocumentedRuleDefault("
            },
            "2": {
                "beforePatchRowNumber": 82,
                "afterPatchRowNumber": 82,
                "PatchRowcode": "         name='container_secret:post',"
            },
            "3": {
                "beforePatchRowNumber": 83,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        check_str='rule:admin or ' +"
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 83,
                "PatchRowcode": "+        check_str='rule:container_project_admin or ' +"
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 84,
                "PatchRowcode": "+                  'rule:container_project_creator or ' +"
            },
            "6": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 85,
                "PatchRowcode": "+                  'rule:container_project_creator_role and ' +"
            },
            "7": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 86,
                "PatchRowcode": "+                  'rule:container_non_private_read or ' +"
            },
            "8": {
                "beforePatchRowNumber": 84,
                "afterPatchRowNumber": 87,
                "PatchRowcode": "                   f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +"
            },
            "9": {
                "beforePatchRowNumber": 85,
                "afterPatchRowNumber": 88,
                "PatchRowcode": "                   f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\","
            },
            "10": {
                "beforePatchRowNumber": 86,
                "afterPatchRowNumber": 89,
                "PatchRowcode": "         scope_types=['project'],"
            },
            "11": {
                "beforePatchRowNumber": 94,
                "afterPatchRowNumber": 97,
                "PatchRowcode": "     ),"
            },
            "12": {
                "beforePatchRowNumber": 95,
                "afterPatchRowNumber": 98,
                "PatchRowcode": "     policy.DocumentedRuleDefault("
            },
            "13": {
                "beforePatchRowNumber": 96,
                "afterPatchRowNumber": 99,
                "PatchRowcode": "         name='container_secret:delete',"
            },
            "14": {
                "beforePatchRowNumber": 97,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-        check_str='rule:admin or ' +"
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 100,
                "PatchRowcode": "+        check_str='rule:container_project_admin or ' +"
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 101,
                "PatchRowcode": "+                  'rule:container_project_creator or ' +"
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 102,
                "PatchRowcode": "+                  'rule:container_project_creator_role and ' +"
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 103,
                "PatchRowcode": "+                  'rule:container_non_private_read or ' +"
            },
            "19": {
                "beforePatchRowNumber": 98,
                "afterPatchRowNumber": 104,
                "PatchRowcode": "                   f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +"
            },
            "20": {
                "beforePatchRowNumber": 99,
                "afterPatchRowNumber": 105,
                "PatchRowcode": "                   f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\","
            },
            "21": {
                "beforePatchRowNumber": 100,
                "afterPatchRowNumber": 106,
                "PatchRowcode": "         scope_types=['project'],"
            }
        },
        "frontPatchFile": [
            "#  Licensed under the Apache License, Version 2.0 (the \"License\"); you may",
            "#  not use this file except in compliance with the License. You may obtain",
            "#  a copy of the License at",
            "#",
            "#       http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "#  Unless required by applicable law or agreed to in writing, software",
            "#  distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT",
            "#  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",
            "#  License for the specific language governing permissions and limitations",
            "#  under the License.",
            "",
            "from oslo_policy import policy",
            "",
            "",
            "_READER = \"role:reader\"",
            "_MEMBER = \"role:member\"",
            "_ADMIN = \"role:admin\"",
            "_PROJECT_MEMBER = f\"{_MEMBER} and project_id:%(target.container.project_id)s\"",
            "_PROJECT_ADMIN = f\"{_ADMIN} and project_id:%(target.container.project_id)s\"",
            "_CONTAINER_CREATOR = \"user_id:%(target.container.creator_id)s\"",
            "_CONTAINER_IS_NOT_PRIVATE = \"True:%(target.container.read_project_access)s\"",
            "",
            "rules = [",
            "    policy.DocumentedRuleDefault(",
            "        name='containers:post',",
            "        check_str=f\"rule:admin_or_creator or {_MEMBER}\",",
            "        scope_types=['project'],",
            "        description='Creates a container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers',",
            "                'method': 'POST'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='containers:get',",
            "        check_str=f\"rule:all_but_audit or {_MEMBER}\",",
            "        scope_types=['project'],",
            "        description='Lists a projects containers.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers',",
            "                'method': 'GET'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='container:get',",
            "        check_str='rule:container_non_private_read or ' +",
            "                  'rule:container_project_creator or ' +",
            "                  'rule:container_project_admin or ' +",
            "                  'rule:container_acl_read or ' +",
            "                  f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +",
            "                  f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\",",
            "        scope_types=['project'],",
            "        description='Retrieves a single container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers/{container-id}',",
            "                'method': 'GET'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='container:delete',",
            "        check_str='rule:container_project_admin or ' +",
            "                  'rule:container_project_creator or ' +",
            "                  f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +",
            "                  f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\",",
            "        scope_types=['project'],",
            "        description='Deletes a container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers/{uuid}',",
            "                'method': 'DELETE'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='container_secret:post',",
            "        check_str='rule:admin or ' +",
            "                  f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +",
            "                  f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\",",
            "        scope_types=['project'],",
            "        description='Add a secret to an existing container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers/{container-id}/secrets',",
            "                'method': 'POST'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='container_secret:delete',",
            "        check_str='rule:admin or ' +",
            "                  f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +",
            "                  f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\",",
            "        scope_types=['project'],",
            "        description='Remove a secret from a container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers/{container-id}/secrets/{secret-id}',",
            "                'method': 'DELETE'",
            "            }",
            "        ]",
            "    ),",
            "]",
            "",
            "",
            "def list_rules():",
            "    return rules"
        ],
        "afterPatchFile": [
            "#  Licensed under the Apache License, Version 2.0 (the \"License\"); you may",
            "#  not use this file except in compliance with the License. You may obtain",
            "#  a copy of the License at",
            "#",
            "#       http://www.apache.org/licenses/LICENSE-2.0",
            "#",
            "#  Unless required by applicable law or agreed to in writing, software",
            "#  distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT",
            "#  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",
            "#  License for the specific language governing permissions and limitations",
            "#  under the License.",
            "",
            "from oslo_policy import policy",
            "",
            "",
            "_READER = \"role:reader\"",
            "_MEMBER = \"role:member\"",
            "_ADMIN = \"role:admin\"",
            "_PROJECT_MEMBER = f\"{_MEMBER} and project_id:%(target.container.project_id)s\"",
            "_PROJECT_ADMIN = f\"{_ADMIN} and project_id:%(target.container.project_id)s\"",
            "_CONTAINER_CREATOR = \"user_id:%(target.container.creator_id)s\"",
            "_CONTAINER_IS_NOT_PRIVATE = \"True:%(target.container.read_project_access)s\"",
            "",
            "rules = [",
            "    policy.DocumentedRuleDefault(",
            "        name='containers:post',",
            "        check_str=f\"rule:admin_or_creator or {_MEMBER}\",",
            "        scope_types=['project'],",
            "        description='Creates a container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers',",
            "                'method': 'POST'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='containers:get',",
            "        check_str=f\"rule:all_but_audit or {_MEMBER}\",",
            "        scope_types=['project'],",
            "        description='Lists a projects containers.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers',",
            "                'method': 'GET'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='container:get',",
            "        check_str='rule:container_non_private_read or ' +",
            "                  'rule:container_project_creator or ' +",
            "                  'rule:container_project_admin or ' +",
            "                  'rule:container_acl_read or ' +",
            "                  f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +",
            "                  f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\",",
            "        scope_types=['project'],",
            "        description='Retrieves a single container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers/{container-id}',",
            "                'method': 'GET'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='container:delete',",
            "        check_str='rule:container_project_admin or ' +",
            "                  'rule:container_project_creator or ' +",
            "                  f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +",
            "                  f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\",",
            "        scope_types=['project'],",
            "        description='Deletes a container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers/{uuid}',",
            "                'method': 'DELETE'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='container_secret:post',",
            "        check_str='rule:container_project_admin or ' +",
            "                  'rule:container_project_creator or ' +",
            "                  'rule:container_project_creator_role and ' +",
            "                  'rule:container_non_private_read or ' +",
            "                  f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +",
            "                  f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\",",
            "        scope_types=['project'],",
            "        description='Add a secret to an existing container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers/{container-id}/secrets',",
            "                'method': 'POST'",
            "            }",
            "        ]",
            "    ),",
            "    policy.DocumentedRuleDefault(",
            "        name='container_secret:delete',",
            "        check_str='rule:container_project_admin or ' +",
            "                  'rule:container_project_creator or ' +",
            "                  'rule:container_project_creator_role and ' +",
            "                  'rule:container_non_private_read or ' +",
            "                  f\"({_PROJECT_MEMBER} and ({_CONTAINER_CREATOR} or \" +",
            "                  f\"{_CONTAINER_IS_NOT_PRIVATE})) or {_PROJECT_ADMIN}\",",
            "        scope_types=['project'],",
            "        description='Remove a secret from a container.',",
            "        operations=[",
            "            {",
            "                'path': '/v1/containers/{container-id}/secrets/{secret-id}',",
            "                'method': 'DELETE'",
            "            }",
            "        ]",
            "    ),",
            "]",
            "",
            "",
            "def list_rules():",
            "    return rules"
        ],
        "action": [
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0",
            "0",
            "0",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "83": [],
            "97": []
        },
        "addLocation": []
    }
}