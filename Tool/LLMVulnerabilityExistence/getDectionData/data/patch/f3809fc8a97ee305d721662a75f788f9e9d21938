{
    "server/openslides/utils/validate.py": {
        "Patch": {
            "0": {
                "beforePatchRowNumber": 43,
                "afterPatchRowNumber": 43,
                "PatchRowcode": "     \"video\","
            },
            "1": {
                "beforePatchRowNumber": 44,
                "afterPatchRowNumber": 44,
                "PatchRowcode": " ]"
            },
            "2": {
                "beforePatchRowNumber": 45,
                "afterPatchRowNumber": 45,
                "PatchRowcode": " "
            },
            "3": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 46,
                "PatchRowcode": "+allowed_attributes = ["
            },
            "4": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 47,
                "PatchRowcode": "+    \"align\","
            },
            "5": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 48,
                "PatchRowcode": "+    \"alt\","
            },
            "6": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 49,
                "PatchRowcode": "+    \"autoplay\","
            },
            "7": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 50,
                "PatchRowcode": "+    \"background\","
            },
            "8": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 51,
                "PatchRowcode": "+    \"bgcolor\","
            },
            "9": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 52,
                "PatchRowcode": "+    \"border\","
            },
            "10": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 53,
                "PatchRowcode": "+    \"class\","
            },
            "11": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 54,
                "PatchRowcode": "+    \"colspan\","
            },
            "12": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 55,
                "PatchRowcode": "+    \"controls\","
            },
            "13": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 56,
                "PatchRowcode": "+    \"dir\","
            },
            "14": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 57,
                "PatchRowcode": "+    \"height\","
            },
            "15": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 58,
                "PatchRowcode": "+    \"hidden\","
            },
            "16": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 59,
                "PatchRowcode": "+    \"href\","
            },
            "17": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 60,
                "PatchRowcode": "+    \"hreflang\","
            },
            "18": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 61,
                "PatchRowcode": "+    \"id\","
            },
            "19": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 62,
                "PatchRowcode": "+    \"lang\","
            },
            "20": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 63,
                "PatchRowcode": "+    \"loop\","
            },
            "21": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 64,
                "PatchRowcode": "+    \"muted\","
            },
            "22": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 65,
                "PatchRowcode": "+    \"poster\","
            },
            "23": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 66,
                "PatchRowcode": "+    \"preload\","
            },
            "24": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 67,
                "PatchRowcode": "+    \"rel\","
            },
            "25": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 68,
                "PatchRowcode": "+    \"rowspan\","
            },
            "26": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 69,
                "PatchRowcode": "+    \"scope\","
            },
            "27": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 70,
                "PatchRowcode": "+    \"sizes\","
            },
            "28": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 71,
                "PatchRowcode": "+    \"src\","
            },
            "29": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 72,
                "PatchRowcode": "+    \"srcset\","
            },
            "30": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 73,
                "PatchRowcode": "+    \"start\","
            },
            "31": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 74,
                "PatchRowcode": "+    \"style\","
            },
            "32": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 75,
                "PatchRowcode": "+    \"target\","
            },
            "33": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 76,
                "PatchRowcode": "+    \"title\","
            },
            "34": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 77,
                "PatchRowcode": "+    \"width\","
            },
            "35": {
                "beforePatchRowNumber": "",
                "afterPatchRowNumber": 78,
                "PatchRowcode": "+]"
            },
            "36": {
                "beforePatchRowNumber": 46,
                "afterPatchRowNumber": 79,
                "PatchRowcode": " "
            },
            "37": {
                "beforePatchRowNumber": 47,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-def allow_all(tag: str, name: str, value: str) -> bool:"
            },
            "38": {
                "beforePatchRowNumber": 48,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-    return True"
            },
            "39": {
                "beforePatchRowNumber": 49,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "40": {
                "beforePatchRowNumber": 50,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-"
            },
            "41": {
                "beforePatchRowNumber": 51,
                "afterPatchRowNumber": "",
                "PatchRowcode": "-allowed_attributes = allow_all"
            },
            "42": {
                "beforePatchRowNumber": 52,
                "afterPatchRowNumber": 80,
                "PatchRowcode": " allowed_styles = ["
            },
            "43": {
                "beforePatchRowNumber": 53,
                "afterPatchRowNumber": 81,
                "PatchRowcode": "     \"color\","
            },
            "44": {
                "beforePatchRowNumber": 54,
                "afterPatchRowNumber": 82,
                "PatchRowcode": "     \"background-color\","
            }
        },
        "frontPatchFile": [
            "from typing import Any, List",
            "",
            "import bleach",
            "",
            "from .rest_api import ValidationError",
            "",
            "",
            "allowed_tags_strict = [",
            "    \"a\",",
            "    \"img\",  # links and images",
            "    \"br\",",
            "    \"p\",",
            "    \"span\",",
            "    \"blockquote\",  # text layout",
            "    \"strike\",",
            "    \"del\",",
            "    \"ins\",",
            "    \"strong\",",
            "    \"u\",",
            "    \"em\",",
            "    \"sup\",",
            "    \"sub\",",
            "    \"pre\",  # text formatting",
            "    \"h1\",",
            "    \"h2\",",
            "    \"h3\",",
            "    \"h4\",",
            "    \"h5\",",
            "    \"h6\",  # headings",
            "    \"ol\",",
            "    \"ul\",",
            "    \"li\",  # lists",
            "    \"table\",",
            "    \"caption\",",
            "    \"thead\",",
            "    \"tbody\",",
            "    \"th\",",
            "    \"tr\",",
            "    \"td\",  # tables",
            "    \"div\",",
            "]",
            "allowed_tags_permissive = allowed_tags_strict + [",
            "    \"video\",",
            "]",
            "",
            "",
            "def allow_all(tag: str, name: str, value: str) -> bool:",
            "    return True",
            "",
            "",
            "allowed_attributes = allow_all",
            "allowed_styles = [",
            "    \"color\",",
            "    \"background-color\",",
            "    \"height\",",
            "    \"width\",",
            "    \"text-align\",",
            "    \"vertical-align\",",
            "    \"float\",",
            "    \"text-decoration\",",
            "    \"margin\",",
            "    \"padding\",",
            "    \"line-height\",",
            "    \"max-width\",",
            "    \"min-width\",",
            "    \"max-height\",",
            "    \"min-height\",",
            "    \"overflow\",",
            "    \"word-break\",",
            "    \"word-wrap\",",
            "]",
            "",
            "",
            "def validate_html_strict(html: str) -> str:",
            "    \"\"\"",
            "    This method takes a string and escapes all non-whitelisted html entries.",
            "    Every field of a model that is loaded trusted in the DOM should be validated.",
            "    During copy and paste from Word maybe some tabs are spread over the html. Remove them.",
            "    \"\"\"",
            "    return base_validate_html(html, allowed_tags_strict)",
            "",
            "",
            "def validate_html_permissive(html: str) -> str:",
            "    \"\"\"",
            "    See validate_html_strict, but allows some more tags, like iframes and videos.",
            "    Do not use on validation for normal users, only for admins!",
            "    \"\"\"",
            "    return base_validate_html(html, allowed_tags_permissive)",
            "",
            "",
            "def base_validate_html(html: str, allowed_tags: List[str]) -> str:",
            "    \"\"\"",
            "    For internal use only.",
            "    \"\"\"",
            "    html = html.replace(\"\\t\", \"\")",
            "    return bleach.clean(",
            "        html, tags=allowed_tags, attributes=allowed_attributes, styles=allowed_styles",
            "    )",
            "",
            "",
            "def validate_json(json: Any, max_depth: int) -> Any:",
            "    \"\"\"",
            "    Traverses through the JSON structure (dicts and lists) and runs",
            "    validate_html_strict on every found string.",
            "",
            "    Give max-depth to protect against stack-overflows. This should be the",
            "    maximum nested depth of the object expected.",
            "    \"\"\"",
            "",
            "    if max_depth == 0:",
            "        raise ValidationError({\"detail\": \"The JSON is too nested.\"})",
            "",
            "    if isinstance(json, dict):",
            "        return {key: validate_json(value, max_depth - 1) for key, value in json.items()}",
            "    if isinstance(json, list):",
            "        return [validate_json(item, max_depth - 1) for item in json]",
            "    if isinstance(json, str):",
            "        return validate_html_strict(json)",
            "",
            "    return json"
        ],
        "afterPatchFile": [
            "from typing import Any, List",
            "",
            "import bleach",
            "",
            "from .rest_api import ValidationError",
            "",
            "",
            "allowed_tags_strict = [",
            "    \"a\",",
            "    \"img\",  # links and images",
            "    \"br\",",
            "    \"p\",",
            "    \"span\",",
            "    \"blockquote\",  # text layout",
            "    \"strike\",",
            "    \"del\",",
            "    \"ins\",",
            "    \"strong\",",
            "    \"u\",",
            "    \"em\",",
            "    \"sup\",",
            "    \"sub\",",
            "    \"pre\",  # text formatting",
            "    \"h1\",",
            "    \"h2\",",
            "    \"h3\",",
            "    \"h4\",",
            "    \"h5\",",
            "    \"h6\",  # headings",
            "    \"ol\",",
            "    \"ul\",",
            "    \"li\",  # lists",
            "    \"table\",",
            "    \"caption\",",
            "    \"thead\",",
            "    \"tbody\",",
            "    \"th\",",
            "    \"tr\",",
            "    \"td\",  # tables",
            "    \"div\",",
            "]",
            "allowed_tags_permissive = allowed_tags_strict + [",
            "    \"video\",",
            "]",
            "",
            "allowed_attributes = [",
            "    \"align\",",
            "    \"alt\",",
            "    \"autoplay\",",
            "    \"background\",",
            "    \"bgcolor\",",
            "    \"border\",",
            "    \"class\",",
            "    \"colspan\",",
            "    \"controls\",",
            "    \"dir\",",
            "    \"height\",",
            "    \"hidden\",",
            "    \"href\",",
            "    \"hreflang\",",
            "    \"id\",",
            "    \"lang\",",
            "    \"loop\",",
            "    \"muted\",",
            "    \"poster\",",
            "    \"preload\",",
            "    \"rel\",",
            "    \"rowspan\",",
            "    \"scope\",",
            "    \"sizes\",",
            "    \"src\",",
            "    \"srcset\",",
            "    \"start\",",
            "    \"style\",",
            "    \"target\",",
            "    \"title\",",
            "    \"width\",",
            "]",
            "",
            "allowed_styles = [",
            "    \"color\",",
            "    \"background-color\",",
            "    \"height\",",
            "    \"width\",",
            "    \"text-align\",",
            "    \"vertical-align\",",
            "    \"float\",",
            "    \"text-decoration\",",
            "    \"margin\",",
            "    \"padding\",",
            "    \"line-height\",",
            "    \"max-width\",",
            "    \"min-width\",",
            "    \"max-height\",",
            "    \"min-height\",",
            "    \"overflow\",",
            "    \"word-break\",",
            "    \"word-wrap\",",
            "]",
            "",
            "",
            "def validate_html_strict(html: str) -> str:",
            "    \"\"\"",
            "    This method takes a string and escapes all non-whitelisted html entries.",
            "    Every field of a model that is loaded trusted in the DOM should be validated.",
            "    During copy and paste from Word maybe some tabs are spread over the html. Remove them.",
            "    \"\"\"",
            "    return base_validate_html(html, allowed_tags_strict)",
            "",
            "",
            "def validate_html_permissive(html: str) -> str:",
            "    \"\"\"",
            "    See validate_html_strict, but allows some more tags, like iframes and videos.",
            "    Do not use on validation for normal users, only for admins!",
            "    \"\"\"",
            "    return base_validate_html(html, allowed_tags_permissive)",
            "",
            "",
            "def base_validate_html(html: str, allowed_tags: List[str]) -> str:",
            "    \"\"\"",
            "    For internal use only.",
            "    \"\"\"",
            "    html = html.replace(\"\\t\", \"\")",
            "    return bleach.clean(",
            "        html, tags=allowed_tags, attributes=allowed_attributes, styles=allowed_styles",
            "    )",
            "",
            "",
            "def validate_json(json: Any, max_depth: int) -> Any:",
            "    \"\"\"",
            "    Traverses through the JSON structure (dicts and lists) and runs",
            "    validate_html_strict on every found string.",
            "",
            "    Give max-depth to protect against stack-overflows. This should be the",
            "    maximum nested depth of the object expected.",
            "    \"\"\"",
            "",
            "    if max_depth == 0:",
            "        raise ValidationError({\"detail\": \"The JSON is too nested.\"})",
            "",
            "    if isinstance(json, dict):",
            "        return {key: validate_json(value, max_depth - 1) for key, value in json.items()}",
            "    if isinstance(json, list):",
            "        return [validate_json(item, max_depth - 1) for item in json]",
            "    if isinstance(json, str):",
            "        return validate_html_strict(json)",
            "",
            "    return json"
        ],
        "action": [
            "0",
            "0",
            "0",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "-1",
            "0",
            "2",
            "2",
            "2",
            "2",
            "2",
            "0",
            "0",
            "0"
        ],
        "dele_reviseLocation": {
            "47": [
                "allow_all"
            ],
            "48": [
                "allow_all"
            ],
            "49": [],
            "50": [],
            "51": [
                "allowed_attributes"
            ]
        },
        "addLocation": []
    }
}