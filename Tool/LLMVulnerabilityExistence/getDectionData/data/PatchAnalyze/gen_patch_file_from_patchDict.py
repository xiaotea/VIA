import os
import json


def create_folder_and_write_file(file_path, content):
    folder_path = os.path.dirname(file_path)
    if not os.path.exists(folder_path):
        os.makedirs(folder_path)
    with open(file_path, 'w',encoding='utf-8') as file:
        file.write(content)


commit_dict_root_path = r'D:\D\个人文件\开源软件供应链安全\python漏洞影响性分析实验\知识图谱创建\整理好的\patchDictNew'

for commit_id in os.listdir(commit_dict_root_path):
    commit_dict_path = os.path.join(commit_dict_root_path, commit_id)
    commit_dict = json.load(open(commit_dict_path, 'r'))
    for patch_file_name in commit_dict:
        patch_file_content_list = commit_dict[patch_file_name]['afterPatchFile']
        content = '\n'.join(patch_file_content_list)  # 文件内容
        file_path = os.path.join("D:\D\个人文件\开源软件供应链安全\python漏洞影响性分析实验\知识图谱创建\PatchAnalyze\patch_file",commit_id,patch_file_name)
        create_folder_and_write_file(file_path, content)