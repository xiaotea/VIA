A stored cross-site scripting (XSS) vulnerability exists in Apache Superset before 3.0.3. An authenticated attacker with create/update permissions on charts or dashboards could store a script or add a specific HTML snippet that would act as a stored XSS.

For 2.X versions, users should change their config to include:

TALISMAN_CONFIG = {
    &quot;content_security_policy&quot;: {
        &quot;base-uri&quot;: [&quot;&#39;self&#39;&quot;],
        &quot;default-src&quot;: [&quot;&#39;self&#39;&quot;],
        &quot;img-src&quot;: [&quot;&#39;self&#39;&quot;, &quot;blob:&quot;, &quot;data:&quot;],
        &quot;worker-src&quot;: [&quot;&#39;self&#39;&quot;, &quot;blob:&quot;],
        &quot;connect-src&quot;: [
            &quot;&#39;self&#39;&quot;,
            &quot; https://api.mapbox.com&quot; https://api.mapbox.com&quot; ;,
            &quot; https://events.mapbox.com&quot; https://events.mapbox.com&quot; ;,
        ],
        &quot;object-src&quot;: &quot;&#39;none&#39;&quot;,
        &quot;style-src&quot;: [
            &quot;&#39;self&#39;&quot;,
            &quot;&#39;unsafe-inline&#39;&quot;,
        ],
        &quot;script-src&quot;: [&quot;&#39;self&#39;&quot;, &quot;&#39;strict-dynamic&#39;&quot;],
    },
    &quot;content_security_policy_nonce_in&quot;: [&quot;script-src&quot;],
    &quot;force_https&quot;: False,
    &quot;session_cookie_secure&quot;: False,
}